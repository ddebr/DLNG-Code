package com.seipl.hazira.dlng.mrcr;
import javax.naming.*;
import javax.servlet.http.HttpSession;
import javax.sql.*;
import javax.swing.tree.ExpandVetoException;


import org.omg.CORBA.VersionSpecHelper;

import java.util.*;
import java.awt.Color;
import java.io.IOException;
import java.io.PrintWriter;
import java.security.Guard;
//import java.awt.geom.Arc2D.Double;
import java.sql.*;
import java.text.*;

import com.seipl.hazira.dlng.util.RuntimeConf;
import com.seipl.hazira.dlng.util.UtilBean;
//Coded By          : Achal Pathak
//Code Reviewed by	:  
//CR Date			:  
//Status	  		: Developing

public class DataBean_CR_Security_Report
{
    Connection conn; 
	Statement stmt;
	Statement stmt1;
	Statement stmt2;
	Statement stmt3;
	Statement stmt_tmp1; //HARSH20210318
	ResultSet rset;
	ResultSet rset_tmpl; //md20111122
	ResultSet rset1;
	ResultSet rset2;
	ResultSet rset3;
	String queryString="";
	String queryString1="";
	String queryString2="";
	
	//Following NumberFormat Object is defined by Samik Shah ... On 8th Dec., 2009 ...
	NumberFormat nf = new DecimalFormat("###########0.00");
	NumberFormat nf2 = new DecimalFormat("###########0.0000");//MD20111121
	
	//Following util Object is defined by Samik Shah ... On 1st Dec., 2009 ...
	UtilBean util = new UtilBean();
		
	//Following (3) String Variables are defined by Samik Shah ... On 2nd Nov., 2009 ...
	public String callFlag="";	
	public String cargo_ref_no="";
	public String year="";
	
	// variable declaration for fetching data of selected Mandate Request no
	
	String cargo_ref_cd = "";
	String SELLER_NAME = "";
	String Mandate_conf_no = "";		                     
	String ship_cd ="";
	String SHIPNAME= "";
	
	// Varible for the Cargo Nomination Form.
	String from_date ="";
	String to_date = "";
	String tot_commitment="";
	String sup_tot_comitment="";
	String bal_tot_comitment="";
	//Introduce by Milan 20110916
	String tot_commitment_mmscm="";
	String sup_tot_comitment_mmscm="";
	String bal_tot_comitment_mmscm="";
	//for Letter of Agreement
	String loa_tot_commitment_mmscm="";
	String loa_sup_tot_comitment_mmscm="";
	String loa_bal_tot_comitment_mmscm="";
	//FOR RE-GAS
	String re_gas_tot_commit_mmscm="";
	String re_gas_sup_tot_comitment_mmscm="";
	String re_gas_bal_tot_comitment_mmscm="";
	//=============================
	String loa_sup_tot_comitment="";
	String loa_bal_tot_comitment="";
	String re_gas_sup_tot_comitment="";
	String re_gas_bal_tot_comitment="";
	String loa_tot_commitment="";
	String re_gas_tot_commit="";
	
	//TRADER MASTER DETAILS
	Vector MAN_CONF_DT= new Vector();
	Vector TRADER_CD = new Vector();
	Vector TRADER_NAME = new Vector();
	Vector TRADER_ABBR = new Vector();
				
	Vector CARGO_REF_CD = new Vector();
	Vector CARGO_REF_NO = new Vector();
	//Vector CONSUMED_QTY = new Vector();	
	// Variable declaration for the mandate request list : Searching 
	Vector MAN_CD = new Vector();
	Vector MAN_CONF_CD = new Vector();	
	Vector CARGO_ARRIVAL_DATE = new Vector();
	
	Vector SHIP_CD = new Vector(); 
	Vector SHIP_NAME = new Vector();
	
	Vector SN_NO = new Vector();
	Vector SN_REV_NO=new Vector();
	Vector FGSA_REV_NO=new Vector();
	Vector FGSA_NO=new Vector();
	Vector CUSTOMER_CD = new Vector();	
	Vector CUSTOMER_NM =new Vector();
	Vector CUSTOMER_ABBR =new Vector();
	Vector BOOKMMBTU = new Vector();	
	Vector SUPPLIEDMBTU = new Vector(); 
	Vector BALANCEMMBTU = new Vector();
	//Intruduce By Milan 20110916 For MMSCM
	Vector BOOKMMSCM = new Vector();	
	Vector SUPPLIEDMMSCM = new Vector(); 
	Vector BALANCEMMSCM = new Vector();
	
	Vector SN_REF_NO = new Vector();
	//////////////////
	Vector Deal_NO=new Vector();
	Vector Deal_Signing_dt=new Vector();
	Vector Deal_cust_nm=new Vector();
	Vector Deal_cust_cd=new Vector();
	Vector Deal_cust_abbr=new Vector();
	Vector Deal_typ=new Vector();
	Vector Deal_cargo_seq_no=new Vector();
	Vector Deal_ENT_DT=new Vector();
	Vector Deal_ENT_BY=new Vector();
	Vector Deal_Price=new Vector();
	Vector Deal_curr=new Vector();
	Vector Deal_ST_DT=new Vector();
	Vector Deal_END_DT=new Vector();
	Vector Deal_qty_booked=new Vector();
	Vector Deal_DCQ=new Vector();
	Vector Deal_qty_Supplied=new Vector();
	Vector Deal_sts=new Vector();
	Vector Deal_duration=new Vector();
	Vector Deal_amt_wout_tax=new Vector();
	Vector Deal_amt_PAY_NOT_RECV=new Vector();
	Vector Deal_adv_amt=new Vector();
	Vector Deal_cont_no=new Vector();
	Vector Deal_typ_nm=new Vector();
	String sysdate="";
	/////////////////////
	
	//Variable Declaration for LAO Cargo Summary Mgmt, by Achal on 22nd October 2010 ...	
	Vector LOA_NO = new Vector();
	Vector LOA_CUSTOMER_CD = new Vector();
	Vector LOA_CARGO_ARRIVAL_DATE = new Vector();
	Vector LOA_REV_NO = new Vector();
	Vector TENDER_NO = new Vector();
	Vector LOA_BOOKMMBTU = new Vector();
	Vector LOA_SUPPLIEDMBTU = new Vector();
	Vector LOA_BALANCEMMBTU = new Vector();
	//Introduce By Milan 20110917 for MMSCM
	Vector LOA_BOOKMMSCM = new Vector();
	Vector LOA_SUPPLIEDMMSCM = new Vector();
	Vector LOA_BALANCEMMSCM = new Vector();
	
	Vector LOA_CUSTOMER_NM = new Vector();
	Vector LOA_CUSTOMER_ABBR = new Vector();
	Vector LOA_REF_NO = new Vector();
	
	//	Variable Declaration for Re-Gas Cargo Summary Mgmt, by Achal on 22nd October 2010 ...	
	Vector RE_GAS_NO = new Vector();
	Vector RE_GAS_CUSTOMER_CD = new Vector();
	Vector RE_GAS_CARGO_ARRIVAL_DATE = new Vector();
	Vector RE_GAS_SEQ_NO = new Vector();
	Vector RE_GAS_BOOKMMBTU = new Vector();
	Vector RE_GAS_SUPPLIEDMBTU = new Vector();
	Vector RE_GAS_BALANCEMMBTU = new Vector();
	Vector RE_GAS_CUSTOMER_NM = new Vector();
	Vector RE_GAS_CUSTOMER_ABBR = new Vector();
	
	//introduce By Milan 20110916
	Vector RE_GAS_BOOKMMSCM = new Vector();
	Vector RE_GAS_SUPPLIEDMMSCM = new Vector();
	Vector RE_GAS_BALANCEMMSCM = new Vector();
	
	//	Variable Declaration for TCQ Variation, by Achal on 23rd March 2011 ...	
	Vector SN_CLOSURE_DT = new Vector();
	Vector SN_CLOSURE_CLOSE = new Vector();	
	Vector TCQ_REQUEST_QTY = new Vector();
	Vector LOA_TCQ_REQUEST_QTY = new Vector();
	Vector ACTUAL_TCQ = new Vector();
	Vector LOA_ACTUAL_TCQ = new Vector();
	Vector SN_CLOSURE_QTY = new Vector();
	Vector TCQ_REQUEST_SIGN = new Vector();
	Vector LOA_TCQ_REQUEST_SIGN = new Vector();
	
	//Following 6 Vectors have been defined by Priyanka on 23rd March 2011 ...	
	Vector SIGNING_DT = new Vector();
	Vector RATE = new Vector();
	Vector LOA_SIGNING_DT = new Vector();
	Vector LOA_RATE = new Vector();
	Vector REGAS_SIGNING_DT = new Vector();
	Vector REGAS_RATE = new Vector();
	
//	FOLLOWING VECTOR HAVE BEEN DEFINED BY JAIMIN ON 17th SEP 2011...
	String cust_nm="";
	Vector CUSTOMER_CD_FGSA=new Vector();
	Vector CUSTOMER_ABR_FGSA=new Vector();
	Vector FGSA_NO_NEW=new Vector();
	Vector SIGNING_DT_FGSA=new Vector();
	Vector START_DT_FGSA=new Vector();
	Vector END_DT_FGSA=new Vector();
	Vector REV_NO_FGSA=new Vector();
	Vector RENEWAL_DT_FGSA=new Vector();
	Vector REV_DT_FGSA=new Vector();
	Vector EMP_CD_FGSA=new Vector();
	Vector EMP_ABR_FGSA=new Vector();
	Vector CUST_CD=new Vector();
	Vector CUST_NM=new Vector();
	Vector DELV_POINT=new Vector();
	
	//FOLLOWING VECTOR HAVE BEEN DEFINED BY Milan Dalsaniya ON 21st NOV 2011...
	// SUFFIX P TO THE VARIABLE STAND FOR THE PRICE DTL VECTORS FOR SN
	Vector CUSTOMER_CD_SN_P=new Vector();
	Vector CUSTOMER_ABR_SN_P=new Vector();
	Vector SN_NO_P =new Vector();
	
	Vector SN_REV_NO_P =new Vector();
	Vector FGSA_NO_P =new Vector();
	Vector FGSA_REV_NO_P =new Vector();
	Vector START_DT_SN_P=new Vector();
	Vector END_DT_SN_P=new Vector();
	Vector RATE_SN_P=new Vector();

	Vector CARGO_REF_NO_SN_P=new Vector();
	Vector CARGO_CONF_PRICE_DT_SN_P=new Vector();
	Vector CARGO_CUSTOM_DUTY_SN_P=new Vector();
	Vector CARGO_MARGIN_SN_P=new Vector();
	Vector COLOR_FLAG_RATE_SN_P=new Vector();
	Vector COLOR_FLAG_CUSTOM_SN_P=new Vector();
	Vector COLOR_FLAG_CONF_PRICE_SN_P=new Vector();
	Vector COLOR_FLAG_MARGIN_SN_P=new Vector();
	

	//for customer wise allocation
	Vector Vgas_date=new Vector();
	Vector[] SUPPLIEDMBTU1 ; 
	Vector[] SUPPLIEDMMSCM1; 
	Vector[] RE_GAS_SUPPLIEDMBTU1;
	Vector[] RE_GAS_SUPPLIEDMMSCM1;
	Vector[] LOA_SUPPLIEDMBTU1; 
	Vector[] LOA_SUPPLIEDMMSCM1; 
	Vector Regas_cargo_ref_no=new Vector(); 
	
	//Following variable declare for regas cargo energy statment
	public String Buyer_cd = "0";
	public String re_gas_no = "0";
	public String no_of_cargo = "1";
	public String frm_dt = "";//JHP
	public String to_dt="";//JHP
	public Vector count=new Vector();//JHP
	public String re_gas_rev_no="";//JHP 
	
	
	public Vector EDQ_FROM_DT = new Vector();
	public Vector EDQ_TO_DT = new Vector();
	public Vector ACTUAL_RECPT_DT = new Vector();
	public Vector CONTRACT_START_DT = new Vector();
	public Vector CONTRACT_END_DT = new Vector();
	public Vector ADQ_QTY = new Vector();
	public Vector SYS_USE_GAS = new Vector();
	public Vector QTY_TO_BE_SUPPLY = new Vector();
	public Vector DCQ_QTY = new Vector();
	public Vector QTY_UNIT_CD = new Vector();
	public Vector QTY_UNIT_ABR = new Vector();
	public Vector BOE_QTY = new Vector(); 
	public Vector SUPP_CD = new Vector(); 
	public Vector SUPP_NM = new Vector();
	public Vector BOE_NO = new Vector();
	public Vector BOE_DT = new Vector();
	public Vector BOE_DT_1=new Vector();
	
	NumberFormat nf3 = new DecimalFormat("###########0");
	
	public Vector SUPP_SEQ_NO= new Vector();
	public Vector SUPP_CONTACT_PERSON= new Vector();
	public Vector SUPP_CONTACT_PERSON_DESG= new Vector();
	public String setcargo_ref_no="-";
	public Vector cust_plant_cd= new Vector();
	public Vector cust_plant_nm= new Vector();
	public Vector Vdatewise_plant_tot=new Vector();
	public Vector QQ_NO=new Vector();
	public Vector QQ_DT=new Vector();
	
	
	public String contact_Customer_Person_Address = "";
	public String contact_Customer_Person_City = "";
	public String contact_Customer_Person_Pin = "";
	public String contact_Customer_Person_Phone = "";
	public String contact_Customer_Person_Fax = "";
	public String contact_Customer_Person_State = "";
	public String contact_Customer_Person_Country = "";
	
	String Sign_dt="";
	
	String Suppl_Name = "";
	String Suppl_abbr="";
	
	Vector Vplant_inv_no=new Vector();
	
	/////////////////////Fetching extra parameter.....
	
	String kind_attn=new String();
	String subject=new String();
	String dear_sir=new String();
	String para[]=new String[4];
	String tbl_statmnt=new String();
	String quantity_quality_ref_no=new String();
	String vessel_arrival_dt=new String();
	String vessel_name=new String();
	String storage_st_dt=new String();
	String storage_end_dt=new String();
	String boe_no_dated=new String();
	String lng_unloaded=new String();
	String less=new String();
	String sug_unloaded=new String();
	String total_lng[]=new String[2];
	String thanks=new String();
	String faithful=new String();
	String hlpl=new String();
	
	
	///////////////// ADDED FOR LTCORA AND CN
	Vector LTCORA_NO=new Vector();
	Vector LTCORA_CUSTOMER_CD=new Vector();
	Vector LTCORA_CARGO_ARRIVAL_DATE=new Vector();
	Vector LTCORA_SEQ_NO=new Vector();
	Vector LTCORA_BOOKMMBTU=new Vector();
	Vector LTCORA_BOOKMMSCM=new Vector();
	Vector LTCORA_RATE=new Vector();
	Vector LTCORA_cargo_ref_no=new Vector();
	Vector LTCORA_CUSTOMER_NM=new Vector();
	Vector LTCORA_CUSTOMER_ABBR=new Vector();
	Vector LTCORA_SIGNING_DT=new Vector();
	Vector LTCORA_SUPPLIEDMBTU=new Vector();
	Vector LTCORA_SUPPLIEDMMSCM=new Vector();
	Vector LTCORA_BALANCEMMBTU=new Vector();
	Vector LTCORA_BALANCEMMSCM=new Vector();
	Vector[] LTCORA_SUPPLIEDMBTU1;
	Vector[] LTCORA_SUPPLIEDMMSCM1;
	
	String LTCORA_tot_commit="0";
	String LTCORA_tot_commit_mmscm="0";
	String LTCORA_sup_tot_comitment="0";
	String LTCORA_bal_tot_comitment="0";
	String LTCORA_sup_tot_comitment_mmscm="0";
	String LTCORA_bal_tot_comitment_mmscm="0";
	
	Vector CN_NO=new Vector();
	Vector CN_CUSTOMER_CD=new Vector();
	Vector CN_CARGO_ARRIVAL_DATE=new Vector();
	Vector CN_SEQ_NO=new Vector();
	Vector CN_BOOKMMBTU=new Vector();
	Vector CN_BOOKMMSCM=new Vector();
	Vector CN_RATE=new Vector();
	Vector CN_cargo_ref_no=new Vector();
	Vector CN_CUSTOMER_NM=new Vector();
	Vector CN_CUSTOMER_ABBR=new Vector();
	Vector CN_SIGNING_DT=new Vector();
	Vector CN_SUPPLIEDMBTU=new Vector();
	Vector CN_SUPPLIEDMMSCM=new Vector();
	Vector CN_BALANCEMMBTU=new Vector();
	Vector CN_BALANCEMMSCM=new Vector();
	Vector[] CN_SUPPLIEDMBTU1;
	Vector[] CN_SUPPLIEDMMSCM1;
	
	String CN_tot_commit="0";
	String CN_tot_commit_mmscm="0";
	String CN_sup_tot_comitment="0";
	String CN_bal_tot_comitment="0";
	String CN_sup_tot_comitment_mmscm="0";
	String CN_bal_tot_comitment_mmscm="0";
	
	//RG20200704
	Vector ltcora_agr_no=new Vector();
	Vector cn_agr_no=new Vector();
	Vector sn_ent_by=new Vector();
	Vector sn_ent_dt=new Vector();
	Vector loa_ent_by=new Vector();
	Vector loa_ent_dt=new Vector();
	Vector ltcora_ent_by=new Vector();
	Vector ltcora_ent_dt=new Vector();
	Vector cn_ent_by=new Vector();
	Vector cn_ent_dt=new Vector();
	Vector sn_apr_by=new Vector();
	Vector sn_apr_dt=new Vector();
	Vector loa_apr_by=new Vector();
	Vector loa_apr_dt=new Vector();
	Vector ltcora_apr_by=new Vector();
	Vector ltcora_apr_dt=new Vector();
	Vector cn_apr_by=new Vector();
	Vector cn_apr_dt=new Vector();
	
	HashMap<String, HashMap> link_cd = new HashMap<String, HashMap>(); //HARSH20211229 AS PER INCIDENT#216
	
	public void init()
	{
	    try
	    {
	    	Context initContext = new InitialContext();
	    	if(initContext == null)
	    	{
	    		throw new Exception("Boom - No Context");
	    	}
	    	
	    	Context envContext  = (Context)initContext.lookup("java:/comp/env");
	    	DataSource ds = (DataSource)envContext.lookup(RuntimeConf.security_database);
	    	if(ds != null) 
	    	{
	    		conn = ds.getConnection();       
	    		if(conn != null)  
	    		{
	    			stmt = conn.createStatement();
	    			stmt1= conn.createStatement();
	    			stmt2= conn.createStatement();	
	    			stmt3= conn.createStatement();
	    			stmt_tmp1 = conn.createStatement(); //HARSH20210318
	    			
	    			if(callFlag.equalsIgnoreCase("CR_Security_Tracking")) //SB20200927
	    			{
	    				/*SB if(Customer_access_flag.equals("Y"))
	    				{
	    					fetchEligibleCargoList_WITH_ACCESS();
	    				} else {*/
	    					System.out.println("in callFlag: "+callFlag);
	    					fetchEligibleCargoList(); //SB20200927
	    				//SB}
	    					    				
	    			}
	    			if(callFlag.equalsIgnoreCase("CR_Security_Exceed")) //SB20201001: Time being kept same function
	    			{
	    				/*SB if(Customer_access_flag.equals("Y"))
	    				{
	    					fetchEligibleCargoList_WITH_ACCESS();
	    				} else {*/
	    					System.out.println("in callFlag: "+callFlag);
	    					fetchEligibleCargoList(); //SB20200927
	    					//CR_CollateralCalculation();//HARSH20201124
	    				//SB}		
	    			}
	    			else if(callFlag.equalsIgnoreCase("EXCEED_CREDIT_LIST"))///Harsh
	    			{
	    				System.out.println("in callFlag: "+callFlag);
	    				fetch_EXCEED_CREDIT_LIST();
	    			}
	    			else if(callFlag.equalsIgnoreCase("Upcoming_Security_List"))///Harsh20201005
	    			{
	    				System.out.println("in callFlag: "+callFlag);
	    				fetch_upcoming_security_list();
	    			}
	    			else if(callFlag.equalsIgnoreCase("Security_General_List"))///Harsh20201005
	    			{
	    				System.out.println("in callFlag: "+callFlag);
	    				fetch_security_general_list();
	    			}
	    			else if(callFlag.equalsIgnoreCase("CREDIT_LIMIT_LIST")) //HARSH20201017
	    			{
	    				AddColumnInLimitMst();
	    				fetch_credit_limit_list();
	    			}
	    			else if(callFlag.equalsIgnoreCase("SECURITY_POST")) //HARSH20201017
	    			{
	    				fetch_security_post();
	    			}
	    			else if(callFlag.equalsIgnoreCase("CR_SECURITY_POST")) //HARSH20201017
	    			{
	    				fetch_CR_security_post();
	    				if(!LC_Mapping_Id.equals("")){
	    				fetchExsitingSecurityRefNoPost();} //HARSH20201125
	    			}
	    			else if(callFlag.equalsIgnoreCase("EXISTING_SECURITY_LIST_POST"))//HARSH20201024 
	    			{
	    				FetchExistingSecurityListPost();
	    			}
	    			else if(callFlag.equalsIgnoreCase("LC_SEQ_NO_LIST"))  //SB20200927
	    			{
	    				addColumns(); //Hiren_20201002
	    				fetch_LC_SEQ_NO_List(); //SB20200927
	    			}
	    			else if(callFlag.equalsIgnoreCase("fetch_Collateral_List"))  //SB20201101
	    			{
						fetch_Collateral_List();//SB20201101
	    			}
	    			else if(callFlag.equalsIgnoreCase("fetch_Credit_Limit_List"))  //HARSH20201120
	    			{
						fetch_CreditLimit_list();
	    			}
	    			else if(callFlag.equalsIgnoreCase("fetchDealExposureDtl"))
	    			{
	    				fetchDealExposureDtl();	
	    				MRCR_ContDtlTotal();
	    			}
	    			else if(callFlag.equalsIgnoreCase("Fetch_Deal_Dtls"))
	    			{
	    				Fetch_Deal_Dtls();
	    			}
	    			else if(callFlag.equalsIgnoreCase("CR_DealCapturing_Tracking")) //SB20201012
	    			{
	    				System.out.println("CR_DealCapturing_Tracking: "+callFlag);
	    				fetchDealCapturingList(); //SB20200927	    					    				
	    			}
	    			else if(callFlag.equalsIgnoreCase("CR_CustList"))//SB20201012
	    			{
	    				fetchCustomerList(); //SB20201012
	    				fetch_LC_IncomingOutgoing_List(); //SB20201012
	    			}
	    			else if(callFlag.equalsIgnoreCase("CR_PreReceipt"))//SB20201013
	    			{
	    				//fetchCustomerList(); //SB20201012
	    				fetch_LC_IncomingOutgoing_List(); //SB20201012
	    			}
	    			else if(callFlag.equalsIgnoreCase("CR_PostDealCustList"))//SB20201013
	    			{
	    				fetchCustomerList(); //SB20201012
	    			}
	    			else if(callFlag.equalsIgnoreCase("TCQ_Variation"))
	    			{
	    				fetchTCQVariationList();	    				
	    			}
	    			else if(callFlag.equalsIgnoreCase("FGSA"))  //JHP20110917
	    			{
	    				fetchcustomer();
	    				fetchfgsaList();
	    			}	
	    			else if(callFlag.equalsIgnoreCase("FGSA_SN_PRICE"))  //MD20111121
	    			{
	    				//System.out.println("MD "+callFlag);
	    				fetchcustomer();
	    				fetchFGSASNPRICEList();
	    				
	    			}
	    			else if(callFlag.equalsIgnoreCase("DATA_FETCH"))  //MD20111122 FOR PORPOSE TO VIEW DATA
	    			{
	    				//System.out.println("MD "+callFlag);
	    				
	    			}
	    			else if(callFlag.equalsIgnoreCase("Cargo_Allocation_customer"))
	    			{
	    				fetchEligibleCargoList_new();	    				
	    			} 
	    			else if(callFlag.equalsIgnoreCase("RE_GAS_CARGO_DTL"))
	    			{
	    				Customer_DTL();
					    Fetch_RE_GAS_CARGO_DTL();
					    Fetch_extra_parameters_pdf_xcl();
					}
	    			else if(callFlag.equalsIgnoreCase("RE_GAS_SERVICES"))
	    			{
	    				Customer_DTL();
					    Fetch_RE_GAS_CARGO_Services();
					//    //System.out.println("setcargo_ref_no"+setcargo_ref_no);
					    if(!setcargo_ref_no.equalsIgnoreCase("0"))
					    {
					    	Fetch_RE_GAS_CARGO_wise();
					    	fetchcargo_allocation_plantwise();
					    }
	    			}
	    			else if(callFlag.equalsIgnoreCase("EXISTING_SECURITY_LIST")) {
	    				FetchExistingSecurityList();
	    			}
	    			else if(callFlag.equalsIgnoreCase("EXISTING_SECURITY_LIST_PRE"))//HARSH20201029
	    			{
	    				FetchExistingSecurityListPre();
	    			}
	    			else if(callFlag.equalsIgnoreCase("POST_LIST"))//HARSH20201102
	    			{
	    				fetchPreReceiptIncomingOutgoingSecurityList();
	    			}
	    			else if(callFlag.equalsIgnoreCase("LIMIT_SUMMARY"))//HARSH20201104
	    			{
	    				fetchAllCustomerLimitSummary();
	    			}
	    			else if(callFlag.equalsIgnoreCase("AUDIT_REPORT"))//HARSH20201110
	    			{
	    				fetchAuditReport();
	    			}
	    			else if (callFlag.equalsIgnoreCase("fetch_report_list")) // MALVIKA20201016
					{
						fetch_report_list();
					}
	    			else if(callFlag.equalsIgnoreCase("PRE_DEAL_CREDIT_CHECK_REQ"))//HARSH20201212
	    			{
	    				fetchPreDealCreditCheckRequest();
	    				mail_list = RECIPIENT_LIST("Pre-Deal Credit Check", "Contract Master", "NA", "On-Event");
	    			}
	    			else if(callFlag.equalsIgnoreCase("PRE_DEAL_CREDIT_APPROVAL"))//HARSH20201225
	    			{
	    				fetchPreDealCreditApproval();
	    				mail_list = RECIPIENT_LIST("Pre-Deal Credit Check Approval", "Credit Risk", "NA", "On-Event");
	    			}
	    			else if(callFlag.equalsIgnoreCase("Credit_Walkforward_Exposure_Report"))//HARSH20201228
	    			{
	    				//walkforwardExpoCustomerList();//HARSH20210220
	    				CustomerMaster(); //HARSH20210222
	    				fetchOnscreenWalkForwardExposure_LimitMonitoring();
	    			}
	    			else if(callFlag.equalsIgnoreCase("CREDIT_RATING"))//HARSH20210206
	    			{
	    				credit_rating_detail();
	    			}
	    			else if(callFlag.equalsIgnoreCase("KPI_REPORT"))//HARSH20210305
	    			{
	    				fetch_kpi_report();
	    			}
	    			else if(callFlag.equalsIgnoreCase("SECURITY_STATUS_REPORT"))//HARSH20210309
	    			{
	    				fetch_security_status_report();
	    				fetch_outgoing_security_status_report(); //HARSH20210716
	    			}
	    			else if(callFlag.equalsIgnoreCase("BANK_LIMIT_EXPOSURE"))//HARSH20210310
	    			{
	    				fetch_BANK_LIMIT_EXPOSURE();
	    			}
	    			else if(callFlag.equalsIgnoreCase("BANK_EXPOSURE_DTL"))//HARSH20210310
	    			{
	    				clear(); //HARSH20210408
	    				fetch_BANK_EXPOSURE_DTL();
	    			}
	    			else if(callFlag.equalsIgnoreCase("PAYMENT_RECEIPT_STATUS"))//HARSH20210313
	    			{
	    				payment_receipt_status_report();
	    			}
	    			//FGSA_SN_PRICE  
	    			conn.close();
	    			conn = null;
	    		}
	    	}
	    }	    
	    catch(Exception e)
	    {
	    	//System.out.println("Exception:(DataBean_Cargo_Processing)-(init()): "+e);
	    }
	    finally
	    {
	    	if(rset != null)
	    	{
				try
				{
					rset.close();
				}
				catch(SQLException e)
				{
					//System.out.println("rset is not close " + e);
				}
			}
	    	if(rset1 != null)
	    	{
				try
				{
					rset1.close();
				}
				catch(SQLException e)
				{
					//System.out.println("rset1 is not close " + e);
				}
			}
	    	if(rset2 != null)
	    	{
				try
				{
					rset2.close();
				}
				catch(SQLException e)
				{
					//System.out.println("rset2 is not close " + e);
				}
			}
	    	if(rset3 != null)
	    	{
				try
				{
					rset3.close();
				}
				catch(SQLException e)
				{
					//System.out.println("rset2 is not close " + e);
				}
			}
	    	if(rset_tmpl != null)
	    	{
				try
				{
					rset_tmpl.close();
				}
				catch(SQLException e)
				{
					//System.out.println("rset2 is not close " + e);
				}
			}
			if(stmt != null)
			{
				try
				{
					stmt.close();
				}
				catch(SQLException e)
				{
					//System.out.println("stmt is not close " + e);
				}
			}
			if(stmt1 != null)
			{
				try
				{
					stmt1.close();
				}
				catch(SQLException e)
				{
					//System.out.println("stmt1 is not close " + e);
				}
			}
			if(stmt2 != null)
			{
				try
				{
					stmt2.close();
				}
				catch(SQLException e)
				{
					//System.out.println("stmt2 is not close " + e);
				}
			}
			if(stmt3 != null)
			{
				try
				{
					stmt3.close();
				}
				catch(SQLException e)
				{
					//System.out.println("stmt2 is not close " + e);
				}
			}
			if(stmt_tmp1 != null)
			{
				try
				{
					stmt_tmp1.close();
				}
				catch(SQLException e)
				{
					//System.out.println("stmt2 is not close " + e);
				}
			}
			if(conn != null)
			{
				try
				{
					conn.close();
				}
				catch(SQLException e)
				{
					//System.out.println("conn is not close " + e);
				}
			}
	    }
	}	
	
	private void FetchExistingSecurityList()throws IOException,SQLException {
		try
		{		
		
		String MappId="";
		String FlagSecurity=""; String SecurityType="";
		String avail_map_id=FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
		
		queryString = "SELECT A.FINANCIAL_YEAR, A.LC_SEQ_NO, A.CUSTOMER_CD, " +
			  "CREDIT_RATING, TO_CHAR(RATING_EFF_DATE,'DD/MM/YYYY'), TO_CHAR(LC_REF_DATE,'DD/MM/YYYY'), " +
			  "TO_CHAR(A.START_DATE,'DD/MM/YYYY'), TO_CHAR(A.END_DATE,'DD/MM/YYYY'), " +
			  "MANUAL_EXCHG_FLAG, MANUAL_EXCHG_RATE, USER_DEFINED_FLAG, " +
			  "USER_DEFINED_DCQ, CALC_LC_AMOUNT, FINAL_LC_AMOUNT, A.REMARKS "
			  + ",CONT_TYPE, FGSA_NO,FGSA_REV_NO, SN_NO, SN_REV_NO, LC_METHOD, A.FLAG,TO_CHAR(SEC_DT,'DD/MM/YYYY'),SEC_REF_NO,TO_CHAR(a.aprv_dt,'dd/mm/yyyy'),b.existing " +
			  " FROM FMS7_LC_MST A, FMS7_LC_DTL B WHERE "
			  + " A.CUSTOMER_CD="+Buyer_cd+" "
			  + " AND END_DATE > to_date('"+contSt_dt+"','dd/mm/yyyy') AND START_DATE < to_date('"+contEnd_dt+"','dd/mm/yyyy') "
			  + " AND A.FINANCIAL_YEAR=B.FINANCIAL_YEAR " +
			 "AND A.LC_SEQ_NO=B.LC_SEQ_NO AND A.CUSTOMER_CD=B.CUSTOMER_CD ORDER BY a.FINANCIAL_YEAR,a.LC_SEQ_NO" ;
		
		System.out.println("SECURITY: FMS7_LC_MST: "+queryString);
		rset = stmt.executeQuery(queryString);		
		
		while(rset.next())
		{
			if(rset.getString(25)!=null)
			{
				if(rset.getString(26)==null) ///HARSH20201020
				{
					String temp_map=rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
					System.out.println(temp_map+"----"+avail_map_id);
					if(!avail_map_id.equals(temp_map)) {
						int lc_seq_no = rset.getInt(2);
						String fin_year = rset.getString(1);
						String LC_SEQ_NO = "";
						
						if(lc_seq_no<10)
						{
							LC_SEQ_NO = "000"+lc_seq_no+"/"+fin_year;
						}
						else if(lc_seq_no<100)
						{
							LC_SEQ_NO = "00"+lc_seq_no+"/"+fin_year;
						}
						else if(lc_seq_no<1000)
						{
							LC_SEQ_NO = "0"+lc_seq_no+"/"+fin_year;
						}
						else
						{
							LC_SEQ_NO = ""+lc_seq_no+"/"+fin_year;
						}
						Vfin_yr.add(rset.getString(1)==null?"0":rset.getString(1));
						VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
						VSecuritySeqNo.add(LC_SEQ_NO);
						//VSecurityStatus.add("");
						VSecurityRating.add(rset.getString(4)==null?"0":rset.getString(4));
						VSecurityRatingEffDt.add(rset.getString(5)==null?"":rset.getString(5));
						VSecurityDueDt.add(rset.getString(6)==null?"":rset.getString(6));
						VSecurityStartDt.add(rset.getString(7)==null?"":rset.getString(7));
						VSecurityEndDt.add(rset.getString(8)==null?"":rset.getString(8));
						VSecurityAmt.add(rset.getString(14)==null?"":rset.getString(14));
						VSecurityRmk.add(rset.getString(15)==null?"":rset.getString(15));	
						VflagSecurity.add(rset.getString(22)==null?"":rset.getString(22));
						Vsec_dt.add(rset.getString(23)==null?"":rset.getString(23));
						Vsec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
						
						MappId=rset.getString(16)+rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
						
						SecurityType=rset.getString(21)==null?"":rset.getString(21);
						if(SecurityType.equals("PCG"))
							VSecurityDealCd.add("All");
						else
							VSecurityDealCd.add(MappId);
						
						FlagSecurity=rset.getString(22)==null?"0":rset.getString(22);
						if(FlagSecurity.equals("Y"))
							VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
						else if(FlagSecurity.equals("O"))
							VSecurityTypeDesc.add(rset.getString(21)+" (Issuance)");
						else
							VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
						
						VSecurityType.add(rset.getString(21)==null?"0":rset.getString(21));
						String status = rset.getString(25)==null?"":rset.getString(25); //HARSH20201019
						if(status == "")
						{
							VSecurityStatus.add("Pending");
						}else{
							VSecurityStatus.add("Approved");
						}//
						/*if(rset.getString(26)!=null)   ///HARSH20201020
						{
							Vexisting_cont.add("LINKED");
						}
						else
						{
							Vexisting_cont.add("");
						} //
	*/				}
				}
					double SumSecurity=0;
					for(int i=0; i<VSecurityAmt.size(); i++)
					{
						SumSecurity+=Double.parseDouble(""+VSecurityAmt.elementAt(i));
					}
					TotalSecurityAmt=nf.format(SumSecurity);
			}	
		}
	}
	catch(Exception e)
	{
	//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
	e.printStackTrace();	
	}
}				
Vector Vexisting_cont = new Vector();
public Vector getVexisting_cont() {return Vexisting_cont;}
		

	private void addColumns() throws SQLException  {
		try {
			int count=0;
			String s="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_MST' "+
					" AND UPPER(COLUMN_NAME) LIKE 'SEC_DT'";
//			System.out.println("s****"+s);
			rset=stmt.executeQuery(s);
			if(rset.next())
			{
				count=rset.getInt(1);
			}
			if(count==0)
			{
				s="ALTER TABLE FMS7_LC_MST ADD SEC_DT DATE";
				stmt.executeUpdate(s);
				conn.commit();
			}
			
			int count1=0;
			String s1="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_MST' "+
					" AND UPPER(COLUMN_NAME) LIKE 'MODIFY_DT'";
//			System.out.println("s1****"+s1);
			rset=stmt.executeQuery(s1);
			if(rset.next())
			{
				count1=rset.getInt(1);
			}
			if(count1==0)
			{
				s1="ALTER TABLE FMS7_LC_MST ADD MODIFY_DT DATE";
				stmt.executeUpdate(s1);
				conn.commit();
			}
			
			int count2=0;
			String s2="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_MST' "+
					" AND UPPER(COLUMN_NAME) LIKE 'MODIFY_BY'";
//			System.out.println("s2****"+s2);
			rset=stmt.executeQuery(s2);
			if(rset.next())
			{
				count2=rset.getInt(1);
			}
			if(count2==0)
			{
				s2="ALTER TABLE FMS7_LC_MST ADD MODIFY_BY NUMBER(6,0)";
				stmt.executeUpdate(s2);
				conn.commit();
			}
			
			int count3=0;
			String s3="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_MST' "+
					" AND UPPER(COLUMN_NAME) LIKE 'SEC_REF_NO'";
//			System.out.println("s2****"+s2);
			rset=stmt.executeQuery(s3);
			if(rset.next())
			{
				count3=rset.getInt(1);
			}
			if(count3==0)
			{
				s3="ALTER TABLE FMS7_LC_MST ADD SEC_REF_NO VARCHAR2(30 BYTE)";
				stmt.executeUpdate(s3);
				conn.commit();
			}
			
			/////////////////////////SB20201010///////////////////////////////////////////////////////
			int count4=0;
			String s4="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_MST' "+
					" AND UPPER(COLUMN_NAME) LIKE 'APRV_DT'";
//			System.out.println("s4****"+s4);
			rset=stmt.executeQuery(s4);
			if(rset.next())
			{
				count4=rset.getInt(1);
			}
			if(count4==0)
			{
				s4="ALTER TABLE FMS7_LC_MST ADD APRV_DT DATE";
				stmt.executeUpdate(s4);
				conn.commit();
			}
			
			int count5=0;
			String s5="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_MST' "+
					" AND UPPER(COLUMN_NAME) LIKE 'APRV_BY'";
//			System.out.println("s5****"+s5);
			rset=stmt.executeQuery(s5);
			if(rset.next())
			{
				count5=rset.getInt(1);
			}
			if(count5==0)
			{
				s5="ALTER TABLE FMS7_LC_MST ADD APRV_BY NUMBER(6,0)";
				stmt.executeUpdate(s5);
				conn.commit();
			}
			//////////////////////////////////////////////////////////////////////////////////////////////////////////
			
			//////////////////////////////////////////HARSH_20201020//////////////////////////////////////////////////
			int count6=0;
			String s6="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_LC_DTL' "+
					" AND UPPER(COLUMN_NAME) LIKE 'EXISTING'";
//			System.out.println("s6****"+s6);
			rset=stmt.executeQuery(s6);
			if(rset.next())
			{
				count=rset.getInt(1);
			}
			if(count==0)
			{
				s="ALTER TABLE FMS7_LC_DTL ADD EXISTING VARCHAR2(40 BYTE)";
				stmt.executeUpdate(s);
				conn.commit();
			}
			
			//////////////////////////////////////////////////////////////////////////////////////////////////////////
		}
		catch(Exception e) {
			conn.rollback();
			e.printStackTrace();
		}
	
	}
	public void Fetch_extra_parameters_pdf_xcl()
	{
		try
		{
			kind_attn="Kind Attn: The General Manager-Marketing";
			subject="Subject: Energy Statement";
			dear_sir="Dear Sir,";
			para[0]="Please find below the statement showing the LNG unloaded quantities and the energy to be delivered to ";
			para[1]=" as RLNG,under Re-gas agreement dated ";
			para[2]=",Binding Side Letter dated ";
			para[3]=" and subsequent side letters, therein.";
			tbl_statmnt="Statement of Energy delivered under the Regas agreement between ";
			quantity_quality_ref_no="Quantity & Quality Certificate Ref no.";
			vessel_name="Vessel Name";
			vessel_arrival_dt="Vessel Arrival Date";
			storage_st_dt="Storage period Start Date";
			storage_end_dt="Storage period End Date";
			boe_no_dated="BOE NO.";
			lng_unloaded="LNG unloaded as per the certificate of Quantity & Quality";
			sug_unloaded="SUG as per the Re-gas agreement";
			less="LESS:";
			total_lng[0]="LNG to be Regassified and delivered as RLNG to ";
			total_lng[1]=" till end of storage period";
			thanks="Thanking you";
			faithful="Your Faithfully,";
		//RG20190326 for company change */	hlpl="For Hazira LNG Pvt. Ltd.";
			hlpl="For Shell Energy India Pvt. Ltd.";
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Fetching extra Parameters....."+e.getMessage());
			e.printStackTrace();
		}
	}
	
	public void Customer_DTL()
	{
		try
		{
			queryString = "SELECT CUSTOMER_CD,CUSTOMER_NAME,CUSTOMER_ABBR FROM FMS7_CUSTOMER_MST ORDER BY CUSTOMER_CD";
			////System.out.println("FMS7_CUSTOMER_MST Fetch Query = "+queryString);
			rset = stmt.executeQuery(queryString);				
			while(rset.next())
			{
				CUST_CD.add(rset.getString(1)==null?"":rset.getString(1));	
				CUST_NM.add(rset.getString(3)==null?"":rset.getString(3));
			}
//			Query for Contact Name,Telephone,Mobile of Supplier
			queryString1 = "SELECT A.SEQ_NO,A.CONTACT_PERSON,A.CONTACT_DESIG,A.PHONE,A.MOBILE  FROM FMS7_SUPPLIER_CONTACT_MST A " +
			   "WHERE A.NOM_FLAG='Y' AND A.EFF_DT=(SELECT MAX(B.EFF_DT) FROM FMS7_SUPPLIER_CONTACT_MST B WHERE " +
			   "A.SEQ_NO=B.SEQ_NO AND B.EFF_DT<=TO_DATE(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY'))";
		//	//System.out.println("FMS7_SUPPLIER_CONTACT_MST Query = "+queryString1);
			rset1 = stmt1.executeQuery(queryString1);
			while(rset1.next())
			{
				SUPP_SEQ_NO.add(rset1.getString(1)==null?"0":rset1.getString(1));
				SUPP_CONTACT_PERSON.add(rset1.getString(2)==null?"":rset1.getString(2));
				SUPP_CONTACT_PERSON_DESG.add(rset1.getString(3)==null?"":rset1.getString(3));
				//PHONE.add(rset1.getString(4)==null?"":rset1.getString(4));
				//MOBILE.add(rset1.getString(5)==null?"":rset1.getString(5));
			}
			
			queryString = "SELECT addr,city,pin,phone,fax_1,state,country " +
			  "FROM FMS7_CUSTOMER_ADDRESS_MST A " +
			  "WHERE A.customer_cd="+Buyer_cd+" AND A.address_type='R' AND " +
			  "A.eff_dt=(SELECT MAX(B.eff_dt) FROM FMS7_CUSTOMER_ADDRESS_MST B " +
			  "WHERE A.customer_cd=B.customer_cd AND B.address_type='R' AND " +
			  "B.eff_dt<=TO_DATE(to_char(sysdate,'DD/MM/YYYY'),'DD/MM/YYYY'))";
	//		//System.out.println("Customer Address Fetch Query = "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				contact_Customer_Person_Address = rset.getString(1)==null?"":rset.getString(1);
				contact_Customer_Person_City = rset.getString(2)==null?"":rset.getString(2);
				contact_Customer_Person_Pin = rset.getString(3)==null?"":rset.getString(3);
				contact_Customer_Person_Phone = rset.getString(4)==null?"":rset.getString(4);
				contact_Customer_Person_Fax = rset.getString(5)==null?"":rset.getString(5);
				contact_Customer_Person_State = rset.getString(6)==null?"":rset.getString(6);
				contact_Customer_Person_Country = rset.getString(7)==null?"":rset.getString(7);
			}
			
						
			queryString = "SELECT TO_CHAR(signing_dt,'fmddth') " +
			  "|| ' ' || TO_CHAR(signing_dt,'fmMonth') " +
			  "|| ' ' || TO_CHAR(signing_dt,'yyyy') " +
			  "FROM FMS7_RE_GAS_MST WHERE " +
			  "re_gas_no="+re_gas_no+" AND rev_no='"+re_gas_rev_no+"'AND " +
			  "customer_cd="+Buyer_cd+" " +
			  "ORDER BY rev_no DESC";
	//		//System.out.println("queryString:"+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				Sign_dt=rset.getString(1);
			}
			
			queryString = "SELECT supplier_name,SUPPLIER_ABBR " +
			  "FROM FMS7_SUPPLIER_MST A " +
			  "WHERE A.supplier_cd=1 AND " +
			  "A.eff_dt=(SELECT MAX(B.eff_dt) FROM FMS7_SUPPLIER_MST B " +
			  "WHERE A.supplier_cd=B.supplier_cd AND " +
			  "B.eff_dt<=TO_DATE(to_char(sysdate,'dd/mm/yyyy'),'DD/MM/YYYY'))";
	//		//System.out.println("Supplier Details Fetch Query = "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				Suppl_Name = rset.getString(1)==null?"":rset.getString(1);
				Suppl_abbr = rset.getString(2)==null?"":rset.getString(2);
			}
			
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public void fetchcontarctDate()
	{
		try
		{
			//JHP start

			queryString = "SELECT to_char(START_DT,'dd/mm/yyyy'), to_char(END_DT,'dd/mm/yyyy')," +
						  "RE_GAS_BASE,STATUS, to_char(REV_DT,'dd/mm/yyyy'), NO_OF_CARGO " +
						  "FROM FMS7_RE_GAS_MST where Customer_cd='"+Buyer_cd+"' AND " +
						  "RE_GAS_NO='"+re_gas_no+"' AND REV_NO='"+re_gas_rev_no+"'";
			//System.out.println("RE_GAS Fetch DATA Query = "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				frm_dt=rset.getString(1)==null?"":rset.getString(1);
				to_dt=rset.getString(2)==null?"":rset.getString(2);
				
			}
			
			//JHP End
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public void Fetch_RE_GAS_CARGO_DTL()
	{
		try
		{
			for(int i=1; i<=Integer.parseInt(no_of_cargo); i++)
			{
				queryString = "SELECT cargo_ref_no, " +
							"TO_CHAR(edq_from_dt,'dd-Mon-yy'), " +
							  "TO_CHAR(edq_to_dt,'dd-Mon-yy')," +
							  " TO_CHAR(actual_recpt_dt,'dd-Mon-yy'), " +
							  "TO_CHAR(contract_start_dt,'dd-Mon-yy')," +
							  " TO_CHAR(contract_end_dt,'dd-Mon-yy'), " +
							  "ship_cd,adq_qty,sys_use_gas," +
							  "qty_to_be_supply,dcq_qty,re_gas_tarif, " +
							  "qty_unit_cd,REGAS_CLOSURE_REQUEST,REGAS_CLOSURE_CLOSE," +
							  "TO_CHAR(REGAS_CLOSURE_DT,'dd/mm/yyyy'),REGAS_CLOSURE_QTY,BOE_NO," +
							  "TO_CHAR(BOE_DT,'dd/mm/yyyy'),BOE_QTY, NVL(SUPP_CD,'0'), " +
							  "NVL(SUPP_NM,''),NVL(QQ_NO,''),TO_CHAR(QQ_DT,'fmMonth') || ' ' || TO_CHAR(QQ_DT,'fmdd') || ',' || TO_CHAR(QQ_DT,'yyyy'), " +
							  "TO_CHAR(BOE_DT,'dd-Mon-yy') " +
							  "FROM FMS7_RE_GAS_CARGO_DTL WHERE customer_cd="+Buyer_cd+" AND " +
							  "re_gas_no="+re_gas_no+" AND cargo_seq_no="+i+"";
			//	//System.out.println("REGAS:QRY-R2001:SELECT:FMS7_RE_GAS_CARGO_DTL: "+queryString);
				////System.out.println("RE-GAS Cargo Contract Detail Fetch Query = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					String temp_cargo_ref_no = rset.getString(1)==null?"":rset.getString(1);
					String temp_sug = rset.getString(9)==null?"":rset.getString(9);
					String temp_teriff = rset.getString(12)==null?"":rset.getString(12);
					
					if(!temp_sug.trim().equals(""))
					{
						temp_sug = nf.format(Double.parseDouble(temp_sug.trim()));
					}
					
					if(!temp_teriff.trim().equals(""))
					{
						temp_teriff = nf2.format(Double.parseDouble(temp_teriff.trim()));
					}
					
					if(temp_cargo_ref_no.equals(""))
					{
						String cargo_ref_no = "";
						if(!Buyer_cd.trim().equals("") && !Buyer_cd.trim().equals("0") && !re_gas_no.trim().equals("") && !re_gas_no.trim().equals("0"))
						{
							if(Integer.parseInt(Buyer_cd.trim())<10)
							{
								cargo_ref_no += "RE0"+Buyer_cd.trim();
							}
							else
							{
								cargo_ref_no += "RE"+Buyer_cd.trim();
							}
							
							if(Integer.parseInt(re_gas_no.trim())<10)
							{
								cargo_ref_no += "0"+re_gas_no.trim();
							}
							else
							{
								cargo_ref_no += re_gas_no.trim();
							}
							
							if(i<10)
							{
								cargo_ref_no += "0"+i;
							}
							else
							{
								cargo_ref_no += ""+i;
							}
						}						
						CARGO_REF_NO.add(cargo_ref_no);
						
					}
					else
					{
						CARGO_REF_NO.add(rset.getString(1)==null?"":rset.getString(1));
						
					}
					double qty_supply = 0;
					EDQ_FROM_DT.add(rset.getString(2)==null?"":rset.getString(2));
					EDQ_TO_DT.add(rset.getString(3)==null?"":rset.getString(3));
					ACTUAL_RECPT_DT.add(rset.getString(4)==null?"":rset.getString(4));
					CONTRACT_START_DT.add(rset.getString(5)==null?"":rset.getString(5));
					CONTRACT_END_DT.add(rset.getString(6)==null?"":rset.getString(6));
					SHIP_CD.add(rset.getString(7)==null?"0":rset.getString(7));
					ADQ_QTY.add(rset.getString(8)==null?"":rset.getString(8));
					SYS_USE_GAS.add(temp_sug);
					qty_supply = Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10));
					//QTY_TO_BE_SUPPLY.add(rset.getString(10)==null?"":rset.getString(10));
					//DCQ_QTY.add(rset.getString(11)==null?"":rset.getString(11));
					//RE_GAS_TARIFF.add(temp_teriff);
					QTY_UNIT_CD.add(rset.getString(13)==null?"1":rset.getString(13));
					
					if(qty_supply!=0)
					{
						QTY_TO_BE_SUPPLY.add(nf3.format(qty_supply));
					}
					else
					{
						QTY_TO_BE_SUPPLY.add("0");
					}
					BOE_NO.add(rset.getString(18)==null?"":rset.getString(18));
					BOE_DT.add(rset.getString(19)==null?"":rset.getString(19));
					BOE_QTY.add(rset.getString(20)==null?"":rset.getString(20));
					SUPP_CD.add(rset.getString(21)==null?"":rset.getString(21));
					SUPP_NM.add(rset.getString(22)==null?"":rset.getString(22));
					QQ_NO.add(rset.getString(23)==null?"":rset.getString(23));
					QQ_DT.add(rset.getString(24)==null?"":rset.getString(24));
					BOE_DT_1.add(rset.getString(25)==null?"":rset.getString(25));

					

				}
				else
				{
					String cargo_ref_no = "";
					if(!Buyer_cd.trim().equals("") && !Buyer_cd.trim().equals("0") && !re_gas_no.trim().equals("") && !re_gas_no.trim().equals("0"))
					{
						if(Integer.parseInt(Buyer_cd.trim())<10)
						{
							cargo_ref_no += "RE0"+Buyer_cd.trim();
						}
						else
						{
							cargo_ref_no += "RE"+Buyer_cd.trim();
						}
						
						if(Integer.parseInt(re_gas_no.trim())<10)
						{
							cargo_ref_no += "0"+re_gas_no.trim();
						}
						else
						{
							cargo_ref_no += re_gas_no.trim();
						}
						
						if(i<10)
						{
							cargo_ref_no += "0"+i;
						}
						else
						{
							cargo_ref_no += ""+i;
						}
					}
					CARGO_REF_NO.add(cargo_ref_no);
					EDQ_FROM_DT.add("");
					EDQ_TO_DT.add("");
					ACTUAL_RECPT_DT.add("");
					CONTRACT_START_DT.add("");
					CONTRACT_END_DT.add("");
					SHIP_CD.add("0");
					ADQ_QTY.add("");
					SYS_USE_GAS.add("");
					QTY_TO_BE_SUPPLY.add("");
				//	DCQ_QTY.add("");
				//	RE_GAS_TARIFF.add("");
					QTY_UNIT_CD.add("1");
					BOE_NO.add("");
					BOE_DT.add("");
					BOE_QTY.add("");
					SUPP_CD.add("0");
					SUPP_NM.add("");
				//	count.add("0");
					QQ_NO.add("");
					QQ_DT.add("");
					BOE_DT_1.add("");
				}
				
			}
			
			for(int i=0; i<SHIP_CD.size(); i++)
			{
				queryString = "SELECT ship_name FROM FMS7_SHIP_MST WHERE ship_cd="+SHIP_CD.elementAt(i)+"";
				////System.out.println("REGAS:QRY-R2002:SELECT:FMS7_SHIP_MST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					SHIP_NAME.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					SHIP_NAME.add("");
				}
				
				queryString = "SELECT unit_abr FROM FMS7_UNIT_MST WHERE unit_cd="+QTY_UNIT_CD.elementAt(i)+"";
				////System.out.println("REGAS:QRY-R2003:SELECT:FMS7_UNIT_MST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					QTY_UNIT_ABR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					QTY_UNIT_ABR.add("");
				}
			}
					
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public void Fetch_RE_GAS_CARGO_Services()
	{
		try
		{
			for(int i=1; i<=Integer.parseInt(no_of_cargo); i++)
			{
				queryString = "SELECT cargo_ref_no, " +
							"TO_CHAR(edq_from_dt,'dd-Mon-yy'), " +
							  "TO_CHAR(edq_to_dt,'dd-Mon-yy')," +
							  " TO_CHAR(actual_recpt_dt,'dd-Mon-yy'), " +
							  "TO_CHAR(contract_start_dt,'dd/mm/yyyy')," +
							  " TO_CHAR(contract_end_dt,'dd/mm/yyyy'), " +
							  "ship_cd,adq_qty,sys_use_gas," +
							  "qty_to_be_supply,dcq_qty,re_gas_tarif, " +
							  "qty_unit_cd,REGAS_CLOSURE_REQUEST,REGAS_CLOSURE_CLOSE," +
							  "TO_CHAR(REGAS_CLOSURE_DT,'dd/mm/yyyy'),REGAS_CLOSURE_QTY,BOE_NO," +
							  "TO_CHAR(BOE_DT,'dd/mm/yyyy'),BOE_QTY, NVL(SUPP_CD,'0'), " +
							  "NVL(SUPP_NM,'') " +
							  "FROM FMS7_RE_GAS_CARGO_DTL WHERE customer_cd="+Buyer_cd+" AND " +
							  "re_gas_no="+re_gas_no+" AND cargo_seq_no="+i+"";
				////System.out.println("REGAS:QRY-R2001:SELECT:FMS7_RE_GAS_CARGO_DTL: "+queryString);
				////System.out.println("RE-GAS Cargo Contract Detail Fetch Query = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					String temp_cargo_ref_no = rset.getString(1)==null?"":rset.getString(1);
					String temp_sug = rset.getString(9)==null?"":rset.getString(9);
					String temp_teriff = rset.getString(12)==null?"":rset.getString(12);
					
					if(!temp_sug.trim().equals(""))
					{
						temp_sug = nf.format(Double.parseDouble(temp_sug.trim()));
					}
					
					if(!temp_teriff.trim().equals(""))
					{
						temp_teriff = nf2.format(Double.parseDouble(temp_teriff.trim()));
					}
					
					if(temp_cargo_ref_no.equals(""))
					{
						String cargo_ref_no = "";
						if(!Buyer_cd.trim().equals("") && !Buyer_cd.trim().equals("0") && !re_gas_no.trim().equals("") && !re_gas_no.trim().equals("0"))
						{
							if(Integer.parseInt(Buyer_cd.trim())<10)
							{
								cargo_ref_no += "RE0"+Buyer_cd.trim();
							}
							else
							{
								cargo_ref_no += "RE"+Buyer_cd.trim();
							}
							
							if(Integer.parseInt(re_gas_no.trim())<10)
							{
								cargo_ref_no += "0"+re_gas_no.trim();
							}
							else
							{
								cargo_ref_no += re_gas_no.trim();
							}
							
							if(i<10)
							{
								cargo_ref_no += "0"+i;
							}
							else
							{
								cargo_ref_no += ""+i;
							}
						}						
						CARGO_REF_NO.add(cargo_ref_no);
						
					}
					else
					{
						CARGO_REF_NO.add(rset.getString(1)==null?"":rset.getString(1));
						
					}
				}
				else
				{
					String cargo_ref_no = "";
					if(!Buyer_cd.trim().equals("") && !Buyer_cd.trim().equals("0") && !re_gas_no.trim().equals("") && !re_gas_no.trim().equals("0"))
					{
						if(Integer.parseInt(Buyer_cd.trim())<10)
						{
							cargo_ref_no += "RE0"+Buyer_cd.trim();
						}
						else
						{
							cargo_ref_no += "RE"+Buyer_cd.trim();
						}
						
						if(Integer.parseInt(re_gas_no.trim())<10)
						{
							cargo_ref_no += "0"+re_gas_no.trim();
						}
						else
						{
							cargo_ref_no += re_gas_no.trim();
						}
						
						if(i<10)
						{
							cargo_ref_no += "0"+i;
						}
						else
						{
							cargo_ref_no += ""+i;
						}
					}
					CARGO_REF_NO.add(cargo_ref_no);
				
				}
				
			}
							
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public void Fetch_RE_GAS_CARGO_wise()
	{
		try
		{
			
				queryString = "SELECT cargo_ref_no, " +
							"TO_CHAR(edq_from_dt,'dd-Mon-yy'), " +
							  "TO_CHAR(edq_to_dt,'dd-Mon-yy')," +
							  " TO_CHAR(actual_recpt_dt,'dd-Mon-yy'), " +
							  "TO_CHAR(contract_start_dt,'dd/mm/yyyy')," +
							  " TO_CHAR(contract_end_dt,'dd/mm/yyyy'), " +
							  "ship_cd,adq_qty,sys_use_gas," +
							  "qty_to_be_supply,dcq_qty,re_gas_tarif, " +
							  "qty_unit_cd,REGAS_CLOSURE_REQUEST,REGAS_CLOSURE_CLOSE," +
							  "TO_CHAR(REGAS_CLOSURE_DT,'dd/mm/yyyy'),REGAS_CLOSURE_QTY,BOE_NO," +
							  "TO_CHAR(BOE_DT,'dd/mm/yyyy'),BOE_QTY, NVL(SUPP_CD,'0'), " +
							  "NVL(SUPP_NM,'') " +
							  "FROM FMS7_RE_GAS_CARGO_DTL WHERE customer_cd="+Buyer_cd+" AND " +
							  "re_gas_no="+re_gas_no+" AND cargo_ref_no='"+setcargo_ref_no+"'";
				//System.out.println("REGAS:QRY-R2001:SELECT:FMS7_RE_GAS_CARGO_DTL: "+queryString);
				////System.out.println("RE-GAS Cargo Contract Detail Fetch Query = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					double qty_supply = 0;
					EDQ_FROM_DT.add(rset.getString(2)==null?"":rset.getString(2));
					EDQ_TO_DT.add(rset.getString(3)==null?"":rset.getString(3));
					ACTUAL_RECPT_DT.add(rset.getString(4)==null?"":rset.getString(4));
					CONTRACT_START_DT.add(rset.getString(5)==null?"":rset.getString(5));
					CONTRACT_END_DT.add(rset.getString(6)==null?"":rset.getString(6));
					SHIP_CD.add(rset.getString(7)==null?"0":rset.getString(7));
					ADQ_QTY.add(rset.getString(8)==null?"":rset.getString(8));
					//SYS_USE_GAS.add(temp_sug);
					qty_supply = Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10));
					//QTY_TO_BE_SUPPLY.add(rset.getString(10)==null?"":rset.getString(10));
					//DCQ_QTY.add(rset.getString(11)==null?"":rset.getString(11));
					//RE_GAS_TARIFF.add(temp_teriff);
					QTY_UNIT_CD.add(rset.getString(13)==null?"1":rset.getString(13));
					
					if(qty_supply!=0)
					{
						QTY_TO_BE_SUPPLY.add(nf3.format(qty_supply));
					}
					else
					{
						QTY_TO_BE_SUPPLY.add("0");
					}
					BOE_NO.add(rset.getString(18)==null?"":rset.getString(18));
					BOE_DT.add(rset.getString(19)==null?"":rset.getString(19));
					BOE_QTY.add(rset.getString(20)==null?"":rset.getString(20));
					SUPP_CD.add(rset.getString(21)==null?"":rset.getString(21));
					SUPP_NM.add(rset.getString(22)==null?"":rset.getString(22));
				}
				else
				{
					EDQ_FROM_DT.add("");
					EDQ_TO_DT.add("");
					ACTUAL_RECPT_DT.add("");
					CONTRACT_START_DT.add("");
					CONTRACT_END_DT.add("");
					SHIP_CD.add("0");
					ADQ_QTY.add("");
					SYS_USE_GAS.add("");
					QTY_TO_BE_SUPPLY.add("");
				//	DCQ_QTY.add("");
				//	RE_GAS_TARIFF.add("");
					QTY_UNIT_CD.add("1");
					BOE_NO.add("");
					BOE_DT.add("");
					BOE_QTY.add("");
					SUPP_CD.add("0");
					SUPP_NM.add("");
				//	count.add("0");
					
				}
				
			
			
			for(int i=0; i<SHIP_CD.size(); i++)
			{
				queryString = "SELECT ship_name FROM FMS7_SHIP_MST WHERE ship_cd="+SHIP_CD.elementAt(i)+"";
				////System.out.println("REGAS:QRY-R2002:SELECT:FMS7_SHIP_MST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					SHIP_NAME.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					SHIP_NAME.add("");
				}
				
				queryString = "SELECT unit_abr FROM FMS7_UNIT_MST WHERE unit_cd="+QTY_UNIT_CD.elementAt(i)+"";
				////System.out.println("REGAS:QRY-R2003:SELECT:FMS7_UNIT_MST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					QTY_UNIT_ABR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					QTY_UNIT_ABR.add("");
				}
			}
					
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public void fetchEligibleCargoList_new()
	{
		try
		{			
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			//Introduce By Milan 20110916 FOR MMSCM
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();						
			Vector RE_GAS_REV_NO=new Vector();
			Vector LTCORA_REV_NO=new Vector(); //ADDED FRO LTCORA AND CN
			Vector CN_REV_NO=new Vector(); //ADDED FRO LTCORA AND CN
			
			
			double count=0;
			String query="select to_date('"+to_date+"','dd/mm/yyyy')- to_date('"+from_date+"','dd/mm/yyyy')+1 from dual";
			rset=stmt.executeQuery(query);
			if(rset.next())
			{
				count=rset.getDouble(1);
			}
			
			for(int i=0;i<count;i++)
			{
				String query1="select to_char(to_date('"+from_date+"','dd/mm/yyyy')+ "+i+",'dd/mm/yyyy') from dual";
				rset=stmt.executeQuery(query1);
				if(rset.next())
				{
					Vgas_date.add(rset.getString(1));
				}
				
			}
			
			
			
			/*queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_SN_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
			 		"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";*/
			
			//Updated By Milan 20110921
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
	 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_SN_MST A where "+ 
	 		"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
	 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
	 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";
			
			//(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))
			//System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{				
				////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
			  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));
			  	
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			  	////System.out.println("BOOKEDMMSCM : "+BOOKMMSCM+" TOTAL : "+tot_comit_mmscm);
			  	
			  	tot_commitment=nf.format(tot_comit);
			  	SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
			  	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	RATE.add(nf.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
			}	
			
			//System.out.println("SN_REF_NO = "+SN_REF_NO);
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" "
						+ "AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+CUSTOMER_CD.elementAt(i)+"' AND EFF_DT<=TO_DATE('"+from_date+"','DD/MM/YYYY'))";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));	
				}
				else
				{
					CUSTOMER_NM.add("");
					CUSTOMER_ABBR.add("");
				}												
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
//							 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
				 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";

				rset = stmt.executeQuery(queryString);
				//System.out.println(">>>>>>> "+queryString);
				if(rset.next())
				{
					SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110916
					SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);//MD20110916
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;//MD20110916
					}
				}
				else
				{
					SUPPLIEDMBTU.add("0.00");
					SUPPLIEDMMSCM.add("0.00");//MD20110916
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;//MD20110916
				}
				
				BALANCEMMBTU.add(nf.format(Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i))));
				//MD20110916
				BALANCEMMSCM.add(nf.format(Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i));
				bal_tot_comit_mmscm+=Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i));
				//System.out.println("SUPLIEDMMSCM : "+SUPPLIEDMMSCM+" TOTAL : "+sup_tot_comit_mmscm);
				//System.out.println("BALANCEMMSCM : "+BALANCEMMSCM+" TOTAL : "+bal_tot_comit_mmscm);
		   }
			SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
			SUPPLIEDMBTU1[k] =new Vector(); 
			SUPPLIEDMMSCM1[k]=new Vector(); 
				
				for(int i=0;i<CUSTOMER_CD.size();i++)
				{

					queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
					 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
					 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							SUPPLIEDMBTU1[k].add("-");
							SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}

			
		   sup_tot_comitment=nf.format(sup_tot_comit);
		   bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   //Introduce by Milan 20010916
		   sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
		    //--------Logic for Tender and LOA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
	 						"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_LOA_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 						"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 						"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
	 						"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";*/
			
			//Upadated By Milan 20110921
			queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_LOA_MST A where "+ 
				"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
				"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
				"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				LOA_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				LOA_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LOA_CARGO_ARRIVAL_DATE.add(temp_dt);				
				LOA_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	TENDER_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	LOA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	loa_tot_commitment=nf.format(tot_comit) ;
			  	
			  	//INTRODUCE BY MILAN 20110917 FOR SCMMBTU
			  	LOA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	loa_tot_commitment_mmscm=nf.format(tot_comit_mmscm) ;
			  	
			  	LOA_REF_NO.add(rset.getString(8)==null?"0":rset.getString(8));
			  	LOA_SIGNING_DT.add(rset.getString(9)==null?"":rset.getString(9));
			  	LOA_RATE.add(nf.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));			  	
			}
			
			for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" ";
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" "
						+ "AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+LOA_CUSTOMER_CD.elementAt(i)+"' AND EFF_DT<=TO_DATE('"+from_date+"','DD/MM/YYYY'))";
				rset = stmt.executeQuery(queryString);
				//System.out.println("LOA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					LOA_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					LOA_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LOA_CUSTOMER_NM.add("");
					LOA_CUSTOMER_ABBR.add("");
				}												
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";


				rset = stmt.executeQuery(queryString);
				//System.out.println("LOA_QTY_MMBTU = "+queryString);
				if(rset.next())
				{
					LOA_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					LOA_SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					LOA_SUPPLIEDMBTU.add("0.00");
					LOA_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;
				}				
				LOA_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+LOA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+LOA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMBTU.elementAt(i));
				
				LOA_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+LOA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+LOA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMMSCM.elementAt(i));
		   }
			
			LOA_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			LOA_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				LOA_SUPPLIEDMBTU1[k] =new Vector(); 
				LOA_SUPPLIEDMMSCM1[k]=new Vector(); 
				
				for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
				{

					queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
					 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
					 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
					 " AND CONTRACT_TYPE='L'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							LOA_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							LOA_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							LOA_SUPPLIEDMBTU1[k].add("-");
							LOA_SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}


			
			
		   loa_sup_tot_comitment=nf.format(sup_tot_comit);
		   loa_bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   loa_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   loa_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			//--------Logic for Re-Gas based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			//Updated By Milan 20110921
			queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF ,A.cargo_ref_no " +
			  "from FMS7_RE_GAS_CARGO_DTL A where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				RE_GAS_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				RE_GAS_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));
				RE_GAS_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				RE_GAS_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				RE_GAS_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				RE_GAS_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	re_gas_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	RE_GAS_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	re_gas_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	REGAS_RATE.add(nf.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	Regas_cargo_ref_no.add(rset.getString(9));
			}			
			
			for(int i=0;i<RE_GAS_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" ";
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" "
						+ "AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+RE_GAS_CUSTOMER_CD.elementAt(i)+"' AND EFF_DT<=TO_DATE('"+from_date+"','DD/MM/YYYY'))";
				rset = stmt.executeQuery(queryString);
				//System.out.println("RE_GAS_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					RE_GAS_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					RE_GAS_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					RE_GAS_CUSTOMER_NM.add("");
					RE_GAS_CUSTOMER_ABBR.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS7_RE_GAS_MST A " +
							  "WHERE A.RE_GAS_NO='"+RE_GAS_NO.elementAt(i)+"' AND " +
							  "A.REV_NO='"+RE_GAS_REV_NO.elementAt(i)+"' AND " +
							  "A.CUSTOMER_CD='"+RE_GAS_CUSTOMER_CD.elementAt(i)+"' ";			 
				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
				  	REGAS_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					REGAS_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";

				//System.out.println("RE_GAS_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					RE_GAS_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					RE_GAS_SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					RE_GAS_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					RE_GAS_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				RE_GAS_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				RE_GAS_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i));
		   }
			re_gas_sup_tot_comitment=nf.format(sup_tot_comit);
			re_gas_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			re_gas_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			re_gas_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			
			RE_GAS_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			RE_GAS_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				RE_GAS_SUPPLIEDMBTU1[k] =new Vector(); 
				RE_GAS_SUPPLIEDMMSCM1[k]=new Vector(); 
				
			for(int i=0;i<RE_GAS_CUSTOMER_CD.size();i++)
			{

				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
				 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
				 " AND CONTRACT_TYPE='R'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							RE_GAS_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							RE_GAS_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							RE_GAS_SUPPLIEDMBTU1[k].add("-");
							RE_GAS_SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}
			
			
			///////*******ADDED FOR LTCORA AND CN******/////////////
//			--------Logic for LTCORA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			
			
			
			
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			//Updated By Milan 20110921
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF ,A.cargo_ref_no " +
			  "from FMS8_LNG_REGAS_CARGO_DTL A where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS8_LNG_REGAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";
			*/
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY')," +
					" A.mapping_id,A.mapping_id,C.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY," +
					" A.REGAS_TARIF ,A.cargo_ref_no,C.rev_no from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C " +
					" where (A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					" A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))  AND A.MAPPING_ID=C.MAPPING_ID " +
					" AND C.CN_NO='0' AND C.CN_REV_NO='0'" +
					" AND C.REV_NO=(SELECT MAX(B.REV_NO) FROM FMS8_LNG_REGAS_MST B where " +
					" C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO='0' AND B.CN_REV_NO='0') AND a.mapping_id=C.mapping_id" +
					" order by A.CONTRACT_START_DT";
			
			
			
			//System.out.println("Fetching LTCORA details..."+queryString);
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{		
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[1];
				String temp_regas_rev_no=tempmap_id[2];
				String temp_cust_cd=tempmap_id[0];
				
				LTCORA_NO.add(temp_regas_no);
				LTCORA_REV_NO.add(temp_regas_rev_no); 
				LTCORA_CUSTOMER_CD.add(temp_cust_cd);									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LTCORA_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				LTCORA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	LTCORA_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	LTCORA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	LTCORA_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	LTCORA_RATE.add(nf.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	LTCORA_cargo_ref_no.add(rset.getString(9));
			}			
			
			for(int i=0;i<LTCORA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" ";
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" "
						+ "AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+LTCORA_CUSTOMER_CD.elementAt(i)+"' AND EFF_DT<=TO_DATE('"+from_date+"','DD/MM/YYYY'))";
				rset = stmt.executeQuery(queryString);
				//System.out.println("LTCORA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					LTCORA_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					LTCORA_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LTCORA_CUSTOMER_NM.add("");
					LTCORA_CUSTOMER_ABBR.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
							  "WHERE A.AGREEMENT_NO='"+LTCORA_NO.elementAt(i)+"' AND " +
							  "A.REV_NO='"+LTCORA_REV_NO.elementAt(i)+"' AND " +
							  "A.CUSTOMER_CD='"+LTCORA_CUSTOMER_CD.elementAt(i)+"' " +
							  "AND CN_NO='0' AND CN_REV_NO='0' ";			 
				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					LTCORA_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LTCORA_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LTCORA_SEQ_NO.elementAt(i)+" AND FGSA_NO="+LTCORA_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='T'";

				//System.out.println("LTCORA_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					LTCORA_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					LTCORA_SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					LTCORA_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					LTCORA_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				LTCORA_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+LTCORA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+LTCORA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				LTCORA_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+LTCORA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+LTCORA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMMSCM.elementAt(i));
		   }
			LTCORA_sup_tot_comitment=nf.format(sup_tot_comit);
			LTCORA_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			LTCORA_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			LTCORA_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			
			LTCORA_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			LTCORA_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				LTCORA_SUPPLIEDMBTU1[k] =new Vector(); 
				LTCORA_SUPPLIEDMMSCM1[k]=new Vector(); 
				
			for(int i=0;i<LTCORA_CUSTOMER_CD.size();i++)
			{

				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LTCORA_SEQ_NO.elementAt(i)+" AND FGSA_NO="+LTCORA_NO.elementAt(i)+" " +
				 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
				 " AND CONTRACT_TYPE='T'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							LTCORA_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							LTCORA_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							LTCORA_SUPPLIEDMBTU1[k].add("-");
							LTCORA_SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}
			////*********LTCORA END***********///////
//			--------Logic for CN based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			
			String mapping_id="";
			
			
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			//Updated By Milan 20110921
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF ,A.cargo_ref_no " +
			  "from FMS8_LNG_REGAS_CARGO_DTL A where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS8_LNG_REGAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";
			*/
			
			Vector temp_mapping_id=new Vector();
			
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
					" A.mapping_id,A.mapping_id,C.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY, A.REGAS_TARIF ," +
					" A.cargo_ref_no ,C.CN_NO, C.cn_rev_no from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where" +
					" (A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					" A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))  AND A.MAPPING_ID=C.MAPPING_ID" +
					" AND C.CN_NO!=0 AND C.cn_rev_no=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
					" where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 " +
					" AND B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) " +
					" FROM FMS8_LNG_REGAS_MST D WHERE  D.agreement_no=B.agreement_no AND " +
					" B.customer_cd=D.customer_cd AND D.CN_NO=0 AND D.agreement_no=C.agreement_no " +
					" AND D.customer_cd=C.customer_cd )) AND a.mapping_id=C.mapping_id" +
					" order by A.CONTRACT_START_DT ";
			
			
			
			//System.out.println("Fetching CN details..."+queryString);
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{		
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				mapping_id=map_id;
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[3];
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
				temp_mapping_id.add(mapping_id);
				CN_NO.add(temp_regas_no);
				CN_REV_NO.add(temp_regas_rev_no); 
				CN_CUSTOMER_CD.add(temp_cust_cd);									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CN_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				CN_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				CN_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	CN_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	CN_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	CN_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	CN_RATE.add(nf.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	CN_cargo_ref_no.add(rset.getString(9));
			}			
			
			for(int i=0;i<CN_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" ";
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" "
						+ "AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+CN_CUSTOMER_CD.elementAt(i)+"' AND EFF_DT<=TO_DATE('"+from_date+"','DD/MM/YYYY'))";
				rset = stmt.executeQuery(queryString);
				//System.out.println("CN_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					CN_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					CN_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					CN_CUSTOMER_NM.add("");
					CN_CUSTOMER_ABBR.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
							  "WHERE MAPPING_ID='"+temp_mapping_id.elementAt(i)+"'  ";			 
				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CN_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					CN_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+CN_SEQ_NO.elementAt(i)+" AND FGSA_NO="+CN_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='C' " +
				 "AND MAPPING_ID='"+temp_mapping_id.elementAt(i)+"'";

				//System.out.println("CN_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					CN_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					CN_SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					CN_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					CN_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				CN_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+CN_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+CN_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				CN_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+CN_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+CN_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMMSCM.elementAt(i));
		   }
			CN_sup_tot_comitment=nf.format(sup_tot_comit);
			CN_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			CN_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			CN_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			
			CN_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			CN_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				CN_SUPPLIEDMBTU1[k] =new Vector(); 
				CN_SUPPLIEDMMSCM1[k]=new Vector(); 
				
			for(int i=0;i<CN_CUSTOMER_CD.size();i++)
			{

				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+CN_SEQ_NO.elementAt(i)+" AND FGSA_NO="+CN_NO.elementAt(i)+" " +
				 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
				 " AND CONTRACT_TYPE='C' AND MAPPING_ID='"+temp_mapping_id.elementAt(i)+"'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							CN_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							CN_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							CN_SUPPLIEDMBTU1[k].add("-");
							CN_SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}
			////*********CN END***********///////
			
			//RE_GAS
			

			
			
		}		
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchEligibleCargoList_new()-->"+e);
			  e.printStackTrace();
		}
	}
	

	public void fetchEligibleCargoList_new_OLD()
	{
		try
		{			
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			//Introduce By Milan 20110916 FOR MMSCM
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();						
			Vector RE_GAS_REV_NO=new Vector();
			double count=0;
			String query="select to_date('"+to_date+"','dd/mm/yyyy')- to_date('"+from_date+"','dd/mm/yyyy')+1 from dual";
			rset=stmt.executeQuery(query);
			if(rset.next())
			{
				count=rset.getDouble(1);
			}
			
			for(int i=0;i<count;i++)
			{
				String query1="select to_char(to_date('"+from_date+"','dd/mm/yyyy')+ "+i+",'dd/mm/yyyy') from dual";
				rset=stmt.executeQuery(query1);
				if(rset.next())
				{
					Vgas_date.add(rset.getString(1));
				}
				
			}
			
			
			
			/*queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_SN_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
			 		"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";*/
			
			//Updated By Milan 20110921
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
	 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_SN_MST A where "+ 
	 		"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
	 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
	 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";
			
			//(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))
			//System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{				
				////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
			  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));
			  	
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			  	////System.out.println("BOOKEDMMSCM : "+BOOKMMSCM+" TOTAL : "+tot_comit_mmscm);
			  	
			  	tot_commitment=nf.format(tot_comit);
			  	SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
			  	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	RATE.add(nf.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
			}	
			
			//System.out.println("SN_REF_NO = "+SN_REF_NO);
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));	
				}
				else
				{
					CUSTOMER_NM.add("");
					CUSTOMER_ABBR.add("");
				}												
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
//							 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
				 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";

				rset = stmt.executeQuery(queryString);
				//System.out.println(">>>>>>> "+queryString);
				if(rset.next())
				{
					SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110916
					SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);//MD20110916
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;//MD20110916
					}
				}
				else
				{
					SUPPLIEDMBTU.add("0.00");
					SUPPLIEDMMSCM.add("0.00");//MD20110916
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;//MD20110916
				}
				
				BALANCEMMBTU.add(nf.format(Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i))));
				//MD20110916
				BALANCEMMSCM.add(nf.format(Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i));
				bal_tot_comit_mmscm+=Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i));
				//System.out.println("SUPLIEDMMSCM : "+SUPPLIEDMMSCM+" TOTAL : "+sup_tot_comit_mmscm);
				//System.out.println("BALANCEMMSCM : "+BALANCEMMSCM+" TOTAL : "+bal_tot_comit_mmscm);
		   }
			SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
			SUPPLIEDMBTU1[k] =new Vector(); 
			SUPPLIEDMMSCM1[k]=new Vector(); 
				
				for(int i=0;i<CUSTOMER_CD.size();i++)
				{

					queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
					 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
					 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							SUPPLIEDMBTU1[k].add("-");
							SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}

			
		   sup_tot_comitment=nf.format(sup_tot_comit);
		   bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   //Introduce by Milan 20010916
		   sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
		    //--------Logic for Tender and LOA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
	 						"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_LOA_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 						"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 						"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
	 						"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";*/
			
			//Upadated By Milan 20110921
			queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_LOA_MST A where "+ 
				"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
				"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
				"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				LOA_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				LOA_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LOA_CARGO_ARRIVAL_DATE.add(temp_dt);				
				LOA_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	TENDER_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	LOA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	loa_tot_commitment=nf.format(tot_comit) ;
			  	
			  	//INTRODUCE BY MILAN 20110917 FOR SCMMBTU
			  	LOA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	loa_tot_commitment_mmscm=nf.format(tot_comit_mmscm) ;
			  	
			  	LOA_REF_NO.add(rset.getString(8)==null?"0":rset.getString(8));
			  	LOA_SIGNING_DT.add(rset.getString(9)==null?"":rset.getString(9));
			  	LOA_RATE.add(nf.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));			  	
			}
			
			for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				//System.out.println("LOA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					LOA_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					LOA_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LOA_CUSTOMER_NM.add("");
					LOA_CUSTOMER_ABBR.add("");
				}												
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";


				rset = stmt.executeQuery(queryString);
				//System.out.println("LOA_QTY_MMBTU = "+queryString);
				if(rset.next())
				{
					LOA_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					LOA_SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					LOA_SUPPLIEDMBTU.add("0.00");
					LOA_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;
				}				
				LOA_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+LOA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+LOA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMBTU.elementAt(i));
				
				LOA_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+LOA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+LOA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMMSCM.elementAt(i));
		   }
			
			LOA_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			LOA_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				LOA_SUPPLIEDMBTU1[k] =new Vector(); 
				LOA_SUPPLIEDMMSCM1[k]=new Vector(); 
				
				for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
				{

					queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
					 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
					 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
					 " AND CONTRACT_TYPE='L'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							LOA_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							LOA_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							LOA_SUPPLIEDMBTU1[k].add("-");
							LOA_SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}


			
			
		   loa_sup_tot_comitment=nf.format(sup_tot_comit);
		   loa_bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   loa_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   loa_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			//--------Logic for Re-Gas based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			//Updated By Milan 20110921
			queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF ,A.cargo_ref_no " +
			  "from FMS7_RE_GAS_CARGO_DTL A where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				RE_GAS_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				RE_GAS_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));
				RE_GAS_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				RE_GAS_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				RE_GAS_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				RE_GAS_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	re_gas_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	RE_GAS_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	re_gas_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	REGAS_RATE.add(nf.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	Regas_cargo_ref_no.add(rset.getString(9));
			}			
			
			for(int i=0;i<RE_GAS_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				//System.out.println("RE_GAS_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					RE_GAS_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					RE_GAS_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					RE_GAS_CUSTOMER_NM.add("");
					RE_GAS_CUSTOMER_ABBR.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS7_RE_GAS_MST A " +
							  "WHERE A.RE_GAS_NO='"+RE_GAS_NO.elementAt(i)+"' AND " +
							  "A.REV_NO='"+RE_GAS_REV_NO.elementAt(i)+"' AND " +
							  "A.CUSTOMER_CD='"+RE_GAS_CUSTOMER_CD.elementAt(i)+"' ";			 
				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
				  	REGAS_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					REGAS_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+from_date+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";

				//System.out.println("RE_GAS_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					RE_GAS_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					RE_GAS_SUPPLIEDMMSCM.add(rset.getString(2)==null?"0.00":nf.format(Double.parseDouble(rset.getString(2))/1000000));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					RE_GAS_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					RE_GAS_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				RE_GAS_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				RE_GAS_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i));
		   }
			re_gas_sup_tot_comitment=nf.format(sup_tot_comit);
			re_gas_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			re_gas_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			re_gas_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			
			RE_GAS_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			RE_GAS_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ;; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				RE_GAS_SUPPLIEDMBTU1[k] =new Vector(); 
				RE_GAS_SUPPLIEDMMSCM1[k]=new Vector(); 
				
			for(int i=0;i<RE_GAS_CUSTOMER_CD.size();i++)
			{

				queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
				 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
				 " AND CONTRACT_TYPE='R'";
					rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							RE_GAS_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
							RE_GAS_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
							
						}
						else
						{
							RE_GAS_SUPPLIEDMBTU1[k].add("-");
							RE_GAS_SUPPLIEDMMSCM1[k].add("-");
							
						}
				}
			}

			
			
		}		
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchEligibleCargoList_new()-->"+e);
			  e.printStackTrace();
		}
	}
	
	
	
	public void fetchcargo_allocation_plantwise()
	{
		try
		{			
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();						
			Vector RE_GAS_REV_NO=new Vector();
			double count=0;
			String query="select to_date('"+CONTRACT_END_DT.elementAt(0)+"','dd/mm/yyyy')- to_date('"+CONTRACT_START_DT.elementAt(0)+"','dd/mm/yyyy')+1 from dual";
			//System.out.println(query);
			rset=stmt.executeQuery(query);
			if(rset.next())
			{
				count=rset.getDouble(1);
			}
			
			for(int i=0;i<count;i++)
			{
				String query1="select to_char(to_date('"+CONTRACT_START_DT.elementAt(0)+"','dd/mm/yyyy')+ "+i+",'dd/mm/yyyy') from dual";
				rset=stmt.executeQuery(query1);
				if(rset.next())
				{
					Vgas_date.add(rset.getString(1));
				}
				
			}
						
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			
			queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF ,A.cargo_ref_no " +
			  "from FMS7_RE_GAS_CARGO_DTL A where cargo_ref_no='"+setcargo_ref_no+"'";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				RE_GAS_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				RE_GAS_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));
				RE_GAS_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				RE_GAS_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				RE_GAS_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
					  	
			}			
			
			queryString=" Select DISTINCT(A.SEQ_NO), to_char(A.EFF_DT,'dd/mm/yyyy'), A.PLANT_TYPE, A.PLANT_NAME, A.PLANT_ABBR, A.PLANT_ADDR, A.PLANT_STATE, A.PLANT_ZONE, A.PLANT_CITY,  A.PLANT_PIN, A.PLANT_SECTOR from FMS7_CUSTOMER_PLANT_DTL A WHERE A.CUSTOMER_CD='"+Buyer_cd+"' and A.EFF_DT=(select max(B.eff_dt) from FMS7_CUSTOMER_PLANT_DTL B where A.seq_no=B.seq_no and B.CUSTOMER_CD='"+Buyer_cd+"') order by A.SEQ_NO";	
			//System.out.println("Last date = "+queryString);
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				cust_plant_cd.add(rset.getString(1)==null?"":rset.getString(1));
				cust_plant_nm.add(rset.getString(4)==null?"":rset.getString(4));
				
			}	
			
			RE_GAS_SUPPLIEDMBTU1=new Vector[Vgas_date.size()] ; 
			RE_GAS_SUPPLIEDMMSCM1=new Vector[Vgas_date.size()] ; 
			
			for(int k=0;k<Vgas_date.size();k++)
			{
				RE_GAS_SUPPLIEDMBTU1[k] =new Vector(); 
				RE_GAS_SUPPLIEDMMSCM1[k]=new Vector(); 
                double sum=0;
				
				for(int i=0;i<cust_plant_cd.size();i++)
				{
					queryString ="select SUM(QTY_MMBTU),SUM(QTY_SCM) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+Buyer_cd+" " +
					 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(0)+" AND FGSA_NO="+re_gas_no+" " +
					 "AND GAS_DT=to_date('"+Vgas_date.elementAt(k)+"','dd/mm/yyyy')" +
					 " AND CONTRACT_TYPE='R' and plant_seq_no='"+cust_plant_cd.elementAt(i)+"'";
					 rset = stmt.executeQuery(queryString);
					////System.out.println(">>>>>>> "+queryString);
					if(rset.next())
					{
						RE_GAS_SUPPLIEDMBTU1[k].add(rset.getString(1)==null?"-":nf.format(Double.parseDouble(rset.getString(1))));
						RE_GAS_SUPPLIEDMMSCM1[k].add(rset.getString(2)==null?"-":nf.format(Double.parseDouble(rset.getString(2))/1000000));
						sum=sum+Double.parseDouble(rset.getString(1)==null?"0":nf.format(Double.parseDouble(rset.getString(1))));		
					}
					else
					{
						RE_GAS_SUPPLIEDMBTU1[k].add("-");
						RE_GAS_SUPPLIEDMMSCM1[k].add("-");
								
					}
				}
				Vdatewise_plant_tot.add(String.valueOf(sum));
			}
			
			
			for(int i=0;i<cust_plant_cd.size();i++)
			{
				String temp="";
				String query1="select hlpl_inv_seq_no,financial_year from FMS7_INVOICE_MST where CUSTOMER_CD="+Buyer_cd+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(0)+" AND FGSA_NO="+re_gas_no+" " +
				 "AND period_start_dt between to_date('"+Vgas_date.firstElement()+"','dd/mm/yyyy') and to_date('"+Vgas_date.lastElement()+"','dd/mm/yyyy')" +
				 " AND CONTRACT_TYPE='R' and plant_seq_no='"+cust_plant_cd.elementAt(i)+"'";
				rset = stmt.executeQuery(query1);
				while(rset.next())
				{
					if(temp.equalsIgnoreCase(""))
					{
						temp=rset.getString(1)+"/"+rset.getString(2);
					}
					else
					{
						temp=temp+","+rset.getString(1)+"/"+rset.getString(2);
					}
					//System.out.println(cust_plant_nm.elementAt(i)+"-->>"+rset.getString(1)+"/"+rset.getString(2));
					
				}
				Vplant_inv_no.add(temp);
			}
			
			
		}		
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchEligibleCargoList_new()-->"+e);
			  e.printStackTrace();
		}
	}
	
	String Emp_cd = "";
	String Customer_access_flag = "N";
	
	public void fetchEligibleCargoList_WITH_ACCESS()
	{
		try
		{			
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			//Introduce By Milan 20110916 FOR MMSCM
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();						
			Vector RE_GAS_REV_NO=new Vector();
			Vector LTCORA_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector LTCORA_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			
			/*queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_SN_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
			 		"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";*/
			
			//Updated By Milan 20110921
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
	 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_SN_MST A, "
	 		+ "SEC_EMP_CUSTOMER_ALLOC_MST B where "+ 
	 		"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
	 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
	 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) AND A.CUSTOMER_CD=B.CUSTOMER_CD "
	 		+ "AND B.EMP_CD='"+Emp_cd+"' order by A.START_DT";
			
			//(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))
			System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{				
				////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add("S"+rset.getString(6)==null?"0":rset.getString(6));	
			  	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
			  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));
			  	
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			  	////System.out.println("BOOKEDMMSCM : "+BOOKMMSCM+" TOTAL : "+tot_comit_mmscm);
			  	
			  	tot_commitment=nf.format(tot_comit);
			  	SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
			  	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
			}	
			
//			//System.out.println("SN_REF_NO = "+SN_REF_NO);
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));	
				}
				else
				{
					CUSTOMER_NM.add("");
					CUSTOMER_ABBR.add("");
				}	
				System.out.println("CUSTOMER_NM: "+CUSTOMER_NM);
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
//							 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
//			
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
				 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";

				rset = stmt.executeQuery(queryString);
//				//System.out.println(">>>>>>> "+queryString);
				if(rset.next())
				{
					SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110916
					SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);//MD20110916
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;//MD20110916
					}
				}
				else
				{
					SUPPLIEDMBTU.add("0.00");
					SUPPLIEDMMSCM.add("0.00");//MD20110916
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;//MD20110916
				}
				
				BALANCEMMBTU.add(nf.format(Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i))));
				//MD20110916
				BALANCEMMSCM.add(nf.format(Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i));
				bal_tot_comit_mmscm+=Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i));
//				//System.out.println("SUPLIEDMMSCM : "+SUPPLIEDMMSCM+" TOTAL : "+sup_tot_comit_mmscm);
//				//System.out.println("BALANCEMMSCM : "+BALANCEMMSCM+" TOTAL : "+bal_tot_comit_mmscm);
				
				//////////////SB20200817////////////////////////
				String TCQ=""; String Alloc_Qty=""; String Gen_Dt=to_date; String Cont_End_Dt="";
				TCQ=""+BOOKMMBTU.elementAt(i); Cont_End_Dt=""+TO_DT.elementAt(i);
				Alloc_Qty=""+SUPPLIEDMBTU.elementAt(i); Cont_End_Dt=""+TO_DT.elementAt(i);
				String Mapp_Id=CUSTOMER_CD.elementAt(i)+"-"+FGSA_NO.elementAt(i)+"-"+FGSA_REV_NO.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i);
				String Phy_CurFrd_Price="0"; String Fin_CurFrd_Price="0";
				String Buy_Sell="SELL"; 
				if(CUSTOMER_ABBR.elementAt(i).equals("SEIPL"))
					Buy_Sell="Buy";
				
				String PriceType="";
				queryString ="SELECT PRICE_TYPE, MAN_CD FROM FMS7_MAN_REQ_MST "+
						" where MAN_CD IN (SELECT CARGO_REF_NO FROM FMS7_SN_CARGO_DTL "
						+ " where FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND FGSA_REV_NO='"+FGSA_REV_NO.elementAt(i)+"' AND SN_NO='"+SN_NO.elementAt(i)+"' "
						+ "AND SN_REV_NO='"+SN_REV_NO.elementAt(i)+"') ";
				rset = stmt.executeQuery(queryString);
//				//System.out.println(">>>>>>> "+queryString);
				if(rset.next())
				{
					PriceType=rset.getString(1);
				}
				if(PriceType.equals(""))
				{
					String NewSalePrice="";
					queryString ="SELECT NEW_SALE_PRICE FROM FMS8_CARGO_ALLOC_REVISED_DTL "+
							" where FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND FGSA_REV_NO='"+FGSA_REV_NO.elementAt(i)+"' AND SN_NO='"+SN_NO.elementAt(i)+"' "
							+ "AND SN_REV_NO='"+SN_REV_NO.elementAt(i)+"' AND CONTRACT_TYPE='S' AND NEW_PRICE_EFF_DT <=TO_DATE('"+Gen_Dt+"','DD/MM/YYYY')";//AND FLAG='A' ";
					rset = stmt.executeQuery(queryString);
				//	System.out.println(">>>>>>> "+queryString);
					if(rset.next())
					{
						NewSalePrice=rset.getString(1);
						PriceType="M";
					}
					else
						PriceType="F";
					System.out.println("NewSalePrice>>>>>>> "+NewSalePrice);
				}
				/*///Price Pulling from Table////////////////////////////
				String tempGen_Dt[]=Gen_Dt.split("/");
				String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; String GenMthYr=GenMth+"/"+GenYr;
				String INDEX_TYPE="LNG_ICE_JKM";
				queryString ="SELECT COMMODITY_VALUE FROM FMS9_COMMODITY_VALUE_DTL WHERE INDEX_TYPE='"+INDEX_TYPE+"' and DELV_MTH=TO_DATE('"+GenMthYr+"','MM/YYYY') ";
				rset = stmt.executeQuery(queryString);
			//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
				if(rset.next())
				{
					Fin_CurFrd_Price=rset.getString(1);
				}
				INDEX_TYPE="RLNG_PHYS_INDIA";
				queryString ="SELECT COMMODITY_VALUE FROM FMS9_COMMODITY_VALUE_DTL WHERE INDEX_TYPE='"+INDEX_TYPE+"' and DELV_MTH=TO_DATE('"+GenMthYr+"','MM/YYYY') ";
				rset = stmt.executeQuery(queryString);
			//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
				if(rset.next())
				{
					Phy_CurFrd_Price=rset.getString(1);
				}
				*////^^^^^^^Price Pulling from Table////////////////////////////
				String PriorCurveGasPrice="";
			//	if(Double.parseDouble(""+VMthYrWisePriceICE_JKM.elementAt(i))>0)
					PriorCurveGasPrice="0";
				
				String DealPrice="";
				DealPrice=""+RATE.elementAt(i);
				String Slope="1.025";
				String GasDate=""+FRM_DT.elementAt(i);
				MRCR_ContDtl(Mapp_Id, Buy_Sell,PriceType, DealPrice, TCQ, Alloc_Qty, GasDate, Gen_Dt, Cont_End_Dt, Phy_CurFrd_Price, Fin_CurFrd_Price, Slope, PriorCurveGasPrice);
				////////////////////////////////////////////////
		   }
		   sup_tot_comitment=nf.format(sup_tot_comit);
		   bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   //Introduce by Milan 20010916
		   sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
		    //--------Logic for Tender and LOA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
	 						"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_LOA_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 						"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 						"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
	 						"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";*/
			
			//Upadated By Milan 20110921
			queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE from FMS7_LOA_MST A, "
				+ "SEC_EMP_CUSTOMER_ALLOC_MST B where "+ 
				"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
				"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
				"A.CUSTOMER_CD=B.CUSTOMER_CD) AND A.CUSTOMER_CD=B.CUSTOMER_CD AND B.EMP_CD='"+Emp_cd+"'  "
				+ "order by A.START_DT";
			rset = stmt.executeQuery(queryString);
//			//System.out.println(queryString);
			while(rset.next())
			{				
				LOA_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				LOA_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LOA_CARGO_ARRIVAL_DATE.add(temp_dt);				
				LOA_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	TENDER_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	LOA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	loa_tot_commitment=nf.format(tot_comit) ;
			  	
			  	//INTRODUCE BY MILAN 20110917 FOR SCMMBTU
			  	LOA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	loa_tot_commitment_mmscm=nf.format(tot_comit_mmscm) ;
			  	
			  	LOA_REF_NO.add(rset.getString(8)==null?"0":rset.getString(8));
			  	LOA_SIGNING_DT.add(rset.getString(9)==null?"":rset.getString(9));
			  	LOA_RATE.add(nf2.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));			  	
			}
			
			for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
//				//System.out.println("LOA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					LOA_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					LOA_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LOA_CUSTOMER_NM.add("");
					LOA_CUSTOMER_ABBR.add("");
				}												
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";


				rset = stmt.executeQuery(queryString);
//				//System.out.println("LOA_QTY_MMBTU = "+queryString);
				if(rset.next())
				{
					LOA_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					LOA_SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					LOA_SUPPLIEDMBTU.add("0.00");
					LOA_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;
				}				
				LOA_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+LOA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+LOA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMBTU.elementAt(i));
				
				LOA_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+LOA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+LOA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LOA_SUPPLIEDMMSCM.elementAt(i));
		   }
		   loa_sup_tot_comitment=nf.format(sup_tot_comit);
		   loa_bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   loa_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   loa_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			//--------Logic for Re-Gas based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			//Updated By Milan 20110921
			queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
			  "from FMS7_RE_GAS_CARGO_DTL A, SEC_EMP_CUSTOMER_ALLOC_MST B where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) AND A.CUSTOMER_CD=B.CUSTOMER_CD "
             + "AND B.EMP_CD='"+Emp_cd+"' order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
//			//System.out.println(queryString);
			while(rset.next())
			{				
				RE_GAS_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				RE_GAS_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));
				RE_GAS_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				RE_GAS_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				RE_GAS_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				RE_GAS_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	re_gas_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	RE_GAS_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	re_gas_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	REGAS_RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			}			
			
			for(int i=0;i<RE_GAS_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
//				//System.out.println("RE_GAS_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					RE_GAS_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					RE_GAS_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					RE_GAS_CUSTOMER_NM.add("");
					RE_GAS_CUSTOMER_ABBR.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS7_RE_GAS_MST A " +
							  "WHERE A.RE_GAS_NO='"+RE_GAS_NO.elementAt(i)+"' AND " +
							  "A.REV_NO='"+RE_GAS_REV_NO.elementAt(i)+"' AND " +
							  "A.CUSTOMER_CD='"+RE_GAS_CUSTOMER_CD.elementAt(i)+"' ";			 
//				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
				  	REGAS_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					REGAS_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";

//				//System.out.println("RE_GAS_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					RE_GAS_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					RE_GAS_SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					RE_GAS_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					RE_GAS_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				RE_GAS_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				RE_GAS_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i));
		   }
			re_gas_sup_tot_comitment=nf.format(sup_tot_comit);
			re_gas_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			re_gas_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			re_gas_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
//			//System.out.println("re_gas_sup_tot_comitment_mmscm"+re_gas_sup_tot_comitment_mmscm);
//			//System.out.println("re_gas_bal_tot_comitment_mmscm"+re_gas_bal_tot_comitment_mmscm);
			
			//////**********ADDED FOR LTCORA AND CN
			//--------Logic for LTCORA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			
			
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF " +
			  "from FMS8_LNG_REGAS_CARGO_DTL A where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";
			*/
			/*queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
						" A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, C.REV_NO " +
						"from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
						"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') " +
						"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
						"AND CN_NO='0' AND CN_REV_NO='0' AND  C.REV_NO=(SELECT MAX(B.REV_NO) " +
						"FROM FMS8_LNG_REGAS_MST B where C.AGREEMENT_NO=B.AGREEMENT_NO AND C.REV_NO=B.REV_NO " +
						"AND C.CUSTOMER_CD=B.CUSTOMER_CD  AND CN_NO='0' AND CN_REV_NO='0') " +
						"order by A.CONTRACT_START_DT";*/
			/////*** beLOW CODE IS CHANGED FOR PERIOD IN PLCAE OF LTCORA ***////
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
			"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
			"C.REV_NO from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C, SEC_EMP_CUSTOMER_ALLOC_MST E where " +
			"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
			"A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
			"AND C.CN_NO!='0' AND CN_NO >'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
			"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO >'9999' AND " +
			"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
			"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
			"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) AND C.CUSTOMER_CD=E.CUSTOMER_CD "
			+ "AND E.EMP_CD='"+Emp_cd+"' " +
			"order by A.CONTRACT_START_DT";
			
			rset = stmt.executeQuery(queryString);
//			//System.out.println(queryString);
			while(rset.next())
			{				
				
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[3];
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
				LTCORA_MAPPING_ID.add(map_id);
				LTCORA_NO.add(temp_regas_no);
				LTCORA_REV_NO.add(temp_regas_rev_no);
				LTCORA_CUSTOMER_CD.add(temp_cust_cd);									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LTCORA_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				LTCORA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	LTCORA_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	LTCORA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	LTCORA_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	LTCORA_RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			}			
			
			for(int i=0;i<LTCORA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
//				//System.out.println("LTCORA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					LTCORA_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					LTCORA_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LTCORA_CUSTOMER_NM.add("");
					LTCORA_CUSTOMER_ABBR.add("");	
				}	
				
				/*queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
							  "WHERE A.AGREEMENT_NO='"+LTCORA_NO.elementAt(i)+"' AND " +
							  "A.REV_NO='"+LTCORA_REV_NO.elementAt(i)+"' AND " +
							  "A.CUSTOMER_CD='"+LTCORA_CUSTOMER_CD.elementAt(i)+"' AND CN_NO='0' AND CN_REV_NO='0'";*/
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
				  "WHERE A.MAPPING_ID='"+LTCORA_MAPPING_ID.elementAt(i)+"' ";
//				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					LTCORA_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					LTCORA_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LTCORA_SEQ_NO.elementAt(i)+" AND FGSA_NO="+LTCORA_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='C' AND MAPPING_ID='"+LTCORA_MAPPING_ID.elementAt(i)+"'";

//				//System.out.println("LTCORA_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					LTCORA_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					LTCORA_SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					LTCORA_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					LTCORA_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				LTCORA_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+LTCORA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+LTCORA_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				LTCORA_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+LTCORA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+LTCORA_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+LTCORA_SUPPLIEDMMSCM.elementAt(i));
		   }
			LTCORA_sup_tot_comitment=nf.format(sup_tot_comit);
			LTCORA_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			LTCORA_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			LTCORA_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
			
			//--------Logic for CN based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			
			
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
					"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
					"C.REV_NO from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C, SEC_EMP_CUSTOMER_ALLOC_MST E where " +
					"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					"A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
					"AND C.CN_NO!='0' AND CN_NO <'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
					"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO <'9999' AND " +
					"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
					"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
					"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) AND C.CUSTOMER_CD=E.CUSTOMER_CD AND "
					+ "E.EMP_CD='"+Emp_cd+"' " +
					"order by A.CONTRACT_START_DT";
//			//System.out.println("CNNNNNNNNNN......"+queryString);
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[3];
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
				CN_MAPPING_ID.add(map_id);
				CN_NO.add(temp_regas_no);
				CN_REV_NO.add(temp_regas_rev_no);
				CN_CUSTOMER_CD.add(temp_cust_cd);									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CN_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				CN_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				CN_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	CN_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	CN_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	CN_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	CN_RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			}			
			
			for(int i=0;i<CN_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
//				//System.out.println("CN_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					CN_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					CN_CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					CN_CUSTOMER_NM.add("");
					CN_CUSTOMER_ABBR.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
							  "WHERE A.MAPPING_ID='"+CN_MAPPING_ID.elementAt(i)+"' ";
							 			 
//				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CN_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					CN_SIGNING_DT.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+CN_SEQ_NO.elementAt(i)+" AND FGSA_NO="+CN_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='C' AND MAPPING_ID='"+CN_MAPPING_ID.elementAt(i)+"'";

//				//System.out.println("CN_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					CN_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					CN_SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}
				}
				else
				{
					CN_SUPPLIEDMBTU.add("0.00");
					sup_tot_comit+=0;
					
					CN_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;
				}				
				CN_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+CN_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+CN_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				CN_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+CN_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+CN_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+CN_SUPPLIEDMMSCM.elementAt(i));
		   }
			CN_sup_tot_comitment=nf.format(sup_tot_comit);
			CN_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			CN_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			CN_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			//END OF LTCORA AND CN
//			//System.out.println("CN_sup_tot_comitment_mmscm"+CN_sup_tot_comitment_mmscm);
//			//System.out.println("CN_bal_tot_comitment_mmscm"+CN_bal_tot_comitment_mmscm);
			
		}		
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchEligibleCargoList()-->"+e);
			  e.printStackTrace();
		}
	}
	
	
	
	public void fetchEligibleCargoList()
	{
		try
		{	
			//HARSH20210207
			///After Generating EOD Exposure We fetch data from FMS9_EOD_EXPO_TRACK_MST if data is not available then applied our logic
			int count = 0;
			queryString = "SELECT COUNT(*) FROM FMS9_EOD_EXPO_TRACK_MST WHERE REPORT_DT = TO_DATE('"+to_date+"','DD/MM/YYYY')";
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				count = rset.getInt(1);
			}count=0;
			if(count != 0)
			{
				queryString = "SELECT A.CUSTOMER_CD,DEAL_ID,CUSTOMER_NM,DEAL_REF_NO,TO_CHAR(DEAL_SIGN_DT,'DD/MM/YYYY'),TO_CHAR(DEAL_START_DT,'DD/MM/YYYY'),TO_CHAR(DEAL_END_DT,'DD/MM/YYYY'),DEAL_TYPE,CR_EXCEED_AMT,CR_EXCEED_AMT_USD,COLLAT_VALUE,LIMIT_VALUE,B.CUSTOMER_ABBR,EXPO_INCLTAX_AMT "
						+ "FROM FMS9_EOD_EXPO_TRACK_MST A,FMS7_CUSTOMER_MST B WHERE A.CUSTOMER_CD = B.CUSTOMER_CD AND REPORT_DT = TO_DATE('"+to_date+"','DD/MM/YYYY') ORDER BY CUSTOMER_CD";
				rset=stmt.executeQuery(queryString);
				while(rset.next())
				{
					CUSTOMER_CD.add(rset.getString(1)==null?"":rset.getString(1));
					String DealId = rset.getString(2)==null?"":rset.getString(2);
					String ContType = DealId.substring(0,1);
					VDealUniqueId.add(DealId);
					VContType.add(ContType);
					VDealUniqueIdColor.add("");
					CUSTOMER_NM.add(rset.getString(3)==null?"":rset.getString(3));
					VContRefno.add(rset.getString(4)==null?"":rset.getString(4));
					SIGNING_DT.add(rset.getString(5)==null?"":rset.getString(5));
					String temp_st_dt = rset.getString(6)==null?"":rset.getString(6); 
					VContStDt.add(temp_st_dt);
					String temp_end_dt = rset.getString(7)==null?"":rset.getString(7);
					VContEndDt.add(temp_end_dt);
					CARGO_ARRIVAL_DATE.add(temp_st_dt+" - "+temp_end_dt);
					VDealType.add(rset.getString(8)==null?"":rset.getString(8));
					VContDelv.add("");//need discuss
					double creditExceed = Double.parseDouble(rset.getString(9)==null?"0":rset.getString(9));
					VCreditExceed.add(nf.format(creditExceed));
					double creditExceedUSD = Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10));
					VCreditExceedUSD.add(nf.format(creditExceedUSD));
					
					double collateralValue = Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11));
					double limitValue = Double.parseDouble(rset.getString(12)==null?"0":rset.getString(12));
					VCollateralValue.add(nf.format(collateralValue));
					VLimitValue.add(nf.format(limitValue));
					CUSTOMER_ABBR.add(rset.getString(13)==null?"":rset.getString(13));
					VGrossExposureAmtInclTax.add(rset.getString(14)==null?"":rset.getString(14));
					
					//VReasonExceedCredit.add("");
					
					VExchgRate.add("");VExchgRate_Dt.add("");VExchgRate_Nm.add("");BOOKMMBTU.add("");VDealDCQ.add("");
					VTransValue.add("");SN_NO.add("");SN_REF_NO.add("");
				}
				CR_BuyDeal(); //HARSH20201208 Only For Buy Deal
				////////////////////////////////////Logic For Reason Of Exceed////////////////////HARSH20201120
				double collateralValue = 0;double collateralLinkedValue = 0; double limitValue=0;
				for(int j=0; j<VCollateralValue.size(); j++)
				{
					String reasonExceed="";
					if(!VCollateralValue.elementAt(j).equals(""))
						collateralValue= Double.parseDouble(""+VCollateralValue.elementAt(j));
					else
						collateralValue=0.00;
					if(!VLimitValue.elementAt(j).equals(""))
						limitValue= Double.parseDouble(""+VLimitValue.elementAt(j));
					else
						limitValue=0.00;
					/*if(!VCollateralValueLinked.elementAt(j).equals(""))
						collateralLinkedValue = Double.parseDouble(""+VCollateralValueLinked.elementAt(j));
					else
						collateralLinkedValue = 0.00;*/
					
					//Shi Ting 07/12/20202: //HARSH20201208
					//1)Credit limit exceeded (Logic: If counter partys exposure exceeds credit limit / collateral 
					//(if counter party has parent, it will use parents limit) for any of the exposure date
					//2)For new deals entered on trade date = EOD date, Open deal with counterparty having no credit limit
					//(Logic: if sell deal, counterparty has no limit, but security type entered during deal captured is open account)
					//3)For new deals entered on trade date = EOD date, Security required for counterparty rated C and D
					//(Logic: if buy deal, counterparty is rated C and D but security type entered during deal captured is open account)
					
					//THE PURPOSE IS IF BUY DEAL THEN CHECK START DT == SYSDATE IF YES THEN CHECK CREDIT RATING C OR D & OPEN ACCOUNT IF YES THEN SHOW BUY DEAL IN EXCEED CREDIT REPORT OTHERWISH NOT SHOW AS PER CUSTOMER FEEDBACK ON  19/02/2021
					String ExceedReasonflag = "N"; //only for buy deal HARSH20210223
					if(collateralValue > 0.00 || limitValue > 0.00)
					{
						reasonExceed = "Credit Limit or Collateral Value Exceed";
						ExceedReasonflag = "Y"; //HARSH20210223
					}
					String sys_dt="";
					String sysdate = "select to_char(sysdate,'DD/MM/YYYY') from dual";
					rset=stmt.executeQuery(sysdate);
					if(rset.next())
					{
						sys_dt=rset.getString(1)==null?"":rset.getString(1);
					}
					//sys_dt="01/12/2020"; //testing HARSH20201208
					//HARSH20210315 if(VContStDt.elementAt(j).equals(to_date))
					if(SIGNING_DT.elementAt(j).equals(to_date)) //NOW TRAED_DATE IS A SIGNING DATE SO, WE COMPARE WITH REPORT DATE AS PER FEEDBACK ON 15/03/2021 
					{
						String checkOA="";
						if(!VContType.elementAt(j).equals("B"))
						{
							checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and link='"+VDealUniqueId.elementAt(j)+"' and sec_type='OA'";// and issu_dt <= to_date('"+to_date+"','dd/mm/yyyy') and exp_dt >= to_date('"+to_date+"','dd/mm/yyyy')";
							//HARSH20210215 USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
						}
						else
						{
							checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr=(select cust_abbr from fms9_limit_mst where cust_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and (credit_rating='C' or credit_rating='D')) and link='"+VDealUniqueId.elementAt(j)+"' and sec_type='OA'";
							//HARSH20210215 USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
						}
						//System.out.println("Open Account:-------"+checkOA);
						rset1 = stmt1.executeQuery(checkOA);
						int found = 0;
						if(rset1.next())
						{
							found = rset1.getInt(1);
						}
						if(found > 0)
						{
							if(VContType.elementAt(j).equals("B"))
							{
								reasonExceed = "Security required for counterparty rated C and D";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
							else
							{
								if(limitValue == 0.00){
									reasonExceed = "Open Deal With Counter Party having no Credit Limit";
									ExceedReasonflag = "Y"; //HARSH20210223
								}
							}
						}
						else
						{
							//reasonExceed = "Unsecured deal with counterparty having no credit limit";
							//ExceedReasonflag = "N"; //HARSH20210223
						}
						
					}
					else
					{
						/*if(limitValue <= 0.00 || (collateralValue <= 0.00 || collateralLinkedValue <= 0.00))
						{
							reasonExceed = "Unsecured deal with counterparty having no credit limit";
							ExceedReasonflag = "N"; //HARSH20210223
						}*/
						//ExceedReasonflag = "N"; //HARSH20210223
					}
					VReasonExceedCredit.add(reasonExceed);
					VReasonExceedCreditFlag.add(ExceedReasonflag); //HARSH20210223
				}
			}else{
				String tmp_from_dt = " ";
				String temp_dt="";
				String tmp_to_dt = " ";			
				double tot_comit=0.0;
				double sup_tot_comit=0.0;
				double bal_tot_comit=0.0;
				//Introduce By Milan 20110916 FOR MMSCM
				double tot_comit_mmscm=0.0;
				double sup_tot_comit_mmscm=0.0;
				double bal_tot_comit_mmscm=0.0;
				Vector FRM_DT=new Vector();
				Vector TO_DT=new Vector();						
				Vector RE_GAS_REV_NO=new Vector();
				Vector LTCORA_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
				Vector LTCORA_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
				Vector CN_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
				Vector CN_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
				Vector MAPPING_ID=new Vector();//MAPP_ID for All
				
				/////////////////////////////////////////////////////////////////////////
				String FirstFortNightEndDt="15"; String FortNightBillStartDt=""; String SecondFortNightBillStartDt=""; String FirstFortNightFlag="";
				String tempGen_Dt[]=to_date.split("/");
				String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; 
				FirstFortNightEndDt = "15/"+GenMth+"/"+GenYr;
				SecondFortNightBillStartDt="16/"+GenMth+"/"+GenYr;
				String NextMth="";
				NextMth = GenMth+"/"+GenYr;
				int DayCount=0;
				queryString = "SELECT TO_DATE('"+FirstFortNightEndDt+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL" ;
			//	System.out.println(" DUAL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					DayCount = rset.getInt(1);
				}
				if(DayCount<0)
				{
					FortNightBillStartDt="01/"+GenMth+"/"+GenYr;
					FirstFortNightFlag="Y";
				}
				else
				{
					FortNightBillStartDt="16/"+GenMth+"/"+GenYr;
					FirstFortNightFlag="N";
				}
				
				///////////////////////////////^^^Find out the Fortnight ///////////////////////
				//Updated By Milan 20110921
				queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
		 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE from FMS7_SN_MST A where "+ 
		 	//SB20200912	"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
		 	//HARSH20210319	"(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
		 		"((SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "//HARSH20210319
		 		+ "OR (START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "//HARSH20210529
		 		+ "OR (SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy'))) AND "+ //HARSH20210529 
		 		//SB20200919	"(SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
		 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
		 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			//	System.out.println("STEP-1: FMS7_SN_MST: "+queryString);
				rset = stmt.executeQuery(queryString);
				////System.out.println("FOr SN : "+to_date+" "+from_date);
				while(rset.next())
				{				
					////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
					SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
					CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
					tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
					tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
					FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
					TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
					temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
					CARGO_ARRIVAL_DATE.add(temp_dt);				
					SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
				  	FGSA_NO.add("S"+rset.getString(6)==null?"0":rset.getString(6));	
				  	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
				  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
				  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
				  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));
				  	
				  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
				  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
				  	////System.out.println("BOOKEDMMSCM : "+BOOKMMSCM+" TOTAL : "+tot_comit_mmscm);
				  	
				  	tot_commitment=nf.format(tot_comit);
				  	SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
				  	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
				  	RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
				  	VSalesPriceFlag.add("2"); //SB20201207: USD=2 for Sales Gas
				  	VSalesPriceCurr.add("USD"); //SB20201207: USD=2 for Sales Gas
				  	String TEMP_apr_by=rset.getString(12)==null?"0":rset.getString(12);
				  	sn_apr_dt.add(rset.getString(13)==null?"-":rset.getString(13));
				  	String temp_ent_by=rset.getString(14)==null?"0":rset.getString(14);
				  	sn_ent_dt.add(rset.getString(15)==null?"-":rset.getString(15));
				  	VDealDCQ.add(rset.getString(16)==null?"0":rset.getString(16));
				  	VNoOfCargo.add(""); //SB20210125: Not in USE for LoA/SN
				  	
				  	VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
				  	VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
					VAdvAmt.add(rset.getString(17)==null?"0":rset.getString(17));
					VTransValue.add(rset.getString(18)==null?"0":rset.getString(18));
					double TransCharge=rset.getDouble(18);
					if(TransCharge==0)
						VContDelv.add("");
					else
						VContDelv.add("(DLV)");
					VDealType.add("GAS"); //SB20201021
				  	String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
				  	rset1=stmt1.executeQuery(queryString_nm);
				  	if(rset1.next()){
				  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
				  	}else{
				  		sn_apr_by.add("-");
				  	}
				  	
				  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
				  	rset1=stmt1.executeQuery(queryString_nm);
				  	if(rset1.next()){
				  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
				  	}else{
				  		sn_ent_by.add("-");
				  	}
				  	MAPPING_ID.add(rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
					VDealUniqueId.add("S"+rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
					VDealId_Display.add("S"+rset.getString(6)+"-"+rset.getString(3)); //HARSH20210722 AS PER INCIDENT ID#112
					VDealUniqueIdColor.add("BLACK");
					VContType.add("S");
					VContRefno.add(rset.getString(9)==null?"":rset.getString(9));
					VContTCQ.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));				
	//////////////////////////Get Exchange Rate////////////////////////////////////////
			String Exchg_Rate_CD="";
			queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
					" FROM FMS7_SN_BILLING_DTL " +
				     "WHERE cont_type='S' AND customer_cd="+rset.getString(5)+" AND FGSA_NO="+rset.getString(6)+" AND sn_no="+rset.getString(3)+" ";
		//	System.out.println("STEP-7: DLNG_SN_BILLING_DTL: >>>> "+queryString2);
			rset2 = stmt2.executeQuery(queryString2);
			if(rset2.next())
			{
				Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
				int due_days = Integer.parseInt(rset2.getString(2));
			}
			double AvailableExchgRate=0;
			queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
					" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
					" AND FLAG='Y' ";
		//	System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
			rset2 = stmt2.executeQuery(queryString2);
			if(rset2.next())
			{
				AvailableExchgRate =rset2.getDouble(1);		
				VExchgRate.add(AvailableExchgRate); 
				VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
				VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
			}
			else
			{
				VExchgRate.add("0"); 
				VExchgRate_Dt.add("Avg."); 
				VExchgRate_Nm.add("Avg."); 
			}	
			///////////////////////////////^^^^^///////////////////////////////////////////////
		}
	///////////////////Calculate for Next Mth //////////////////////////////
				int no_of_days=0; String Gen_Dt=to_date; 
					String LastDateMth=""; String LastDateNextMth=""; String FirstDateNextMth=""; 
					queryString = "SELECT TO_CHAR(LAST_DAY(TO_DATE('"+Gen_Dt+"','DD/MM/YYYY')),'DD/MM/YYYY') FROM DUAL";
					//	System.out.println("Query for generating Last Date of the selected Month = "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							LastDateMth = rset.getString(1);// System.out.println("LastDateMth: "+LastDateMth);
						}
					////	queryString = "SELECT TO_CHAR(LAST_DAY(TO_DATE('"+Gen_Dt+"','DD/MM/YYYY')+1),'DD/MM/YYYY') FROM DUAL";
						queryString = "SELECT TO_CHAR(TO_DATE('"+LastDateMth+"','DD/MM/YYYY')+1,'DD/MM/YYYY') FROM DUAL ";
					//	System.out.println("Query for generating Last Date of the selected Month = "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							FirstDateNextMth = rset.getString(1); //System.out.println("FirstDateNextMth: "+FirstDateNextMth);
						}
					queryString = "SELECT TO_CHAR(LAST_DAY(TO_DATE('"+LastDateMth+"','DD/MM/YYYY')+1),'DD/MM/YYYY') FROM DUAL";
					//		System.out.println("Next Date of the selected Month = "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next())
							{
								LastDateNextMth = rset.getString(1); //System.out.println("LastDateNextMth: "+LastDateNextMth);
								
							}
							UnDeliveredFmTo=LastDateMth;
							String tempLastDateNextMth[]=LastDateNextMth.split("/");
							String tempMth=tempLastDateNextMth[1]; String tempYr=tempLastDateNextMth[2]; 
							NextMth = tempMth+"/"+tempYr;
					queryString = "SELECT TO_CHAR(TO_DATE('"+from_date+"','DD/MM/YYYY')-1,'DD/MM/YYYY') FROM DUAL ";
						//	System.out.println("Next Date of the selected Month = "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next())
							{
								LastDatePrevtMth = rset.getString(1); 
								//System.out.println("LastDatePrevtMth: "+LastDatePrevtMth);
								
							}
				/////////////////////////////LOA LIst of Contracts/////////////////////////////////////////////////////////////////
							queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
									"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE  from FMS7_LOA_MST A where "+ 
							//SB20201013		"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
							//HARSH20210319		"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND " + //SB20201013
									"((A.SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "//HARSH20210319
									+ "OR (A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "//HARSH20210529
									+ "OR (A.SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy'))) AND "+ //HARSH20210529
									//SB20200919			"(A.SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
									"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
									"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
								rset = stmt.executeQuery(queryString);
						//		System.out.println("LOA: "+queryString);
								while(rset.next())
								{				

									SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
									CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
									tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
									tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
									FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
									TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
									temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
									CARGO_ARRIVAL_DATE.add(temp_dt);				
									SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
								  	FGSA_NO.add("L"+rset.getString(6)==null?"0":rset.getString(6));	
								  	FGSA_REV_NO.add("0");	 //No Rev no in LoA
								  	BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
								  	BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));//MD20110916
								  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
								  	
								  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
								  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
								  	
								  	tot_commitment=nf.format(tot_comit);
								  	SN_REF_NO.add(rset.getString(8)==null?"0":rset.getString(8));	
								  	SIGNING_DT.add(rset.getString(9)==null?"0":rset.getString(9));
								  	RATE.add(nf2.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));
									VSalesPriceFlag.add("2"); //SB20201207: USD=2 for Sales Gas
									VSalesPriceCurr.add("USD"); //SB20201207: USD=2 for Sales Gas
								  	String TEMP_apr_by=rset.getString(11)==null?"0":rset.getString(11);
								  	sn_apr_dt.add(rset.getString(12)==null?"-":rset.getString(12));
								  	String temp_ent_by=rset.getString(13)==null?"0":rset.getString(13);
								  	sn_ent_dt.add(rset.getString(14)==null?"-":rset.getString(14));
								  	VDealDCQ.add(rset.getString(15)==null?"0":rset.getString(15));
								  	VNoOfCargo.add(""); //SB20210125: Not in USE for LoA/SN
								  	VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
								  	VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
									VAdvAmt.add(rset.getString(16)==null?"0":rset.getString(16));
									VTransValue.add(rset.getString(17)==null?"0":rset.getString(17));
									double TransCharge=rset.getDouble(17);
									if(TransCharge==0)
										VContDelv.add("");
									else
										VContDelv.add("(DLV)");
									VDealType.add("GAS"); //SB20201021
								  	String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
								  	rset1=stmt1.executeQuery(queryString_nm);
								  	if(rset1.next()){
								  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
								  	}else{
								  		sn_apr_by.add("-");
								  	}
								  	
								  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
								  	rset1=stmt1.executeQuery(queryString_nm);
								  	if(rset1.next()){
								  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
								  	}else{
								  		sn_ent_by.add("-");
								  	}
								  	MAPPING_ID.add(rset.getString(6)+"-0"+"-"+rset.getString(3)+"-"+rset.getString(4));
								  	VDealUniqueId.add("L"+rset.getString(6)+"-0"+"-"+rset.getString(3)+"-"+rset.getString(4));
								  	VDealId_Display.add("L"+rset.getString(6)+"-"+rset.getString(3));//HARSH20210722 AS PER INCIDENT ID#112
								  	VDealUniqueIdColor.add("BLUE");
								  	VContType.add("L");
								  	VContRefno.add(rset.getString(8)==null?"":rset.getString(8));
									VContTCQ.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));		
									//////////////////////////Get Exchange Rate////////////////////////////////////////
									String Exchg_Rate_CD="";
									queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
											" FROM FMS7_SN_BILLING_DTL " +
										     "WHERE cont_type='L' AND customer_cd="+rset.getString(5)+" AND FGSA_NO="+rset.getString(6)+" AND sn_no="+rset.getString(3)+" ";
							//		System.out.println("STEP-7: DLNG_SN_BILLING_DTL: >>>> "+queryString2);
									rset2 = stmt2.executeQuery(queryString2);
									if(rset2.next())
									{
										Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
										int due_days = Integer.parseInt(rset2.getString(2));
									}
									double AvailableExchgRate=0;
									queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
											" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
											" AND FLAG='Y' ";
							//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
									rset2 = stmt2.executeQuery(queryString2);
									if(rset2.next())
									{
										AvailableExchgRate =rset2.getDouble(1);		
										VExchgRate.add(AvailableExchgRate); 
										VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
										VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
									}
									else
									{
										VExchgRate.add("0"); 
										VExchgRate_Dt.add("Avg."); 
										VExchgRate_Nm.add("Avg."); 
									}	
									///////////////////////////////^^^^^///////////////////////////////////////////////
								}
				//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
							//// beLOW CODE IS CHANGED FOR PERIOD IN PLCAE OF LTCORA ////
							//SB20210126	queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
								queryString="select TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'), " +
								"A.mapping_id,A.mapping_id,A.CARGO_REF_NO,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
								"C.REV_NO,C.PRE_APPROVAL_BY,TO_CHAR(C.PRE_APPROVAL_DaTE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), DCQ_QTY, A.TARIFF_CUR_FLAG, NO_OF_CARGO,TO_CHAR(SIGNING_DT,'DD/MM/YYYY') " //HARSH20210609 SIGNING DATE ADDED
								+ "from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
								"((C.SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) " +
								" OR (A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "
								+ "OR (C.SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy'))) "
								+ "AND A.MAPPING_ID=C.MAPPING_ID " +
								"AND C.CN_NO!='0' AND CN_NO >'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
								"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO >'9999' AND " +
								"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
								"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
								//"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +  //RG20191108
								"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd and B.rev_no=D.rev_no and D.rev_no=C.rev_no )) " +  
								"order by A.CONTRACT_START_DT";
								//rset = stmt.executeQuery(queryString);
								System.out.println("LTCORA: -"+queryString);
								while(rset.next())
								{				
									
									String map_id=rset.getString(3)==null?"":rset.getString(3);
									String tempmap_id[]=map_id.split("-");
									
									String temp_regas_no=tempmap_id[3];
									String temp_regas_rev_no=tempmap_id[4];
									String temp_cust_cd=tempmap_id[0];
									
							//SB20201027		SN_NO.add(temp_regas_no);
							//SB20201027		SN_REV_NO.add(temp_regas_rev_no);	
								///	LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
									SN_NO.add(rset.getString(6)==null?"0":rset.getString(6));
									SN_REV_NO.add("0");			  	
							//SB20201027	  	FGSA_NO.add(tempmap_id[1]);	
							//SB20201027		FGSA_REV_NO.add("0");	 //No Rev no in LoA
								  	FGSA_NO.add(temp_regas_no);	  	
								  	FGSA_REV_NO.add(temp_regas_rev_no);	 //No Rev no in LoA
									CUSTOMER_CD.add(temp_cust_cd);									
									tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
									tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
									FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
									TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
									temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
									CARGO_ARRIVAL_DATE.add(temp_dt);	
								//SB	BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
								  	BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));//MD20110916
								  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
								  	tot_commitment=nf.format(tot_comit);
								  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
								  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
								//SB  	SN_REF_NO.add(rset.getString(5));  //For Capacity Deal, Cargo Seq No.
								  	//HARSH20210609 WRONG SIGNING_DT.add(rset.getString(1)==null?"0":rset.getString(1));
								  	SIGNING_DT.add(rset.getString(17)==null?"":rset.getString(17));//HARSH20210609
								  	RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
								  	VSalesPriceFlag.add(rset.getString(15)==null?"2":rset.getString(15)); //SB20201207
								  	if(rset.getString(15).equals("2"))
								  		VSalesPriceCurr.add("USD"); //SB20201207: USD=2 for Sales Gas
								  	else
								  		VSalesPriceCurr.add("INR"); //SB20201207: INR=1 for Sales Gas
								  	VNoOfCargo.add(rset.getString(16)==null?"*":rset.getString(16)); //SB20210125
								  	String TEMP_apr_by=rset.getString(10)==null?"0":rset.getString(10);
								  	sn_apr_dt.add(rset.getString(11)==null?"-":rset.getString(11));
								  	String temp_ent_by=rset.getString(12)==null?"0":rset.getString(12);
								  	sn_ent_dt.add(rset.getString(13)==null?"-":rset.getString(13));
								  	VDealDCQ.add(rset.getString(14)==null?"1":rset.getString(14));
								  	VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
								  	VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
									VAdvAmt.add("0");
									VTransValue.add("0");
									double TransCharge=0;
									if(TransCharge==0)
										VContDelv.add("");
									else
										VContDelv.add("(DLV)");
									VDealType.add("CAPACITY"); //SB20201021
									MAPPING_ID.add(map_id);
								  	VDealUniqueId.add("C"+map_id);
								  	VDealId_Display.add("C"+map_id);//HARSH20210722 AS PER INCIDENT ID#112
								  	VDealUniqueIdColor.add("BLUE");
								  	VContType.add("C");
								  	VContRefno.add(rset.getString(5)==null?"":rset.getString(5)); //HARSH20220119
								//SB	VContTCQ.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7)))); //For Temporary		
									//////////////////////////Get Exchange Rate////////////////////////////////////////
							
									String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
								  	rset1=stmt1.executeQuery(queryString_nm);
								  	if(rset1.next()){
								  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
								  	}else{
								  		sn_apr_by.add("-");
								  	}
								  	
								  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
								  	rset1=stmt1.executeQuery(queryString_nm);
								  	if(rset1.next()){
								  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
								  	}else{
								  		sn_ent_by.add("-");
								  	}
									//////////////////////////Get Exchange Rate////////////////////////////////////////
									String Exchg_Rate_CD="";
									queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
											" FROM FMS8_LNG_REGAS_BILLING_DTL " +
										     "WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
								//	System.out.println("STEP-7: FMS8_LNG_REGAS_BILLING_DTL: >>>> "+queryString2);
									rset2 = stmt2.executeQuery(queryString2);
									if(rset2.next())
									{
										Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
										int due_days = Integer.parseInt(rset2.getString(2));
									}
									double AvailableExchgRate=0;
									queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
											" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
											" AND FLAG='Y' ";
							//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
									rset2 = stmt2.executeQuery(queryString2);
									if(rset2.next())
									{
										AvailableExchgRate =rset2.getDouble(1);		
										VExchgRate.add(AvailableExchgRate); 
										VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
										VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
									}
									else
									{
										VExchgRate.add("0"); 
										VExchgRate_Dt.add("Avg."); 
										VExchgRate_Nm.add("Avg."); 
									}
				///////////////////////For Multiple Cargos/////////////////////
									double QtyToSupp=0; double TotalQtyToSupp=0; String CargoRefNo=""; String CargoDcqValue=""; double CargoDcq=0;
									double CargoQtyToBeSupp=0; double SumOfCargoAllocQty=0; double SumOfCargoBalanceQty=0; 
									queryString2 ="select A.CARGO_REF_NO,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY, DCQ_QTY, A.REGAS_TARIF, A.mapping_id, TO_CHAR(CONTRACT_START_DT,'dd/mm/yyyy'), TO_CHAR(CONTRACT_END_DT,'dd/mm/yyyy') from FMS8_LNG_REGAS_CARGO_DTL A"
									 +" where A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND MAPPING_ID='"+map_id+"' "
									 +" order by A.CONTRACT_START_DT,A.CONTRACT_END_DT, A.CARGO_SEQ_NO ";
									System.out.println(" MULTIPLE CARGO: FMS8_LNG_REGAS_CARGO_DTL: "+queryString2);
									rset2 = stmt2.executeQuery(queryString2);
									while(rset2.next())
									{
										//String CargoNoTemp[]=map_id.split("-");									
										String CargoNo=rset2.getString(2);//CargoNoTemp[3];
										VCargoDealNo.add(map_id);
										VCargoSeqNo.add(rset2.getString(1));
										VCargoQTS.add(rset2.getString(3));
										VCargoDCQ.add(rset2.getString(4));
										VCargoContStartDt.add(rset2.getString(7));
										VCargoContEndDt.add(rset2.getString(8));
										
										CargoRefNo=CargoRefNo+rset2.getString(2)+",";
										QtyToSupp=rset2.getDouble(3);
										CargoQtyToBeSupp=QtyToSupp;
										TotalQtyToSupp+=QtyToSupp;
										CargoDcqValue=CargoDcqValue+rset2.getString(3)+"("+rset2.getString(4)+"),";
										VCargoNo.add(CargoNo);
										String queryStringQty="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL "+
												" WHERE MAPPING_ID='"+map_id+"' "
												+ " AND GAS_DT between to_date('"+rset2.getString(7)+"','dd/mm/yyyy') and to_date('"+to_date+"','dd/mm/yyyy')"
										//SB+ " AND GAS_DT <= to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')";
												+ "  AND SN_NO="+CargoNo+" ";
										//	System.out.println(map_id+" :STEP-3A: FMS7_DAILY_ALLOCATION_DTL: "+queryStringQty);
											rset1=stmt1.executeQuery(queryStringQty);
											if(rset1.next()){
											//	VCargoWiseBilledQty.add(rset1.getDouble(1));
												SumOfCargoAllocQty=rset1.getDouble(1);
												VCargoWiseBilledQty.add(rset1.getDouble(1)); //System.out.println(CargoNo+" :rset1.getDouble(1): "+rset1.getDouble(1));
											}	
											else
												VCargoWiseBilledQty.add("0");
											SumOfCargoBalanceQty=CargoQtyToBeSupp-SumOfCargoAllocQty;
											VCargoWiseBalanceQty.add(SumOfCargoBalanceQty);
									}
								/*	VCargoSeqNo.add("");
									VCargoDealNo.add("");
									VCargoQTS.add(nf.format(TotalQtyToSupp));
									VCargoDCQ.add("");
									VCargoContStartDt.add("Total:"+map_id);
									VCargoContEndDt.add("");
									VCargoNo.add("0");*/
									
									SN_REF_NO.add(CargoRefNo+"/"+CargoDcqValue);
									BOOKMMBTU.add(nf.format(TotalQtyToSupp));	
									VContTCQ.add(nf.format(TotalQtyToSupp));	
									///////////////////////////////////////////////////////////////
									///////////////////////////////^^^^^///////////////////////////////////////////////
								}	
		////////////^^LTCORA///////////////////////////////////////////////
								/*System.out.println(VCargoSeqNo.size()+" :VCargoSeqNo: "+VCargoSeqNo);
								System.out.println(VCargoDealNo.size()+" :VCargoDealNo: "+VCargoDealNo);
								System.out.println(VCargoQTS.size()+" :VCargoQTS: "+VCargoQTS);
								System.out.println(VCargoWiseBilledQty.size()+" :VCargoWiseBilledQty: "+VCargoWiseBilledQty);
								System.out.println(VCargoWiseBalanceQty.size()+" :VCargoWiseBalanceQty: "+VCargoWiseBalanceQty);*/
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//// beLOW CODE IS CHANGED FOR PERIOD IN PLCAE OF LTCORA ////
				/*	queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
							"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
							"C.REV_NO,C.PRE_APPROVAL_BY,TO_CHAR(C.PRE_APPROVAL_DaTE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), DCQ_QTY from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
							"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
							"A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
							"AND C.CN_NO!='0' AND CN_NO <'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
							"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO <'9999' AND " +
							"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
							"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
					//"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +  //RG20191108
					"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd and B.rev_no=D.rev_no and D.rev_no=C.rev_no )) " +  
					"order by A.CONTRACT_START_DT";
					*/
					//SB20210126 queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
					queryString="select TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'), " +
							"A.mapping_id,A.mapping_id,A.CARGO_REF_NO,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
							"C.REV_NO,PRE_APPROVAL_BY,TO_CHAR(PRE_APPROVAL_DATE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), DCQ_QTY, A.TARIFF_CUR_FLAG, NO_OF_CARGO,TO_CHAR(SIGNING_DT,'DD/MM/YYYY')  " //HARSH20210609 SIGNING DT ADDED
							+ "from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
							"((C.SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) " +
							" OR (A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "
							+ "OR (C.SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy'))) "
							+ "AND A.MAPPING_ID=C.MAPPING_ID " +
							"AND C.CN_NO!='0' AND CN_NO <'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
							"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO <'9999' AND " +
							"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
							"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
							"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +
							"order by A.CONTRACT_START_DT";
					//rset = stmt.executeQuery(queryString);
					//System.out.println("CN-LTCORA: -"+queryString);
					while(rset.next())
					{				
					
					String map_id=rset.getString(3)==null?"":rset.getString(3);
					String tempmap_id[]=map_id.split("-");
					
					String temp_regas_no=tempmap_id[3];
					String temp_regas_rev_no=tempmap_id[4];
					String temp_cust_cd=tempmap_id[0];
					
					//SB20201027		SN_NO.add(temp_regas_no);
					//SB20201027		SN_REV_NO.add(temp_regas_rev_no);	
					///	LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
					SN_NO.add(rset.getString(6)==null?"0":rset.getString(6));
					SN_REV_NO.add("0");			  	
					//SB20201027	  	FGSA_NO.add(tempmap_id[1]);	
					//SB20201027		FGSA_REV_NO.add("0");	 //No Rev no in LoA
					FGSA_NO.add(temp_regas_no);	  	
					FGSA_REV_NO.add(temp_regas_rev_no);	 //No Rev no in LoA
					CUSTOMER_CD.add(temp_cust_cd);									
					tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
					tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
					FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
					TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
					temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
					CARGO_ARRIVAL_DATE.add(temp_dt);	
				//SB	BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
					BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));//MD20110916
					tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
					tot_commitment=nf.format(tot_comit);
					tot_comit_mmscm=(tot_comit/38900);//MD20110916
					tot_commitment_mmscm=nf.format(tot_comit_mmscm);
				//SB	SN_REF_NO.add(rset.getString(5));  //For Capacity Deal, Cargo Seq No.	
					//HARSH20210609 WRONG SIGNING_DT.add(rset.getString(1)==null?"0":rset.getString(1));
					SIGNING_DT.add(rset.getString(17)==null?"":rset.getString(17)); //HARSH20210609
					RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
					VSalesPriceFlag.add(rset.getString(15)==null?"2":rset.getString(15)); //SB20201207
					if(rset.getString(15).equals("2"))
				  		VSalesPriceCurr.add("USD"); //SB20201207: USD=2 for Sales Gas
				  	else
				  		VSalesPriceCurr.add("INR"); //SB20201207: INR=1 for Sales Gas
					VNoOfCargo.add(rset.getString(16)==null?"*":rset.getString(16)); //SB20210125
					
					String TEMP_apr_by=rset.getString(10)==null?"0":rset.getString(10);
					sn_apr_dt.add(rset.getString(11)==null?"-":rset.getString(11));
					String temp_ent_by=rset.getString(12)==null?"0":rset.getString(12);
					sn_ent_dt.add(rset.getString(13)==null?"-":rset.getString(13));
					VDealDCQ.add(rset.getString(14)==null?"1":rset.getString(14));
					VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
					VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
					VAdvAmt.add("0");
					VTransValue.add("0");
					double TransCharge=0;
					if(TransCharge==0)
						VContDelv.add("");
					else
						VContDelv.add("(DLV)");
					VDealType.add("CAPACITY"); //SB20201021
					MAPPING_ID.add(map_id);
					VDealUniqueId.add("C"+map_id);
					VDealId_Display.add("C"+map_id);//HARSH20210722 AS PER INCIDENT ID#112
					VDealUniqueIdColor.add("BLUE");
					VContType.add("C");
					VContRefno.add(rset.getString(5)==null?"":rset.getString(5)); //HARSH20220119
			//SB		VContTCQ.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7)))); //For Temporary		
					//////////////////////////Get Exchange Rate////////////////////////////////////////
					
					String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
					rset1=stmt1.executeQuery(queryString_nm);
					if(rset1.next()){
					sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
					}else{
					sn_apr_by.add("-");
					}
					
					queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
					rset1=stmt1.executeQuery(queryString_nm);
					if(rset1.next()){
					sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
					}else{
					sn_ent_by.add("-");
					}
					//////////////////////////Get Exchange Rate////////////////////////////////////////
					String Exchg_Rate_CD="";
					queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
					" FROM FMS8_LNG_REGAS_BILLING_DTL " +
					"WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
					//	System.out.println("STEP-7: FMS8_LNG_REGAS_BILLING_DTL: >>>> "+queryString2);
					rset2 = stmt2.executeQuery(queryString2);
					if(rset2.next())
					{
					Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
					int due_days = Integer.parseInt(rset2.getString(2));
					}
					double AvailableExchgRate=0;
					queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
					" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
					" AND FLAG='Y' ";
					//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
					rset2 = stmt2.executeQuery(queryString2);
					if(rset2.next())
					{
					AvailableExchgRate =rset2.getDouble(1);		
					VExchgRate.add(AvailableExchgRate); 
					VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
					VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
					}
					else
					{
					VExchgRate.add("0"); 
					VExchgRate_Dt.add("Avg."); 
					VExchgRate_Nm.add("Avg."); 
					}	
					///////////////////////For Multiple Cargos/////////////////////
					double QtyToSupp=0; double TotalQtyToSupp=0; String CargoRefNo=""; String CargoDcqValue=""; double CargoDcq=0;
					double CargoQtyToBeSupp=0; double SumOfCargoAllocQty=0; double SumOfCargoBalanceQty=0; 
					queryString2 ="select A.CARGO_REF_NO,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY, DCQ_QTY, A.REGAS_TARIF, A.mapping_id, TO_CHAR(CONTRACT_START_DT,'dd/mm/yyyy'), TO_CHAR(CONTRACT_END_DT,'dd/mm/yyyy') from FMS8_LNG_REGAS_CARGO_DTL A"
					 +" where A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND MAPPING_ID='"+map_id+"' "
					 +" order by A.CONTRACT_START_DT,A.CONTRACT_END_DT, A.CARGO_SEQ_NO ";
					//System.out.println(" MULTIPLE CARGO: FMS8_LNG_REGAS_CARGO_DTL: "+queryString2);
					rset2 = stmt2.executeQuery(queryString2);
					while(rset2.next())
					{
						//String CargoNoTemp[]=map_id.split("-");									
						String CargoNo=rset2.getString(2);//CargoNoTemp[3];
						VCargoSeqNo.add(rset2.getString(1));
						VCargoDealNo.add(map_id);
						VCargoQTS.add(rset2.getString(3));
						VCargoDCQ.add(rset2.getString(4));
						VCargoContStartDt.add(rset2.getString(7));
						VCargoContEndDt.add(rset2.getString(8));
						
						CargoRefNo=CargoRefNo+rset2.getString(2)+",";
						QtyToSupp=rset2.getDouble(3);
						CargoQtyToBeSupp=QtyToSupp;
						TotalQtyToSupp+=QtyToSupp;
						CargoDcqValue=CargoDcqValue+rset2.getString(3)+"("+rset2.getString(4)+"),";
						VCargoNo.add(CargoNo);
						String queryStringQty="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL "+
								" WHERE MAPPING_ID='"+map_id+"' "
								+ " AND GAS_DT between to_date('"+rset2.getString(7)+"','dd/mm/yyyy') and to_date('"+to_date+"','dd/mm/yyyy')"
						//SB+ " AND GAS_DT <= to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')";
								+ "  AND SN_NO="+CargoNo+" ";
							System.out.println(map_id+" :STEP-3A: FMS7_DAILY_ALLOCATION_DTL: "+queryStringQty);
							rset1=stmt1.executeQuery(queryStringQty);
							if(rset1.next()){
							//	VCargoWiseBilledQty.add(rset1.getDouble(1));
								SumOfCargoAllocQty=rset1.getDouble(1);
								VCargoWiseBilledQty.add(rset1.getDouble(1)); //System.out.println(CargoNo+" :rset1.getDouble(1): "+rset1.getDouble(1));
							}	
							else
								VCargoWiseBilledQty.add("0");
							SumOfCargoBalanceQty=CargoQtyToBeSupp-SumOfCargoAllocQty;
							VCargoWiseBalanceQty.add(SumOfCargoBalanceQty);
					}
				/*	VCargoSeqNo.add("");
					VCargoDealNo.add("");
					VCargoQTS.add(nf.format(TotalQtyToSupp));
					VCargoDCQ.add("");
					VCargoContStartDt.add("Total:"+map_id);
					VCargoContEndDt.add("");
					VCargoNo.add("0");
					*/
					SN_REF_NO.add(CargoRefNo+"/"+CargoDcqValue);
					BOOKMMBTU.add(nf.format(TotalQtyToSupp));	
					VContTCQ.add(nf.format(TotalQtyToSupp));
					///////////////////////////////////////////////////////////////
	///////////////////////////////^^^^^///////////////////////////////////////////////
	}	
					queryString="select TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'), " +
							"mapping_id,mapping_id,CN_NO,C.REV_NO,C.PRE_APPROVAL_BY,TO_CHAR(C.PRE_APPROVAL_DaTE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), "
							+ "TARIFF_CUR_FLAG, NO_OF_CARGO,TO_CHAR(SIGNING_DT,'DD/MM/YYYY'),TARIFF_AMT " //HARSH20210609 SIGNING DATE ADDED
							+ "from FMS8_LNG_REGAS_MST C where " +
							"((SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) " +
							" OR (START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) "
							+ "OR (SIGNING_DT = to_date('"+to_date+"','dd/mm/yyyy') AND START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy'))) "
							+"AND C.CN_NO!='0' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
							"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND " +
							"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
							"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
							//"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +  //RG20191108
							"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd and B.rev_no=D.rev_no and D.rev_no=C.rev_no )) " +  
							"order by START_DT";
					rset = stmt.executeQuery(queryString);
					//System.out.println("LTCORA: -"+queryString);
					while(rset.next())
					{				
						
						String map_id=rset.getString(3)==null?"":rset.getString(3);
						String tempmap_id[]=map_id.split("-");
						
						String temp_regas_no=tempmap_id[3];
						String temp_regas_rev_no=tempmap_id[4];
						String temp_cust_cd=tempmap_id[0];
						
				//SB20201027		SN_NO.add(temp_regas_no);
				//SB20201027		SN_REV_NO.add(temp_regas_rev_no);	
					///	LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
						SN_NO.add(rset.getString(5)==null?"0":rset.getString(5));
						SN_REV_NO.add("0");			  	
				//SB20201027	  	FGSA_NO.add(tempmap_id[1]);	
				//SB20201027		FGSA_REV_NO.add("0");	 //No Rev no in LoA
					  	FGSA_NO.add(temp_regas_no);	  	
					  	FGSA_REV_NO.add(temp_regas_rev_no);	 //No Rev no in LoA
						CUSTOMER_CD.add(temp_cust_cd);									
						tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
						tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
						FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
						TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
						temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
						CARGO_ARRIVAL_DATE.add(temp_dt);
						
						BOOKMMSCM.add("0.00");//MD20110916
					  	tot_comit +=0.00;
					  	tot_commitment=nf.format(tot_comit);
					  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
					  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
					//SB  	SN_REF_NO.add(rset.getString(5));  //For Capacity Deal, Cargo Seq No.
					    //HARSH20210609 WRONG SIGNING_DT.add(rset.getString(1)==null?"0":rset.getString(1));
					  	SIGNING_DT.add(rset.getString(13)==null?"":rset.getString(13));//HARSH20210609
					  	RATE.add(nf2.format(Double.parseDouble(rset.getString(14)==null?"0":rset.getString(14))));
					  	VSalesPriceFlag.add(rset.getString(11)==null?"2":rset.getString(11)); //SB20201207
					  	if(rset.getString(11).equals("2"))
					  		VSalesPriceCurr.add("USD"); //SB20201207: USD=2 for Sales Gas
					  	else
					  		VSalesPriceCurr.add("INR"); //SB20201207: INR=1 for Sales Gas
					  	VNoOfCargo.add(rset.getString(12)==null?"*":rset.getString(12)); //SB20210125
					  	String TEMP_apr_by=rset.getString(7)==null?"0":rset.getString(7);
					  	sn_apr_dt.add(rset.getString(8)==null?"-":rset.getString(8));
					  	String temp_ent_by=rset.getString(9)==null?"0":rset.getString(9);
					  	sn_ent_dt.add(rset.getString(10)==null?"-":rset.getString(10));
					  	VDealDCQ.add("1");
					  	VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
					  	VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
						VAdvAmt.add("0");
						VTransValue.add("0");
						double TransCharge=0;
						if(TransCharge==0)
							VContDelv.add("");
						else
							VContDelv.add("(DLV)");
						VDealType.add("CAPACITY"); //SB20201021
						MAPPING_ID.add(map_id);
					  	VDealUniqueId.add("C"+map_id);
					  	VDealId_Display.add("C"+tempmap_id[1]+"-"+rset.getString(5));//HARSH20210722 AS PER INCIDENT ID#112 //MAPPING ID CHANGED AS REQUESTED BY @JAYASRI MAM 
					  	VDealUniqueIdColor.add("BLUE");
					  	VContType.add("C");
					  	VContRefno.add(""); 
					  	
	//////////////////////////Get Exchange Rate////////////////////////////////////////
						
						String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
					  	rset1=stmt1.executeQuery(queryString_nm);
					  	if(rset1.next()){
					  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
					  	}else{
					  		sn_apr_by.add("-");
					  	}
					  	
					  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
					  	rset1=stmt1.executeQuery(queryString_nm);
					  	if(rset1.next()){
					  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
					  	}else{
					  		sn_ent_by.add("-");
					  	}
						//////////////////////////Get Exchange Rate////////////////////////////////////////
						String Exchg_Rate_CD="";
						queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
								" FROM FMS8_LNG_REGAS_BILLING_DTL " +
							     "WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
					//	System.out.println("STEP-7: FMS8_LNG_REGAS_BILLING_DTL: >>>> "+queryString2);
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
							int due_days = Integer.parseInt(rset2.getString(2));
						}
						double AvailableExchgRate=0;
						queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
								" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
								" AND FLAG='Y' ";
				//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							AvailableExchgRate =rset2.getDouble(1);		
							VExchgRate.add(AvailableExchgRate); 
							VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
							VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
						}
						else
						{
							VExchgRate.add("0"); 
							VExchgRate_Dt.add("Avg."); 
							VExchgRate_Nm.add("Avg."); 
						}
						
						///////////////////////For Multiple Cargos/////////////////////
							double QtyToSupp=0; double TotalQtyToSupp=0; String CargoRefNo=""; String CargoDcqValue=""; double CargoDcq=0;
							double CargoQtyToBeSupp=0; double SumOfCargoAllocQty=0; double SumOfCargoBalanceQty=0; 
							queryString2 ="select A.CARGO_REF_NO,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY, DCQ_QTY, A.REGAS_TARIF, A.mapping_id, TO_CHAR(CONTRACT_START_DT,'dd/mm/yyyy'), TO_CHAR(CONTRACT_END_DT,'dd/mm/yyyy') from FMS8_LNG_REGAS_CARGO_DTL A"
							 //+" where A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND MAPPING_ID='"+map_id+"' "
							 +" where MAPPING_ID='"+map_id+"' "
							 +" order by A.CONTRACT_START_DT,A.CONTRACT_END_DT, A.CARGO_SEQ_NO ";
							System.out.println(" MULTIPLE CARGO: FMS8_LNG_REGAS_CARGO_DTL: "+queryString2);
							rset2 = stmt2.executeQuery(queryString2);
							while(rset2.next())
							{
								//String CargoNoTemp[]=map_id.split("-");									
								String CargoNo=rset2.getString(2);//CargoNoTemp[3];
								VCargoDealNo.add(map_id);
								VCargoSeqNo.add(rset2.getString(1));
								VCargoQTS.add(rset2.getString(3));
								VCargoDCQ.add(rset2.getString(4));
								VCargoContStartDt.add(rset2.getString(7));
								VCargoContEndDt.add(rset2.getString(8));
								
								CargoRefNo=CargoRefNo+rset2.getString(2)+",";
								QtyToSupp=rset2.getDouble(3);
								CargoQtyToBeSupp=QtyToSupp;
								TotalQtyToSupp+=QtyToSupp;
								CargoDcqValue=CargoDcqValue+rset2.getString(3)+"("+rset2.getString(4)+"),";
								VCargoNo.add(CargoNo);
								String queryStringQty="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL "+
										" WHERE MAPPING_ID='"+map_id+"' "
										+ " AND GAS_DT between to_date('"+rset2.getString(7)+"','dd/mm/yyyy') and to_date('"+to_date+"','dd/mm/yyyy')"
								//SB+ " AND GAS_DT <= to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')";
										+ "  AND SN_NO="+CargoNo+" ";
								//	System.out.println(map_id+" :STEP-3A: FMS7_DAILY_ALLOCATION_DTL: "+queryStringQty);
									rset1=stmt1.executeQuery(queryStringQty);
									if(rset1.next()){
									//	VCargoWiseBilledQty.add(rset1.getDouble(1));
										SumOfCargoAllocQty=rset1.getDouble(1);
										VCargoWiseBilledQty.add(rset1.getDouble(1)); //System.out.println(CargoNo+" :rset1.getDouble(1): "+rset1.getDouble(1));
									}	
									else
										VCargoWiseBilledQty.add("0");
									
									//System.out.println(CargoNo+"=="+CargoQtyToBeSupp+"====="+SumOfCargoAllocQty);
									SumOfCargoBalanceQty=CargoQtyToBeSupp-SumOfCargoAllocQty;
									VCargoWiseBalanceQty.add(SumOfCargoBalanceQty);
							}
							
							SN_REF_NO.add(CargoRefNo+"/"+CargoDcqValue);
							BOOKMMBTU.add(nf.format(TotalQtyToSupp));	
							VContTCQ.add(nf.format(TotalQtyToSupp));
					}
					/*System.out.println(VCargoSeqNo.size()+" II:VCargoSeqNo: "+VCargoSeqNo);
					System.out.println(VCargoDealNo.size()+" II:VCargoDealNo: "+VCargoDealNo);
					System.out.println(VCargoQTS.size()+" II:VCargoQTS: "+VCargoQTS);
					System.out.println(VCargoWiseBilledQty.size()+" II:VCargoWiseBilledQty: "+VCargoWiseBilledQty);
					System.out.println(VCargoWiseBalanceQty.size()+" II:VCargoWiseBalanceQty: "+VCargoWiseBalanceQty);*/
////////////^^LTCORA//////////////////////////////////////////////
				for(int i=0;i<CUSTOMER_CD.size();i++)
				{
					queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" "
							+ "and eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+CUSTOMER_CD.elementAt(i)+"' and eff_dt<=to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy'))";
				//	System.out.println(" NEXT MTH: DUAL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
						CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));	
						//System.out.println(MAPPING_ID.elementAt(i)+" :CUSTOMER_NM: >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> "+rset.getString(2));
					}
					else
					{
						CUSTOMER_NM.add("");
						CUSTOMER_ABBR.add("");
					}	
					/////SB20201111///For Float Indication and Calculation. Pricice Pulling as Forward & Avg.////////////////////////////
					String MappIdForPriceType="";  
					MappIdForPriceType=CUSTOMER_CD.elementAt(i)+"-"+MAPPING_ID.elementAt(i);
					if(!MappIdForPriceType.equals("")) //HARSH20210608
					{
						if(!VContType.elementAt(i).equals("C")) //HARSH20210608
						{
							String split[] = MappIdForPriceType.split("-"); //HARSH20210608
							MappIdForPriceType = split[0]+"-"+split[1]+"-%-"+split[3]+"-%";//HARSH20210608
						}
					}
					String PriceType=""; String CurveName="";
					queryString ="SELECT DISTINCT PRICE_TYPE, CURVE_NM FROM FMS9_MRCR_CONT_PRICE_DTL "+
							//HARSH20210608 " where MAPPING_ID='"+MappIdForPriceType+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND FLAG='Y' ";
							" where MAPPING_ID LIKE '"+MappIdForPriceType+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND FLAG='Y' ";
					rset = stmt.executeQuery(queryString);
			//		System.out.println(">>>>>>> "+queryString);
					if(rset.next())
					{
						PriceType=PriceType+rset.getString(1);
						CurveName=rset.getString(2)==null?"":rset.getString(2);
					}
					else
					{
						PriceType="F"; 
						CurveName="";
					}
					
			//		System.out.println(PriceType+" 1. NewSalePrice>>>>>>> "+PriceType.length());
					if(PriceType.length()>1)
						PriceType="M";
			//		System.out.println(PriceType+" 2. NewSalePrice>>>>>>> "+PriceType.length());
					//System.out.println(PriceType+" 2. VExchgRate>>>>>>> "+VExchgRate);
						if(PriceType.equals("F"))
						{
							VPriceTypeDeal.add("");
							VCurve_Nm.add("");
						//SB20201207	VPriceTypeDealRate.add(RATE.elementAt(i));
							VEff_Price.add("");
							//System.out.println(VSalesPriceFlag+" VSalesPriceFlag>>>>> ");
							if(VSalesPriceFlag.elementAt(i).equals("1")) //SB20201207
							{
								if(!VExchgRate.elementAt(i).equals("") && !VExchgRate.elementAt(i).equals("0") && !VExchgRate.elementAt(i).equals("0.00") && !VExchgRate.elementAt(i).equals("0.0000"))
								{
									if(Double.parseDouble(""+RATE.elementAt(i))>0)
									{
										VPriceTypeDealRateA.add(Double.parseDouble(""+RATE.elementAt(i))/Double.parseDouble(""+VExchgRate.elementAt(i))); //SB20201207
										VPriceTypeDealRate.add(Double.parseDouble(""+RATE.elementAt(i))/Double.parseDouble(""+VExchgRate.elementAt(i)));
									}
									else
									{
										VPriceTypeDealRateA.add(Double.parseDouble(""+RATE.elementAt(i))); //SB20201207
										VPriceTypeDealRate.add(Double.parseDouble(""+RATE.elementAt(i)));
									}
								}
								else
								{
									VPriceTypeDealRateA.add(Double.parseDouble(""+RATE.elementAt(i))); //SB20201207
									VPriceTypeDealRate.add(Double.parseDouble(""+RATE.elementAt(i)));
								}
							}
							else
							{
								VPriceTypeDealRateA.add(RATE.elementAt(i)); //SB20201207
								VPriceTypeDealRate.add(RATE.elementAt(i));
							}
						}
						else if(PriceType.equals("M"))
						{
							VPriceTypeDeal.add("FLOAT");
							VCurve_Nm.add(CurveName);
							////////////////////////////SB20201120/////////////////////////////////////////////
								String INDEX_TYPE="LNG_ICE_JKM";
								String ReportDt=to_date;
							//	System.out.println(INDEX_TYPE+" #########:NEXT MTH: Price Findings: "+ReportDt);
								MRCR_PriceOutA(to_date, INDEX_TYPE, to_date, ""+MappIdForPriceType, ""+RATE.elementAt(i)); //SB20201204   : This is for Current Month
								MRCR_PriceOut2(ReportDt, INDEX_TYPE, FirstDateNextMth, ""+MappIdForPriceType, ""+RATE.elementAt(i)); // This is for Next Month(forward Notional)
							////////////////////////////^^^^^SB20201120/////////////////////////////////////////////
								
						}
						else
						{
							VPriceTypeDeal.add("N.A.");
							VCurve_Nm.add("N.A.");
							VPriceTypeDealRate.add("0.1");
							VEff_Price.add("");
							VPriceTypeDealRateA.add("0.2"); //SB20201204
						}
					//////////////////////^^^^^^SB20201111////SB20201111///For Float Indication and Calculation. Pricice Pulling as Forward & Avg.//////////////////////
					
						
					//////////////////////Logic to Find out the ContEnd Date as Next Mth Last Date///////////////////
	
						no_of_days=0; String ContEndDateCurrMth="";
						queryString = "SELECT TO_DATE('"+TO_DT.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+LastDateMth+"','DD/MM/YYYY')+1 FROM DUAL" ;
								//	System.out.println(" NEXT MTH: DUAL: "+queryString);
									rset = stmt.executeQuery(queryString);
									if(rset.next()) {
										no_of_days = rset.getInt(1);
									}
									if(no_of_days<0)
										ContEndDateCurrMth=""+TO_DT.elementAt(i); //Contract Closes before the Next Month End.
									else
										ContEndDateCurrMth=""+LastDateMth;
						////////////////////////////////////////////////////////////////////////////////////////////////////							
						
						double AvgExchgRate_AllocatedQty=0;

						SUPPLIEDMBTU.add("0.00");
						SUPPLIEDMMSCM.add("0.00");//MD20110916
						VUnBilledAmtTillPrevMth.add("0");
				//		System.out.println(">PrevMth: >>>AvgExchgRate_AllocatedQty>> "+AvgExchgRate_AllocatedQty);
						
						//////////////////////Amount receivable as on Gen Date, since begining of Cont. and Payment Not received.//////////////////////////////////
						String LastBilledQtyEndDt=""; double BilledQty=0; double BalanceQty=0; 
						double CargoWiseBilledQty=0; //SB20210203
						String queryString11="";
						if(VContType.elementAt(i).equals("C"))
						{
							queryString11="SELECT TO_CHAR(MAX(PERIOD_END_DT),'DD/MM/YYYY') FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' "
									+ " AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') ";
							//	System.out.println("STEP-3: FMS7_INVOICE_MST: "+queryString11);
						}
						else
						{
						 queryString11="SELECT TO_CHAR(MAX(PERIOD_END_DT),'DD/MM/YYYY') FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND "
						  //SB20200912		+ "SN_NO='"+SN_NO.elementAt(i)+"' AND (PERIOD_START_DT <=to_date('"+FirstFortNightEndDt+"','dd/mm/yyyy') AND PERIOD_END_DT >= TO_DATE('"+from_date+"','dd/mm/yyyy'))";
							+ "SN_NO='"+SN_NO.elementAt(i)+"' AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') ";//AND (PAY_RECV_AMT IS NULL OR PAY_RECV_DT > TO_DATE('"+to_date+"','dd/mm/yyyy')) ";
					//		System.out.println("STEP-3: FMS7_INVOICE_MST: "+queryString11);
						}
						  	rset1=stmt1.executeQuery(queryString11);
							if(rset1.next()){
								LastBilledQtyEndDt=rset1.getString(1)==null?"":rset1.getString(1);
							}
							else
								LastBilledQtyEndDt="";
					//		System.out.println("STEP-3a: LAST BILL DATE: "+LastBilledQtyEndDt);	
						double TDSpercentDR=0;  double TDSinPaymtRecvdDR=0; //SB20210108	
						double AccountReceivableTCS=0;	//SB20201130		
						double UnBilledReceivable=0; double AccountReceivable=0;  double AccountNetReceivable=0;  double AccountReceivableCR=0; double AccountReceivableDR=0; double AccountNetReceivableCR=0; double AccountNetReceivableDR=0;
						double AccountReceivableTax=0; double AvgTaxInInv=0; double BilledReceivablePaymtRecvd=0; double BilledReceivablePaymtRecvdDR=0; double BilledReceivablePaymtRecvdCR=0;
						double AccountReceivableCalculatedTaxDR=0;
						double recv_pay=0;double recv_tax=0;double recv_drcr_pay=0;double recv_drcr_tax=0;
						String InvRecvDisplay="";
					if(!LastBilledQtyEndDt.equals(""))	
						{
						if(VContType.elementAt(i).equals("C"))
						{
							queryString11="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL "+
									" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' "
									+ " AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy') and to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')";
							//SB+ " AND GAS_DT <= to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')";
									//+ "  AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' ";
								//System.out.println(MAPPING_ID.elementAt(i)+" :STEP-3A: FMS7_DAILY_ALLOCATION_DTL: "+queryString11);
						}
						else
						{
							queryString11="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL "+
									" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND "+
		//HA20200922				" SN_NO='"+SN_NO.elementAt(i)+"' AND SN_REV_NO="+SN_REV_NO.elementAt(i)+" "
									" SN_NO='"+SN_NO.elementAt(i)+"' "
//									+ " AND GAS_DT < TO_DATE('"+to_date+"','dd/mm/yyyy')"
									+ " AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy') and to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')"
									+ "  AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' ";
						//	System.out.println("STEP-3A: FMS7_DAILY_ALLOCATION_DTL: "+queryString11);
						}
						rset1=stmt1.executeQuery(queryString11);
						if(rset1.next()){
							BilledQty=rset1.getDouble(1);
						}	
						
						
						//	System.out.println(BilledQty+" STEP-3b: LAST ALLOC QTY:FMS7_DAILY_ALLOCATION_DTL: "+BilledQty);	
							
							//HARSH20201215 VInvoiceReceivableGrossINR.add(CUSTOMER_CD.elementAt(i)+""+VContType.elementAt(i)+"-"+FGSA_NO.elementAt(i)+"-"+FGSA_REV_NO.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i)+" :Last billed: "+LastBilledQtyEndDt+"~Last Billed Qty: "+BilledQty);
							//InvRecvDisplay=CUSTOMER_CD.elementAt(i)+""+VContType.elementAt(i)+"-"+FGSA_NO.elementAt(i)+"-"+FGSA_REV_NO.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i)+" :Last billed: "+LastBilledQtyEndDt+"~Last Billed Qty: "+BilledQty; //HARSH20201215
					
						InvRecvDisplay= VDealUniqueId.elementAt(i)+" :Last billed: "+LastBilledQtyEndDt+"~Last Billed Qty: "+nf.format(BilledQty); //HARSH20201215
						
							String PaymtRecvdDtDR="";
							String queryString12="SELECT (DR_CR_GROSS_AMT_INR), (DR_CR_NET_AMT_INR), CRITERIA  FROM FMS7_DR_CR_NOTE "+ //CRITERIA HARSH20201215
									" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND " 							
									+ "SN_NO='"+SN_NO.elementAt(i)+"' AND DR_CR_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') AND UPPER(DR_CR_FLAG)='CR' AND CRITERIA !='REV_INV' ";
							//	System.out.println("STEP-3: FMS7_DR_CR_NOTE: "+queryString12);
						  	rset1=stmt1.executeQuery(queryString12);
							while(rset1.next()){
								AccountReceivableCR=AccountReceivableCR+rset1.getDouble(1);
								AccountNetReceivableCR=AccountNetReceivableCR+rset1.getDouble(2);
							
							//SB	InvRecvDisplay=InvRecvDisplay+"~"+"CR("+rset1.getString(3)+") INR: "+nf.format(rset1.getDouble(1)); //nf.format HARSH20201215
							
							}
							//////////////////////SB20201130: Manual DR/CR NOTE//////////////////////////////
							queryString12="SELECT (DR_CR_GROSS_AMT_INR), (DR_CR_NET_AMT_INR), CRITERIA  FROM FMS7_MANUAL_DR_CR_NOTE "+ //CRITERIA HARSH20201215
									" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND " 
									+ "SN_NO='"+SN_NO.elementAt(i)+"' AND DR_CR_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') AND UPPER(DR_CR_FLAG)='CR' AND CRITERIA !='REV_INV' ";
								//	System.out.println("STEP-3: FMS7_INVOICE_MST: "+queryString12);
								  	rset1=stmt1.executeQuery(queryString12);
									while(rset1.next()){
										AccountReceivableCR=AccountReceivableCR+rset1.getDouble(1);
										AccountNetReceivableCR=AccountNetReceivableCR+rset1.getDouble(2);
								//		InvRecvDisplay=InvRecvDisplay+"~"+"CR_M("+rset1.getString(3)+") INR: "+nf.format(rset1.getDouble(1));  //nf.format HARSH20201215
									
									}
							if(AccountReceivableCR>0) //SB20201219
								InvRecvDisplay=InvRecvDisplay+"~"+"CR(Total) INR: "+nf.format(AccountReceivableCR); //nf.format HARSH20201215
							//////////////////////^^^^^//////////////////////////////////////////////////////
					//		System.out.println(BilledQty+" STEP-3c: Amt Receivable:CR: FMS7_DR_CR_NOTE : "+AccountReceivableCR);
							
							String PaymtRecvdDtCR="";
							 queryString12="SELECT (DR_CR_GROSS_AMT_INR), (DR_CR_NET_AMT_INR), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY'), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, CRITERIA, DR_CR_DOC_NO, TDS_PERCENT FROM FMS7_DR_CR_NOTE "+ //CRITERIA HARSH20201215
									" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND " 
									+ "SN_NO='"+SN_NO.elementAt(i)+"' AND DR_CR_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') AND UPPER(DR_CR_FLAG)='DR' AND CRITERIA !='DIFF-TAX' "
									+ "AND APRV_BY is not null "; //SB20201219
								//	System.out.println("STEP-3A: FMS7_DR_CR_NOTE: "+queryString12);
								  	rset1=stmt1.executeQuery(queryString12);
									while(rset1.next()){
										AccountReceivableDR=AccountReceivableDR+rset1.getDouble(1);
										AccountNetReceivableDR=AccountNetReceivableDR+rset1.getDouble(2);
										AccountReceivableCalculatedTaxDR=AccountNetReceivableDR-AccountReceivableDR;	 //SB20200921: 
										InvRecvDisplay="~"+"DR("+rset1.getString(7)+" D"+rset1.getString(8)+") INR: "+nf.format(rset1.getDouble(1));//nf.format HARSH20201215
										
										PaymtRecvdDtCR=rset1.getString(4)==null?"01/01/2100":rset1.getString(4);
								//SB20201219		queryString = "SELECT TO_DATE('"+PaymtRecvdDtCR+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY')+1 FROM DUAL" ;
										queryString = "SELECT TO_DATE('"+PaymtRecvdDtCR+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL" ;
										//	System.out.println(" NEXT MTH: DUAL: "+queryString);
											rset = stmt.executeQuery(queryString);
											if(rset.next()) {
												no_of_days = rset.getInt(1);
											}
											if(no_of_days<=0)
											{//System.out.println(BilledReceivablePaymtRecvdDR+" AccountReceivableTax: "+AccountReceivableCalculatedTaxDR);										
												TDSpercentDR=rset1.getDouble(9); //SB2021010
												TDSinPaymtRecvdDR=Double.parseDouble(nf.format(rset1.getDouble(1)*(TDSpercentDR/100))); //SB20210108
												if(TDSpercentDR>0 && TDSinPaymtRecvdDR>0)
													InvRecvDisplay="~"+"DR_M("+rset1.getString(8)+") Pamt Recvd_M(TDS"+TDSpercentDR+") INR: "+nf.format(TDSinPaymtRecvdDR); //SB20210108
											
												recv_drcr_pay+=(rset1.getDouble(3)+TDSinPaymtRecvdDR);//SB20210108
											recv_drcr_tax+=(rset1.getDouble(2)-rset1.getDouble(1));	
										//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR("+rset1.getString(8)+") Pamt Recvd(Net) INR: "+nf.format(rset1.getDouble(3)); //SB20201216
										//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR("+rset1.getString(8)+") Pamt Recvd(Tax) INR: "+nf.format((rset1.getDouble(2)-rset1.getDouble(1))); //SB20201216
											
											double TcsInvWise_drcr=0; double GrossPaymentReceived_drcr=0;  //SB20201219
										//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR("+rset1.getString(7)+") Pamt Recvd("+rset1.getString(8)+") INR: "+nf.format(rset1.getDouble(3)); //SB20201216
				///////////////				////////////////SB20201130: For TCS Calculation//////////////////////////////////////////								
													String query="select (tcs_amt) from fms7_invoice_tcs_dtl where hlpl_inv_seq_no ='"+rset1.getDouble(5)+"' and financial_year='"+rset1.getString(6)+"' and contract_type='"+VContType.elementAt(i)+"' and "
															+ "EFF_DT<= TO_DATE('"+to_date+"','dd/mm/yyyy') and customer_cd='"+CUSTOMER_CD.elementAt(i)+"' AND INVOICE_TYPE='DEBIT' AND FLAG='Y' and COMMODITY_TYPE='RLNG'";
												//	System.out.println("STEP-3A: fms7_invoice_tcs_dtl: "+query);
													rset=stmt.executeQuery(query);
													if(rset.next()){
														AccountReceivableTCS=AccountReceivableTCS+rset.getDouble(1);
														TcsInvWise_drcr=rset.getDouble(1); //SB20201219
													//SB	InvRecvDisplay=InvRecvDisplay+"~"+"TCS("+rset1.getString(8)+") INR: "+nf.format(rset.getDouble(1)); //nf.format HARSH20201215
													}
													recv_drcr_tax=recv_drcr_tax+TcsInvWise_drcr;  //SB20201219: TCS added into tax deduction for ease of calculation
													GrossPaymentReceived_drcr=rset1.getDouble(3)-((rset1.getDouble(2)-rset1.getDouble(1)+TcsInvWise_drcr)); //SB20201219
												//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR("+rset1.getString(8)+") Pamt Recvd_M(Gross) INR: "+nf.format(GrossPaymentReceived_drcr); //SB20201219

													///////////////////////////////^^^^^^^SB20201130: For TCS Calculation//////////////////////////////////////////
											}	
									}	
									BilledReceivablePaymtRecvdDR = recv_drcr_pay - recv_drcr_tax+TDSinPaymtRecvdDR; //SB20201219
									if(BilledReceivablePaymtRecvdDR>0) //SB20201219
										InvRecvDisplay=InvRecvDisplay+"~"+"DR Total: ("+nf.format(BilledReceivablePaymtRecvdDR)+" = "+nf.format(recv_drcr_pay)+"-"+nf.format(recv_drcr_tax);//nf.format HARSH20201215
									//////////////////////SB20201130: Manual DR/CR NOTE//////////////////////////////
									queryString12="SELECT (DR_CR_GROSS_AMT_INR), (DR_CR_NET_AMT_INR), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY'), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, CRITERIA, DR_CR_DOC_NO, TDS_PERCENT FROM FMS7_MANUAL_DR_CR_NOTE "+ //CRITERIA HARSH20201215
											" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND " 
											+ "SN_NO='"+SN_NO.elementAt(i)+"' AND DR_CR_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') AND UPPER(DR_CR_FLAG)='DR' AND CRITERIA !='DIFF-TAX' " //SB20201207
											+ "AND APRV_BY is not null "; //SB20201219	
								//		System.out.println("STEP-3B: FMS7_MANUAL_DR_CR_NOTE: "+queryString12);
										  	rset1=stmt1.executeQuery(queryString12);
											while(rset1.next()){
												AccountReceivableDR=AccountReceivableDR+rset1.getDouble(1);
												AccountNetReceivableDR=AccountNetReceivableDR+rset1.getDouble(2);
												AccountReceivableCalculatedTaxDR=AccountNetReceivableDR-AccountReceivableDR;	 //SB20200921: 
											//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR_M("+rset1.getString(7)+" "+rset1.getString(8)+") INR: "+nf.format(rset1.getDouble(1));//nf.format HARSH20201215
												
												PaymtRecvdDtCR=rset1.getString(4)==null?"01/01/2100":rset1.getString(4);
									//SB20201219			queryString = "SELECT TO_DATE('"+PaymtRecvdDtCR+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY')+1 FROM DUAL" ;
												queryString = "SELECT TO_DATE('"+PaymtRecvdDtCR+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL" ;
												//	System.out.println(" NEXT MTH: DUAL: "+queryString);
													rset = stmt.executeQuery(queryString);
													if(rset.next()) {
														no_of_days = rset.getInt(1);
													}
													if(no_of_days<=0)
													{//System.out.println(BilledReceivablePaymtRecvdDR+" AccountReceivableTax: "+AccountReceivableCalculatedTaxDR);	
														TDSpercentDR=rset1.getDouble(9); //SB2021010
														TDSinPaymtRecvdDR=Double.parseDouble(nf.format(rset1.getDouble(1)*(TDSpercentDR/100))); //SB20210108
														if(TDSpercentDR>0 && TDSinPaymtRecvdDR>0)
															InvRecvDisplay=InvRecvDisplay+"~"+"DR_M("+rset1.getString(8)+") Pamt Recvd_M(TDS"+TDSpercentDR+") INR: "+nf.format(TDSinPaymtRecvdDR); //SB20210108

														recv_drcr_pay+=(rset1.getDouble(3)+TDSinPaymtRecvdDR);//SB20210108
													//recv_drcr_pay+=rset1.getDouble(3);
													recv_drcr_tax+=(rset1.getDouble(2)-rset1.getDouble(1));		
												//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR_M("+rset1.getString(8)+") Pamt Recvd_M(Net) INR: "+nf.format(rset1.getDouble(3)); //SB20201216
												//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR_M("+rset1.getString(8)+") Pamt Recvd_M(Tax) INR: "+nf.format((rset1.getDouble(2)-rset1.getDouble(1))); //SB20201216
													double TcsInvWise_drcr=0; double GrossPaymentReceived_drcr=0;  //SB20201219
						///////						////////////////////////SB20201130: For TCS Calculation//////////////////////////////////////////								
																	String query="select (tcs_amt) from fms7_invoice_tcs_dtl where hlpl_inv_seq_no ='"+rset1.getDouble(5)+"' and financial_year='"+rset1.getString(6)+"' and contract_type='"+VContType.elementAt(i)+"' and "
																			+ "EFF_DT<= TO_DATE('"+to_date+"','dd/mm/yyyy') and customer_cd='"+CUSTOMER_CD.elementAt(i)+"' AND INVOICE_TYPE='DEBIT' AND FLAG='Y' and COMMODITY_TYPE='RLNG'";
																//	System.out.println("STEP-3B: fms7_invoice_tcs_dtl: "+query);
																	rset=stmt.executeQuery(query);
																	if(rset.next()){
																		AccountReceivableTCS=AccountReceivableTCS+rset.getDouble(1);
																		TcsInvWise_drcr=rset.getDouble(1); //SB20201219
																	//SB	InvRecvDisplay=InvRecvDisplay+"~"+"TCS_M("+rset1.getString(8)+") INR: "+nf.format(TcsInvWise_drcr); //nf.format HARSH20201215
																	}
																	recv_drcr_tax=recv_drcr_tax+TcsInvWise_drcr;  //SB20201219: TCS added into tax deduction for ease of calculation
																	GrossPaymentReceived_drcr=rset1.getDouble(3)-((rset1.getDouble(2)-rset1.getDouble(1)+TcsInvWise_drcr)); //SB20201219
																//SB	InvRecvDisplay=InvRecvDisplay+"~"+"DR_M("+rset1.getString(8)+") Pamt Recvd_M(Gross) INR: "+nf.format(GrossPaymentReceived_drcr); //SB20201219
													///////////////////////////////^^^^^^^SB20201130: For TCS Calculation//////////////////////////////////////////
													}
													
											}
									//////////////////////^^^^^//////////////////////////////////////////////////////
									BilledReceivablePaymtRecvdDR = recv_drcr_pay - recv_drcr_tax;
									if(BilledReceivablePaymtRecvdDR>0) //SB20201219
										InvRecvDisplay=InvRecvDisplay+"~"+"Final DR(+M):("+nf.format(BilledReceivablePaymtRecvdDR)+"="+nf.format(recv_drcr_pay)+"-"+nf.format(recv_drcr_tax);//nf.format HARSH20201215
						//	System.out.println(BilledQty+" STEP-3d: Amt Receivable:DR: FMS7_DR_CR_NOTE : "+BilledReceivablePaymtRecvdDR);
									
					
		//////////////////////Calculate One by One/////////////////////////////////
					double TDSpercent=0;  double TDSinPaymtRecvd=0; //SB20210108	
					double AdvAdjAmt=0;  
					double TotalAdvAmt=0; double TotalAdvAmtTax=0;  double TotalAdvAdjAmt=0; double TotalAdvAdjAmtTax=0; double TotalSUGTaxAmt=0; //SB20210123
					double BilledReceivableGrossUSD=0; String PaymtRecvdDt="01/01/2100"; double InvAllocQty=0; double AccountReceivableTransTariff=0;
					if(VContType.elementAt(i).equals("C"))
					{
					
						queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
								+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,NEW_INV_SEQ_NO " //SB20200928//SB20201130
								+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
								+ "AND FLAG NOT IN  ('A','U') AND NET_AMT_INR>0 "
								+ "AND APPROVED_FLAG='Y' AND FLAG!='X' ORDER BY HLPL_INV_SEQ_NO "; //SB20201219	
							//System.out.println("STEP-3C: FMS7_INVOICE_MST: "+queryString1);
						//HARSH20210824 EXCLUDED CANCEL INVOICE AS PER SHI TING MAIL ON 23/08/2021 Incident ID#163
									
					}
					else
					{
						queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
							+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,NEW_INV_SEQ_NO " //SB20200928//SB20201130
							+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE IN ('"+VContType.elementAt(i)+"','I') AND " 
								+ "SN_NO='"+SN_NO.elementAt(i)+"' "//AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "//AND (PAY_RECV_AMT IS NULL OR PAY_RECV_DT > TO_DATE('"+to_date+"','dd/mm/yyyy')) ";
								+ "AND APPROVED_FLAG='Y' AND FLAG!='X' ORDER BY HLPL_INV_SEQ_NO "; //SB20201219	
								//	System.out.println("STEP-3C: FMS7_INVOICE_MST: "+queryString1);
							//HARSH20210824 EXCLUDED CANCEL INVOICE AS PER SHI TING MAIL ON 23/08/2021 Incident ID#163
					}
							  	rset1=stmt1.executeQuery(queryString1);
								while(rset1.next()){	
									PaymtRecvdDt="";
									AccountReceivable=AccountReceivable+rset1.getDouble(1);
									AccountNetReceivable=AccountNetReceivable+rset1.getDouble(2);
									AvgExchgRate_AllocatedQty=rset1.getDouble(3);
									AccountReceivableTax=AccountReceivableTax+rset1.getDouble(4);	
									BilledReceivableGrossUSD=BilledReceivableGrossUSD+rset1.getDouble(5); 
									PaymtRecvdDt=rset1.getString(7)==null?"01/01/2100":rset1.getString(7);
									InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getString(12)+") INR: "+nf.format(rset1.getDouble(1)); //nf.format HARSH20201215
									
									queryString = "SELECT TO_DATE('"+PaymtRecvdDt+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL" ;
									//	System.out.println(" NEXT MTH: DUAL: "+queryString);
										rset = stmt.executeQuery(queryString);
										if(rset.next()) {
											no_of_days = rset.getInt(1); // System.out.println(no_of_days);
										}
										if(no_of_days<=0)
										{
											TDSpercent=rset1.getDouble(11); //SB2021010
											TDSinPaymtRecvd=Double.parseDouble(nf.format(rset1.getDouble(1)*(TDSpercent/100))); //SB20210108
											if(TDSpercent>0 && TDSinPaymtRecvd>0)
												InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd(TDS"+TDSpercent+") INR: "+nf.format(TDSinPaymtRecvd); //SB20210108

											recv_pay+=(rset1.getDouble(6)+TDSinPaymtRecvd);//SB2021010
											//recv_pay+=rset1.getDouble(6);
											recv_tax+=rset1.getDouble(4);
											
										//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd(Net) INR: "+nf.format(rset1.getDouble(6)); //SB20201216
										//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd(Tax) INR: "+nf.format(rset1.getDouble(4)); //SB20201216
											
											double TcsInvWise=0; double GrossPaymentReceived=0;  //SB20201219
				///////////////				////////////////SB20201130: For TCS Calculation//////////////////////////////////////////								
											String query="select (tcs_amt) from fms7_invoice_tcs_dtl where hlpl_inv_seq_no ='"+rset1.getDouble(9)+"' and financial_year='"+rset1.getString(10)+"' and contract_type='"+VContType.elementAt(i)+"' and "
													+ "EFF_DT<= TO_DATE('"+to_date+"','dd/mm/yyyy') and customer_cd='"+CUSTOMER_CD.elementAt(i)+"' AND INVOICE_TYPE='SALES' AND FLAG='Y' and COMMODITY_TYPE='RLNG'";
									//		System.out.println("STEP-3C: fms7_invoice_tcs_dtl: "+query);
											rset=stmt.executeQuery(query);
											if(rset.next()){
												AccountReceivableTCS=AccountReceivableTCS+rset.getDouble(1);
												TcsInvWise=rset.getDouble(1); //SB20201219
											//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") TCS(*) INR: "+nf.format(TcsInvWise); //nf.format HARSH20201215
											}
											recv_tax=recv_tax+TcsInvWise;  //SB20201219: TCS added into tax deduction for ease of calculation
											GrossPaymentReceived=rset1.getDouble(6)-(rset1.getDouble(4)+TcsInvWise); //SB20201219
										//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd(Gross) INR: "+nf.format(GrossPaymentReceived); //SB20201219
											///////////////////////////////^^^^^^^SB20201130: For TCS Calculation//////////////////////////////////////////
										}								
										InvAllocQty=rset1.getDouble(8); //SB20200928
										AccountReceivableTransTariff=AccountReceivableTransTariff+InvAllocQty*Double.parseDouble(""+VTransValue.elementAt(i));
										if(AccountReceivableTransTariff>0) //SB20201219
											InvRecvDisplay=InvRecvDisplay+"~"+"INV-DLV("+rset1.getString(12)+") INR: "+InvAllocQty*Double.parseDouble(""+VTransValue.elementAt(i));
										///////////////////SB20201202: For LTCORA Adv Adj////////////////////////////
										if(VContType.elementAt(i).equals("C"))
										{
											queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
													+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT, FLAG, NEW_INV_SEQ_NO, SN_NO " //SB20200928//SB20201130
													+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
												//SB20210127	+ "AND FLAG IN  ('A','U') "//SB20210124 AND NET_AMT_INR>0 "
													+ "AND FLAG IN  ('A') "//SB20210124 AND NET_AMT_INR>0 "
													+ "AND APPROVED_FLAG='Y' ORDER BY HLPL_INV_SEQ_NO "; //SB20201219	
															//System.out.println("STEP-3C(Flag-U&A): FMS7_INVOICE_MST: "+queryString1);
															rset = stmt.executeQuery(queryString1);
															while(rset.next())
															{
																String CargoNo = rset.getString(14)==null?"0":rset.getString(14);
																String FLAG = rset.getString(12)==null?"":rset.getString(12);
																if(FLAG.equals("A"))
																	TotalAdvAmt+=rset.getDouble(1); //SB20210123
																else if(FLAG.equals("U"))
																	TotalSUGTaxAmt+=rset.getDouble(4); //SB20210123
																VCapDealNo.add(MAPPING_ID.elementAt(i));
																VCapDealInvNo.add((rset.getString(13)));
																VCapDealInvType.add((rset.getString(12)));
																VCapGrossAmt.add(nf.format(rset.getDouble(1)));
																VCapNetAmt.add(nf.format(rset.getDouble(1)));
																VCapTaxAmt.add(nf.format(rset.getDouble(4)));
																VCapExchRate.add((rset.getDouble(3)));
																VCapBillQty.add((rset.getDouble(8)));
																VCapCargoSeqNo.add(CargoNo);
															}
											String query = "SELECT RECEIPT_VOU_NO,NVL(TO_CHAR(ADV_INV_DT,'DD/MM/YYYY'),''),ADJUST_AMT FROM  "
													+ "FMS8_ADV_INV_DTL WHERE FINANCIAL_YEAR='"+rset1.getString(10)+"' AND "
													+ "CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND HLPL_INV_SEQ_NO='"+rset1.getDouble(9)+"' "
													+ "AND FLAG = 'Y' ";
										//	System.out.println("Fetching Receipt Voucher Nos..."+query);
											rset = stmt.executeQuery(query);
											while(rset.next())
											{
												//String amt = rset.getString(3)==null?"0":rset.getString(3);
												String date = rset.getString(2)==null?"":rset.getString(2);
												String data = rset.getString(1)==null?"":rset.getString(1);
											//SB20201203	AdvAdjAmt = AdvAdjAmt+rset.getDouble(3); //SB20201202
												AdvAdjAmt = rset.getDouble(3); //SB20201202
												TotalAdvAdjAmt+=AdvAdjAmt; //SB20210123
												AccountReceivable=AccountReceivable-AdvAdjAmt; //SB20201202: Subtract Advance Adj for LTCORA
											//SB	InvRecvDisplay=InvRecvDisplay+"~"+"ADJ-INV("+rset1.getInt(9)+") INR: "+nf.format(AdvAdjAmt); //nf.format HARSH20201215
											}
										}
										//////////////////////////////////////////////////////////////////////////////		
									
									}
							//////////////////////////////////////SB20201130: Manual Invoice//////////////////////////////////////////////////////////////////////
								if(VContType.elementAt(i).equals("C"))
								{
									queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
											+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,HLPL_INV_SEQ_NO   " //SB20200928
											+ " FROM FMS7_MANUAL_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
											+ "AND FLAG NOT IN  ('A','U') AND NET_AMT_INR>0 "
											+"AND APPROVED_FLAG='Y'"; //SB20201219	
												//System.out.println("STEP-3D: FMS7_MANUAL_INVOICE_MST: "+queryString1);
								}
								else
								{
								queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
										+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,HLPL_INV_SEQ_NO  " //SB20200928
										+ " FROM FMS7_MANUAL_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND CONTRACT_TYPE IN ('"+VContType.elementAt(i)+"','I') AND " 
											+ "SN_NO='"+SN_NO.elementAt(i)+"' "//AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "//AND (PAY_RECV_AMT IS NULL OR PAY_RECV_DT > TO_DATE('"+to_date+"','dd/mm/yyyy')) ";
											+"AND APPROVED_FLAG='Y'"; //SB20201219
											//		System.out.println("STEP-3D: FMS7_INVOICE_MST: "+queryString1);
								}
										  	rset1=stmt1.executeQuery(queryString1);
											while(rset1.next()){	
												PaymtRecvdDt="";
												AccountReceivable=AccountReceivable+rset1.getDouble(1); 
												AccountNetReceivable=AccountNetReceivable+rset1.getDouble(2);
												AvgExchgRate_AllocatedQty=rset1.getDouble(3);
												AccountReceivableTax=AccountReceivableTax+rset1.getDouble(4);	
												BilledReceivableGrossUSD=BilledReceivableGrossUSD+rset1.getDouble(5); 
												PaymtRecvdDt=rset1.getString(7)==null?"01/01/2100":rset1.getString(7);
												InvRecvDisplay=InvRecvDisplay+"~"+"INV_M("+rset1.getString(9)+") INR: "+ nf.format(rset1.getDouble(1)); //nf.format HARSH20201215
												queryString = "SELECT TO_DATE('"+PaymtRecvdDt+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL" ;
													//System.out.println(" NEXT MTH: DUAL: "+queryString);
													rset = stmt.executeQuery(queryString);
													if(rset.next()) {
														no_of_days = rset.getInt(1); // System.out.println(no_of_days);
													}
													if(no_of_days<=0)
													{
														TDSpercent=rset1.getDouble(11); //SB2021010
														TDSinPaymtRecvd=Double.parseDouble(nf.format(rset1.getDouble(1)*(TDSpercent/100))); //SB20210108
														if(TDSpercent>0 && TDSinPaymtRecvd>0)
															InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getString(9)+") Pamt Recvd(TDS"+TDSpercent+") INR: "+nf.format(TDSinPaymtRecvd); //SB20210108
														recv_pay+=(rset1.getDouble(6)+TDSinPaymtRecvd);//SB2021010
														recv_tax+=rset1.getDouble(4);
													//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd_M(Net) INR: "+nf.format(rset1.getDouble(6)); //SB20201216
													//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd_M(Tax) INR: "+nf.format(rset1.getDouble(4)); //SB20201216
														double TcsInvWise=0; double GrossPaymentReceived=0;  //SB20201219
														///////////////////////////////SB20201130: For TCS Calculation//////////////////////////////////////////								
														String query="select (tcs_amt) from fms7_invoice_tcs_dtl where hlpl_inv_seq_no ='"+rset1.getDouble(9)+"' and financial_year='"+rset1.getString(10)+"' and contract_type='"+VContType.elementAt(i)+"' and "
																+ "EFF_DT<= TO_DATE('"+to_date+"','dd/mm/yyyy') and customer_cd='"+CUSTOMER_CD.elementAt(i)+"' AND INVOICE_TYPE='SALES' AND FLAG='Y' and COMMODITY_TYPE='RLNG'";
														//System.out.println("STEP-3D: fms7_invoice_tcs_dtl: "+query);
														rset=stmt.executeQuery(query);
														if(rset.next()){
															AccountReceivableTCS=AccountReceivableTCS+rset.getDouble(1);
															TcsInvWise=rset.getDouble(1); //SB20201219
														//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV_M("+rset1.getInt(9)+") TCS_M(*) INR: "+nf.format(TcsInvWise);
														}
														recv_tax=recv_tax+TcsInvWise;  //SB20201219: TCS added into tax deduction for ease of calculation
														GrossPaymentReceived=rset1.getDouble(6)-(rset1.getDouble(4)+TcsInvWise); //SB20201219
													//SB	InvRecvDisplay=InvRecvDisplay+"~"+"INV("+rset1.getInt(9)+") Pamt Recvd_M(Gross) INR: "+nf.format(GrossPaymentReceived); //SB20201219
														///////////////////////////////^^^^^^^SB20201130: For TCS Calculation//////////////////////////////////////////
													}								
													InvAllocQty=rset1.getDouble(8); //SB20200928
													AccountReceivableTransTariff=AccountReceivableTransTariff+InvAllocQty*Double.parseDouble(""+VTransValue.elementAt(i));
													if(AccountReceivableTransTariff>0) //SB20201219
														InvRecvDisplay=InvRecvDisplay+"~"+"INV_M-DLV("+rset1.getInt(9)+") INR: "+InvAllocQty*Double.parseDouble(""+VTransValue.elementAt(i));
									///////////////////SB20201202: For LTCORA Adv Adj////////////////////////////
													if(VContType.elementAt(i).equals("C"))
													{
														queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
																+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT, FLAG, NEW_INV_SEQ_NO, SN_NO " //SB20200928//SB20201130
																+ " FROM FMS7_MANUAL_INVOICE_MST WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' AND PERIOD_END_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
															//	+ "AND FLAG IN  ('A','U') "//SB20210124 AND NET_AMT_INR>0 "
																+ "AND FLAG IN  ('A') "//SB20210124 AND NET_AMT_INR>0 "
																+ "AND APPROVED_FLAG='Y' ORDER BY HLPL_INV_SEQ_NO "; //SB20201219	
																		//System.out.println("STEP-3C(Flag-U&A): FMS7_INVOICE_MST: "+queryString1);
																		rset = stmt.executeQuery(queryString1);
																		while(rset.next())
																		{
																			String CargoNo = rset.getString(14)==null?"0":rset.getString(14);
																			String FLAG = rset.getString(12)==null?"":rset.getString(12);
																			if(FLAG.equals("A"))
																				TotalAdvAmt+=rset.getDouble(1); //SB20210123
																			else if(FLAG.equals("U"))
																				TotalSUGTaxAmt+=rset.getDouble(4); //SB20210123
																			VCapDealNo.add(MAPPING_ID.elementAt(i));
																			VCapDealInvNo.add((rset.getString(13)));
																			VCapDealInvType.add((rset.getString(12)));
																			VCapGrossAmt.add(nf.format(rset.getDouble(1)));
																			VCapNetAmt.add(nf.format(rset.getDouble(1)));
																			VCapTaxAmt.add(nf.format(rset.getDouble(4)));
																			VCapExchRate.add(nf.format(rset.getDouble(3)));
																			VCapBillQty.add((rset.getDouble(8)));
																			VCapCargoSeqNo.add(CargoNo);
																		}
														String query = "SELECT RECEIPT_VOU_NO,NVL(TO_CHAR(ADV_INV_DT,'DD/MM/YYYY'),''),ADJUST_AMT, TAX_ADJ_REMARK FROM  "
																+ "FMS8_ADV_INV_DTL WHERE FINANCIAL_YEAR='"+rset1.getString(10)+"' AND "
																+ "CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND HLPL_INV_SEQ_NO='"+rset1.getDouble(9)+"' "
																+ "AND FLAG = 'Y' ";
													//	System.out.println("Fetching Receipt Voucher Nos..."+query);
														rset = stmt.executeQuery(query);
														while(rset.next())
														{
															//String amt = rset.getString(3)==null?"0":rset.getString(3);
															String date = rset.getString(2)==null?"":rset.getString(2);
															String data = rset.getString(1)==null?"":rset.getString(1);
														//SB20201203	AdvAdjAmt = AdvAdjAmt+rset.getDouble(3); //SB20201202
															AdvAdjAmt = rset.getDouble(3); //SB20201202
															TotalAdvAdjAmt+=AdvAdjAmt; //SB20210123
															AccountReceivable=AccountReceivable-AdvAdjAmt; //SB20201202: Subtract Advance Adj for LTCORA
														//SB	InvRecvDisplay=InvRecvDisplay+"~"+"ADJ-INV("+rset1.getInt(9)+") INR: "+nf.format(AdvAdjAmt); //nf.format HARSH20201215
														}
													}
													//////////////////////////////////////////////////////////////////////////////		
													//System.out.println("recv_pay :: "+nf.format(recv_pay)+" recv_tax :: "+nf.format(recv_tax));
												}
											BilledReceivablePaymtRecvd = recv_pay - recv_tax; //SB20201217: IT was missing 
											/////////////////////////////////////::://////////////////////////////////////////////////////////////////////////////////////////////
											
											InvRecvDisplay=InvRecvDisplay+"~"+"Total Payment Recevd Tax(-): "+nf.format(recv_tax);
											if(AccountReceivableTransTariff>0) //SB20201219
												InvRecvDisplay=InvRecvDisplay+"~"+"Total (TransValue DLV): "+nf.format(AccountReceivableTransTariff);
											
											
										
									
									AccountNetReceivable=AccountNetReceivable-AccountNetReceivableCR+AccountNetReceivableDR;
									VUnBilledReceivableTax.add(AccountNetReceivable);
									VReceivableAmtTax.add(nf.format(AccountNetReceivable));
									VReceivableAmtTaxCR.add(AccountNetReceivableCR);
									VReceivableAmtTaxDR.add(AccountNetReceivableDR);						
									AccRecvUptoDt="As on "+to_date; 
									
									VBilledReceivableExchgAvg.add(AvgExchgRate_AllocatedQty);
									
									VUnBilledReceivableGrossUSD.add(BilledReceivableGrossUSD);
									
									VUnBilledReceivablePeriodEndDt.add(LastBilledQtyEndDt);
									
									//SB20200928//////////////Transportation Charges For Allocated Qty of current month//////////////////////////////////////
									AccountReceivable=AccountReceivable+AccountReceivableTransTariff;
									InvRecvDisplay=InvRecvDisplay+"~"+"Total Invoice Amt: "+nf.format(AccountReceivable);
					
									///////////^^^^Transportation Charges to be included//////////////////////////////////////
									VBilledReceivableDtl.add(CUSTOMER_CD.elementAt(i)+": ("+nf.format(AccountReceivable)+"-"+nf.format(BilledReceivablePaymtRecvd)+")-"+AccountReceivableCR+"+("+AccountReceivableDR+"-"+BilledReceivablePaymtRecvdDR+"+"+AccountReceivableTCS+")\n"); //SB20201206
									//SB20201130:	AccountReceivable=(AccountReceivable-BilledReceivablePaymtRecvd)-AccountReceivableCR+(AccountReceivableDR-BilledReceivablePaymtRecvdDR);
						//SB20201201	AccountReceivable=(AccountReceivable-BilledReceivablePaymtRecvd)-AccountReceivableCR+(AccountReceivableDR-BilledReceivablePaymtRecvdDR-AccountReceivableTCS);//SB20201130: TCS deducted
							////sb		AccountReceivable=(AccountReceivable-BilledReceivablePaymtRecvd)-AccountReceivableCR+(AccountReceivableDR-BilledReceivablePaymtRecvdDR+AccountReceivableTCS);//SB20201130: TCS deducted
									AccountReceivable=(AccountReceivable-BilledReceivablePaymtRecvd)-AccountReceivableCR+(AccountReceivableDR-BilledReceivablePaymtRecvdDR);//SB20201130: TCS deducted
						//SB20201201			AccountReceivable=(AccountReceivable-BilledReceivablePaymtRecvd)-AccountReceivableCR+(AccountReceivableDR-BilledReceivablePaymtRecvdDR);//SB20201130: TCS deducted
									
							///SB20201203		AccountReceivable=AccountReceivable-AdvAdjAmt; //SB20201202: Subtract Advance Adj for LTCORA
									
							/*		InvRecvDisplay=InvRecvDisplay+"~"+"Total A/C DR(+): "+nf.format(AccountReceivableDR); 
									InvRecvDisplay=InvRecvDisplay+"~"+"Total A/C TCS(+): "+nf.format(AccountReceivableTCS);
									
									InvRecvDisplay=InvRecvDisplay+"~"+" Total A/C CR(-): "+nf.format(AccountReceivableCR);							
									InvRecvDisplay=InvRecvDisplay+"~"+"Total A/C Payment Received(-Tax): "+nf.format(BilledReceivablePaymtRecvd);
									InvRecvDisplay=InvRecvDisplay+"~"+"Total A/C DR Payment Received(-Tax): "+nf.format(BilledReceivablePaymtRecvdDR);
									*/
						//HARSH20210513			InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C Receivable: "+nf.format(AccountReceivable);
									
									/*//////////////////////////Adv & SUG Tax/////////////////////////
									InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C Adv Amt Received: "+nf.format(TotalAdvAmt);
									InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C Adv Amt Tax Received: "+nf.format(TotalAdvAmtTax);
									InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C Adv Adjusted: "+nf.format(TotalAdvAdjAmt);
									InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C SUG Tax Amt: "+nf.format(TotalSUGTaxAmt);
									
									*///////////////////////////////////////////////////////////////////////////
									
									
									if(AccountReceivable > 2) //HARSH20210513 AS DISCUSSED WITH ROHITBHAI
									{
										InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C Receivable: "+nf.format(AccountReceivable);
									}
									else
									{
										AccountReceivable = 0;
										InvRecvDisplay=InvRecvDisplay+"~"+"Final A/C Receivable: "+nf.format(AccountReceivable);
									}
									VInvoiceReceivableGrossINR.add(InvRecvDisplay); //SB20201215
									
									VUnBilledReceivable.add(nf.format(AccountReceivable));
									VUnBilledReceivableTaxOnly.add(AccountReceivableTax);
							//SB20200917		VAvgTaxUndelivered.add(nf.format(AvgTaxInInv));
									VBilledQtyTCQ.add(nf.format(BilledQty));
									BalanceQty=Double.parseDouble(""+VContTCQ.elementAt(i))-BilledQty; //Balance after Receivable Amt/Qty
									VBalanceUnbilledTCQ.add(nf.format(BalanceQty));
									VBilledReceivablePaymtRecvd.add(nf.format(BilledReceivablePaymtRecvd)); //SB20200918
									VBilledReceivablePaymtRecvdDR.add(nf.format(BilledReceivablePaymtRecvdDR)); //SB20200918
									VBilledReceivableDR.add(nf.format(AccountReceivableDR)); //SB20200918
									VBilledReceivableCR.add(nf.format(AccountReceivableCR)); //SB20200918

								if(AccountReceivable>0)
									AvgTaxInInv=(AccountReceivableTax/AccountReceivable)*100; //Avg Tax to be applied in Undelivered Qty
								
								//RG20210201 added for unbilled account recievable as requested by mahesh sir
								if(VContType.elementAt(i).equals("C") || VContType.elementAt(i).equals("B")){
									double grossinr=0;
									queryString1="select gross_amt_inr,hlpl_inv_seq_no,sn_no,financial_year,fgsa_no,pay_recv_amt,tds_percent,net_amt_inr from fms7_invoice_mst where net_amt_inr>0 and "
												+ "mapping_id='"+MAPPING_ID.elementAt(i)+"' and flag not in ('A','U') and "
												//SB20210208: Interest Inv to be included -by ShiTing/Rohit						+ "adv_adj_flg not in ('BA') and contract_type not in ('M') and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy') "
												+ "(adv_adj_flg not in ('BA') or adv_adj_flg is null) and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy') "
												+ "UNION select gross_amt_inr,hlpl_inv_seq_no,sn_no,financial_year,fgsa_no,pay_recv_amt,tds_percent,net_amt_inr "
												+ "from fms7_manual_invoice_mst where net_amt_inr>0 and "
									//SB20210208: Interest Inv to be included -by ShiTing/Rohit			+ "mapping_id='"+MAPPING_ID.elementAt(i)+"' and flag not in ('A','U') and contract_type not in ('M') and "
												+ "mapping_id='"+MAPPING_ID.elementAt(i)+"' and flag not in ('A','U') and "
												+ "(adv_adj_flg not in ('BA') or adv_adj_flg is null) and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy')";
												//HARSH20220119 AS PER PARITOSH MAIL ON 18/01/2022, DEFICIENCY INVOICE ADDED FOR LTCORA
									System.out.println("queryString1-ruchi---"+queryString1);
									rset1=stmt1.executeQuery(queryString1);
									while(rset1.next()){
										
										String pay_recv_amt=rset1.getString(6)==null?"":rset1.getString(6);
										System.out.println("pay_recv_amt---"+pay_recv_amt);
										if(pay_recv_amt.equalsIgnoreCase("")){
											queryString1="select hlpl_inv_seq_no,dr_cr_flag,criteria,dr_cr_gross_amt_inr,pay_recv_amt,tds_percent,dr_cr_net_amt_inr from fms7_dr_cr_note where hlpl_inv_seq_no='"+rset1.getString(2)+"' "
														+ "and contract_type='"+VContType.elementAt(i)+"' and sn_no='"+rset1.getString(3)+"' "
														+ "and fgsa_no='"+rset1.getString(5)+"'  and financial_year='"+rset1.getString(4)+"' and aprv_by is not null and dr_cr_dt<= to_date('"+to_date+"','dd/mm/yyyy') "
														+ "UNION select hlpl_inv_seq_no,dr_cr_flag,criteria,dr_cr_gross_amt_inr,pay_recv_amt,tds_percent,dr_cr_net_amt_inr from fms7_manual_dr_cr_note where "
														+ "hlpl_inv_seq_no='"+rset1.getString(2)+"' "
														+ "and contract_type='"+VContType.elementAt(i)+"' and sn_no='"+rset1.getString(3)+"' "
														+ "and fgsa_no='"+rset1.getString(5)+"'  and financial_year='"+rset1.getString(4)+"' and aprv_by is not null and dr_cr_dt<= to_date('"+to_date+"','dd/mm/yyyy')";
											rset2=stmt2.executeQuery(queryString1);
											System.out.println("queryString1-ruchi-dr cr--"+queryString1);
											if(rset2.next()){
												String crtiria=rset2.getString(3)==null?"":rset2.getString(3);
												String crdrflag= rset2.getString(2)==null?"":rset2.getString(2);
												String payrecv=rset2.getString(5)==null?"":rset2.getString(5);
												if(!crtiria.equals("REV_INV")){
													System.out.println("--crtiria--"+crtiria);
													if(payrecv.equals("")){
														grossinr+=rset1.getDouble(1);
														if(crdrflag.equalsIgnoreCase("cr")){
															grossinr=grossinr-Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4));
														}else if(crdrflag.equalsIgnoreCase("dr")){
															grossinr+=Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4));
														}
													}else{
														grossinr+=rset1.getDouble(1);
														if(crdrflag.equalsIgnoreCase("dr")){
															double diffamt=0;
															double tds_amt=(Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4)) * Double.parseDouble(rset2.getString(6)==null?"0":rset2.getString(6)))/100;
															double amt=Double.parseDouble(rset2.getString(7)==null?"0":rset2.getString(7))-tds_amt;
															if(Double.parseDouble(rset2.getString(5)==null?"0":rset2.getString(5))==amt){
																
															}else{
																diffamt=Double.parseDouble(rset2.getString(5)==null?"0":rset2.getString(5))-amt;
																grossinr+=diffamt;
															}
															//grossinr+=Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4));
														}
													}
												}else{
													grossinr+=rset1.getDouble(1);
													System.out.println("--grossinr-unpaid-"+grossinr);
												}
											}else{
												grossinr+=rset1.getDouble(1);
												System.out.println("--grossinr-unpaid else-"+grossinr);
											}
										}else{
											//String grossamt=rset1.getString(1)==null?"0":rset1.getString(1);
											double diffamt=0;
											double tds_amt=(Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1)) * Double.parseDouble(rset1.getString(7)==null?"0":rset1.getString(7)))/100;
											System.out.println("--tds_amt tds-"+tds_amt);
											double amt=Double.parseDouble(rset1.getString(8)==null?"0":rset1.getString(8))-tds_amt;
											System.out.println("--amt tds-"+amt);
											if(Double.parseDouble(rset1.getString(6)==null?"0":rset1.getString(6))==amt){
												
											}else{
												diffamt=amt-Double.parseDouble(rset1.getString(6)==null?"0":rset1.getString(6));
												System.out.println("--diffamt tds-"+diffamt);
												grossinr+=diffamt;
											}
											System.out.println("--grossinr-paid tds-"+grossinr);
										}
									}
									//for before adjustment
									queryString1="select gross_amt_inr,hlpl_inv_seq_no,sn_no,financial_year,fgsa_no,pay_recv_amt,tds_percent,net_amt_inr from fms7_invoice_mst where net_amt_inr>0 and "
											+ "mapping_id='"+MAPPING_ID.elementAt(i)+"'  and flag not in ('A','U') and "
											//SB20210208: Interest Inv to be included -by ShiTing/Rohit		+ "adv_adj_flg in ('BA') and contract_type not in ('M') and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy') "
											+ "adv_adj_flg in ('BA') and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy') "
											+ "UNION select gross_amt_inr,hlpl_inv_seq_no,sn_no,financial_year,fgsa_no,pay_recv_amt,tds_percent,net_amt_inr "
											+ "from fms7_manual_invoice_mst where net_amt_inr>0 and "
											+ "mapping_id='"+MAPPING_ID.elementAt(i)+"' and flag not in ('A','U')  and "
											//SB20210208: Interest Inv to be included -by ShiTing/Rohit 	+ "adv_adj_flg in ('BA') and contract_type not in ('M') and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy')";
											+ "adv_adj_flg in ('BA') and approved_by is not null and invoice_dt<=to_date('"+to_date+"','dd/mm/yyyy')";
								rset1=stmt1.executeQuery(queryString1);
								System.out.println("queryString1-ruchi-adjutsment--"+queryString1);
								while(rset1.next()){
									queryString1="select hlpl_inv_seq_no,adjust_amt from fms8_adv_inv_dtl where hlpl_inv_seq_no='"+rset1.getString(2)+"' "
											+ "and mapping_id='"+MAPPING_ID.elementAt(i)+"' ";
									rset2=stmt2.executeQuery(queryString1);
									System.out.println("queryString1-ruchi-adjutsment-advinv-"+queryString1);
									if(rset2.next()){
										String pay_recv_amt=rset1.getString(6)==null?"":rset1.getString(6);
										if(pay_recv_amt.equals("")){
											grossinr+=Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1))- Double.parseDouble(rset2.getString(2)==null?"0":rset2.getString(2));
											System.out.println("grossinr adjustment unpaid-"+grossinr);
										}else{
											double diffamt=0;
											double tds_amt=(Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1)) * Double.parseDouble(rset1.getString(7)==null?"0":rset1.getString(7)))/100;
											double amt=Double.parseDouble(rset1.getString(8)==null?"0":rset1.getString(8))-tds_amt;
											if(Double.parseDouble(rset1.getString(6)==null?"0":rset1.getString(6))==amt){
												
											}else{
												diffamt=Double.parseDouble(rset1.getString(6)==null?"0":rset1.getString(6))-amt;
												grossinr+=diffamt;
											}
											System.out.println("grossinr adjustment-paid--"+grossinr);
										}
									}
									
									queryString1="select hlpl_inv_seq_no,dr_cr_flag,criteria,dr_cr_gross_amt_inr,pay_recv_amt,tds_percent,dr_cr_net_amt_inr from fms7_dr_cr_note where hlpl_inv_seq_no='"+rset1.getString(2)+"' "
												+ "and contract_type='"+VContType.elementAt(i)+"' and sn_no='"+rset1.getString(3)+"' "
												+ "and fgsa_no='"+rset1.getString(5)+"'  and financial_year='"+rset1.getString(4)+"' and aprv_by is not null and dr_cr_dt<= to_date('"+to_date+"','dd/mm/yyyy') "
												+ "UNION select hlpl_inv_seq_no,dr_cr_flag,criteria,dr_cr_gross_amt_inr,pay_recv_amt,tds_percent,dr_cr_net_amt_inr from fms7_manual_dr_cr_note where "
												+ "hlpl_inv_seq_no='"+rset1.getString(2)+"' "
												+ "and contract_type='"+VContType.elementAt(i)+"'  and sn_no='"+rset1.getString(3)+"' "
												+ "and fgsa_no='"+rset1.getString(5)+"' and financial_year='"+rset1.getString(4)+"' and aprv_by is not null and dr_cr_dt<= to_date('"+to_date+"','dd/mm/yyyy')";
									rset2=stmt2.executeQuery(queryString1);
									if(rset2.next()){
										String crtiria=rset2.getString(3)==null?"":rset2.getString(3);
										String crdrflag= rset2.getString(2)==null?"":rset2.getString(2);
										String payrecv=rset2.getString(5)==null?"":rset2.getString(5);
										if(!crtiria.equals("REV_INV")){
											//grossinr+=rset1.getDouble(1);
											if(payrecv.equals("")){
												if(crdrflag.equalsIgnoreCase("cr")){
													grossinr=grossinr-Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4));
												}else if(crdrflag.equalsIgnoreCase("dr")){
													grossinr+=Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4));
												}
											}else{
												if(crdrflag.equalsIgnoreCase("dr")){
													double diffamt=0;
													double tds_amt=(Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4)) * Double.parseDouble(rset2.getString(6)==null?"0":rset2.getString(6)))/100;
													double amt=Double.parseDouble(rset2.getString(7)==null?"0":rset2.getString(7))-tds_amt;
													if(Double.parseDouble(rset2.getString(5)==null?"0":rset2.getString(5))==amt){
														
													}else{
														diffamt=Double.parseDouble(rset2.getString(5)==null?"0":rset2.getString(5))-amt;
														grossinr+=diffamt;
													}
													//grossinr+=Double.parseDouble(rset2.getString(4)==null?"0":rset2.getString(4));
												}
											}
										}else{
											grossinr=grossinr;
										}
									}else{
										grossinr=grossinr;
										System.out.println("grossinr adjustment dr cr paid--"+grossinr);
									}
								 }
								AccountReceivable=Double.parseDouble(nf.format(grossinr)); //SB20210206: Wrong value on Screen due to RG's logic introduced later
								if(AccountReceivable > 2) //HARSH20210513 AS DISCUSSED WITH ROHITBHAI
								{}
								else
								{
									AccountReceivable = 0;
									grossinr = 0;
								}
								VUnBilledReceivable_RG.add(nf.format(grossinr));
								}else{
									VUnBilledReceivable_RG.add("0.00");
								}
								//
								
						}
						else
						{//System.out.println(AccountReceivableTax+"*ELSE SIDE***"+AccountReceivable+"***: AvgTaxInInv: "+AvgTaxInInv);
							VBilledReceivableDtl.add("-");//SB20201206
							VUnBilledReceivable.add("0.00");
							VUnBilledReceivable_RG.add("0.00");
							VUnBilledReceivableTax.add("0");
							AvgExchgRate_AllocatedQty=0;
							VBilledReceivableExchgAvg.add("0");
							VUnBilledReceivableTaxOnly.add("0");
							VUnBilledReceivableGrossUSD.add("0");
							VUnBilledReceivablePeriodEndDt.add(LastBilledQtyEndDt);
							VReceivableAmtTax.add("0");
							VReceivableAmtTaxCR.add("0");
							VReceivableAmtTaxDR.add("0");
							AvgTaxInInv=0;
							
					//SB20200917		VAvgTaxUndelivered.add("0");
							VBilledQtyTCQ.add("0");
							BalanceQty=Double.parseDouble(""+VContTCQ.elementAt(i)); //Balance after Receivable Amt/Qty
							VBalanceUnbilledTCQ.add(nf.format(BalanceQty));
							VBilledReceivablePaymtRecvd.add("0"); //SB20200918
							VBilledReceivablePaymtRecvdDR.add("0");//SB20200918
							VBilledReceivableDR.add("0"); //SB20200918
							VBilledReceivableCR.add("0"); //SB20200918
							VInvoiceReceivableGrossINR.add("");//In case Account receivable is 0.00 HARSH20201215
						}

		//		System.out.println(VInvoiceReceivableGrossINR.size()+" :VInvoiceReceivableGrossINR: "+VInvoiceReceivableGrossINR);
							
					//System.out.println(AccountReceivableTax+"*IN SIDE***"+AccountReceivable+"***: AvgTaxInInv: "+AvgTaxInInv);
				///////////////////////////////////////////////////////////////////////////
				
					/////////////////////SB20200914: Get the Max Tax against the Customer//////////////////////////////
				//SB20200921	if(AvgTaxInInv==0)
				if(!VContType.elementAt(i).equals("C"))
					{
						queryString = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
						" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND APP_DATE <=TO_DATE('"+to_date+"','DD/MM/YYYY') "
						+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
						+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<=TO_DATE('"+to_date+"','DD/MM/YYYY'))";
						//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
						rset = stmt.executeQuery(queryString);
						//System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							AvgTaxInInv=rset.getDouble(1);
						}
					}
				else if(VContType.elementAt(i).equals("C")) //ADDED FOR LTCORA AND CN
					{
						queryString = "SELECT MAX(FACTOR) FROM FMS7_CUSTOMER_SERVICE_TAX_DTL A, FMS7_TAX_STRUCTURE_DTL B WHERE " +
									  "A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND APP_DATE <=TO_DATE('"+to_date+"','DD/MM/YYYY') "
									  + "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_SERVICE_TAX_DTL B WHERE A.customer_cd=B.customer_cd AND "
									  + "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<=TO_DATE('"+to_date+"','DD/MM/YYYY'))";
						//System.out.println("==FMS7_CUSTOMER_SERVICE_TAX_DTL==="+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							AvgTaxInInv=rset.getDouble(1);
							AvgTaxInInv=18; //After discussing With ruchi; //SB20210203
						}
					}
					VAvgTaxUndelivered.add(AvgTaxInInv); //Tax applicable
					///////////////^^^^//////////////////////////////////////
				/*SB	VAvgTaxUndelivered.add(nf.format(AvgTaxInInv));
					VBilledQtyTCQ.add(nf.format(BilledQty));
					BalanceQty=Double.parseDouble(""+VContTCQ.elementAt(i))-BilledQty; //Balance after Receivable Amt/Qty
					VBalanceUnbilledTCQ.add(nf.format(BalanceQty));
					*/
				//	System.out.println(BalanceQty+" QTY: Billed Mth: >>>AvgExchgRate_AllocatedQty>> "+AvgExchgRate_AllocatedQty);
					///////////////^^^^^//////////////////////////////////////////////////////////////////////
					String LastBilledQtyNextDt=""; String PrevGenDate="";
					if(LastBilledQtyEndDt.equals(""))	
					{
						LastBilledQtyEndDt=""+FRM_DT.elementAt(i); //Begining of Contract Date
						//LastBilledQtyNextDt =""+FRM_DT.elementAt(i); //Begining of Contract Date
					}
					else
					{
						queryString = "SELECT TO_CHAR(TO_DATE('"+LastBilledQtyEndDt+"','DD/MM/YYYY')+1,'DD/MM/YYYY')  FROM DUAL" ;
					  	rset=stmt.executeQuery(queryString);
						if(rset.next()){
							LastBilledQtyNextDt = rset.getString(1)==null?"01/01/2000":rset.getString(1);
						}
					}
					////////////////////////SB20200923: Incase of Invoice is not generated////////////////////
					if(LastBilledQtyNextDt.equals(""))	
					{
						LastBilledQtyNextDt=""+FRM_DT.elementAt(i); //Begining of Contract Date
					//	System.out.println(LastBilledQtyNextDt+"<<<<<<< >>>LastBilledQtyNextDt>> ");
					}
					////////////////////////////////////////////////////////////////////////////
						queryString = "SELECT TO_CHAR(TO_DATE('"+to_date+"','DD/MM/YYYY')-1,'DD/MM/YYYY')  FROM DUAL" ;
						//	System.out.println(" NEXT MTH: DUAL: "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next()) {
								PrevGenDate = rset.getString(1)==null?"01/01/2000":rset.getString(1);
							}
				////////////////////////////////////////////////////////////////////////////////////////////////////
	/*///////////////////////////////SB20210203: QTY Calculation For Unbilled/////////////////////////////////////////////
			if(VContType.elementAt(i).equals("C"))
			{
				double SumOfCargoAllocQty=0;
			for(int m=0; m<VCargoDealNo.size(); m++)
			{
			
				if(VCargoDealNo.elementAt(i).equals(MAPPING_ID.elementAt(i)))
				{
					String queryStringQty="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL "+
							" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"' "
							+ " AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy') and to_date('"+PrevGenDate+"','dd/mm/yyyy')"
					//SB+ " AND GAS_DT <= to_date('"+LastBilledQtyEndDt+"','dd/mm/yyyy')";
							+ "  AND SN_NO="+VCargoNo.elementAt(m)+" ";
						System.out.println(MAPPING_ID.elementAt(i)+" :STEP-3A: FMS7_DAILY_ALLOCATION_DTL: "+queryStringQty);
						rset1=stmt1.executeQuery(queryStringQty);
						if(rset1.next()){
						//	VCargoWiseBilledQty.add(rset1.getDouble(1));
							SumOfCargoAllocQty+=rset1.getDouble(1);
							VCargoWiseBilledQty.add(SumOfCargoAllocQty);
						}	
						//else
						//	VCargoWiseBilledQty.add("0");
				}
				else
				{
					VCargoWiseBilledQty.add(SumOfCargoAllocQty);
					SumOfCargoAllocQty=0;
				}
			}
			System.out.println(VCargoSeqNo.size()+" :STEP-UnBilled: FMS7_DAILY_ALLOCATION_DTL: "+VCargoWiseBilledQty);
			}
			*///////////////////////////////////////////////////////////////////////////////////////
					double AvgExchgRateAlloc=0; double UnBilledAllocQty=0; 
				
					double UnBilledAllocQtyDaily=0; double UnBilledAllocQtySum=0; double UnBilledAllocCost=0; double UnBilledAllocCostSum=0; double SalesRate=0;
					int AvgCount=0; double UnBilledAllocQtyAmtTCS=0;
					queryString = "SELECT TO_DATE('"+PrevGenDate+"','DD/MM/YYYY')-TO_DATE('"+LastBilledQtyNextDt+"','DD/MM/YYYY')+1 FROM DUAL" ;
						//	System.out.println("STEP-5: Un DeLIVERED: DUAL: "+queryString);
										rset = stmt.executeQuery(queryString);
										if(rset.next()) {
											no_of_days = rset.getInt(1);
										}
										
			//SB20201118: To Stop										no_of_days =10;  //SB20201111: To get the List of  w/o UnBilled Qty/Amt. Temporary arrangement
					
					for(int k=0; k<no_of_days; k++)
					{
						String UnBilledDt=""; 
					queryString = "SELECT TO_CHAR(TO_DATE('"+LastBilledQtyNextDt+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL" ;
				//		System.out.println(" NEXT MTH: DUAL: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next()) {
							UnBilledDt = rset.getString(1);
						}
						if(VContType.elementAt(i).equals("C"))
						{						
							queryString ="select SUM(QTY_MMBTU), SUM(COST), AVG(EXCHG_RATE), AVG(SALES_RATE) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " + //SB20201202
									" AND MAPPING_ID='"+MAPPING_ID.elementAt(i)+"'  AND GAS_DT between to_date('"+UnBilledDt+"','dd/mm/yyyy')" +
									 "AND to_date('"+UnBilledDt+"','dd/mm/yyyy') AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' ";
									 //+ "AND SN_NO="+SN_NO.elementAt(i)+"";
							//HARSH20210525 SN_NO IS CARGO SEQ NO AS DISCUSSED WITH RUCHI 
						}
						else
						{
					//SB20201202	queryString ="select (QTY_MMBTU), (COST), (EXCHG_RATE), (SALES_RATE) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
								queryString ="select SUM(QTY_MMBTU), SUM(COST), AVG(EXCHG_RATE), AVG(SALES_RATE) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " + //SB20201202
								 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
								 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+UnBilledDt+"','dd/mm/yyyy')" +
								 "AND to_date('"+UnBilledDt+"','dd/mm/yyyy') AND CONTRACT_TYPE='"+VContType.elementAt(i)+"'";	
						}
						///if(CUSTOMER_CD.elementAt(i).equals("29"))	
						////System.out.println("UN BILLED: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
						rset2 = stmt2.executeQuery(queryString);
							if(rset2.next())
							{
							//SB20200102	UnBilledAllocQtyDaily=Double.parseDouble(rset2.getString(1));
								UnBilledAllocQtyDaily=rset2.getDouble(1); //SB20200102
						///		if(VPriceTypeDeal.elementAt(i).equals("FLOAT")) //SB20201203: As discussed with Rohit
								{
									UnBilledAllocCost=UnBilledAllocCost+((UnBilledAllocQtyDaily)*Double.parseDouble(""+VPriceTypeDealRateA.elementAt(i))*Double.parseDouble(""+VExchgRate.elementAt(i)));
									SalesRate=Double.parseDouble(""+VPriceTypeDealRateA.elementAt(i));
								}
							
								if(rset2.getDouble(3)>0) //SB20201208
									AvgExchgRateAlloc=rset2.getDouble(3);
								AvgExchgRateAlloc=Double.parseDouble(""+VExchgRate.elementAt(i)); //SB20201208: Overriding Allocated ExchRate with applicable Exchg Rate
								AvgCount++;
								if(BalanceQty-UnBilledAllocQtyDaily>0)
								{
									UnBilledAllocQtySum=UnBilledAllocQtySum+UnBilledAllocQtyDaily; 
						///			UnBilledReceivable=UnBilledReceivable+UnBilledAllocCost;
									UnBilledReceivable=UnBilledAllocCost;
									BalanceQty=BalanceQty-UnBilledAllocQtyDaily;
									UnBilledFmTo=LastBilledQtyNextDt+"-"+UnBilledDt;
									//if(CUSTOMER_CD.elementAt(i).equals("29"))	
										//System.out.println(BalanceQty-UnBilledAllocQtyDaily+" ***UnBilledReceivable*****: "+nf.format(UnBilledReceivable));
								}
								else
								{System.out.println(BalanceQty+" ***************************************************************: "+AvgCount);
									UnBilledAllocQtySum=UnBilledAllocQtySum+BalanceQty;
									UnBilledReceivable=UnBilledReceivable+(BalanceQty*AvgExchgRateAlloc*SalesRate);
									BalanceQty=0;	
									ContEndDateCurrMth=UnBilledDt;
									break;
								}
							}
							else
							{
								UnBilledAllocQtyDaily=0;
								UnBilledAllocCost=0;
						//SB20201208		AvgExchgRateAlloc=0;
								SalesRate=Double.parseDouble(""+VPriceTypeDealRateA.elementAt(i));//SB20201204 Double.parseDouble(""+RATE.elementAt(i));
								UnBilledFmTo=LastBilledQtyNextDt+"-"+UnBilledDt;///if(CUSTOMER_CD.elementAt(i).equals("29"))	 System.out.println(BalanceQty+" **ELSE**: "+AvgCount);
							}
						//	System.out.println(VTransValue.elementAt(i)+" ***UnBilledAllocQtyDaily******: "+nf.format(UnBilledAllocQtySum));
					}
					////////////////Transportation Charges For Allocated Qty of current month//////////////////////////////////////
					UnBilledReceivable=UnBilledReceivable+UnBilledAllocQtySum*Double.parseDouble(""+VTransValue.elementAt(i));
					///////////^^^^Transportation Charges to be included//////////////////////////////////////
				//	if(CUSTOMER_CD.elementAt(i).equals("29"))
					{
					//	System.out.println(Double.parseDouble(""+VTransValue.elementAt(i))+" ***VTransValue******: "+nf.format(UnBilledAllocQtySum*Double.parseDouble(""+VTransValue.elementAt(i))));
					//	System.out.println(UnBilledAllocQtyDaily+" ***FINAL UnBilledReceivable******: "+nf.format(UnBilledReceivable));					
					}
					VUnBilledQtyCurrMth.add(nf.format(UnBilledAllocQtySum));
					VUnBilledAmtCurrMth.add(nf.format(UnBilledReceivable));
					VUnBilledAvgExchgRate.add(AvgExchgRateAlloc);
					VUnBilledAvgSalesRate.add(SalesRate);
					VUnBilledAmtCurrMthDt.add(UnBilledFmTo);
					VBalanceTCQCurrMth.add(nf.format(BalanceQty));
					VUnBilledReceivableTaxTCS.add(nf.format(UnBilledAllocQtyAmtTCS)); //SB20200918
				  	///////////////////^^^^^Get Allocated Qty//////////////////////////
					
					
					
					
				//	System.out.println(">UnBilled Current Mth: >>>AvgExchgRate_AllocatedQty>> "+AvgExchgRateAlloc);
					
					VAvgExchgRate.add(AvgExchgRate_AllocatedQty); 
					
					BALANCEMMBTU.add(nf.format(Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i))));
					//MD20110916
					BALANCEMMSCM.add(nf.format(Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i))));
					bal_tot_comit+=Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i));
					bal_tot_comit_mmscm+=Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i));
					//System.out.println("SUPLIEDMMSCM : "+SUPPLIEDMMSCM+" TOTAL : "+sup_tot_comit_mmscm);
					//System.out.println("BALANCEMMSCM : "+BALANCEMMSCM+" TOTAL : "+bal_tot_comit_mmscm);
						
					//////////////SB20200817////////////////////////
					String TCQ=""; String Alloc_Qty="";  String Cont_End_Dt="";
					TCQ=""+BOOKMMBTU.elementAt(i); Cont_End_Dt=""+TO_DT.elementAt(i);
					Alloc_Qty=""+SUPPLIEDMBTU.elementAt(i); Cont_End_Dt=""+TO_DT.elementAt(i);
					String Mapp_Id=CUSTOMER_CD.elementAt(i)+"-"+FGSA_NO.elementAt(i)+"-"+FGSA_REV_NO.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i);
					String Phy_CurFrd_Price="0"; String Fin_CurFrd_Price="0";
					String Buy_Sell="SELL";
					if(CUSTOMER_ABBR.elementAt(i).equals("SEIPL"))
						Buy_Sell="Buy";
					/*SB20201111: May not required after introducing Price Type similar to MR
					String PriceType="";
				
					queryString ="SELECT PRICE_TYPE FROM FMS9_MRCR_CONT_DTL "+
							" where MAPPING_ID='"+Mapp_Id+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND FLAG='Y' ";
					rset = stmt.executeQuery(queryString);
//					//System.out.println(">>>>>>> "+queryString);
					if(rset.next())
					{
						PriceType=rset.getString(1);
					}
					if(PriceType.equals(""))
					{
						String NewSalePrice="";
						queryString ="SELECT NEW_SALE_PRICE FROM FMS8_CARGO_ALLOC_REVISED_DTL "+
								" where FGSA_NO='"+FGSA_NO.elementAt(i)+"' AND FGSA_REV_NO='"+FGSA_REV_NO.elementAt(i)+"' AND SN_NO='"+SN_NO.elementAt(i)+"' "
								+ "AND SN_REV_NO='"+SN_REV_NO.elementAt(i)+"' AND CONTRACT_TYPE='"+VContType.elementAt(i)+"' AND NEW_PRICE_EFF_DT <=TO_DATE('"+Gen_Dt+"','DD/MM/YYYY')";//AND FLAG='A' ";
						rset = stmt.executeQuery(queryString);
					//	System.out.println("PRICE-TYPE********* "+queryString);
						if(rset.next())
						{
							NewSalePrice=rset.getString(1);
							PriceType="M";
						}
						else
							PriceType="F";
					//	System.out.println(PriceType+" :NewSalePrice>>>>>>> "+NewSalePrice);
					}
					*/
				//////////////////Un Delivered Qty and Amt for the Current Mth////OK: Perfect Case1: Cont closes before the mth and after the month@DCQ////////////////////////////////
								double UnDelvAllocQtyCurrMthDaily=0;  double UnDelvAllocQtyCurrMth=0; double UnDelvAllocAmtCurrMth=0; String UnDelvStartDt="";
								if(FirstFortNightFlag.equals("N"))	
									UnDelvStartDt=to_date;
								else
									UnDelvStartDt=SecondFortNightBillStartDt;
								
				
								
								
								
								//////////////////////Logic to Find out the ContEnd Date as Next Mth Last Date///////////////////
								no_of_days=0; String StartDateForUnDeliveredCurrMth="";
								queryString = "SELECT TO_DATE('"+to_date+"','DD/MM/YYYY')-TO_DATE('"+FRM_DT.elementAt(i)+"','DD/MM/YYYY')+1 FROM DUAL" ;
										//	System.out.println(" NEXT MTH: DUAL: "+queryString);
											rset = stmt.executeQuery(queryString);
											if(rset.next()) {
												no_of_days = rset.getInt(1);
											}
											if(no_of_days<0)
												StartDateForUnDeliveredCurrMth=""+FRM_DT.elementAt(i); //Contract Closes before the Next Month End.
											else
												StartDateForUnDeliveredCurrMth=""+to_date;
								////////////////////////////////////////////////////////////////////////////////////////////////////			
								queryString = "SELECT TO_DATE('"+ContEndDateCurrMth+"','DD/MM/YYYY')-TO_DATE('"+StartDateForUnDeliveredCurrMth+"','DD/MM/YYYY')+1 FROM DUAL" ;
							//	System.out.println("STEP-5: Un DeLIVERED: DUAL: "+queryString);
											rset = stmt.executeQuery(queryString);
											if(rset.next()) {
												no_of_days = rset.getInt(1);
											}
									/*		System.out.println(VCargoWiseBalanceQty.size()+" :Start VCargoWiseBalanceQty: "+VCargoWiseBalanceQty);
											System.out.println(VCargoNo.size()+" :Start VCargoNo: "+VCargoNo);
											System.out.println(VCargoDealNo.size()+" :Start VCargoDealNo: "+VCargoDealNo);
											*/
				///////////////////Get Variable DCQ//////////////////////////
								String AvgDcq2=""; int count2=0;
								for(int k=0; k<no_of_days; k++)
								{
									String DcqDt="";
								queryString = "SELECT TO_CHAR(TO_DATE('"+StartDateForUnDeliveredCurrMth+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL" ;
							//		System.out.println(" NEXT MTH: DUAL: "+queryString);
									rset = stmt.executeQuery(queryString);
									if(rset.next()) {
										DcqDt = rset.getString(1);
									}
									if(!VContType.elementAt(i).equals("C"))
									{
									if(VContType.elementAt(i).equals("S"))
									{
							  	queryString = "SELECT NVL(dcq,'0') "
										+ " FROM FMS7_SN_DCQ_DTL A WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND SN_NO="+SN_NO.elementAt(i)+" AND SN_REV_NO="+SN_REV_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND "
										+ " A.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.FLAG='Y' "
										+ " AND A.sn_rev_no=(SELECT MAX(B.sn_rev_no) FROM FMS7_SN_DCQ_DTL B WHERE A.fgsa_no=B.fgsa_no AND A.sn_no=B.sn_no AND "
										+ " A.customer_cd=B.customer_cd AND  B.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.FLAG='Y') ";
									//	System.out.println("DCQ: FMS7_SN_DCQ_DTL: "+queryString);
										rset2 = stmt2.executeQuery(queryString);
									}
									else if(VContType.elementAt(i).equals("L"))
									{
										queryString = "SELECT NVL(dcq,'0') "
												+ " FROM FMS7_LOA_DCQ_DTL A WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND LOA_NO="+SN_NO.elementAt(i)+" AND LOA_REV_NO="+SN_REV_NO.elementAt(i)+" AND TENDER_NO="+FGSA_NO.elementAt(i)+" AND "
												+ " A.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.FLAG='Y' "
												+ " AND A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_DCQ_DTL B WHERE A.TENDER_NO=B.TENDER_NO AND A.LOA_NO=B.LOA_NO AND "
												+ " A.customer_cd=B.customer_cd AND  B.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.FLAG='Y') ";
											//	System.out.println("DCQ: FMS7_LOA_DCQ_DTL: "+queryString);
												rset2 = stmt2.executeQuery(queryString);
									}
										if(rset2.next())
										{
											UnDelvAllocQtyCurrMthDaily=Double.parseDouble(rset2.getString(1));
											count2++;
										}
										else
										{
											UnDelvAllocQtyCurrMthDaily=Double.parseDouble(""+VDealDCQ.elementAt(i));
											count2++;
										}
									}
									else ///SB20201021: For LTCORA
									{
									//SB20210203	UnDelvAllocQtyCurrMthDaily=Double.parseDouble(""+VDealDCQ.elementAt(i)); System.out.println("UnDelvAllocQtyCurrMthDaily: "+UnDelvAllocQtyCurrMthDaily);
									//	VCargoWiseBalanceQty
									//	System.out.println(MAPPING_ID.elementAt(i)+" :VCargoDealNo: "+VCargoDealNo.size());
										double CargoBalance=0; double CargoDCQ=0; double CargoUnDelvAllocQtyCurrMth=0; int IndexNo=0;
										for(int n=0; n<VCargoDealNo.size(); n++)
										{//System.out.println(MAPPING_ID.elementAt(i)+" :VCargoDealNo: "+VCargoDealNo.elementAt(n));
											if(MAPPING_ID.elementAt(i).equals(VCargoDealNo.elementAt(n)))
											{
												IndexNo=n;
												CargoBalance=Double.parseDouble(""+VCargoWiseBalanceQty.elementAt(n));
												CargoDCQ=Double.parseDouble(""+VCargoDCQ.elementAt(n));
												if((CargoBalance-CargoDCQ)>0)
												{
													//System.out.println(CargoBalance+" :CargoBalance-CargoDCQ: "+CargoDCQ);
													CargoBalance=CargoBalance-CargoDCQ;
													CargoUnDelvAllocQtyCurrMth+=CargoDCQ;//System.out.println(CargoBalance+" :CargoUnDelvAllocQtyCurrMth: "+VCargoNo.elementAt(n));
													VCargoWiseBalanceQty.removeElementAt(n);
													VCargoWiseBalanceQty.add(IndexNo, nf.format(CargoBalance));
												}
												else
												{
													if(CargoBalance>0)
														CargoUnDelvAllocQtyCurrMth+=CargoBalance;//System.out.println(CargoBalance+" :CargoUnDelvAllocQtyCurrMth: "+VCargoNo.elementAt(n));
														VCargoWiseBalanceQty.removeElementAt(n);
														VCargoWiseBalanceQty.add(IndexNo, 0);
												}
												
											}
										}
										UnDelvAllocQtyCurrMthDaily=CargoUnDelvAllocQtyCurrMth;
									}
									//System.out.println(DcqDt+" :VCargoWiseBalanceQty: "+VCargoWiseBalanceQty);
										if(BalanceQty-UnDelvAllocQtyCurrMthDaily>0)
										{
											BalanceQty=BalanceQty-UnDelvAllocQtyCurrMthDaily;//System.out.println(nf.format(BalanceQty)+" :UnDelvAllocQtyCurrMthDaily: "+UnDelvAllocQtyCurrMthDaily);
											UnDelvAllocQtyCurrMth=UnDelvAllocQtyCurrMth+UnDelvAllocQtyCurrMthDaily;
										}
										else
										{
											if(BalanceQty>0)
												UnDelvAllocQtyCurrMth=UnDelvAllocQtyCurrMth+BalanceQty;//System.out.println(nf.format(BalanceQty)+" LastQty:UnDelvAllocQtyCurrMthDaily: "+UnDelvAllocQtyCurrMthDaily);
											AvgDcq2="* Last Qty: "+nf.format(BalanceQty);
											BalanceQty=0;	
											ContEndDateCurrMth=DcqDt;
											break;
										}
									
								}
							  	///////////////////^^^^^Get Variable DCQ//////////////////////////
								System.out.println(VCargoWiseBalanceQty.size()+" :FINAL VCargoWiseBalanceQty: "+VCargoWiseBalanceQty);
								/////SB20200928:09PM//////////////If contract closes before next month but Qty remains then//////////////////////////
								no_of_days=0;
								queryString = "SELECT TO_DATE('"+TO_DT.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+FirstDateNextMth+"','DD/MM/YYYY') FROM DUAL" ;
							//	System.out.println("STEP-6: Un DeLIVERED: DUAL: "+queryString);
											rset = stmt.executeQuery(queryString);
											if(rset.next()) {
												no_of_days = rset.getInt(1);
											}
								if(no_of_days<0)
								{
									UnDelvAllocQtyCurrMth=UnDelvAllocQtyCurrMth+BalanceQty;
									BalanceQty=0; //SB20201121: Incase Forward Month is not applicable. i.e., Cont ended before 1st of next month
								}
								////////////////////////^^^^^^^^^^^^^^////////////////////////
								
							///	System.out.println(UnDelvAllocQtyCurrMth+" :STEP-6A:RATE.elementAt(i): "+RATE.elementAt(i));
							//	System.out.println(VPriceTypeDeal+" :STEP-6B   PriceTypeDealRateA.elementAt(i): "+VPriceTypeDealRateA.elementAt(i));
								VBalanceTCQNextMth.add(nf.format(BalanceQty));
						///		if(VPriceTypeDeal.elementAt(i).equals("FLOAT")) //SB20201203: As discussed with Rohit
									UnDelvAllocAmtCurrMth=UnDelvAllocAmtCurrMth+((UnDelvAllocQtyCurrMth)*Double.parseDouble(""+VPriceTypeDealRateA.elementAt(i))*Double.parseDouble(""+VExchgRate.elementAt(i)));
						///		else //
						///			UnDelvAllocAmtCurrMth=UnDelvAllocAmtCurrMth+((UnDelvAllocQtyCurrMth)*Double.parseDouble(""+RATE.elementAt(i))*Double.parseDouble(""+VExchgRate.elementAt(i)));
								//System.out.println("UN-DELIVERED CURRENT MONTH: "+nf.format(UnDelvAllocAmtCurrMth));
								VUnDeliveredCurrMth.add(nf.format(UnDelvAllocQtyCurrMth)+AvgDcq2);
								VUnDeliveredCurrMthEndDt.add(StartDateForUnDeliveredCurrMth+" - "+ContEndDateCurrMth);
								
								////////////////Transportation Charges for Current month//////////////////////////////////////
								UnDelvAllocAmtCurrMth=UnDelvAllocAmtCurrMth+UnDelvAllocQtyCurrMth*Double.parseDouble(""+VTransValue.elementAt(i));
								///////////^^^^Transportation Charges to be included//////////////////////////////////////
											
								VUnDeliveredCurrMthAmt.add(nf.format(UnDelvAllocAmtCurrMth));
								UnDelvCurrMthFmToDt=to_date+"-"+LastDateMth; 
								
							//	System.out.println("CR: EXPOSURE TRACKING REPORT: VUnDeliveredNextMthAmt: "+VUnDeliveredNextMthAmt);
				//////////////////////////////////////////////////////////////////////////
							
							
							
			/*/////////////////Un Delivered Qty and Amt for the Next Mth////////////////////////////////////
							//////////////////////Logic to Find out the ContEnd Date as Current Mth Last Date///////////////////
							no_of_days=0; String ContEndDate="";
							double UnDelvAllocQtyNextMthDaily=0;  double UnDelvAllocQtyNextMth=0; double UnDelvAllocAmtNextMth=0; 
							queryString = "SELECT TO_DATE('"+TO_DT.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+LastDateNextMth+"','DD/MM/YYYY')+1 FROM DUAL" ;
							//	System.out.println(" NEXT MTH: DUAL: "+queryString);
								rset = stmt.executeQuery(queryString);
								if(rset.next()) {
									no_of_days = rset.getInt(1);
								}
								if(no_of_days<0)
									ContEndDate=""+TO_DT.elementAt(i); //Contract Closes before the Next Month End.
								else
									ContEndDate=""+LastDateNextMth;
							////////////////////////////////////////////////////////////////////////////////////////////////////
								
					queryString = "SELECT TO_DATE('"+ContEndDate+"','DD/MM/YYYY')-TO_DATE('"+FirstDateNextMth+"','DD/MM/YYYY')+1 FROM DUAL" ;
			//		System.out.println("STEP-6: Un DeLIVERED: DUAL: "+queryString);
								rset = stmt.executeQuery(queryString);
								if(rset.next()) {
									no_of_days = rset.getInt(1);
								}

						double UnDelvAllocQty=0; double UnDelvAllocAmt=0; String AvgDcq=""; int count=0;

		///////////////////Get Variable DCQ//////////////////////////
									for(int k=0; k<no_of_days; k++)
									{
										String DcqDt="";
									queryString = "SELECT TO_CHAR(TO_DATE('"+FirstDateNextMth+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL" ;
								//		System.out.println(" NEXT MTH: DUAL: "+queryString);
										rset = stmt.executeQuery(queryString);
										if(rset.next()) {
											DcqDt = rset.getString(1);
										}
										if(VContType.elementAt(i).equals("S"))
										{
								  	queryString = "SELECT NVL(dcq,'0') "
											+ " FROM FMS7_SN_DCQ_DTL A WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND SN_NO="+SN_NO.elementAt(i)+" AND SN_REV_NO="+SN_REV_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND "
											+ " A.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.FLAG='Y' "
											+ " AND A.sn_rev_no=(SELECT MAX(B.sn_rev_no) FROM FMS7_SN_DCQ_DTL B WHERE A.fgsa_no=B.fgsa_no AND A.sn_no=B.sn_no AND "
											+ " A.customer_cd=B.customer_cd AND  B.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.FLAG='Y') ";
									//		System.out.println("DCQ: FMS7_SN_DCQ_DTL: "+queryString);
											rset2 = stmt2.executeQuery(queryString);
										}
										else
										{
											queryString = "SELECT NVL(dcq,'0') "
													+ " FROM FMS7_LOA_DCQ_DTL A WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND LOA_NO="+SN_NO.elementAt(i)+" AND LOA_REV_NO="+SN_REV_NO.elementAt(i)+" AND TENDER_NO="+FGSA_NO.elementAt(i)+" AND "
													+ " A.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND A.FLAG='Y' "
													+ " AND A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_DCQ_DTL B WHERE A.TENDER_NO=B.TENDER_NO AND A.LOA_NO=B.LOA_NO AND "
													+ " A.customer_cd=B.customer_cd AND  B.from_dt<=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.to_dt>=TO_DATE('"+DcqDt+"','DD/MM/YYYY') AND B.FLAG='Y') ";
											//		System.out.println("DCQ: FMS7_LOA_DCQ_DTL: "+queryString);
													rset2 = stmt2.executeQuery(queryString);
										}
											if(rset2.next())
											{
												UnDelvAllocQtyNextMthDaily=Double.parseDouble(rset2.getString(1));
												count++;
											}
											else
											{
												UnDelvAllocQtyNextMthDaily=Double.parseDouble(""+VDealDCQ.elementAt(i));
												count++;
											}
										//	System.out.println(BalanceQty+" :BalanceQty: "+UnDelvAllocQtyNextMthDaily);
											if(BalanceQty-UnDelvAllocQtyNextMthDaily>0)
											{
												BalanceQty=BalanceQty-UnDelvAllocQtyNextMthDaily;
												UnDelvAllocQtyNextMth=UnDelvAllocQtyNextMth+UnDelvAllocQtyNextMthDaily;
											}
											else
											{
												UnDelvAllocQtyNextMth=UnDelvAllocQtyNextMth+BalanceQty;
												AvgDcq="* Last Qty: "+nf.format(BalanceQty);
												System.out.println(UnDelvAllocQtyNextMth+" CR: : Cont closed: "+VExchgRate.elementAt(i)+"  : "+RATE.elementAt(i));
												BalanceQty=0;	
												ContEndDate=DcqDt;
												break;
											}
									}
							//		System.out.println(UnDelvAllocQtyNextMth+" CR: EXPOSURE TRACKING REPORT: VUnDeliveredNextMthAmt: "+VUnDeliveredNextMthAmt);
								  	///////////////////^^^^^Get Variable DCQ//////////////////////////

									/////SB20200928:09PM//////////////If contract closes before Forward Next month but Qty remains then//////////////////////////
									no_of_days=0;
									queryString = "SELECT TO_DATE('"+TO_DT.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+LastDateNextMth+"','DD/MM/YYYY') FROM DUAL" ;
								//	System.out.println("STEP-6: Un DeLIVERED: DUAL: "+queryString);
												rset = stmt.executeQuery(queryString);
												if(rset.next()) {
													no_of_days = rset.getInt(1);
												}
									if(no_of_days<0)
										UnDelvAllocQtyNextMth=UnDelvAllocQtyNextMth+BalanceQty;
									////////////////////////^^^^^^^^^^^^^^////////////////////////

									/////SB20201121//////////////If contract closes before next month but Qty remains then//////////////////////////
									no_of_days=0;
									queryString = "SELECT TO_DATE('"+TO_DT.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+FirstDateNextMth+"','DD/MM/YYYY') FROM DUAL" ;
								//	System.out.println("STEP-6: Un DeLIVERED: DUAL: "+queryString);
												rset = stmt.executeQuery(queryString);
												if(rset.next()) {
													no_of_days = rset.getInt(1);
												}
									if(no_of_days<0)
										UnDelvAllocQtyNextMth=0;
									////////////////////////^^^^^^^^^^^^^^////////////////////////
									
						VUnDeliveredNextMth.add(nf.format(UnDelvAllocQtyNextMth)+AvgDcq);
						VUnDeliveredNextMthEndDt.add(FirstDateNextMth+"-"+ContEndDate);
					//	System.out.println(UnDelvAllocQtyNextMth+" CR: : Final Calculation: "+VExchgRate.elementAt(i)+"  : "+RATE.elementAt(i));
					//	System.out.println(UnDelvAllocQtyNextMth+" CR: : VPriceTypeDeal: "+VPriceTypeDeal.size()+"  : "+VPriceTypeDeal);
			
			//*SB20201121:For ForwarPrice			
			 	if(VPriceTypeDeal.elementAt(i).equals("FLOAT")) //SB20201112
							UnDelvAllocAmtNextMth=UnDelvAllocAmtNextMth+(UnDelvAllocQtyNextMth*Double.parseDouble(""+VPriceTypeDealRate.elementAt(i))*Double.parseDouble(""+VExchgRate.elementAt(i)));
						else 
							UnDelvAllocAmtNextMth=UnDelvAllocAmtNextMth+(UnDelvAllocQtyNextMth*Double.parseDouble(""+RATE.elementAt(i))*Double.parseDouble(""+VExchgRate.elementAt(i)));
						////////////////Transportation Charges For Next month//////////////////////////////////////
						UnDelvAllocAmtNextMth=UnDelvAllocAmtNextMth+UnDelvAllocQtyNextMth*Double.parseDouble(""+VTransValue.elementAt(i));
						///////////^^^^Transportation Charges to be included//////////////////////////////////////
									
						VUnDeliveredNextMthAmt.add(nf.format(UnDelvAllocAmtNextMth));

					FowardMth=NextMth;
			//		System.out.println("CR: EXPOSURE TRACKING REPORT: VUnDeliveredNextMthAmt: "+VUnDeliveredNextMthAmt);
				*//////////////////////////////////////////////////////////////////////////
				//	System.out.println(UnBilledReceivable+"<<<<<<<<<<    >>>>>>> "+AvgTaxInInv);
				double grossExposure=AccountReceivable+UnBilledReceivable; //System.out.println("CR: grossExposure: "+grossExposure);
		//SB20200921		double grossExposureInclTax=AccountNetReceivable+(UnBilledReceivable+UnBilledReceivable*(AvgTaxInInv/100));
				double grossExposureInclTax=grossExposure+grossExposure*(AvgTaxInInv/100);
			//SB20201118	grossExposureInclTax=40000; //SB20201118: for Testing Purpose of Collateral Linked Value
				//grossExposureInclTax=80000000;
				double collateralValue=0;
				double limitValue=0;
				double creditExceed=0;
				double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(i)); //HARSH20201119
				
				String DealUniqueId = (String) VDealUniqueId.elementAt(i); //HARSH20201119
				DealUniqueId=DealUniqueId.substring(1,DealUniqueId.length()); //HARSH20201119
				/*HARSH20201119 queryString ="SELECT SUM(VALUE) from FMS9_SECURITY_POST_MST "+
				" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND "
				+ "LINK LIKE '%"+DealUniqueId+"' AND APRV_BY IS NOT NULL AND FLAG='Y' AND RECEIVED='R' AND MAPPING_ID IS NULL ";*/
				
				/*HARSH20210215 queryString ="SELECT NVL(VALUE,0),CURRENCY from FMS9_SECURITY_POST_MST "+
				" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND "
				+ "LINK LIKE '%"+DealUniqueId+"' AND APRV_BY IS NOT NULL AND FLAG='Y' AND RECEIVED='R' AND MAPPING_ID IS NULL ";*/
	
				/*HARSH20210526 queryString ="SELECT NVL(VALUE,0),CURRENCY from FMS9_SECURITY_POST_MST "+
						" WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
						+ "LINK LIKE '"+VDealUniqueId.elementAt(i)+"' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NULL ";
				*/
				if(VContType.elementAt(i).equals("C")) //HARSH20210526
				{
					queryString ="SELECT NVL(VALUE,0),CURRENCY,SEC_TYPE from FMS9_SECURITY_POST_MST "+
							" WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "LINK LIKE '"+VDealUniqueId.elementAt(i)+"' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NULL ";
				}
				else //HARSH20210526
				{
					String DealId = VDealUniqueId.elementAt(i).toString();
					String fgsano = "0";
					String snno="0";
					if(!DealId.equals(""))
					{
						String dealid[] = DealId.split("-");
						fgsano = dealid[0].substring(1,dealid[0].length());
						snno = dealid[2]; 
					}
					queryString ="SELECT NVL(VALUE,0),CURRENCY,SEC_TYPE from FMS9_SECURITY_POST_MST "+
							" WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "LINK LIKE '"+VContType.elementAt(i)+""+fgsano+"-%-"+snno+"-%' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NULL ";
				}
				//HARSH20210526 NO NEED TO CHECK REV NO FOR SECURITY AS DISCUSSED WITH SHI TING IN TUESDAY MEETING 25/05/2021
				//HARSH20210415 MATCHING CANCEL_DT-1 
				//HARSH20210322 ONLY CHANGE FLAG CONDITION AFTER IMPLEMENTING AUTO EXPIRED
				//HARSH20210215 NOW WE USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
				//	System.out.println("FMS9_SECURITY_POST_MST: "+queryString);
				rset = stmt.executeQuery(queryString);				
				while(rset.next())
				{
					String currency= rset.getString(2)==null?"":rset.getString(2);
					if(currency.equals("USD"))
					{
						collateralValue+=rset.getDouble(1)*LastExchgRate;
					}
					else
					{
						collateralValue+=rset.getDouble(1);
					}
					//collateralValue=rset.getDouble(1);
				}
				String MappIdLinked=""; double LinkedValue=0;
				double TotalLinkedValue=0;//HARSH20210622
				String LinkedRefNo="";//HARSH20210622
				int countlink=0;//HARSH20210622
				
				/*HARSH20210215 queryString ="SELECT NVL(REF_NO,'*'), NVL(MAPPING_ID,''), VALUE,CURRENCY from FMS9_SECURITY_POST_MST "+  //Added Currency HARSH20201119
						" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND "
						+ "LINK LIKE '"+VDealUniqueId.elementAt(i)+"' AND APRV_BY IS NOT NULL AND FLAG='Y' AND RECEIVED='R' AND MAPPING_ID IS NOT NULL ";*/
					
				/*HARSH20210526queryString ="SELECT NVL(REF_NO,'*'), NVL(MAPPING_ID,''), VALUE,CURRENCY from FMS9_SECURITY_POST_MST "+  //Added Currency HARSH20201119
						" WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
						+ "LINK LIKE '"+VDealUniqueId.elementAt(i)+"' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NOT NULL ";
				*/
				if(VContType.elementAt(i).equals("C")) //HARSH20210526
				{
					queryString ="SELECT NVL(REF_NO,'*'), NVL(MAPPING_ID,''), VALUE,CURRENCY,SEC_TYPE from FMS9_SECURITY_POST_MST "+  //Added Currency HARSH20201119
							" WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "LINK LIKE '"+VDealUniqueId.elementAt(i)+"' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NOT NULL ";
				}
				else//HARSH20210526
				{
					String DealId = VDealUniqueId.elementAt(i).toString();
					String fgsano = "0";
					String snno="0";
					if(!DealId.equals(""))
					{
						String dealid[] = DealId.split("-");
						fgsano = dealid[0].substring(1,dealid[0].length());
						snno = dealid[2]; 
					}
					queryString ="SELECT NVL(REF_NO,'*'), NVL(MAPPING_ID,''), VALUE,CURRENCY,SEC_TYPE from FMS9_SECURITY_POST_MST "+  //Added Currency HARSH20201119
							" WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "LINK LIKE '"+VContType.elementAt(i)+""+fgsano+"-%-"+snno+"-%' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NOT NULL ";
					
				}
				//HARSH20210526 NO NEED TO CHECK REV NO FOR SECURITY AS DISCUSSED WITH SHI TING IN TUESDAY MEETING 25/05/2021
				//HARSH20210415 MATCHING CANCEL_DT-1 
				//HARSH20210322 ONLY CHANGE FLAG CONDITION AFTER IMPLEMENTING AUTO EXPIRED
				//HARSH20210215 NOW WE USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD	
				//	System.out.println("FMS9_SECURITY_POST_MST: "+queryString);
				rset = stmt.executeQuery(queryString);				
				while(rset.next())
				{
					countlink += 1; //HARSH20210622 FOR COUNTING THE LINK SECURITY
					//HARSH20210622 VCollateralRefLinked.add(rset.getString(1)==null?"":rset.getString(1));
					LinkedRefNo=rset.getString(1)==null?"":rset.getString(1); //HARSH20210622
					MappIdLinked=rset.getString(2)==null?"":rset.getString(2);
					LinkedValue=Double.parseDouble(""+rset.getString(3)==null?"0":rset.getString(3));
					String currency= rset.getString(4)==null?"":rset.getString(4);
					if(currency.equals("USD"))
					{
						LinkedValue = LinkedValue * LastExchgRate;
						//HARSH20210622 VCollateralValueLinked.add(nf.format(LinkedValue)); FOR MULTIPLE LINK SECURITY AS PER SHI TING MAIL ON 22/06/2021
						TotalLinkedValue+=LinkedValue;//HARSH20210622
					}
					else
					{
						//HARSH20210622 VCollateralValueLinked.add(nf.format(LinkedValue)); FOR MULTIPLE LINK SECURITY AS PER SHI TING MAIL ON 22/06/2021
						TotalLinkedValue+=LinkedValue;//HARSH20210622
					}
				}
				/*HARSH20210622 else
				{
					VCollateralRefLinked.add("");
					VCollateralValueLinked.add("");
				}*/
				
				HashMap<String, String> info = new HashMap<String, String>(); //HARSH20211229 AS PER INCIDENT#216
				link_cd.put(""+CUSTOMER_ABBR.elementAt(i), info);//HARSH20211229 AS PER INCIDENT#216
				
				if(countlink == 0) //HARSH20210622 FOR MULTIPLE LINK SECURITY AS PER SHI TING MAIL ON 22/06/2021
				{
					VCollateralRefLinked.add("");
					VCollateralValueLinked.add("");
				}
				else
				{
					if(countlink == 1)
					{
						VCollateralRefLinked.add(LinkedRefNo);
						VCollateralValueLinked.add(nf.format(TotalLinkedValue));//HARSH20210622 FOR MULTIPLE LINK SECURITY AS PER SHI TING MAIL ON 22/06/2021
					}
					else
					{
						VCollateralRefLinked.add("*");
						VCollateralValueLinked.add(nf.format(TotalLinkedValue));//HARSH20210622 FOR MULTIPLE LINK SECURITY AS PER SHI TING MAIL ON 22/06/2021
					}
				}
				
		/*SB20201031		if(VContType.elementAt(i).equals("C"))
					collateralValue=0;
					*/
			//SB20200915	double netExposure=collateralValue-limitValue-grossExposureInclTax;
			//SB20200918: as per Shi email	double netExposure=grossExposureInclTax-collateralValue-limitValue;
				double netExposure=grossExposureInclTax-collateralValue; //SB20200918: as per Shi email
				//HARSH20201119 double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(i));
				
			/*HARSH20210207	VGrossExposureAmt.add(nf.format(grossExposure));
				VGrossExposureAmtInclTax.add(nf.format(grossExposureInclTax));
				VCollateralValue.add(nf.format(collateralValue));*/
				/////////SB20201031/////////LIMIT CALCULATON///////////////////////////////////////
/*//				queryString ="SELECT SUM(AMT) from FMS9_LIMIT_DTL "+ //HARSH20201208 CHECK BUY OR SELL
//						" WHERE CUST_CD="+CUSTOMER_CD.elementAt(i)+" AND EFF_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL AND FLAG='Y' AND BUY_SELL='S'"; //HARSH20201124 Available Limit Reflect in Limit As Per Customer feedback on 24/11/2020
*/					
					queryString ="SELECT SUM(AMT) from FMS9_LIMIT_DTL "+ 
							" WHERE CUST_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND EFF_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') and inactivation_dt is null) or ((exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') or exp_dt is null) and inactivation_dt-1 >= to_date('"+to_date+"','DD/MM/YYYY'))) AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL"; //HARSH20201124 Available Limit Reflect in Limit As Per Customer feedback on 24/11/2020
					//HARSH20210130 ONLY CHANGE QUERY LOGIC AND "INACTIVATION_DT-1" AS PER CUSTOMER FEEDBACK ON 29/01/2021
					//HARSH20210127 NOW MATCH EXP_DT AND INACTIVATION_DT WHICH ONE IS LESS DATE THAT IS OUR EXPIRATION DAYE AS PER CUSTOMER FEEDBACK ON 27/01/2021
					//HARSH20210122 WE ADD CONDITION LIKE EXP_DT IS NULL AS PER CUSTOMER FEEDBACK NOW EXP_DT IS NOT MANDATORY FIELD
					//HARSH20210123  AND FLAG='Y'
					
					//	System.out.println(CUSTOMER_ABBR.elementAt(i)+" FMS9_LIMIT_DTL: "+queryString);
						rset = stmt.executeQuery(queryString);				
						while(rset.next())
						{
							limitValue=rset.getDouble(1);
						}
				 /////HARSH20210302/////PARENT LIMIT CALCULATION/////////////////////
				double percentageOwnship = 0;double parentlimitValue=0; //HARSH20201120
				String parent_abbr = "",limitParentFlag="N"; //HARSH20210302
				queryString="SELECT PARENT_OWNSHIP_ABBR FROM FMS9_LIMIT_MST"
						+ " WHERE CUST_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND PARENT_ENT_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND (PARENT_EXIT_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR PARENT_EXIT_DT IS NULL)";
						rset=stmt.executeQuery(queryString);
						if(rset.next())
						{
							parent_abbr = rset.getString(1)==null?"":rset.getString(1);
							limitParentFlag="Y";
						}
						VParentAbbr.add(parent_abbr);
						VLimitParentFlag.add(limitParentFlag);
				queryString ="SELECT SUM(AMT) from FMS9_LIMIT_DTL "+
						" WHERE CUST_ABBR='"+parent_abbr+"' AND EFF_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') and inactivation_dt is null) or ((exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') or exp_dt is null) and inactivation_dt-1 >= to_date('"+to_date+"','DD/MM/YYYY'))) AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL";
						rset=stmt.executeQuery(queryString);
						while(rset.next())
						{
							parentlimitValue = rset.getDouble(1);
							//System.out.println("parentlimitValue ::= "+parentlimitValue);
						}
						if(parentlimitValue > 0)
						{
							VParentLimitValue.add(nf.format(parentlimitValue));
						}else{
							VParentLimitValue.add("");
						}
				/////////////////////////////////////////////////////////////////////////////						
				////////////////////***SB20201031/////////////////////////////////////////////
				VLimitValueLinked.add(nf.format(limitValue)); //SB20201118
	//SB20201118			VLimitValue.add(nf.format(limitValue));
	//SB20201118			VNetExposure.add(nf.format(netExposure));
	/*SB20201118			if(netExposure>0) 
					//SB20200918: as per Shi email	creditExceed=netExposure;
					creditExceed=netExposure-limitValue; //SB20200918: as per Shi email
				VCreditExceed.add(nf.format(creditExceed));
				
				VNetExposureUSD.add(nf.format(netExposure/LastExchgRate));
				VCreditExceedUSD.add(nf.format(creditExceed/LastExchgRate));
				*/
				String PriorCurveGasPrice="";
			//	if(Double.parseDouble(""+VMthYrWisePriceICE_JKM.elementAt(i))>0)
					PriorCurveGasPrice="0";
				String DealPrice="";
				DealPrice=""+RATE.elementAt(i);
				String Slope="1.025";
				String GasDate=""+FRM_DT.elementAt(i);
		//SB20200919: It may require for Forward Pricing		MRCR_ContDtl2(Mapp_Id, Buy_Sell,PriceType, DealPrice, TCQ, Alloc_Qty, GasDate, Gen_Dt, Cont_End_Dt, Phy_CurFrd_Price, Fin_CurFrd_Price, Slope, PriorCurveGasPrice);
				////////////////////////////////////////////////
/////////////////////////////TCS Calculation//////////////////////////////
			String customer_cd=""+CUSTOMER_CD.elementAt(i); String fin_year="2020-2021"; 
			//////////////////////FY findings///////////////////////////////////
			int fin_yr = Integer.parseInt(to_date.substring(6));
			int fin_mon = Integer.parseInt(to_date.substring(3,5));
			if(fin_mon>3)
			{
				fin_year = ""+fin_yr+"-"+(fin_yr+1);
			}
			else
			{
				fin_year = ""+(fin_yr-1)+"-"+fin_yr;
				fin_yr=fin_yr-1;
			}
			if(fin_yr>=2020)
				Tcs_FY=fin_year;
			else
				Tcs_FY="N.A.";
			///////////////////////////////////////////////////////////////////////
			//For Testing			String customer_Invoice_Net_Amt_INR="4900000";//+grossExposureInclTax; //Only Unbilled Receivable
			String customer_Invoice_Net_Amt_INR=""+grossExposureInclTax; //Only Unbilled Receivable to be considered for TCS Calculation 
			String total_net_amt_finan=""; String dlng_total_net_amt_finan=""; 
			//System.out.println(customer_cd+"  Start of TCS >>>>>tot_diff_amt>> "+fin_year);
			//FIND TCS FECTOR FROM TABLE HARSH20210413
			double tcsFactor=0;
			queryString = "SELECT FACTOR FROM FMS7_TAX_STRUCTURE_DTL WHERE TAX_CODE = (SELECT TAX_CODE FROM FMS7_TAX_MST WHERE UPPER(TAX_NAME) = 'TCS') "
					+ "AND APP_DATE = (SELECT MAX(APP_DATE) FROM FMS7_TAX_STRUCTURE_DTL WHERE APP_DATE <= TO_DATE('"+to_date+"','DD/MM/YYYY'))";
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				tcsFactor = rset.getDouble(1);
			}
			if(tcsFactor <= 0)
			{
				tcsFactor=0.00075;
			}
			/////////////////////////////
			String tot_diff_amt="0"; String tcs_app_flag="Y"; double tcs_limit_amt=5000000; double tot_amt=0; double TCSamt=0;
			if(!VContType.elementAt(i).equals("C") && fin_yr>=2020)
			{
				queryString="SELECT HLPL_INV_SEQ_NO FROM FMS7_INVOICE_TCS_DTL WHERE CUSTOMER_CD='"+customer_cd+"' "
				+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y'  ";
			//		System.out.println("FMS7_INVOICE_TCS_DTL-DLNG-"+queryString);
				rset=stmt.executeQuery(queryString);
				if(rset.next())
				{
					tcs_app_flag="Y";
					tot_diff_amt=customer_Invoice_Net_Amt_INR.replace(",","");
				}
				else   ///For First time TCS applicable during the FY
				{
				//For DLNG
					queryString="SELECT nvl(SUM(NET_AMT_INR),'0') FROM DLNG_INVOICE_MST WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
					+ "AND FINANCIAL_YEAR='"+fin_year+"' AND HLPL_INV_SEQ_NO NOT IN (SELECT B.HLPL_INV_SEQ_NO FROM DLNG_DR_CR_NOTE B WHERE B.CONTRACT_TYPE IN ('S','L') "
					+ "	AND B.CUSTOMER_CD='"+customer_cd+"' AND B.FINANCIAL_YEAR='"+fin_year+"' AND B.CRITERIA ='REV_INV' AND "
					+ "B.DR_CR_FLAG='cr' AND B.APRV_BY IS NOT NULL) ";
			//		System.out.println("queryString-DLNG-"+queryString);
					rset=stmt.executeQuery(queryString);
					if(rset.next()){
						queryString1="SELECT nvl(SUM(DR_CR_NET_AMT_INR),'0') FROM DLNG_DR_CR_NOTE WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
								+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y' AND DR_CR_FLAG='dr' AND APRV_BY IS NOT NULL ";
							//System.out.println("queryString--"+queryString1);
							rset1=stmt1.executeQuery(queryString1);
							if(rset1.next()){
								dlng_total_net_amt_finan=nf.format(Double.parseDouble(rset.getString(1)==null?"":rset.getString(1))+Double.parseDouble(rset1.getString(1)==null?"":rset1.getString(1)));
							}
							else
							{
								dlng_total_net_amt_finan = rset.getString(1)==null?"0":rset.getString(1);
							}
				
					//tot_diff_amt=customer_Invoice_Net_Amt_INR.replace(",","");
				}
			//
			//queryString="SELECT SUM(NET_AMT_INR) FROM FMS7_INVOICE_MST WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
			//+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y' ";
			queryString="SELECT nvl(SUM(NET_AMT_INR),'0') + "+dlng_total_net_amt_finan+" FROM FMS7_INVOICE_MST WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
			+ "AND FINANCIAL_YEAR='"+fin_year+"' AND HLPL_INV_SEQ_NO NOT IN (SELECT B.HLPL_INV_SEQ_NO FROM FMS7_DR_CR_NOTE B WHERE B.CONTRACT_TYPE IN ('S','L') "
			+ "	AND B.CUSTOMER_CD='"+customer_cd+"' AND B.FINANCIAL_YEAR='"+fin_year+"' AND B.CRITERIA ='REV_INV' AND "
			+ "B.DR_CR_FLAG='cr' AND B.APRV_BY IS NOT NULL) AND HLPL_INV_SEQ_NO NOT IN (SELECT C.HLPL_INV_SEQ_NO FROM FMS7_MANUAL_DR_CR_NOTE C WHERE "
			+ "C.CONTRACT_TYPE IN ('S','L') AND C.CUSTOMER_CD='"+customer_cd+"' "
			+ "AND C.FINANCIAL_YEAR='"+fin_year+"' AND C.CRITERIA ='REV_INV' AND C.DR_CR_FLAG='cr' AND C.APRV_BY IS NOT NULL) ";
			//	System.out.println("queryString--"+queryString);
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				//total_net_amt_finan=rset.getDouble(1);
				queryString1="SELECT nvl(SUM(DR_CR_NET_AMT_INR),'0') FROM FMS7_DR_CR_NOTE WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
					+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y' AND DR_CR_FLAG='dr' AND APRV_BY IS NOT NULL ";
			//		System.out.println("queryString--"+queryString1);
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
				total_net_amt_finan=nf.format(Double.parseDouble(rset.getString(1)==null?"":rset.getString(1))+Double.parseDouble(rset1.getString(1)==null?"":rset1.getString(1)));
			}
			else
			{
				total_net_amt_finan=nf.format(Double.parseDouble(rset.getString(1)==null?"":rset.getString(1)));
			}
			//for getting manual invoice
			queryString1="SELECT nvl(SUM(NET_AMT_INR),'0') FROM FMS7_MANUAL_INVOICE_MST WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
				+ "AND FINANCIAL_YEAR='"+fin_year+"' AND HLPL_INV_SEQ_NO NOT IN (SELECT B.HLPL_INV_SEQ_NO FROM FMS7_DR_CR_NOTE B WHERE B.CONTRACT_TYPE IN ('S','L') "
				+ "	AND B.CUSTOMER_CD='"+customer_cd+"' AND B.FINANCIAL_YEAR='"+fin_year+"' AND B.CRITERIA ='REV_INV' AND "
				+ "B.DR_CR_FLAG='cr' AND B.APRV_BY IS NOT NULL) AND HLPL_INV_SEQ_NO NOT IN (SELECT C.HLPL_INV_SEQ_NO FROM FMS7_MANUAL_DR_CR_NOTE C WHERE "
				+ "C.CONTRACT_TYPE IN ('S','L') AND C.CUSTOMER_CD='"+customer_cd+"' "
				+ "AND C.FINANCIAL_YEAR='"+fin_year+"' AND C.CRITERIA ='REV_INV' AND C.DR_CR_FLAG='cr' AND C.APRV_BY IS NOT NULL) ";
			//	System.out.println("queryString1--"+queryString1);
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				total_net_amt_finan=nf.format(Double.parseDouble(total_net_amt_finan)+Double.parseDouble(rset1.getString(1)==null?"":rset1.getString(1)));
			}
			//
			//FOR GETTING DEBIT NOTE FROM MANUAL TABLE 
			queryString1="SELECT nvl(SUM(DR_CR_NET_AMT_INR),'0') FROM FMS7_MANUAL_DR_CR_NOTE WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
				+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y' AND DR_CR_FLAG='dr' AND APRV_BY IS NOT NULL ";
			//	System.out.println("queryString--"+queryString1);
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				total_net_amt_finan=nf.format(Double.parseDouble(total_net_amt_finan)+Double.parseDouble(rset1.getString(1)==null?"":rset1.getString(1)));
			}
			//
			//FOR GETTING CREDIT NOTE FROM TABLE 
			queryString1="SELECT nvl(SUM(DR_CR_NET_AMT_INR),'0') FROM FMS7_DR_CR_NOTE WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
				+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y' AND DR_CR_FLAG='cr' and criteria!='REV_INV' AND APRV_BY IS NOT NULL ";
			//	System.out.println("queryString--"+queryString1);
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				total_net_amt_finan=nf.format(Double.parseDouble(total_net_amt_finan)-Double.parseDouble(rset1.getString(1)==null?"":rset1.getString(1)));
			}
			//
			//FOR GETTING CREDIT NOTE FROM TABLE 
			queryString1="SELECT nvl(SUM(DR_CR_NET_AMT_INR),'0') FROM FMS7_MANUAL_DR_CR_NOTE WHERE CONTRACT_TYPE IN ('S','L') AND CUSTOMER_CD='"+customer_cd+"' "
				+ "AND FINANCIAL_YEAR='"+fin_year+"' AND FLAG='Y' AND DR_CR_FLAG='cr' and criteria!='REV_INV' AND APRV_BY IS NOT NULL  ";
			//System.out.println("queryString--"+queryString1);
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next()){
				total_net_amt_finan=nf.format(Double.parseDouble(total_net_amt_finan)-Double.parseDouble(rset1.getString(1)==null?"":rset1.getString(1)));
			}
			
			//
			//System.out.println("total_net_amt_finan--"+total_net_amt_finan+"----"+customer_Invoice_Net_Amt_INR);
			if(Double.parseDouble(total_net_amt_finan)>tcs_limit_amt)
			{
			//	System.out.println("total_net_amt_finan-in if-"+total_net_amt_finan);
				tcs_app_flag="Y";
				tot_diff_amt=customer_Invoice_Net_Amt_INR.replace(",","");
			}
			else
			{
			//System.out.println("total_net_amt_finan in this else--"+total_net_amt_finan+"----"+customer_Invoice_Net_Amt_INR);
				if(!customer_Invoice_Net_Amt_INR.equals(""))
				{
					tot_amt=Double.parseDouble(customer_Invoice_Net_Amt_INR.replace(",",""))+Double.parseDouble(total_net_amt_finan);
				//	System.out.println("Total TCS-Taxable Amoun: "+tot_amt);
					if(tot_amt>tcs_limit_amt){
						tcs_app_flag="Y";
						tot_diff_amt=nf.format(tot_amt-tcs_limit_amt);
					}
				}
			//invoice_total_tax=nf3.format(total_tax_amt);
			//customer_Invoice_Net_Amt_INR = nf3.format(total_tax_amt+Double.parseDouble(temp_gross_amt_inr));
			}
			}
			else
			{
				//System.out.println("dlng_total_net_amt_finan--"+dlng_total_net_amt_finan+"----"+customer_Invoice_Net_Amt_INR);
				if(Double.parseDouble(dlng_total_net_amt_finan)>tcs_limit_amt){
				//System.out.println("dlng_total_net_amt_finan-in if-"+dlng_total_net_amt_finan);
				tcs_app_flag="Y";
				tot_diff_amt=customer_Invoice_Net_Amt_INR.replace(",","");
				}
				else
				{
					if(!customer_Invoice_Net_Amt_INR.equals("")){
						tot_amt=Double.parseDouble(customer_Invoice_Net_Amt_INR.replace(",",""))+Double.parseDouble(dlng_total_net_amt_finan)+UnBilledReceivable;
						//System.out.println("tot_amt--"+tot_amt);
						if(tot_amt>tcs_limit_amt){
							tcs_app_flag="Y";
							tot_diff_amt=nf.format(tot_amt-tcs_limit_amt);
						}
					}
					//invoice_total_tax=nf3.format(total_tax_amt);
					//customer_Invoice_Net_Amt_INR = nf3.format(total_tax_amt+Double.parseDouble(temp_gross_amt_inr));
					}
				}
			}
				TCSamt=Double.parseDouble(tot_diff_amt)*tcsFactor;
				VTcsGrossAmtFY.add(""+tot_amt);
				VTcsApplicableAmt.add((tot_diff_amt));
				VTcsAmt.add(nf.format(TCSamt));
			}
			else
			{
				VTcsGrossAmtFY.add("");
				VTcsApplicableAmt.add("N.A.");
				VTcsAmt.add("");
			}			
				//System.out.println(tcs_limit_amt+"  End of TCS >>>>>tot_diff_amt>> "+tot_diff_amt);
				/////////////////SB20210126: shifted here to include TCS/////////////////////////////////////////////////
				VGrossExposureAmt.add(nf.format(grossExposure));
				grossExposureInclTax=grossExposureInclTax+TCSamt; //SB20210126: added TCS
				VGrossExposureAmtInclTax.add(nf.format(grossExposureInclTax));
				VCollateralValue.add(nf.format(collateralValue));
			///////////////////////////////////////////////////////////////////////////
			   }
			//	System.out.println(VPriceTypeDealRate.size()+"  NEXT MONTH >>>>>VPriceTypeDealRate>> "+VPriceTypeDealRate);
			//	System.out.println(VPriceTypeDealRateA.size()+" ********:CURRENT MTH: VPriceTypeDealRateA: "+VPriceTypeDealRateA);	
			//	System.out.println(VBilledReceivableDtl.size()+"  <<VBilledReceivableDtl>> \n"+VBilledReceivableDtl); //SB20201206
			   sup_tot_comitment=nf.format(sup_tot_comit);
			   bal_tot_comitment=nf.format(bal_tot_comit);
			   
			   //Introduce by Milan 20010916
			   sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			   bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			//--------Logic for Re-Gas based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
	
			//CR_CollateralCalculation();//HARSH20210207
			CR_CollateralCalculation_V2(); //HARSH20211229 AS PER INCIDENT#216	
		}	
	}	
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchEligibleCargoList()-->"+e);
			  e.printStackTrace();
		}
	}
	public void Fetch_Deal_Dtls()
	{
		try
		{	
			//System.out.println("in it method");
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			//Introduce By Milan 20110916 FOR MMSCM
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();						
			Vector RE_GAS_REV_NO=new Vector();
			Vector LTCORA_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector LTCORA_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,"
					+ "A.FGSA_REV_NO,A.TCQ, " +
	 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,to_char(A.ENT_DT,'dd/mm/yyyy'),EMP_CD,A.DCQ from FMS7_SN_MST A where "+ 
	 		"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
	 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
	 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";
			
			//System.out.println("For SN"+queryString);
			rset = stmt.executeQuery(queryString);
			//System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{				
				//System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));
				
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				//CARGO_ARRIVAL_DATE.add(temp_dt);	
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add(rset.getString(6)==null?"0":rset.getString(6));
			  	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
				//RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
			  	//BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	//BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
			  	//SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
			  //	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	
			  	////////////RG20190319////////For New Report///////////////////////
			  /*	String query1="SELECT CARGO_REF_NO FROM FMS7_SN_CARGO_DTL A WHERE SN_NO='"+rset.getString(9)+"' AND "
					  			+ "CUSTOMER_CD='"+rset.getString(5)+"' AND FGSA_NO='"+rset.getString(6)+"' AND " +
						 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_CARGO_DTL B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
						 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) AND " +
						 		"A.FGSA_REV_NO=(SELECT MAX(c.FGSA_REV_NO) FROM FMS7_SN_CARGO_DTL c where A.SN_NO=c.SN_NO AND A.FGSA_NO=c.FGSA_NO AND " +
						 		"A.CUSTOMER_CD=c.CUSTOMER_CD AND A.FGSA_REV_NO=c.FGSA_REV_NO)  ";
			  System.out.println("query1............"+query1);
			  	rset3=stmt3.executeQuery(query1);
			  	while(rset3.next()){*/
			  	System.out.println("--rset.getString(3)---"+rset.getString(3));
			  	
			  	String queryString1="SELECT SUM(GROSS_AMT_INR) FROM FMS7_INVOICE_MST WHERE FGSA_NO='"+rset.getString(6)+"' AND CONTRACT_TYPE='S' AND "
			  			+ "SN_NO='"+rset.getString(3)+"' AND (PERIOD_START_DT <=to_date('"+to_date+"','dd/mm/yyyy') AND PERIOD_END_DT >= "
			  					+ "TO_DATE('"+from_date+"','dd/mm/yyyy'))";
				System.out.println(""+queryString1);
			  	rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_wout_tax.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_wout_tax.add("0.00");
				}
				
				queryString1="SELECT SUM(NET_AMT_INR) FROM FMS7_INVOICE_MST WHERE FGSA_NO='"+rset.getString(6)+"' AND CONTRACT_TYPE='S' AND "
			  			+ "SN_NO='"+rset.getString(3)+"' AND (PERIOD_START_DT <=to_date('"+to_date+"','dd/mm/yyyy') AND PERIOD_END_DT >= "
			  					+ "TO_DATE('"+from_date+"','dd/mm/yyyy')) AND (PAY_RECV_DT IS NULL AND PAY_RECV_AMT IS NULL)";
				System.out.println(""+queryString1);
			  	rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_PAY_NOT_RECV.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_PAY_NOT_RECV.add("0.00");
				}
			  		
			  		String query="SELECT COUNT(*) FROM FMS7_SN_MST WHERE (sysdate BETWEEN TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy') and TO_DATE('"+tmp_to_dt+"','dd/mm/yyyy')) AND " +
			  				"SN_REV_NO='"+rset.getString(4)+"' and SN_NO='"+rset.getString(3)+"' and FGSA_NO='"+rset.getString(6)+"' and FGSA_REV_NO='"+rset.getString(7)+"' ";
			  	//System.out.println("query........."+query);
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		if(rset1.getInt(1)>0){
			  			Deal_sts.add("Active");
			  		}else{
			  		 	String query2="SELECT COUNT(*) FROM FMS7_SN_MST WHERE (sysdate < TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy')) AND " +
				  				"SN_REV_NO='"+rset.getString(4)+"' and SN_NO='"+rset.getString(3)+"' and FGSA_NO='"+rset.getString(6)+"' and FGSA_REV_NO='"+rset.getString(7)+"' ";
				  	//System.out.println("query........."+query2);
			  			rset2=stmt2.executeQuery(query2);
			  			if(rset2.next()){
				  			if(rset2.getInt(1)>0){
					  			Deal_sts.add("Yet To Start");
					  		}else{
					  			Deal_sts.add("InActive");
					  		}
			  			}
			  		}
			  	}
			  	
			  	Deal_cust_cd.add(rset.getString(5)==null?"0":rset.getString(5));
				Deal_ST_DT.add(tmp_from_dt);
				Deal_END_DT.add(tmp_to_dt);
				Deal_NO.add(rset.getString(6)==null?"0":rset.getString(6));
				Deal_typ.add("SN");
				Deal_typ_nm.add("Supply Notice");
			  	Deal_qty_booked.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	Deal_cargo_seq_no.add("-");
			  	Deal_Signing_dt.add(rset.getString(10)==null?"0":rset.getString(10));
			  	Deal_Price.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
			  	Deal_curr.add("2");
				Deal_ENT_DT.add(rset.getString(12)==null?"":rset.getString(12));
				Deal_DCQ.add(rset.getString(14)==null?"0.00":nf.format(Double.parseDouble(rset.getString(14))));
				Deal_cont_no.add(rset.getString(3)==null?"":rset.getString(3));
				Deal_adv_amt.add("N.A");
				
				query="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+rset.getString(13)+"'";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_ENT_BY.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_ENT_BY.add("");
			  	}
			  	query="	select to_date('"+tmp_to_dt+"','dd/mm/yyyy') - to_date('"+tmp_from_dt+"','dd/mm/yyyy')+1 from dual";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_duration.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_duration.add("");
			  	}
			  	}
			  	
			  	
			  
			  
			//}	
			
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				//System.out.println(queryString);
				if(rset.next())
				{
					Deal_cust_nm.add(rset.getString(2)==null?"":rset.getString(2));
					Deal_cust_abbr.add(rset.getString(1)==null?"":rset.getString(1));	
				}
				else
				{
					Deal_cust_nm.add("");
					Deal_cust_abbr.add("");
				}												
			
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+SN_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" " +
				 "AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					Deal_qty_Supplied.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
				}
				else
				{
					Deal_qty_Supplied.add("0.00");
				}
		   }
		 
		    //--------Logic for Tender and LOA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			FRM_DT.clear();
			TO_DT.clear();
			
			//Upadated By Milan 20110921
			queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,TO_CHAR(A.ENT_DT,'DD/MM/YYYY'),A.EMP_CD,A.DCQ from FMS7_LOA_MST A where "+ 
				"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
				"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
				"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			rset = stmt.executeQuery(queryString);
//			System.out.println(queryString);
			while(rset.next())
			{				
				LOA_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				LOA_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LOA_CARGO_ARRIVAL_DATE.add(temp_dt);				
				LOA_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	TENDER_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	LOA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	loa_tot_commitment=nf.format(tot_comit) ;
			  	LOA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	loa_tot_commitment_mmscm=nf.format(tot_comit_mmscm) ;
			  	LOA_REF_NO.add(rset.getString(8)==null?"0":rset.getString(8));
			  	LOA_SIGNING_DT.add(rset.getString(9)==null?"":rset.getString(9));
			  	LOA_RATE.add(nf2.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));
			  	
				////////////RG20190319////////For New Report///////////////////////
			  	//System.out.println("---TENDER_NO--"+TENDER_NO+"---LOA_NO---"+LOA_NO);
			  	String queryString1="SELECT SUM(GROSS_AMT_INR) FROM FMS7_INVOICE_MST WHERE FGSA_NO='"+rset.getString(6)+"' AND CONTRACT_TYPE='L' and sn_no='"+rset.getString(3)+"'"
			  			+ " AND (PERIOD_START_DT <=to_date('"+to_date+"','dd/mm/yyyy') AND PERIOD_END_DT >= "
			  					+ "TO_DATE('"+from_date+"','dd/mm/yyyy'))";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_wout_tax.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_wout_tax.add("0.00");
				}
				queryString1="SELECT SUM(NET_AMT_INR) FROM FMS7_INVOICE_MST WHERE FGSA_NO='"+rset.getString(6)+"' AND CONTRACT_TYPE='L' and sn_no='"+rset.getString(3)+"'"
			  			+ " AND (PERIOD_START_DT <=to_date('"+to_date+"','dd/mm/yyyy') AND PERIOD_END_DT >= "
			  					+ "TO_DATE('"+from_date+"','dd/mm/yyyy')) AND (PAY_RECV_DT IS NULL AND PAY_RECV_AMT IS NULL)";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_PAY_NOT_RECV.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_PAY_NOT_RECV.add("0.00");
				}
				
				
			  	String query="SELECT COUNT(*) FROM FMS7_LOA_MST WHERE (sysdate BETWEEN TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy') and TO_DATE('"+tmp_to_dt+"','dd/mm/yyyy')) AND " +
		  				"LOA_REV_NO='"+rset.getString(4)+"' and LOA_NO='"+rset.getString(3)+"' and TENDER_NO='"+rset.getString(6)+"' ";
			  	//System.out.println("query........."+query);
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		if(rset1.getInt(1)>0){
			  			Deal_sts.add("Active");
			  		}else{
			  		 	String query1="SELECT COUNT(*) FROM FMS7_LOA_MST WHERE (sysdate < TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy')) AND " +
		  				"LOA_REV_NO='"+rset.getString(4)+"' and LOA_NO='"+rset.getString(3)+"' and TENDER_NO='"+rset.getString(6)+"' ";
				  	//System.out.println("query........."+query1);
			  			rset2=stmt2.executeQuery(query1);
			  			if(rset2.next()){
				  			if(rset2.getInt(1)>0){
					  			Deal_sts.add("Yet To Start");
					  		}else{
					  			Deal_sts.add("InActive");
					  		}
			  			}
			  		}
			  	}
			  	Deal_cust_cd.add(rset.getString(5)==null?"0":rset.getString(5));
				Deal_ST_DT.add(tmp_from_dt);
				Deal_END_DT.add(tmp_to_dt);
				Deal_NO.add(rset.getString(6)==null?"0":rset.getString(6));
				Deal_typ.add("LOA");
				Deal_typ_nm.add("LOA");
			  	Deal_qty_booked.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	Deal_cargo_seq_no.add("");
			  	Deal_Signing_dt.add(rset.getString(9)==null?"0":rset.getString(9));
			  	Deal_Price.add(nf2.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));
				Deal_curr.add("2");
				Deal_ENT_DT.add(rset.getString(11)==null?"":rset.getString(11));
				Deal_DCQ.add(rset.getString(13)==null?"0.00":nf.format(Double.parseDouble(rset.getString(13))));
				Deal_adv_amt.add("N.A");
				Deal_cont_no.add(rset.getString(3)==null?"":rset.getString(3));
				
				query="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+rset.getString(12)+"'";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_ENT_BY.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_ENT_BY.add("");
			  	}
			  	query="	select to_date('"+tmp_to_dt+"','dd/mm/yyyy') - to_date('"+tmp_from_dt+"','dd/mm/yyyy')+1 from dual";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_duration.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_duration.add("");
			  	}
			}
			
			for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				//System.out.println("LOA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					Deal_cust_nm.add(rset.getString(2)==null?"":rset.getString(2));
					Deal_cust_abbr.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					Deal_cust_nm.add("");
					Deal_cust_abbr.add("");
				}		
				
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LOA_NO.elementAt(i)+" AND FGSA_NO="+TENDER_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='L'";
				rset = stmt.executeQuery(queryString);
				//System.out.println("LOA_QTY_MMBTU = "+queryString);
				if(rset.next())
				{
					Deal_qty_Supplied.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
				}
				else
				{
					Deal_qty_Supplied.add("0.00");
				}				
		   }
			//--------Logic for Re-Gas based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			FRM_DT.clear();
			TO_DT.clear();
			/*queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF " +
	 					  "from FMS7_RE_GAS_CARGO_DTL A where (A.CONTRACT_START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
	 					  "OR A.CONTRACT_END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
	 		              "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
	 		              "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";*/
			
			//Updated By Milan 20110921
			queryString = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'),A.RE_GAS_NO,A.RE_GAS_REV_NO,A.CUSTOMER_CD"
					+ ",A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.RE_GAS_TARIF,DCQ_QTY " +
			  "from FMS7_RE_GAS_CARGO_DTL A where "+ 
			  "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
             "A.RE_GAS_REV_NO=(SELECT MAX(B.RE_GAS_REV_NO) FROM FMS7_RE_GAS_CARGO_DTL B where A.RE_GAS_NO=B.RE_GAS_NO AND A.RE_GAS_REV_NO=B.RE_GAS_REV_NO AND " +
             "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.CARGO_SEQ_NO=B.CARGO_SEQ_NO) order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				RE_GAS_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				RE_GAS_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));
				RE_GAS_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				RE_GAS_CARGO_ARRIVAL_DATE.add(temp_dt);											  
				RE_GAS_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				RE_GAS_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));	
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	re_gas_tot_commit=""+ nf.format(tot_comit) ;
			  	//MD20110917
			  	RE_GAS_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	re_gas_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	REGAS_RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	
			  	///////////RG20190320////for deal summary report////
			  	
				String queryString1="SELECT SUM(GROSS_AMT_INR) FROM FMS7_INVOICE_MST WHERE FGSA_NO='"+rset.getString(3)+"' AND CONTRACT_TYPE='R' and sn_no='"+rset.getString(6)+"'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_wout_tax.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_wout_tax.add("0.00");
				}
				queryString1="SELECT SUM(NET_AMT_INR) FROM FMS7_INVOICE_MST WHERE FGSA_NO='"+rset.getString(3)+"' AND CONTRACT_TYPE='R'"
						+ " and sn_no='"+rset.getString(6)+"' AND (PAY_RECV_DT IS NULL AND PAY_RECV_AMT IS NULL)";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_PAY_NOT_RECV.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_PAY_NOT_RECV.add("0.00");
				}
				
			  	String query="SELECT COUNT(*) FROM FMS7_RE_GAS_CARGO_DTL WHERE (sysdate BETWEEN TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy') and TO_DATE('"+tmp_to_dt+"','dd/mm/yyyy')) AND " +
			  				"RE_GAS_REV_NO='"+rset.getString(4)+"' and RE_GAS_NO='"+rset.getString(3)+"' ";
			  	//System.out.println("query........."+query);
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		if(rset1.getInt(1)>0){
			  			Deal_sts.add("Active");
			  		}else{
			  		 	String query1="SELECT COUNT(*) FROM FMS7_RE_GAS_CARGO_DTL WHERE (sysdate < TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy')) AND " +
			  				"RE_GAS_REV_NO='"+rset.getString(4)+"' and RE_GAS_NO='"+rset.getString(3)+"' ";
				  	//System.out.println("query........."+query1);
			  			rset2=stmt2.executeQuery(query1);
			  			if(rset2.next()){
				  			if(rset2.getInt(1)>0){
					  			Deal_sts.add("Yet To Start");
					  		}else{
					  			Deal_sts.add("InActive");
					  		}
			  			}
			  		}
			  	}
			  	
			  	Deal_cust_cd.add(rset.getString(5)==null?"0":rset.getString(5));
				Deal_ST_DT.add(tmp_from_dt);
				Deal_END_DT.add(tmp_to_dt);
				
				Deal_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				Deal_typ.add("Re-Gas");
				Deal_typ_nm.add("Re-Gas");
			  	Deal_qty_booked.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	Deal_cargo_seq_no.add(rset.getString(6)==null?"0":rset.getString(6));
			  	//Deal_Signing_dt.add(rset.getString(10)==null?"0":rset.getString(10));
			  	Deal_Price.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
				Deal_curr.add("2");
				//Deal_ENT_DT.add(rset.getString(12)==null?"":rset.getString(12));
				Deal_DCQ.add(rset.getString(9)==null?"0.00":nf.format(Double.parseDouble(rset.getString(9))));
				Deal_adv_amt.add("N.A");
				Deal_cont_no.add(rset.getString(3)==null?"":rset.getString(3));
				
			  	query="	select to_date('"+tmp_to_dt+"','dd/mm/yyyy') - to_date('"+tmp_from_dt+"','dd/mm/yyyy')+1 from dual";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_duration.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_duration.add("");
			  	}
			  	/////////////////////////////////////
			}			
			
			for(int i=0;i<RE_GAS_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				//System.out.println("RE_GAS_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					Deal_cust_nm.add(rset.getString(2)==null?"":rset.getString(2));
					Deal_cust_abbr.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					Deal_cust_nm.add("");
					Deal_cust_abbr.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY'),TO_CHAR(ENT_DT,'DD/MM/YYYY'),EMP_CD FROM FMS7_RE_GAS_MST A " +
							  "WHERE A.RE_GAS_NO='"+RE_GAS_NO.elementAt(i)+"' AND " +
							  "A.REV_NO='"+RE_GAS_REV_NO.elementAt(i)+"' AND " +
							  "A.CUSTOMER_CD='"+RE_GAS_CUSTOMER_CD.elementAt(i)+"' ";			 
				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
				  	Deal_Signing_dt.add(rset.getString(1)==null?"":rset.getString(1));
				  	Deal_ENT_DT.add(rset.getString(2)==null?"":rset.getString(2));
				  	
				  	String query="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+rset.getString(3)+"'";
				  	rset1=stmt1.executeQuery(query);
				  	if(rset1.next()){
				  		Deal_ENT_BY.add(rset1.getString(1)==null?"":rset1.getString(1));
				  	}else{
				  		Deal_ENT_BY.add("");
				  	}
				}
				else
				{
					Deal_Signing_dt.add("");
					Deal_ENT_DT.add("");
					Deal_ENT_BY.add("");
				}
	
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";

				//System.out.println("RE_GAS_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					Deal_qty_Supplied.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
				}
				else
				{
					Deal_qty_Supplied.add("0.00");
				}				
				RE_GAS_BALANCEMMBTU.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+RE_GAS_BOOKMMBTU.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMBTU.elementAt(i));
				//MD20110917
				RE_GAS_BALANCEMMSCM.add(nf.format(Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit_mmscm+=Double.parseDouble(""+RE_GAS_BOOKMMSCM.elementAt(i))- Double.parseDouble(""+RE_GAS_SUPPLIEDMMSCM.elementAt(i));
		   }
			re_gas_sup_tot_comitment=nf.format(sup_tot_comit);
			re_gas_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			re_gas_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			re_gas_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			
//			System.out.println("re_gas_sup_tot_comitment_mmscm"+re_gas_sup_tot_comitment_mmscm);
//			System.out.println("re_gas_bal_tot_comitment_mmscm"+re_gas_bal_tot_comitment_mmscm);
			
			//////**********ADDED FOR LTCORA AND CN
			//--------Logic for LTCORA based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			
			
			FRM_DT.clear();
			TO_DT.clear();


			/////*** beLOW CODE IS CHANGED FOR PERIOD IN PLCAE OF LTCORA ***////
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
			"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
			"C.REV_NO,to_char(C.ENT_DT,'dd/mm/yyyy'),C.ENT_BY,A.DCQ_QTY,A.TARIFF_CUR_FLAG from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
			"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
			"A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
			"AND C.CN_NO!='0' AND CN_NO >'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
			"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO >'9999' AND " +
			"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
			"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
			"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +
			"order by A.CONTRACT_START_DT";
			
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{				
				
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[3];
				String temp_ag_no=tempmap_id[1];
				String temp_ag_rev_no=tempmap_id[2];//RG20190530
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
				LTCORA_MAPPING_ID.add(map_id);
				LTCORA_NO.add(temp_regas_no);
				LTCORA_REV_NO.add(temp_regas_rev_no);
				LTCORA_CUSTOMER_CD.add(temp_cust_cd);
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				LTCORA_CARGO_ARRIVAL_DATE.add(temp_dt);		
				LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));
				LTCORA_RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
				
//			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
//			  	LTCORA_tot_commit=""+ nf.format(tot_comit) ;
			  	//LTCORA_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
//			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  //LTCORA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
//			  	LTCORA_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	
			  	///////////////////RG20190320//////For deal summary report//////////////

				String queryString1="SELECT SUM(GROSS_AMT_INR) FROM FMS7_INVOICE_MST WHERE mapping_id='"+map_id+"' AND CONTRACT_TYPE='C' and sn_no='"+rset.getString(6)+"'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_wout_tax.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_wout_tax.add("0.00");
				}
				queryString1="SELECT SUM(NET_AMT_INR) FROM FMS7_INVOICE_MST WHERE mapping_id='"+map_id+"' AND CONTRACT_TYPE='C' "
						+ "and sn_no='"+rset.getString(6)+"' AND (PAY_RECV_DT IS NULL AND PAY_RECV_AMT IS NULL)";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_PAY_NOT_RECV.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_PAY_NOT_RECV.add("0.00");
				}
				System.out.println("mapp id..."+tempmap_id[0]+"-"+tempmap_id[3]+"-"+tempmap_id[4]+"-"+rset.getString(6)+"-0-C");
				String temp_mappingid=tempmap_id[0]+"-"+tempmap_id[3]+"-"+tempmap_id[4]+"-"+rset.getString(6)+"-0-C";
				
				queryString1="SELECT PRICE_RATE FROM FMS7_CONT_PRICE_DTL WHERE mapping_id='"+temp_mappingid+"' AND LTCORA_NO='"+temp_ag_no+"' AND LTCORA_REV_NO='"+temp_ag_rev_no+"'"
						+ " AND PRICE_CD='1' ";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_adv_amt.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_adv_amt.add("-");
				}
				
				
				String query="SELECT COUNT(*) FROM FMS8_LNG_REGAS_MST WHERE (sysdate BETWEEN TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy') and TO_DATE('"+tmp_to_dt+"','dd/mm/yyyy')) AND " +
		  				"Agreement_no='"+temp_ag_no+"' and CN_NO='"+temp_regas_no+"' and mapping_id='"+rset.getString(3)+"' and customer_cd='"+temp_cust_cd+"'";
			  	//System.out.println("query........."+query);
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		if(rset1.getInt(1)>0){
			  			Deal_sts.add("Active");
			  		}else{
			  		 	String query1="SELECT COUNT(*) FROM FMS8_LNG_REGAS_MST WHERE (sysdate < TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy')) AND " +
		  				"Agreement_no='"+temp_ag_no+"' and CN_NO='"+temp_regas_no+"' and mapping_id='"+rset.getString(3)+"' and customer_cd='"+temp_cust_cd+"'";
				  	//System.out.println("query........."+query1);
			  			rset2=stmt2.executeQuery(query1);
			  			if(rset2.next()){
				  			if(rset2.getInt(1)>0){
					  			Deal_sts.add("Yet To Start");
					  		}else{
					  			Deal_sts.add("InActive");
					  		}
			  			}
			  		}
			  	}
			  	Deal_NO.add(temp_ag_no);
				Deal_typ.add("Period");
				Deal_typ_nm.add("Period");
				Deal_cust_cd.add(temp_cust_cd);
				Deal_ST_DT.add(tmp_from_dt);
				Deal_END_DT.add(tmp_to_dt);
				Deal_cargo_seq_no.add(rset.getString(6)==null?"0":rset.getString(6));
				
				Deal_qty_booked.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	Deal_Price.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
				Deal_curr.add(rset.getString(13)==null?"":rset.getString(13));
			  	Deal_ENT_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	Deal_DCQ.add(rset.getString(12)==null?"0.00":nf.format(Double.parseDouble(rset.getString(12))));
			  	Deal_cont_no.add(temp_regas_no);
			  	
			  	query="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+rset.getString(11)+"'";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_ENT_BY.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_ENT_BY.add("");
			  	}
			  	query="	select to_date('"+tmp_to_dt+"','dd/mm/yyyy') - to_date('"+tmp_from_dt+"','dd/mm/yyyy')+1 from dual";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_duration.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_duration.add("");
			  	}
			  	
			}			
			
			for(int i=0;i<LTCORA_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
//				System.out.println("LTCORA_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					Deal_cust_nm.add(rset.getString(2)==null?"":rset.getString(2));
					Deal_cust_abbr.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					Deal_cust_nm.add("");
					Deal_cust_abbr.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
				  "WHERE A.MAPPING_ID='"+LTCORA_MAPPING_ID.elementAt(i)+"' ";
			//	System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					//LTCORA_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
					Deal_Signing_dt.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					//LTCORA_SIGNING_DT.add("");
					Deal_Signing_dt.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+LTCORA_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+LTCORA_SEQ_NO.elementAt(i)+" AND FGSA_NO="+LTCORA_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='C' AND MAPPING_ID='"+LTCORA_MAPPING_ID.elementAt(i)+"'";

			//	System.out.println("LTCORA_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					//LTCORA_SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					Deal_qty_Supplied.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
				//	LTCORA_SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
//					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
//					{
//						sup_tot_comit+=Double.parseDouble(rset.getString(1));
//						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
//					}
//					else
//					{
//						sup_tot_comit+=0;
//						sup_tot_comit_mmscm+=0;
//					}
				}
				else
				{
					Deal_qty_Supplied.add("0.00");
					/*sup_tot_comit+=0;
					
					LTCORA_SUPPLIEDMMSCM.add("0.00");
					sup_tot_comit_mmscm+=0;*/
				}				
		   }
			/*LTCORA_sup_tot_comitment=nf.format(sup_tot_comit);
			LTCORA_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			LTCORA_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			LTCORA_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);*/
			
			
			//--------Logic for CN based Summary Contract based Agreement	
			tot_comit=0.0;
			bal_tot_comit=0.0;
			sup_tot_comit=0.0;
			//MD20110917
			tot_comit_mmscm=0.0;
			sup_tot_comit_mmscm=0.0;
			bal_tot_comit_mmscm=0.0;
			
			
			
			FRM_DT.clear();
			TO_DT.clear();
			
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
					"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
					"C.REV_NO,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'),C.ENT_BY,A.DCQ_QTY,A.TARIFF_CUR_FLAG from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
					"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					"A.CONTRACT_END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
					"AND C.CN_NO!='0' AND CN_NO <'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
					"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO <'9999' AND " +
					"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
					"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
					"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +
					"order by A.CONTRACT_START_DT,A.CARGO_SEQ_NO";
//			System.out.println("CNNNNNNNNNN......"+queryString);
			rset = stmt.executeQuery(queryString);
//			System.out.println(queryString);
			while(rset.next())
			{				
				
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				String temp_ag_no=tempmap_id[1];
				String temp_ag_rev_no=tempmap_id[2];//RG20190530
				String temp_regas_no=tempmap_id[3];
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
				CN_MAPPING_ID.add(map_id);
				CN_NO.add(temp_regas_no);
				CN_REV_NO.add(temp_regas_rev_no);
				CN_CUSTOMER_CD.add(temp_cust_cd);	
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CN_CARGO_ARRIVAL_DATE.add(temp_dt);	
				CN_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
				//CN_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	CN_tot_commit=""+ nf.format(tot_comit) ;
			  	CN_BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));	
			  	tot_comit_mmscm += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))/38900));
			  	CN_tot_commit_mmscm=""+ nf.format(tot_comit_mmscm) ;
			  	CN_RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	///////////////RG20190320///////////////deal summery report///////
			  	Deal_NO.add(temp_ag_no);
				Deal_typ.add("CN");
				Deal_typ_nm.add("Confirmation Notice");
				Deal_cust_cd.add(temp_cust_cd);	
				Deal_cargo_seq_no.add(rset.getString(6)==null?"0":rset.getString(6));
				Deal_ST_DT.add(tmp_from_dt);
				Deal_END_DT.add(tmp_to_dt);
				Deal_qty_booked.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	Deal_Price.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	Deal_curr.add(rset.getString(13)==null?"":rset.getString(13));
			  	Deal_ENT_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	Deal_DCQ.add(rset.getString(12)==null?"0.00":nf.format(Double.parseDouble(rset.getString(12))));
			  	Deal_cont_no.add(temp_regas_no);
			  	
			  	String queryString1="SELECT SUM(GROSS_AMT_INR) FROM FMS7_INVOICE_MST WHERE mapping_id='"+map_id+"' AND CONTRACT_TYPE='C' and sn_no='"+rset.getString(6)+"'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_wout_tax.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_wout_tax.add("0.00");
				}
				queryString1="SELECT SUM(NET_AMT_INR) FROM FMS7_INVOICE_MST WHERE mapping_id='"+map_id+"' AND CONTRACT_TYPE='C' "
						+ "and sn_no='"+rset.getString(6)+"' AND (PAY_RECV_DT IS NULL AND PAY_RECV_AMT IS NULL)";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_amt_PAY_NOT_RECV.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_amt_PAY_NOT_RECV.add("0.00");
				}
				String temp_mappingid=tempmap_id[0]+"-"+tempmap_id[3]+"-"+tempmap_id[4]+"-"+rset.getString(6)+"-0-C";
				//System.out.println("temp_mappingid.."+temp_mappingid);
				queryString1="SELECT PRICE_RATE FROM FMS7_CONT_PRICE_DTL WHERE mapping_id='"+temp_mappingid+"' AND LTCORA_NO='"+temp_ag_no+"' AND"
						+ " LTCORA_REV_NO='"+temp_ag_rev_no+"' AND PRICE_CD='1' ";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					Deal_adv_amt.add(rset1.getString(1)==null?"0":rset1.getString(1));
				}else{
					Deal_adv_amt.add("-");
				}
				String query="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+rset.getString(11)+"'";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_ENT_BY.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_ENT_BY.add("");
			  	}
			  	query="	select to_date('"+tmp_to_dt+"','dd/mm/yyyy') - to_date('"+tmp_from_dt+"','dd/mm/yyyy')+1 from dual";
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		Deal_duration.add(rset1.getString(1)==null?"":rset1.getString(1));
			  	}else{
			  		Deal_duration.add("");
			  	}
			  	query="SELECT COUNT(*) FROM FMS8_LNG_REGAS_MST WHERE (sysdate BETWEEN TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy') and TO_DATE('"+tmp_to_dt+"','dd/mm/yyyy')) AND " +
		  				"Agreement_no='"+temp_ag_no+"' and CN_NO='"+temp_regas_no+"' and mapping_id='"+rset.getString(3)+"' and customer_cd='"+temp_cust_cd+"'";
			  	//System.out.println("query........."+query);
			  	rset1=stmt1.executeQuery(query);
			  	if(rset1.next()){
			  		if(rset1.getInt(1)>0){
			  			Deal_sts.add("Active");
			  		}else{
			  		 	String query1="SELECT COUNT(*) FROM FMS8_LNG_REGAS_MST WHERE (sysdate < TO_DATE('"+tmp_from_dt+"','dd/mm/yyyy')) AND " +
		  				"Agreement_no='"+temp_ag_no+"' and CN_NO='"+temp_regas_no+"' and mapping_id='"+rset.getString(3)+"' and customer_cd='"+temp_cust_cd+"'";
				  	//System.out.println("query........."+query1);
			  			rset2=stmt2.executeQuery(query1);
			  			if(rset2.next()){
				  			if(rset2.getInt(1)>0){
					  			Deal_sts.add("Yet To Start");
					  		}else{
					  			Deal_sts.add("InActive");
					  		}
			  			}
			  		}
			  	}
			}			
			
			for(int i=0;i<CN_CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
//				System.out.println("CN_CUSTOMER_CD = "+queryString);
				if(rset.next())
				{
					Deal_cust_nm.add(rset.getString(2)==null?"":rset.getString(2));
					Deal_cust_abbr.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					Deal_cust_nm.add("");
					Deal_cust_abbr.add("");	
				}	
				
				queryString = "SELECT TO_CHAR(A.SIGNING_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST A " +
							  "WHERE A.MAPPING_ID='"+CN_MAPPING_ID.elementAt(i)+"' ";
							 			 
//				System.out.println(queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					//CN_SIGNING_DT.add(rset.getString(1)==null?"":rset.getString(1));
					Deal_Signing_dt.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					Deal_Signing_dt.add("");
				}
	
//				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+RE_GAS_CUSTOMER_CD.elementAt(i)+" " +
//							 "AND SN_NO="+RE_GAS_SEQ_NO.elementAt(i)+" AND FGSA_NO="+RE_GAS_NO.elementAt(i)+" " +
//							 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
//							 "AND to_date('"+TO_DT.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='R'";
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+CN_CUSTOMER_CD.elementAt(i)+" " +
				 "AND SN_NO="+CN_SEQ_NO.elementAt(i)+" AND FGSA_NO="+CN_NO.elementAt(i)+" " +
				 "AND GAS_DT between to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+to_date+"','dd/mm/yyyy') AND CONTRACT_TYPE='C' AND MAPPING_ID='"+CN_MAPPING_ID.elementAt(i)+"'";

//				System.out.println("CN_QTY_MMBTU = "+queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					Deal_qty_Supplied.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110917
					/*CN_SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;
					}*/
				}
				else
				{
					Deal_qty_Supplied.add("0.00");
					/*//sup_tot_comit+=0;
					
					CN_SUPPLIEDMMSCM.add("0.00");
					//sup_tot_comit_mmscm+=0;
*/				}	
		   }
			/*CN_sup_tot_comitment=nf.format(sup_tot_comit);
			CN_bal_tot_comitment=nf.format(bal_tot_comit);
			//MD20110917
			CN_sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
			CN_bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
			//END OF LTCORA AND CN
			System.out.println("CN_sup_tot_comitment_mmscm"+CN_sup_tot_comitment_mmscm);
			System.out.println("CN_bal_tot_comitment_mmscm"+CN_bal_tot_comitment_mmscm);*/
			
		}		
		catch(Exception e)
		{
			  System.out.println("Exception in Databean_Contract_MasterReport--->fetchEligibleCargoList()-->"+e);
			  e.printStackTrace();
		}
	}
	
	
	//TCQ Variation Developed by Achal on 23/03/2011
	public void fetchTCQVariationList()
	{
		//Vector tempMODIFYCLOSURETCQ = new Vector();
		//Vector tempLOA_REV_NO = new Vector();
		Vector tempDt = new Vector();
		try
		{	
			if(Customer_access_flag.equals("Y"))
			{
				queryString ="select TO_CHAR(A.SN_CLOSURE_DT,'DD/MM/YYYY'),A.SN_CLOSURE_CLOSE,A.SN_NO,A.SN_REV_NO," +
						"A.CUSTOMER_CD,A.FGSA_NO,A.TCQ_REQUEST_CLOSE,A.TCQ, " +
						"A.TCQ_REQUEST_QTY,A.SN_CLOSURE_QTY,TO_CHAR(A.REV_DT,'DD/MM/YYYY'),A.TCQ_REQUEST_SIGN,A.START_DT from "
						+ "FMS7_SN_MST A, SEC_EMP_CUSTOMER_ALLOC_MST B " +
						"where (A.REV_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy') AND A.TCQ_REQUEST_CLOSE='Y')"+ 
						"OR (A.SN_CLOSURE_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy') AND A.SN_CLOSURE_CLOSE='Y' ) "
						+ " AND A.CUSTOMER_CD=B.CUSTOMER_CD AND B.EMP_CD='"+Emp_cd+"' " +
						"order by A.SN_CLOSURE_DT";
			} else {
				queryString ="select TO_CHAR(A.SN_CLOSURE_DT,'DD/MM/YYYY'),A.SN_CLOSURE_CLOSE,A.SN_NO,A.SN_REV_NO," +
						"A.CUSTOMER_CD,A.FGSA_NO,A.TCQ_REQUEST_CLOSE,A.TCQ, " +
						"A.TCQ_REQUEST_QTY,A.SN_CLOSURE_QTY,TO_CHAR(A.REV_DT,'DD/MM/YYYY'),A.TCQ_REQUEST_SIGN,A.START_DT from FMS7_SN_MST A " +
						"where (A.REV_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy') AND A.TCQ_REQUEST_CLOSE='Y')"+ 
						"OR (A.SN_CLOSURE_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy') AND A.SN_CLOSURE_CLOSE='Y' ) " +
						"order by A.SN_CLOSURE_DT";
			}
			
						 
//			//System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{				
				SN_CLOSURE_DT.add(rset.getString(1)==null?rset.getString(11)==null?"":rset.getString(11):rset.getString(1));
				if(rset.getString(2)!=null) //|| !(rset.getString(2).trim().equals("")) )
				{
					if(rset.getString(2).trim().equalsIgnoreCase("Y"))
					{
						SN_CLOSURE_CLOSE.add("Variation due to SN Closure. ");			
					}
					else
					{
						if(rset.getString(7)!=null) // || !(rset.getString(7).trim().equals("")) )
						{
							if(rset.getString(7).trim().equalsIgnoreCase("Y"))
							{
								SN_CLOSURE_CLOSE.add("Variation due to Modification of TCQ. ");
							}
							else
							{
								SN_CLOSURE_CLOSE.add("");
							}
						}
						else
						{
							SN_CLOSURE_CLOSE.add("");
						}
					}
				}
				else
				{
					if(rset.getString(7)!=null) // || !(rset.getString(7).trim().equals("")) )
					{
						if(rset.getString(7).trim().equalsIgnoreCase("Y"))
						{
							SN_CLOSURE_CLOSE.add("Variation due to Modification of TCQ. ");
						}
						else
						{
							SN_CLOSURE_CLOSE.add("");
						}
					}
					else
					{
						SN_CLOSURE_CLOSE.add("");
					}
				}
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));																
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	TCQ_REQUEST_QTY.add(rset.getString(9)==null?"0.00":nf.format(Double.parseDouble(rset.getString(9))));
			  	SN_CLOSURE_QTY.add(rset.getString(10)==null?"0.00":nf.format(Double.parseDouble(rset.getString(10))));
			  	TCQ_REQUEST_SIGN.add(rset.getString(12)==null?"-":rset.getString(12));
			  	tempDt.add(rset.getString(13)==null?"":rset.getString(13));
			}	
						
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" "
						+ "and eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+CUSTOMER_CD.elementAt(i)+"' and eff_dt<=to_date('"+tempDt.elementAt(i)+"','dd/mm/yyyy'))";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));					
				}
				else
				{
					CUSTOMER_NM.add("");
				}
				int sn_rev_no=0;
				if((Integer.parseInt(""+SN_REV_NO.elementAt(i))) > 0)					
				{
					sn_rev_no=Integer.parseInt(""+SN_REV_NO.elementAt(i));
				}
				else
				{
					sn_rev_no=1;
				}
				queryString ="select TCQ from FMS7_SN_MST where " +
				"SN_NO="+SN_NO.elementAt(i)+" AND " +
				//"SN_REV_NO='"+(sn_rev_no - 1)+"' AND " +
				"SN_REV_NO='0' AND " +
				"CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND " +
				"FGSA_NO="+FGSA_NO.elementAt(i)+" ";
//				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					ACTUAL_TCQ.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
				}
				else
				{
					ACTUAL_TCQ.add("0.00");
				}
		   }
			
		    //--------Logic for Tender and LOA based Summary Contract based Agreement	
			Vector tempDt1 = new Vector();
			if(Customer_access_flag.equals("Y"))
			{
				queryString ="select TO_CHAR(A.LOA_CLOSURE_DT,'DD/MM/YYYY'),A.LOA_CLOSURE_CLOSE,A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				 		"A.TCQ_REQUEST_QTY,A.TCQ_REQUEST_SIGN,A.START_DT from FMS7_LOA_MST A, SEC_EMP_CUSTOMER_ALLOC_MST B "
				 		+ "where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
				 		"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
				 		"A.LOA_CLOSURE_CLOSE='Y' AND A.CUSTOMER_CD=B.CUSTOMER_CD AND B.EMP_CD='"+Emp_cd+"' "
				 		+ "order by A.LOA_CLOSURE_DT";
			} else {
				queryString ="select TO_CHAR(A.LOA_CLOSURE_DT,'DD/MM/YYYY'),A.LOA_CLOSURE_CLOSE,A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				 		"A.TCQ_REQUEST_QTY,A.TCQ_REQUEST_SIGN,A.START_DT from FMS7_LOA_MST A where (A.START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')"+ 
				 		"OR A.END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) AND " +
				 		"A.LOA_CLOSURE_CLOSE='Y' order by A.LOA_CLOSURE_DT";
			}
						 			
//			//System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{				
				LOA_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				LOA_CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));													
				LOA_CARGO_ARRIVAL_DATE.add(rset.getString(1)==null?"":rset.getString(1));				
				LOA_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	TENDER_NO.add(rset.getString(6)==null?"0":rset.getString(6));				  	
			  	LOA_BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));				  	
			  	LOA_TCQ_REQUEST_QTY.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	LOA_TCQ_REQUEST_SIGN.add(rset.getString(9)==null?"":rset.getString(9));
			  	tempDt1.add(rset.getString(10)==null?"":rset.getString(10));
			}
			
			for(int i=0;i<LOA_CUSTOMER_CD.size();i++)
			{
//				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" ";	
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" "
						+ "and eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+LOA_CUSTOMER_CD.elementAt(i)+"' and eff_dt<=to_date('"+tempDt.elementAt(i)+"','dd/mm/yyyy'))";
//				//System.out.println("LOA_CUSTOMER_CD = "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					LOA_CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));					
				}
				else
				{
					LOA_CUSTOMER_NM.add("");
				}
				int loa_rev_no=0;
				if((Integer.parseInt(""+LOA_REV_NO.elementAt(i))) > 0)					
				{
					loa_rev_no=Integer.parseInt(""+LOA_REV_NO.elementAt(i));
				}
				else
				{
					loa_rev_no=1;
				}				
				queryString ="select TCQ from FMS7_LOA_MST where " +
				"LOA_NO="+LOA_NO.elementAt(i)+" AND " +
				//"LOA_REV_NO='"+(loa_rev_no - 1)+"' AND " +
				"LOA_REV_NO='0' AND " +
				"CUSTOMER_CD="+LOA_CUSTOMER_CD.elementAt(i)+" AND " +
				"TENDER_NO="+TENDER_NO.elementAt(i)+" ";
//				//System.out.println(queryString);
				rset = stmt.executeQuery(queryString);				
				if(rset.next())
				{
					LOA_ACTUAL_TCQ.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
				}
				else
				{
					LOA_ACTUAL_TCQ.add("0.00");
				}
		   }
		}		
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchTCQVariationList()-->"+e);
			  e.printStackTrace();
		}
	}
	public void fetchcustomer()
	{
		try
		{
			queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST";
			rset = stmt.executeQuery(queryString);
			//System.out.println(queryString);
			while(rset.next())
			{
				CUST_CD.add(rset.getString(3)==null?"":rset.getString(3));
				CUST_NM.add(rset.getString(1)==null?"":rset.getString(1));					
			}
			
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	public void fetchfgsaList()
	{
		try
		{
			
			if(!cust_nm.equalsIgnoreCase("0"))
			{
		//	queryString ="select CUSTOMER_CD,FGSA_NO,TO_CHAR(SIGNING_DT,'DD/MM/YYYY'),TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),REV_NO,TO_CHAR(REV_DT,'DD/MM/YYYY'),TO_CHAR(RENEWAL_DT,'DD/MM/YYYY'),EMP_CD from FMS7_FGSA_MST WHERE (START_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy') " +
		//		"or END_DT between to_date('"+from_date+"','dd/mm/yyyy') AND to_date('"+to_date+"','dd/mm/yyyy')) and CUSTOMER_CD='"+cust_nm+"' order by START_DT";
		  
			queryString ="select CUSTOMER_CD,FGSA_NO,TO_CHAR(SIGNING_DT,'DD/MM/YYYY'),TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),REV_NO,TO_CHAR(REV_DT,'DD/MM/YYYY'),TO_CHAR(REN_DT,'DD/MM/YYYY'),EMP_CD from FMS7_FGSA_MST WHERE (START_DT <= to_date('"+to_date+"','dd/mm/yyyy') " +
				"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) and CUSTOMER_CD='"+cust_nm+"' order by START_DT";
			
			}
			else
			{
			queryString ="select CUSTOMER_CD,FGSA_NO,TO_CHAR(SIGNING_DT,'DD/MM/YYYY'),TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),REV_NO,TO_CHAR(REV_DT,'DD/MM/YYYY'),TO_CHAR(REN_DT,'DD/MM/YYYY'),EMP_CD from FMS7_FGSA_MST WHERE START_DT <= to_date('"+to_date+"','dd/mm/yyyy') " +
				"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy')  order by START_DT";
		
			}
			//System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				 CUSTOMER_CD_FGSA.add(rset.getString(1)==null?"0":rset.getString(1));
				 FGSA_NO_NEW.add(rset.getString(2)==null?"0":rset.getString(2));
				 SIGNING_DT_FGSA.add(rset.getString(3)==null?"":rset.getString(3));
				 START_DT_FGSA.add(rset.getString(4)==null?"":rset.getString(4));
				 END_DT_FGSA.add(rset.getString(5)==null?"":rset.getString(5));
				 REV_NO_FGSA.add(rset.getString(6)==null?"0":rset.getString(6));
				 REV_DT_FGSA.add(rset.getString(7)==null?"":rset.getString(7));
				 RENEWAL_DT_FGSA.add(rset.getString(8)==null?"":rset.getString(8));
				 EMP_CD_FGSA.add(rset.getString(9)==null?"0":rset.getString(9));
				 
							 
			}
			for(int i=0;i<CUSTOMER_CD_FGSA.size();i++)
			{
				String t2="";
			 queryString ="select PLANT_SEQ_NO FROM FMS7_FGSA_PLANT_MST WHERE CUSTOMER_CD='"+CUSTOMER_CD_FGSA.elementAt(i)+"' AND FGSA_NO='"+FGSA_NO_NEW.elementAt(i)+"' AND REV_NO='"+REV_NO_FGSA.elementAt(i)+"'";
			 //System.out.println(queryString);
			 rset = stmt.executeQuery(queryString);
			 while(rset.next())
				{
				 
				 String t1=rset.getString(1)==null?"":rset.getString(1);
				
				 queryString ="Select A.PLANT_NAME from FMS7_CUSTOMER_PLANT_DTL A WHERE A.CUSTOMER_CD='"+CUSTOMER_CD_FGSA.elementAt(i)+"' and A.EFF_DT=(select max(B.eff_dt) from FMS7_CUSTOMER_PLANT_DTL B where A.seq_no=B.seq_no and B.CUSTOMER_CD='"+CUSTOMER_CD_FGSA.elementAt(i)+"') AND A.SEQ_NO='"+t1+"' order by A.SEQ_NO";
				 //System.out.println(queryString);
				 rset1 = stmt1.executeQuery(queryString);
				 while(rset1.next())
				 {
					 String t3=rset1.getString(1)==null?"":rset1.getString(1); 
					 t2=t2+t3+", ";
				 }
				 
				 
				}
			 DELV_POINT.add(t2); 
			}
			for(int i=0;i<CUSTOMER_CD_FGSA.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD_FGSA.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					CUSTOMER_ABR_FGSA.add(rset.getString(2)==null?"":rset.getString(2));					
				}
				else
				{
					CUSTOMER_ABR_FGSA.add("");
				}	
			}
			for(int i=0;i<EMP_CD_FGSA.size();i++)
			{
				queryString ="select EMP_ABR,EMP_NM from HR_EMP_MST where EMP_CD="+EMP_CD_FGSA.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					EMP_ABR_FGSA.add(rset.getString(2)==null?"":rset.getString(2));					
				}
				else
				{
					EMP_ABR_FGSA.add("-");
				}	
			}
		}
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchfgsaList()-->"+e);
			  e.printStackTrace();
		}
	}
	
	public void fetchFGSASNPRICEList()
	{
		try
		{
			Vector sn_no_tmp = new Vector();
			
			if(!cust_nm.equalsIgnoreCase("0") && !from_date.trim().equalsIgnoreCase("") && !to_date.trim().equalsIgnoreCase("")&& !from_date.equals(null) && !to_date.equals(null))
			{
		  
				queryString ="select A.CUSTOMER_CD, A.SN_NO, A.SN_REV_NO, A.FGSA_NO, A.FGSA_REV_NO," +
							" TO_CHAR(A.START_DT,'DD/MM/YYYY'), TO_CHAR(A.END_DT,'DD/MM/YYYY')," +
							" A.RATE, B.CARGO_REF_NO,  B.SALE_PRICE, B.COST_PRICE, B.MARGIN, A.sn_ref_no " +
							" from FMS7_SN_MST A, FMS7_SN_CARGO_DTL B" +
							" WHERE (A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy') " +
							" AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) and A.CUSTOMER_CD='"+cust_nm+"' " +
							" AND A.FGSA_NO = B.FGSA_NO AND A.FGSA_REV_NO = B.FGSA_REV_NO " +
							" AND A.SN_NO = B.SN_NO AND A.SN_REV_NO = B.SN_REV_NO" +
							" order by A.FGSA_NO, A.FGSA_REV_NO, A.SN_NO, A.SN_REV_NO";
				
			
			}
			else if(!from_date.trim().equalsIgnoreCase("") && !to_date.trim().equalsIgnoreCase("")&& !from_date.equals(null) && !to_date.equals(null))
			{
				queryString ="select A.CUSTOMER_CD, A.SN_NO, A.SN_REV_NO, A.FGSA_NO, A.FGSA_REV_NO," +
							" TO_CHAR(A.START_DT,'DD/MM/YYYY'), TO_CHAR(A.END_DT,'DD/MM/YYYY')," +
							" A.RATE, B.CARGO_REF_NO,  B.SALE_PRICE, B.COST_PRICE, B.MARGIN, A.sn_ref_no " +
							" from FMS7_SN_MST A, FMS7_SN_CARGO_DTL B" +
							" WHERE (A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy') " +
							" AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) " +
							" AND A.FGSA_NO = B.FGSA_NO AND A.FGSA_REV_NO = B.FGSA_REV_NO " +
							" AND A.SN_NO = B.SN_NO AND A.SN_REV_NO = B.SN_REV_NO" +
							" order by A.customer_cd,A.FGSA_NO, A.FGSA_REV_NO, A.SN_NO, A.SN_REV_NO";
				
		
			}
			//System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			String sn_no = "";
			String sn_ref_no = "";
			while(rset.next())
			{
				CUSTOMER_CD_SN_P.add(rset.getString(1)==null?"0":rset.getString(1));
				sn_no_tmp.add(rset.getString(2)==null?"0":rset.getString(2));
			//	SN_NO_P.add(rset.getString(2)==null?"0":rset.getString(2));
				SN_REV_NO_P.add(rset.getString(3)==null?"0":rset.getString(3));
				FGSA_NO_P.add(rset.getString(4)==null?"0":rset.getString(4));
				FGSA_REV_NO_P.add(rset.getString(5)==null?"0":rset.getString(5));
				START_DT_SN_P.add(rset.getString(6)==null?"-":rset.getString(6));
				END_DT_SN_P.add(rset.getString(7)==null?"-":rset.getString(7));
				RATE_SN_P.add(rset.getString(8)==null?"-":rset.getString(8));
				CARGO_REF_NO_SN_P.add(rset.getString(9)==null?"-":rset.getString(9));
				CARGO_MARGIN_SN_P.add(rset.getString(12)==null?"-":rset.getString(12));
				
				sn_no = rset.getString(2)==null?"0":rset.getString(2);
				sn_ref_no = rset.getString(13)==null?"0":rset.getString(13);
				
				if(!sn_ref_no.equals("0"))
				{
					SN_NO_P.add(sn_ref_no);
				}
				else
				{
					SN_NO_P.add(sn_no);
				}
				
			}

			for(int i=0;i<CUSTOMER_CD_SN_P.size();i++)
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD_SN_P.elementAt(i)+" ";
				rset = stmt.executeQuery(queryString);
				////System.out.println(queryString);
				if(rset.next())
				{
					CUSTOMER_ABR_SN_P.add(rset.getString(2)==null?"":rset.getString(2));					
				}
				else
				{
					CUSTOMER_ABR_SN_P.add("");
				}	
			}
			
			for(int i=0; i<sn_no_tmp.size(); i++)
			{
				
				queryString = "select PRICE, TO_CHAR(DELV_TO_DT,'DD/MM/YYYY')"+
				   		"FROM FMS7_MAN_CONFIRM_CARGO_DTL WHERE " +
				   		"CARGO_REF_CD='"+cargo_ref_no+"'";
				
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CARGO_CONF_PRICE_DT_SN_P.add(rset.getString(1)==null?"":rset.getString(1));
					String conf_price = rset.getString(1)==null?"0":rset.getString(1);
					String delv_to_dt = rset.getString(2)==null?"":rset.getString(2);
					////System.out.println("OK 1 "+CARGO_REF_NO_SN_P.elementAt(i));
//					Following Logic Has Been Introduced To Calculate Custom Tax Amount ...
				  	String tax_amt = "";
				  	String tax_str_cd = "0";
				  	double cd_charge_per_mmbtu = 0;
					
					String queryString1 = "SELECT A.TAX_STR_CD FROM FMS7_CARGO_TAX_MST A " +
								  		  "WHERE A.APP_DATE=(SELECT MAX(B.APP_DATE) FROM FMS7_CARGO_TAX_MST B " +
								  		  "WHERE B.APP_DATE<=TO_DATE('"+delv_to_dt+"','DD/MM/YYYY'))";
					////System.out.println("Custom Duty Details Query = "+queryString1);
					rset1 = stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						
						tax_str_cd = rset1.getString(1)==null?"0":rset1.getString(1);
					}
					
					////System.out.println("tax_str_cd = "+tax_str_cd);
					
					queryString1 = "SELECT NVL(A.tax_code,'0'), NVL(A.factor,'0.00'), NVL(A.tax_on,'1'), NVL(A.tax_on_cd,'0'), " +
								   "TO_CHAR(A.app_date,'DD/MM/YYYY') FROM FMS7_TAX_STRUCTURE_DTL A WHERE A.tax_str_cd="+tax_str_cd+" AND " +
								   "A.app_date=(SELECT MAX(B.app_date) FROM FMS7_TAX_STRUCTURE_DTL B WHERE B.tax_str_cd="+tax_str_cd+" AND " +
								   "B.app_date<=TO_DATE('"+delv_to_dt+"','DD/MM/YYYY')) ORDER BY A.tax_code DESC";
					
					rset1=stmt1.executeQuery(queryString1);
					while(rset1.next())
					{
						if(rset1.getString(3).equals("1"))
						{
							////System.out.println("OK 2 "+CARGO_REF_NO_SN_P.elementAt(i));
							tax_amt = nf2.format((Double.parseDouble(""+conf_price)*Double.parseDouble(rset1.getString(2)))/100);
							////System.out.println("OK 2.1 "+CARGO_REF_NO_SN_P.elementAt(i));
						}
						else if(rset1.getString(3).equals("2"))
						{
							String queryString2 = "SELECT NVL(A.tax_code,'0'), NVL(A.factor,'0'), NVL(A.tax_on,'1'), NVL(A.tax_on_cd,'0'), " +
										   		  "TO_CHAR(A.app_date,'DD/MM/YYYY') FROM FMS7_TAX_STRUCTURE_DTL A WHERE A.tax_str_cd="+tax_str_cd+" AND " +
										   		  "A.app_date=(SELECT MAX(B.app_date) FROM FMS7_TAX_STRUCTURE_DTL B WHERE B.tax_str_cd="+tax_str_cd+" AND " +
										   		  "B.app_date<=TO_DATE('"+delv_to_dt+"','DD/MM/YYYY')) AND A.tax_code="+rset1.getString(4)+"";
							////System.out.println("Query For Finding Out Tax Which Is Dependent On Other Tax Value = "+queryString2);
					 		rset2=stmt2.executeQuery(queryString2);
					 		if(rset2.next())
					 		{
					 			if(rset2.getString(3).equals("1"))
								{
					 				////System.out.println("OK 3 "+CARGO_REF_NO_SN_P.elementAt(i));
									tax_amt = ""+(Double.parseDouble(""+conf_price)*Double.parseDouble(rset2.getString(2))/100);
								}
								
					 			tax_amt = ""+(Double.parseDouble(tax_amt)*Double.parseDouble(rset1.getString(2)))/100;
					 		}
					 		else
					 		{
					 			tax_amt = ""+0.00;
					 		}			 		
						}
						else
						{
							tax_amt = ""+0.00;
						}
						////System.out.println("OK 4 "+CARGO_REF_NO_SN_P.elementAt(i));
						cd_charge_per_mmbtu += Double.parseDouble(tax_amt);
						
					}
					
					////System.out.println("OK 5 "+CARGO_REF_NO_SN_P.elementAt(i));
					CARGO_CUSTOM_DUTY_SN_P.add(nf2.format(cd_charge_per_mmbtu));
				}
				else
				{
					CARGO_CUSTOM_DUTY_SN_P.add("-");
					CARGO_CONF_PRICE_DT_SN_P.add("-");
				}
				
				
			}
			
			int j =1;
			for(int i = 0; i<CARGO_REF_NO_SN_P.size()-1; i++)
			{
				
				if(sn_no_tmp.elementAt(i).toString().equals(sn_no_tmp.elementAt(j).toString()) && 
						FGSA_NO_P.elementAt(i).toString().equals(FGSA_NO_P.elementAt(j).toString()) && 
						FGSA_REV_NO_P.elementAt(i).toString().equals(FGSA_REV_NO_P.elementAt(j).toString()))
					{
						if(!RATE_SN_P.elementAt(i).toString().equals(RATE_SN_P.elementAt(j).toString()))
						{
							COLOR_FLAG_RATE_SN_P.add("red");
						}
						else
						{
							COLOR_FLAG_RATE_SN_P.add("");
						}
					}
				else
				{
					COLOR_FLAG_RATE_SN_P.add("");
					
				}
					j++;
				
			}
			COLOR_FLAG_RATE_SN_P.add("");
			
			
			//System.out.println(CUSTOMER_CD_SN_P.size());
			//System.out.println(CUSTOMER_ABR_SN_P.size());
			//System.out.println(SN_REV_NO_P.size());
			//System.out.println(FGSA_NO_P.size());
			//System.out.println(FGSA_REV_NO_P.size());
			//System.out.println(START_DT_SN_P.size());
			//System.out.println(END_DT_SN_P.size());
			//System.out.println(RATE_SN_P.size());
			//System.out.println(CARGO_REF_NO_SN_P.size());
			//System.out.println(CARGO_CONF_PRICE_DT_SN_P.size());
			//System.out.println(CARGO_CUSTOM_DUTY_SN_P.size());
			//System.out.println(CARGO_MARGIN_SN_P.size());
			//System.out.println(COLOR_FLAG_CONF_PRICE_SN_P.size());
			//System.out.println(COLOR_FLAG_CUSTOM_SN_P.size());
			//System.out.println(COLOR_FLAG_CUSTOM_SN_P);
			
		
		}
		catch(Exception e)
		{
			  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchFGSASNPRICEList()-->"+e);
			  e.printStackTrace();
		}
	}	
	/////////////////////////Find Out Price Out for JKM ////////////////////////
	public void MRCR_PriceOut(String INDEX_TYPE, String GenDate)
	{
		try
		{
	////Price Pulling from Table////////////////////////////
	String tempGen_Dt[]=GenDate.split("/");
	String GenMth=tempGen_Dt[0]; String GenYr=tempGen_Dt[1]; 
	String GenMthYr=GenDate;
	INDEX_TYPE="JKM";
	String LNG_ICE_JKM_PriceOut="0"; String Phy_CurFrd_Price="";

	String Slope="";
	//SB	queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='S' ";
	queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='S' ";
//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
	rset2 = stmt.executeQuery(queryString);			
	if(rset2.next())
	{
		VSlope_BRENT.add(rset2.getString(1)==null?"1":rset2.getString(1));  //CR-DATED_BRENT
		VSlope_ICE_JKM.add(rset2.getString(2)==null?"1":rset2.getString(2));  //LNG_ICE_JKM
		VSlope_JKM.add(rset2.getString(3)==null?"1":rset2.getString(3));  //LNG_JKM
		VSlope_LNG_PHYS.add(rset2.getString(4)==null?"1":rset2.getString(4));  //LNG_PHYS_INDIA
		VSlope_RLNG_PHYS.add(rset2.getString(5)==null?"1":rset2.getString(5));  //RLNG_PHYS_INDIA
		VSlope.add(rset2.getString(2)==null?"1":rset2.getString(2));  //Default: LNG_ICE_JKM 
		Slope=rset2.getString(2)==null?"1":rset2.getString(2);
		VSlope_FLAG.add("Y");
		Slope_ICE_JKM=Slope;
		Slope_FLAG="Y";
	}
	else
	{
		VSlope_BRENT.add("1.0");
		VSlope_ICE_JKM.add("1.0");
		VSlope_JKM.add("1.0");
		VSlope_LNG_PHYS.add("1.0");
		VSlope_RLNG_PHYS.add("1.0");
		VSlope.add("1.0");
		Slope="1.0";
		VSlope_FLAG.add("N");
		Slope_ICE_JKM=Slope;
		Slope_FLAG="N";
	}
	String Constant="";
	//SB		queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='C' ";
			queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='C' ";
	//		System.out.println("CONSTANT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
			rset2 = stmt.executeQuery(queryString);			
			if(rset2.next())
			{
				Const_ICE_JKM=rset2.getString(2)==null?"0":rset2.getString(2); 
				Const_RLNG_PHYS=rset2.getString(5)==null?"0":rset2.getString(5);
				Const_ICE_JKM_FLAG="Y";
				VConst_ICE_JKM.add(Const_ICE_JKM);  //ICE_JKM_FORWARD
				VConst_RLNG_PHYS.add(Const_RLNG_PHYS);  //RLNG_PHYS_FORWARD
				Constant=rset2.getString(2)==null?"0":rset2.getString(2);
				VConst_ICE_JKM_FLAG.add(Const_ICE_JKM_FLAG);
				Constant=Const_ICE_JKM;
			}
			else
			{
				VConst_ICE_JKM.add("0");
				VConst_RLNG_PHYS.add("0");
				Constant="0";
				VConst_ICE_JKM_FLAG.add("N");
				Const_ICE_JKM="0"; 
				Const_RLNG_PHYS="0";
				Const_ICE_JKM_FLAG="N";
			}
	////^^^^^^^Price Pulling from Table////////////////////////////
			
		Vector Veff_dt = new Vector();
		Vector temp_Vcurren_cd = new Vector();
		Vector temp_Vcurren_cd_from = new Vector();
			String start_dt =""; String delv_mth ="01/"+GenMth+"/"+GenYr; int businessMonth=0; int businessYear=0; String StartMonth="";String EndMonth="";
			if(Integer.parseInt(GenMth)>2 && Integer.parseInt(GenMth)<=12)
			{
				businessMonth=(Integer.parseInt(GenMth)-2);
				businessYear=(Integer.parseInt(GenYr));
			}
			else
			{
				if(Integer.parseInt(GenMth)==2) {businessMonth=12;}
				if(Integer.parseInt(GenMth)==1) {businessMonth=11;}
				businessYear=(Integer.parseInt(GenYr)-1);
			}
					
			if(businessMonth<=9)
			{
				StartMonth="0"+businessMonth;
				start_dt = "16/"+"0"+businessMonth+"/"+GenYr;
			}
			else
			{
				StartMonth=""+businessMonth;
				start_dt = "16/"+businessMonth+"/"+GenYr;
			}
		
			int total_days = 0;
			String date_arr = "";
			String PriceBegMthDt=start_dt;
			System.out.println("start_dt = "+start_dt);
			queryString = "SELECT TO_CHAR(LAST_DAY(TO_DATE('"+start_dt+"','DD/MM/YYYY')),'DD/MM/YYYY') FROM DUAL";
			//	System.out.println("Query for generating Last Date of the selected Month = "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					total_days = Integer.parseInt(rset.getString(1).substring(0,2));
				}
				
				for(int i=16; i<=total_days; i++)
				{
					date_arr = i+"/"+StartMonth+"/"+GenYr;
					Veff_dt.add(date_arr);
				}
				businessMonth++;
				if(businessMonth>12)
				{
					businessMonth=1;
					businessYear=(Integer.parseInt(GenYr));
				}
				
				if(businessMonth<=9)
				{
					start_dt = "01/"+"0"+businessMonth+"/"+GenYr;
					EndMonth="0"+businessMonth;
				}
				else
				{
					start_dt = "01/"+businessMonth+"/"+GenYr;
					EndMonth=""+businessMonth;
				}
				queryString = "SELECT TO_CHAR(LAST_DAY(TO_DATE('"+start_dt+"','DD/MM/YYYY')),'DD/MM/YYYY') FROM DUAL";
			//	System.out.println("Query for generating Last Date of the selected Month = "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					total_days = Integer.parseInt(rset.getString(1).substring(0,2));
				}
				
				for(int i=1; i<=15; i++)
				{
					if(i<=9)
					{
						date_arr = "0"+i+"/"+EndMonth+"/"+GenYr;
					}
					else
					{
						date_arr = i+"/"+EndMonth+"/"+GenYr;
					}					
					Veff_dt.add(date_arr);
				}
				String PriceEndMthDt=date_arr;
				///////////////////////////////HOLIDAY CALCULATION///////////////////////////////////
				Vector VHoliday_Dt = new Vector();
				queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
						+ " WHERE HOLIDAY_DT BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND FLAG='Y' ORDER BY HOLIDAY_DT";
				rset = stmt.executeQuery(queryString);
				System.out.println(">>>>>>>PRICE PUULING: "+queryString);
				while(rset.next())
				{
					VHoliday_Dt.add(rset.getString(1));
				}
				System.out.println(GenDate+">>>>>>>PRICE VHoliday_Dt: "+VHoliday_Dt.size());
				for(int i=0; i<VHoliday_Dt.size(); i++)
				{
					int noOfDaysStarting=0;
					queryString = "SELECT TO_DATE('"+VHoliday_Dt.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+Veff_dt.elementAt(0)+"','DD/MM/YYYY') FROM DUAL" ;
						System.out.println(" DUAL: FIRST: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next()) {
							noOfDaysStarting = rset.getInt(1);
						}
						if(noOfDaysStarting==0) 
							PriceBegMthDt=""+Veff_dt.elementAt(1);
						System.out.println(PriceBegMthDt+">>>>>>>PRICE 1.VHoliday_Dt: "+VHoliday_Dt);	
					int noOfDays=0;
					queryString = "SELECT TO_DATE('"+VHoliday_Dt.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+Veff_dt.lastElement()+"','DD/MM/YYYY') FROM DUAL" ;
						System.out.println(" DUAL: LAST: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next()) {
							noOfDays = rset.getInt(1);
						}
						if(noOfDays==0) 
							PriceEndMthDt=""+Veff_dt.elementAt(Veff_dt.size()-2);
				}
				System.out.println(PriceEndMthDt+">>>>>>>PRICE 2.VHoliday_Dt: "+VHoliday_Dt);
				/////////////////////////////////////////////////////////////////////////////////////
				
				double AvgPrice=0; int PriceAvlCount=1;
				queryString = "select SUM(LNG_ICE_JKM), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where LNG_ICE_JKM>0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' ";
			//	System.out.println("COMMODITY: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					AvgPrice = rset.getDouble(1);
					PriceAvlCount = rset.getInt(2);
				}
				else
				{
					AvgPrice = 0;
					PriceAvlCount = 1;
				}
				System.out.println(AvgPrice+" :AvgPrice: "+PriceAvlCount);
				
			double sumCommodityValue=0; int countNonZero=0; double avgCommodityValue=0; double Eff_avgCommodityValue=0; 
			if(PriceAvlCount>0)
				avgCommodityValue=AvgPrice/PriceAvlCount; 
			else
				avgCommodityValue=0;
			String rate_value=""; String AvgCommodityValue=""; String ContPriceBasedCommodityValue="";
		//	String Constant="0";
			Eff_avgCommodityValue=avgCommodityValue*Double.parseDouble(""+Slope)-Double.parseDouble(""+Constant);
			//		Eff_avgCommodityValue=avgCommodityValue-Double.parseDouble(""+Constant);
			AvgCommodityValue=nf2.format(avgCommodityValue);System.out.println(GenMthYr+" :AvgCommodityValue: "+AvgCommodityValue);
			if(avgCommodityValue>0)
			{
				VMthYrWisePriceICE_JKM.add(AvgCommodityValue);
				PrvCurvePrice=""+AvgCommodityValue;
				PriceIndex_SettleDate=PriceEndMthDt;
				VPriceIndex_SettleDate.add(PriceEndMthDt);
				PriceIndex_StartDate=PriceBegMthDt;
				VPriceIndex_StartDate.add(PriceBegMthDt);
				PriceIndex_EndDate=PriceEndMthDt;
				VPriceIndex_EndDate.add(PriceEndMthDt);
				EffPriceSlopeConst=nf2.format(Eff_avgCommodityValue);
				VEff_Price.add(nf2.format(Eff_avgCommodityValue));
			}
			else
			{
				VMthYrWisePriceICE_JKM.add(avgCommodityValue);
				PrvCurvePrice=""+avgCommodityValue;
				PriceIndex_SettleDate="";
				VPriceIndex_SettleDate.add("");
				PriceIndex_StartDate="";
				VPriceIndex_StartDate.add("");
				PriceIndex_EndDate="";
				VPriceIndex_EndDate.add("");
				EffPriceSlopeConst="";
				VEff_Price.add("");
			}
			
		//	System.out.println(sumCommodityValue+" :COMMODITY: ContPriceBasedCommodityValue  "+ContPriceBasedCommodityValue);
	}
	catch(Exception e)
	{
		  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchFGSASNPRICEList()-->"+e);
		  e.printStackTrace();
	}
}	
	////////////////////////////////////////////////////////////////////////////
	
	/////////////////////SB20200817////////////////////////////
	public void MRCR_ContDtl(String MappId, String BuySell, String PriceTypeCargo, String DealPrice, String TCQ, String AllocQty, String GasDt, String GenDt, String ContEndDt, String PhyCurFrdPrice, String FinCurFrdPrice, String Slope, String PriorMthCurvePrice)
	{
		try
		{
			String PriceType=""; //FinCurFrdPrice=".5"; //PhyCurFrdPrice="2.5";
		
			double U_Phy_Leg=0;
			double U_Fin_Leg=0;
			double R_Fin_Leg=0;
			
			VBuySell.add(BuySell);
			
		
			String tempGasDt[]=GasDt.split("/");
			String GasMth=tempGasDt[1]; String GasYr=tempGasDt[2]; String GasMthYr=GasMth+"/"+GasYr;
			
			String Gen_Dt=to_date; 
			String tempGen_Dt[]=Gen_Dt.split("/");
			String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; String GenMthYr=GenMth+"/"+GenYr;
		//SB	queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='S' ";
	/*		queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GasMthYr+"','MM/YYYY') AND CURVE_TYPE='S' ";
		//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
			rset2 = stmt.executeQuery(queryString);			
			if(rset2.next())
			{
				VSlope_BRENT.add(rset2.getString(1)==null?"1":rset2.getString(1));  //CR-DATED_BRENT
				VSlope_ICE_JKM.add(rset2.getString(2)==null?"1":rset2.getString(2));  //LNG_ICE_JKM
				VSlope_JKM.add(rset2.getString(3)==null?"1":rset2.getString(3));  //LNG_JKM
				VSlope_LNG_PHYS.add(rset2.getString(4)==null?"1":rset2.getString(4));  //LNG_PHYS_INDIA
				VSlope_RLNG_PHYS.add(rset2.getString(5)==null?"1":rset2.getString(5));  //RLNG_PHYS_INDIA
				VSlope.add(rset2.getString(2)==null?"1":rset2.getString(2));  //Default: LNG_ICE_JKM 
				Slope=rset2.getString(2)==null?"1":rset2.getString(2);
				VSlope_FLAG.add("Y");
			}
			else
			{
				VSlope_BRENT.add("1.0");
				VSlope_ICE_JKM.add("1.0");
				VSlope_JKM.add("1.0");
				VSlope_LNG_PHYS.add("1.0");
				VSlope_RLNG_PHYS.add("1.0");
				VSlope.add("1.025");
				Slope="1.025";
				VSlope_FLAG.add("N");
			}*/
			////Settlement Price Pulling from Table////////////////////////////
			//SB	queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='F' ";
					queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GasMthYr+"','MM/YYYY') AND CURVE_TYPE='F' ";
					//	System.out.println("SETTLEMENT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
						rset2 = stmt.executeQuery(queryString);			
						if(rset2.next())
						{
							VSettle_ICE_JKM.add(rset2.getString(2)==null?"1":rset2.getString(2));  //ICE_JKM_FORWARD
							VSettle_RLNG_PHYS.add(rset2.getString(5)==null?"1":rset2.getString(5));  //RLNG_PHYS_FORWARD
							FinCurFrdPrice=rset2.getString(2);
							PhyCurFrdPrice=rset2.getString(5);
							VSettle_ICE_JKM_FLAG.add("Y");
							VSettle_RLNG_PHYS_FLAG.add("Y");//System.out.println("IF ****"+VSettle_ICE_JKM);
						}
					else
						{
							VSettle_ICE_JKM.add("0");
							VSettle_RLNG_PHYS.add("0");
							FinCurFrdPrice="0";
							PhyCurFrdPrice="0";
							VSettle_ICE_JKM_FLAG.add("N");
							VSettle_RLNG_PHYS_FLAG.add("N");//System.out.println("ELSe ****"+VSettle_ICE_JKM);
						}
						
			////^^^^^^^Constant Pulling from Table////////////////////////////
						String Constant="";
				//SB		queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='C' ";
		/*SB				queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GasMthYr+"','MM/YYYY') AND CURVE_TYPE='C' ";
				//		System.out.println("CONSTANT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
						rset2 = stmt.executeQuery(queryString);			
						if(rset2.next())
						{
							VConst_ICE_JKM.add(rset2.getString(2)==null?"0":rset2.getString(2));  //ICE_JKM_FORWARD
							VConst_RLNG_PHYS.add(rset2.getString(5)==null?"0":rset2.getString(5));  //RLNG_PHYS_FORWARD
							Constant=rset2.getString(2)==null?"0.15":rset2.getString(2);
							VConst_ICE_JKM_FLAG.add("Y");
						}
						else
						{
							VConst_ICE_JKM.add("0.15");
							VConst_RLNG_PHYS.add("0.15");
							Constant="0.15";
							VConst_ICE_JKM_FLAG.add("N");
						}*/
			////^^^^^^^Price Pulling from Table////////////////////////////
			if(BuySell.equalsIgnoreCase("Sell"))
				TCQ="-"+TCQ;
		
			////////////////////////////////Get Price Type from Existing system //////////////////////
			if(PriceTypeCargo.equals("M"))
			{
				VPriceType.add("FLOAT");
				VDealPriceCurve.add("LNG_ICE_JKM");
				VDealPhysCurve.add("RLNG_PHYS_INDIA");
				VDealTCQ.add(TCQ);
				VRLNG_PHYS_IN_EXPO.add(TCQ);
				VLNG_ICE_JKM_EXPO.add(nf.format((-1)*Double.parseDouble(TCQ)*Double.parseDouble(Slope)));
			}
			else if(PriceTypeCargo.equals("F"))
			{
				VPriceType.add("FIXED");
				VDealPriceCurve.add("RLNG_PHYS_INDIA");
				VDealPhysCurve.add("RLNG_PHYS_INDIA");
				VDealTCQ.add(TCQ);
				VRLNG_PHYS_IN_EXPO.add(TCQ);
				VLNG_ICE_JKM_EXPO.add(0);
			}
			else
			{
				VPriceType.add("FIXED");
				VDealPriceCurve.add("RLNG_PHYS_INDIA");
				VDealPhysCurve.add("RLNG_PHYS_INDIA");
				VCargoRefNo.add("0");
				VDealTCQ.add(0);
				VRLNG_PHYS_IN_EXPO.add(0);
				VLNG_ICE_JKM_EXPO.add(0);
			}
			//////////////////////////////////////////////////////////////////////////////////////////
			int no_of_days = -1; int ContEndNoOfDays = -1; int ContPriorGasNoOfDays = -1;
			queryString = "SELECT TO_DATE('"+GenDt+"','DD/MM/YYYY')-TO_DATE('"+from_date+"','DD/MM/YYYY')+1 FROM DUAL" ;
		//	System.out.println(" DUAL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				no_of_days = rset.getInt(1);
			}
			queryString = "SELECT TO_DATE('"+ContEndDt+"','DD/MM/YYYY')-TO_DATE('"+GenDt+"','DD/MM/YYYY') FROM DUAL" ;
		//	System.out.println(" DUAL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				ContEndNoOfDays = rset.getInt(1);
			}
			queryString = "SELECT TO_DATE('"+GasDt+"','DD/MM/YYYY')-TO_DATE('"+GenDt+"','DD/MM/YYYY') FROM DUAL" ;
			//	System.out.println(" DUAL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					ContPriorGasNoOfDays = rset.getInt(1);
				}
				
	/*SB20200901		for(int i=no_of_days;i>=0;i--) {
				queryString = "SELECT TO_CHAR(TO_DATE('"+GenDt+"','DD/MM/YYYY')-"+i+",'DD/MM/YYYY') FROM DUAL";
//				System.out.println("Fetching all dates..."+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					VAll_Dt.add(rset.getString(1));
				} 
			}*/
			if(ContEndNoOfDays<0)
			{
				VRU_Physical_Leg.add("R");
				VRLNG_PHYS_INDIA_EXPOSURE_U.add("0");
			}
			else
			{
				VRU_Physical_Leg.add("U");
				VRLNG_PHYS_INDIA_EXPOSURE_U.add(TCQ);
			}
			
			double LNG_ICE_JKM_EXPO=(-1)*Double.parseDouble(TCQ)*Double.parseDouble(Slope);
			
			if(PriceType.equals("M") && ContEndNoOfDays<0)
			{
				VRU_Financial_Leg.add("R");
				VLNG_ICE_JKM_EXPOSURE_U.add("0");
					U_Phy_Leg=(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice));
				VU_Phy_Leg.add(nf.format(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice)));
				U_Fin_Leg=(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice));
				VU_Fin_Leg.add(nf.format(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice)));
				R_Fin_Leg=(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice));
				VR_Fin_Leg.add(nf.format(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice)));
			}
			else
			{
				VRU_Financial_Leg.add("U");
				if(Double.parseDouble(PriorMthCurvePrice)==0)
					VLNG_ICE_JKM_EXPOSURE_U.add(nf.format((-1)*Double.parseDouble(TCQ)*Double.parseDouble(Slope)));
				else
					VLNG_ICE_JKM_EXPOSURE_U.add("");
				U_Phy_Leg=(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice));
				VU_Phy_Leg.add(nf.format(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice)));
				U_Fin_Leg=(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice));
				VU_Fin_Leg.add(nf.format(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice)));
				R_Fin_Leg=(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice));
				VR_Fin_Leg.add(nf.format(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice)));
			}
			VTotal.add(nf.format(U_Phy_Leg+U_Fin_Leg+R_Fin_Leg));
			////////////////////////////////////////////////////////////
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}

	public void MRCR_ContDtl2(String MappId, String BuySell, String PriceTypeCargo, String DealPrice, String TCQ, String AllocQty, String GasDt, String GenDt, String ContEndDt, String PhyCurFrdPrice, String FinCurFrdPrice, String Slope, String PriorMthCurvePrice)
	{
		try
		{
			String PriceType=""; //FinCurFrdPrice=".5"; //PhyCurFrdPrice="2.5";
		
			double U_Phy_Leg=0;
			double U_Fin_Leg=0;
			double R_Fin_Leg=0;
			
			VBuySell.add(BuySell);
			
		
			String tempGasDt[]=GasDt.split("/");
			String GasMth=tempGasDt[1]; String GasYr=tempGasDt[2]; String GasMthYr=GasMth+"/"+GasYr;
			
			String Gen_Dt=to_date; 
			String tempGen_Dt[]=Gen_Dt.split("/");
			String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; String GenMthYr=GenMth+"/"+GenYr;
		//SB	queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='S' ";
			queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GasMthYr+"','MM/YYYY') AND CURVE_TYPE='S' ";
		//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
			rset2 = stmt.executeQuery(queryString);			
			if(rset2.next())
			{
				VSlope_BRENT.add(rset2.getString(1)==null?"1":rset2.getString(1));  //CR-DATED_BRENT
				VSlope_ICE_JKM.add(rset2.getString(2)==null?"1":rset2.getString(2));  //LNG_ICE_JKM
				VSlope_JKM.add(rset2.getString(3)==null?"1":rset2.getString(3));  //LNG_JKM
				VSlope_LNG_PHYS.add(rset2.getString(4)==null?"1":rset2.getString(4));  //LNG_PHYS_INDIA
				VSlope_RLNG_PHYS.add(rset2.getString(5)==null?"1":rset2.getString(5));  //RLNG_PHYS_INDIA
				VSlope.add(rset2.getString(2)==null?"1":rset2.getString(2));  //Default: LNG_ICE_JKM 
				Slope=rset2.getString(2)==null?"1":rset2.getString(2);
				VSlope_FLAG.add("Y");
			}
			else
			{
				VSlope_BRENT.add("1.0");
				VSlope_ICE_JKM.add("1.0");
				VSlope_JKM.add("1.0");
				VSlope_LNG_PHYS.add("1.0");
				VSlope_RLNG_PHYS.add("1.0");
				VSlope.add("1.025");
				Slope="1.025";
				VSlope_FLAG.add("N");
			}
			////Settlement Price Pulling from Table////////////////////////////
			//SB	queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='F' ";
					queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GasMthYr+"','MM/YYYY') AND CURVE_TYPE='F' ";
					//	System.out.println("SETTLEMENT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
						rset2 = stmt.executeQuery(queryString);			
						if(rset2.next())
						{
							VSettle_ICE_JKM.add(rset2.getString(2)==null?"1":rset2.getString(2));  //ICE_JKM_FORWARD
							VSettle_RLNG_PHYS.add(rset2.getString(5)==null?"1":rset2.getString(5));  //RLNG_PHYS_FORWARD
							FinCurFrdPrice=rset2.getString(2);
							PhyCurFrdPrice=rset2.getString(5);
							VSettle_ICE_JKM_FLAG.add("Y");
							VSettle_RLNG_PHYS_FLAG.add("Y");//System.out.println("IF ****"+VSettle_ICE_JKM);
						}
					else
						{
							VSettle_ICE_JKM.add("0");
							VSettle_RLNG_PHYS.add("0");
							FinCurFrdPrice="0";
							PhyCurFrdPrice="0";
							VSettle_ICE_JKM_FLAG.add("N");
							VSettle_RLNG_PHYS_FLAG.add("N");//System.out.println("ELSe ****"+VSettle_ICE_JKM);
						}
						
			////^^^^^^^Constant Pulling from Table////////////////////////////
						String Constant="";
				//SB		queryString ="SELECT CURVE_VALUE1, CURVE_VALUE2, CURVE_VALUE3, CURVE_VALUE4, CURVE_VALUE4 FROM FMS9_CURVE_VALUE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GenMthYr+"','MM/YYYY') AND CURVE_TYPE='C' ";
						queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_CURVE_PRICE_DTL WHERE CURVE_DD_MM_YR=TO_DATE('"+GasMthYr+"','MM/YYYY') AND CURVE_TYPE='C' ";
				//		System.out.println("CONSTANT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
						rset2 = stmt.executeQuery(queryString);			
						if(rset2.next())
						{
							VConst_ICE_JKM.add(rset2.getString(2)==null?"0":rset2.getString(2));  //ICE_JKM_FORWARD
							VConst_RLNG_PHYS.add(rset2.getString(5)==null?"0":rset2.getString(5));  //RLNG_PHYS_FORWARD
							Constant=rset2.getString(2)==null?"0.15":rset2.getString(2);
							VConst_ICE_JKM_FLAG.add("Y");
						}
						else
						{
							VConst_ICE_JKM.add("0.15");
							VConst_RLNG_PHYS.add("0.15");
							Constant="0.15";
							VConst_ICE_JKM_FLAG.add("N");
						}
			////^^^^^^^Price Pulling from Table////////////////////////////
			if(BuySell.equalsIgnoreCase("Sell"))
				TCQ="-"+TCQ;
		
			////////////////////////////////Get Price Type from Existing system //////////////////////
			if(PriceTypeCargo.equals("M"))
			{
				VPriceType.add("FLOAT");
				VDealPriceCurve.add("LNG_ICE_JKM");
				VDealPhysCurve.add("RLNG_PHYS_INDIA");
				VDealTCQ.add(TCQ);
				VRLNG_PHYS_IN_EXPO.add(TCQ);
				VLNG_ICE_JKM_EXPO.add(nf.format((-1)*Double.parseDouble(TCQ)*Double.parseDouble(Slope)));
			}
			else if(PriceTypeCargo.equals("F"))
			{
				VPriceType.add("FIXED");
				VDealPriceCurve.add("RLNG_PHYS_INDIA");
				VDealPhysCurve.add("RLNG_PHYS_INDIA");
				VDealTCQ.add(TCQ);
				VRLNG_PHYS_IN_EXPO.add(TCQ);
				VLNG_ICE_JKM_EXPO.add(0);
			}
			else
			{
				VPriceType.add("FIXED");
				VDealPriceCurve.add("RLNG_PHYS_INDIA");
				VDealPhysCurve.add("RLNG_PHYS_INDIA");
				VCargoRefNo.add("0");
				VDealTCQ.add(0);
				VRLNG_PHYS_IN_EXPO.add(0);
				VLNG_ICE_JKM_EXPO.add(0);
			}
			//////////////////////////////////////////////////////////////////////////////////////////
			int no_of_days = -1; int ContEndNoOfDays = -1; int ContPriorGasNoOfDays = -1;
			queryString = "SELECT TO_DATE('"+GenDt+"','DD/MM/YYYY')-TO_DATE('"+from_date+"','DD/MM/YYYY')+1 FROM DUAL" ;
		//	System.out.println(" DUAL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				no_of_days = rset.getInt(1);
			}
			queryString = "SELECT TO_DATE('"+ContEndDt+"','DD/MM/YYYY')-TO_DATE('"+GenDt+"','DD/MM/YYYY') FROM DUAL" ;
		//	System.out.println(" DUAL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				ContEndNoOfDays = rset.getInt(1);
			}
			queryString = "SELECT TO_DATE('"+GasDt+"','DD/MM/YYYY')-TO_DATE('"+GenDt+"','DD/MM/YYYY') FROM DUAL" ;
			//	System.out.println(" DUAL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					ContPriorGasNoOfDays = rset.getInt(1);
				}
				
	/*SB20200901		for(int i=no_of_days;i>=0;i--) {
				queryString = "SELECT TO_CHAR(TO_DATE('"+GenDt+"','DD/MM/YYYY')-"+i+",'DD/MM/YYYY') FROM DUAL";
//				System.out.println("Fetching all dates..."+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					VAll_Dt.add(rset.getString(1));
				} 
			}*/
			if(ContEndNoOfDays<0)
			{
				VRU_Physical_Leg.add("R");
				VRLNG_PHYS_INDIA_EXPOSURE_U.add("0");
			}
			else
			{
				VRU_Physical_Leg.add("U");
				VRLNG_PHYS_INDIA_EXPOSURE_U.add(TCQ);
			}
			
			double LNG_ICE_JKM_EXPO=(-1)*Double.parseDouble(TCQ)*Double.parseDouble(Slope);
			
			if(PriceType.equals("M") && ContEndNoOfDays<0)
			{
				VRU_Financial_Leg.add("R");
				VLNG_ICE_JKM_EXPOSURE_U.add("0");
				U_Phy_Leg=(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice));
				VU_Phy_Leg.add(nf.format(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice)));
				U_Fin_Leg=(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice));
				VU_Fin_Leg.add(nf.format(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice)));
				R_Fin_Leg=(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice));
				VR_Fin_Leg.add(nf.format(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice)));
			}
			else
			{
				VRU_Financial_Leg.add("U");
				if(Double.parseDouble(PriorMthCurvePrice)==0)
					VLNG_ICE_JKM_EXPOSURE_U.add(nf.format((-1)*Double.parseDouble(TCQ)*Double.parseDouble(Slope)));
				else
					VLNG_ICE_JKM_EXPOSURE_U.add("");
				U_Phy_Leg=(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice));
				VU_Phy_Leg.add(nf.format(Double.parseDouble(TCQ)*Double.parseDouble(PhyCurFrdPrice)));
				U_Fin_Leg=(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice));
				VU_Fin_Leg.add(nf.format(LNG_ICE_JKM_EXPO*Double.parseDouble(FinCurFrdPrice)));
				R_Fin_Leg=(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice));
				VR_Fin_Leg.add(nf.format(Double.parseDouble(AllocQty)*Double.parseDouble(DealPrice)));
			}
			VTotal.add(nf.format(U_Phy_Leg+U_Fin_Leg+R_Fin_Leg));
			////////////////////////////////////////////////////////////
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	
	public void MRCR_ContDtlTotal()
	{
		try
		{
			String PriceType=""; //FinCurFrdPrice=".5"; //PhyCurFrdPrice="2.5";
		
			double SumTotal=0;
			double TotalDCQTCQ=0;
			double TotalAllocQty=0;
			double TotalRealizedQty=0;
			double TotalUnRealizedQty=0;
			
			for(int i=0; i<VTotal.size(); i++)
			{
				TotalDCQTCQ=TotalDCQTCQ+Double.parseDouble(""+VDealDCQ.elementAt(i));
				if(!VDealAllocQty.elementAt(i).equals(""))
					TotalAllocQty=TotalAllocQty+Double.parseDouble(""+VDealAllocQty.elementAt(i));
				if(!VRLNG_PHYS_INDIA_EXPOSURE_U.elementAt(i).equals(""))
					TotalRealizedQty=TotalRealizedQty+Double.parseDouble(""+VRLNG_PHYS_INDIA_EXPOSURE_U.elementAt(i));
				if(!VLNG_ICE_JKM_EXPOSURE_U.elementAt(i).equals(""))
					TotalUnRealizedQty=TotalUnRealizedQty+Double.parseDouble(""+VLNG_ICE_JKM_EXPOSURE_U.elementAt(i));
				SumTotal=SumTotal+Double.parseDouble(""+VTotal.elementAt(i));
			}
			FinalTotal=nf.format(SumTotal);
			Total_DCQ_TCQ = nf.format(TotalDCQTCQ);
			Total_AllocQty = nf.format(TotalAllocQty);
			Total_RealizedQty = nf.format(TotalRealizedQty);
			Total_UnRealizedQty = nf.format(TotalUnRealizedQty);
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	////////////////////NEW Fn for Deal Exposure Dtl/////////
	public void fetchDealExposureDtl()
	{
		try
		{			
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			//Introduce By Milan 20110916 FOR MMSCM
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();	
			String Buy_Sell="Sell";
			Vector RE_GAS_REV_NO=new Vector();
			Vector LTCORA_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector LTCORA_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			/////////////////////////////////Count No of Mth/Days of Contract/////////////////////////////////////
			String ContMthWise_tmp_from_dt = " ";
			String ContMthWise_temp_dt="";
			Vector VContMthWise_FRM_DT=new Vector();
			Vector VContMthWise_TO_DT=new Vector();	
			Vector VContMthWise_gas_date=new Vector();	
			
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy') from FMS7_SN_MST A where "+ 
			 		"A.CUSTOMER_CD='"+DealCustCd+"' AND A.FGSA_NO='"+FgsaNo+"' AND A.FGSA_REV_NO='"+FgsaRevNo+"' AND A.SN_NO='"+SnNo+"' AND A.SN_REV_NO='"+SnRevNo+"' "+
			 		"AND (A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";
				System.out.println("DEAL-DTL: FMS7_SN_MST: "+queryString);
					rset = stmt.executeQuery(queryString);
					System.out.println("FOr SN : "+to_date+" "+from_date);
					while(rset.next())
					{				
						////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
					//	SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
					//	CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
						ContMthWise_tmp_from_dt = rset.getString(1)==null?"01/01/2000":rset.getString(1);
						ContMthWise_temp_dt = rset.getString(2)==null?"01/01/2020":rset.getString(2);
						VContMthWise_FRM_DT.add(rset.getString(1)==null?"01/01/2020":rset.getString(1));
						VContMthWise_TO_DT.add(rset.getString(2)==null?"01/01/2020":rset.getString(2));
						
						
						queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+rset.getString(5)+" "
								+ "and eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+rset.getString(5)+"' and eff_dt<=to_date('"+rset.getString(1)+"','dd/mm/yyyy'))";
						rset2 = stmt2.executeQuery(queryString);
						////System.out.println(queryString);
						if(rset2.next())
						{
							CUSTOMER_NM.add(rset2.getString(2)==null?"":rset2.getString(2));
							CUSTOMER_ABBR.add(rset2.getString(1)==null?"":rset2.getString(1));	
						}
						else
						{
							CUSTOMER_NM.add("");
							CUSTOMER_ABBR.add("");
						}		
						if(rset2.getString(1).equals("SEIPL"))
						{
							Buy_Sell="Buy";
						}
						String TEMP_apr_by=rset.getString(12)==null?"0":rset.getString(12);
					  	sn_apr_dt.add(rset.getString(13)==null?"-":rset.getString(13));
					  	String temp_ent_by=rset.getString(14)==null?"0":rset.getString(14);
					  	sn_ent_dt.add(rset.getString(15)==null?"-":rset.getString(15));
					  
					  	
					  	String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
					  	rset1=stmt1.executeQuery(queryString_nm);
					  	if(rset1.next()){
					  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
					  	}else{
					  		sn_apr_by.add("-");
					  	}
					  	
					  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
					  	rset1=stmt1.executeQuery(queryString_nm);
					  	if(rset1.next()){
					  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
					  	}else{
					  		sn_ent_by.add("-");
					  	}
					}
				/////////////////////////////////////////////////////////////////
						////////////To Find Price Type///////////////////////////////////
					String Mapp_Id=DealCustCd+"-"+FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
					String PriceType="";
					queryString ="SELECT PRICE_TYPE FROM FMS9_MRCR_CONT_DTL "+
					" where MAPPING_ID='"+Mapp_Id+"' AND CONTRACT_TYPE='S' AND FLAG='Y' ";
					rset = stmt.executeQuery(queryString);
//					//System.out.println(">>>>>>> "+queryString);
					if(rset.next())
					{
						PriceType=rset.getString(1);
					}
					if(PriceType.equals(""))
					{
						String NewSalePrice="";
						queryString ="SELECT NEW_SALE_PRICE FROM FMS8_CARGO_ALLOC_REVISED_DTL "+
								" where FGSA_NO='"+FgsaNo+"' AND FGSA_REV_NO='"+FgsaRevNo+"' AND SN_NO='"+SnNo+"' "
								+ "AND SN_REV_NO='"+SnRevNo+"' AND CUSTOMER_CD='"+DealCustCd+"' AND CONTRACT_TYPE='S' AND NEW_PRICE_EFF_DT <=TO_DATE('"+to_date+"','DD/MM/YYYY')";//AND FLAG='A' ";
						rset = stmt.executeQuery(queryString);
						System.out.println(">>>>>>> "+queryString);
						if(rset.next())
						{
							NewSalePrice=rset.getString(1);
							PriceType="M";
						}
						else
							PriceType="F";
						System.out.println("NewSalePrice>>>>>>> "+NewSalePrice);
					}
					////////////^^^^^^To Find Price Type///////////////////////////////////
			double count=0;
			if(ContMthWise_temp_dt.equals("")) {ContMthWise_temp_dt="01/02/2001"; ContMthWise_tmp_from_dt="01/02/2001";}
			String query="select to_date('"+ContMthWise_temp_dt+"','dd/mm/yyyy')- to_date('"+ContMthWise_tmp_from_dt+"','dd/mm/yyyy')+1 from dual";
			System.out.println("DEAL-DTL: FMS7_SN_MST: "+query);
			rset=stmt.executeQuery(query);
			if(rset.next())
			{
				count=rset.getDouble(1);
			}
			
			for(int i=0;i<count;i++)
			{
				String query1="select to_char(to_date('"+ContMthWise_tmp_from_dt+"','dd/mm/yyyy')+ "+i+",'dd/mm/yyyy') from dual";
				rset=stmt.executeQuery(query1);
				if(rset.next())
				{
					VContMthWise_gas_date.add(rset.getString(1));
				}	
			}	
				////Price Pulling from Table////////////////////////////
					String StartDate=""+VContMthWise_gas_date.elementAt(0);
					String tempStartDate[]=StartDate.split("/");
					String GenMth=tempStartDate[1]; String GenYr=tempStartDate[2]; String GenMthYr=GenMth+"/"+GenYr;
					StartDate=GenMthYr;
					VMthYrWise.add(StartDate);
					
					String INDEX_TYPE="LNG_ICE_JKM"; String PriceGen_Dt=""; String NextDate="";
					int ContEndNoOfDays=-1;
					for(int i=1; i<VContMthWise_gas_date.size();i++) {	
						NextDate=""+VContMthWise_gas_date.elementAt(i);
						String tempNextDate[]=NextDate.split("/");
						GenMth=tempNextDate[1]; GenYr=tempNextDate[2]; GenMthYr=GenMth+"/"+GenYr;
						
						PriceGen_Dt=StartDate;
						if(ContEndNoOfDays<0)
							MRCR_PriceOut(INDEX_TYPE, PriceGen_Dt);
						else
						{
							VMthYrWisePriceICE_JKM.add(PrvCurvePrice);
							VPriceIndex_SettleDate.add(PriceIndex_SettleDate);
							VPriceIndex_StartDate.add(PriceIndex_StartDate);
							VPriceIndex_EndDate.add(PriceIndex_EndDate);
							VConst_ICE_JKM.add(Const_ICE_JKM);
							VConst_RLNG_PHYS.add(Const_RLNG_PHYS);
							VConst_ICE_JKM_FLAG.add(Const_ICE_JKM_FLAG);
							VEff_Price.add(EffPriceSlopeConst);
							
							VSlope_BRENT.add(Slope_ICE_JKM);
							VSlope_ICE_JKM.add(Slope_ICE_JKM);
							VSlope_JKM.add(Slope_ICE_JKM);
							VSlope_LNG_PHYS.add(Slope_ICE_JKM);
							VSlope_RLNG_PHYS.add(Slope_ICE_JKM);
							VSlope.add(Slope_ICE_JKM);
							VSlope_FLAG.add(Slope_FLAG);
						}
						
						queryString = "SELECT TO_DATE('"+StartDate+"','MM/YYYY')-TO_DATE('"+GenMthYr+"','MM/YYYY') FROM DUAL" ;
						//	System.out.println(" DUAL: "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next()) {
								ContEndNoOfDays = rset.getInt(1);
							}												
						StartDate=""+GenMthYr;
						VMthYrWise.add(StartDate);
					}
					VMthYrWisePriceICE_JKM.add(""+PrvCurvePrice);
					VPriceIndex_SettleDate.add(""+PriceIndex_SettleDate);
					VPriceIndex_StartDate.add(""+PriceIndex_StartDate);
					VPriceIndex_EndDate.add(""+PriceIndex_EndDate);
					VConst_ICE_JKM.add(Const_ICE_JKM);
					VConst_RLNG_PHYS.add(Const_ICE_JKM);
					VConst_ICE_JKM_FLAG.add("N");
					VEff_Price.add(EffPriceSlopeConst);
					
					VSlope_BRENT.add(Slope_ICE_JKM);
					VSlope_ICE_JKM.add(Slope_ICE_JKM);
					VSlope_JKM.add(Slope_ICE_JKM);
					VSlope_LNG_PHYS.add(Slope_ICE_JKM);
					VSlope_RLNG_PHYS.add(Slope_ICE_JKM);
					VSlope.add(Slope_ICE_JKM);
					VSlope_FLAG.add(Slope_FLAG);
					
				
				////^^^^^^^Price Pulling from Table////////////////////////////

//			System.out.println(VContMthWise_gas_date.size()+"DEAL-DTL: VContMthWise_gas_date: "+VContMthWise_gas_date);
			for(int i=0;i<count;i++)
			{
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
	 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), A.DCQ from FMS7_SN_MST A where "+ 
	 		"A.CUSTOMER_CD='"+DealCustCd+"' AND A.FGSA_NO='"+FgsaNo+"' AND A.FGSA_REV_NO='"+FgsaRevNo+"' AND A.SN_NO='"+SnNo+"' AND A.SN_REV_NO='"+SnRevNo+"' "+
	 		"AND (A.START_DT <= to_date('"+VContMthWise_gas_date.elementAt(i)+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+VContMthWise_gas_date.elementAt(i)+"','dd/mm/yyyy')) AND " +
	 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
	 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.START_DT";
	//	System.out.println("DEAL-DTL: FMS7_SN_MST: "+queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{				
				////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(VContMthWise_gas_date.elementAt(i));
				TO_DT.add(VContMthWise_gas_date.elementAt(i));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add("S"+rset.getString(6)==null?"0":rset.getString(6));	
			  	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
			  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			  	tot_commitment=nf.format(tot_comit);
			  	SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
			  	SIGNING_DT.add(VContMthWise_gas_date.elementAt(i));
			  	RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
			  	///////////////////Get Variable DCQ//////////////////////////
			  	queryString = "SELECT NVL(dcq,'0') "
						+ " FROM FMS7_SN_DCQ_DTL A WHERE CUSTOMER_CD="+DealCustCd+" AND SN_NO="+SnNo+" AND SN_REV_NO="+SnRevNo+" AND FGSA_NO="+FgsaNo+" AND FGSA_REV_NO="+FgsaRevNo+" AND "
						+ " A.from_dt<=TO_DATE('"+VContMthWise_gas_date.elementAt(i)+"','DD/MM/YYYY') AND A.to_dt>=TO_DATE('"+VContMthWise_gas_date.elementAt(i)+"','DD/MM/YYYY') AND A.FLAG='Y' "
						+ " AND A.sn_rev_no=(SELECT MAX(B.sn_rev_no) FROM FMS7_SN_DCQ_DTL B WHERE A.fgsa_no=B.fgsa_no AND A.sn_no=B.sn_no AND "
						+ " A.customer_cd=B.customer_cd AND  B.from_dt<=TO_DATE('"+VContMthWise_gas_date.elementAt(i)+"','DD/MM/YYYY') AND B.to_dt>=TO_DATE('"+VContMthWise_gas_date.elementAt(i)+"','DD/MM/YYYY') AND B.FLAG='Y') ";
				//		System.out.println("FMS7_SN_DCQ_DTL: "+queryString);
						rset2 = stmt2.executeQuery(queryString);
						if(rset2.next())
						{
							VDealDCQ.add(rset2.getString(1));
							VDealDCQFlag.add("Y");
						}
						else
						{
							VDealDCQ.add(rset.getString(16)==null?"0":rset.getString(16));
							VDealDCQFlag.add("N");
						}
			  	///////////////////^^^^^Get Variable DCQ//////////////////////////
			}	
			}
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
											
			//	System.out.println("CUSTOMER_NM: "+CUSTOMER_NM);
				queryString ="select SUM(QTY_MMBTU) from FMS7_DAILY_ALLOCATION_DTL where CUSTOMER_CD="+DealCustCd+" " +
				 "AND SN_NO="+SnNo+" AND SN_REV_NO="+SnRevNo+" AND FGSA_NO="+FgsaNo+" " +
				 "AND FGSA_REV_NO="+FgsaRevNo+" AND GAS_DT between to_date('"+VContMthWise_gas_date.elementAt(i)+"','dd/mm/yyyy')" +
				 "AND to_date('"+VContMthWise_gas_date.elementAt(i)+"','dd/mm/yyyy') AND CONTRACT_TYPE='S'";
			//	System.out.println("EXPO: >>>>>>>FMS7_DAILY_ALLOCATION_DTL "+queryString);
				rset = stmt.executeQuery(queryString);
				
				if(rset.next())
				{
					SUPPLIEDMBTU.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))));
					//MD20110916
					SUPPLIEDMMSCM.add(rset.getString(1)==null?"0.00":nf.format(Double.parseDouble(rset.getString(1))/38900));
					if(rset.getString(1)!=null && !(rset.getString(1).equals("")))
					{
						sup_tot_comit+=Double.parseDouble(rset.getString(1));
						sup_tot_comit_mmscm+=(Double.parseDouble(rset.getString(1))/38900);//MD20110916
					}
					else
					{
						sup_tot_comit+=0;
						sup_tot_comit_mmscm+=0;//MD20110916
					}
				}
				else
				{
					SUPPLIEDMBTU.add("0.00");
					SUPPLIEDMMSCM.add("0.00");//MD20110916
					sup_tot_comit+=0;
					sup_tot_comit_mmscm+=0;//MD20110916
				}
				
				BALANCEMMBTU.add(nf.format(Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i))));
				//MD20110916
				BALANCEMMSCM.add(nf.format(Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i));
				bal_tot_comit_mmscm+=Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i));
				//System.out.println("SUPLIEDMMSCM : "+SUPPLIEDMMSCM+" TOTAL : "+sup_tot_comit_mmscm);
				//System.out.println("BALANCEMMSCM : "+BALANCEMMSCM+" TOTAL : "+bal_tot_comit_mmscm);
					
				//////////////SB20200817////////////////////////
				String TCQ=""; String Alloc_Qty=""; String Gen_Dt=to_date; String Cont_End_Dt=""; 
				TCQ=""+BOOKMMBTU.elementAt(i);
				String DCQ=""+VDealDCQ.elementAt(i); 
				TCQ=DCQ;
				Alloc_Qty=""+SUPPLIEDMBTU.elementAt(i); 
				Cont_End_Dt=""+TO_DT.elementAt(i);
			////	String Mapp_Id=CUSTOMER_CD.elementAt(i)+"-"+FGSA_NO.elementAt(i)+"-"+FGSA_REV_NO.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i);
				String Phy_CurFrd_Price="0"; String Fin_CurFrd_Price="0";
				//String Buy_Sell="SELL";
				if(Buy_Sell.equals("Buy"))
				{
					VDealAllocQty.add(Alloc_Qty);
				}
				else
					VDealAllocQty.add("-"+Alloc_Qty);
			
				String PriorCurveGasPrice="";
			//	if(VMthYrWisePriceICE_JKM.elementAt(i).equals(""))
					PriorCurveGasPrice=""+VMthYrWisePriceICE_JKM.elementAt(i);
				
				String DealPrice="";
				DealPrice=""+RATE.elementAt(i);
				String Slope="1.025";
				String GasDate=""+VContMthWise_gas_date.elementAt(i);
				MRCR_ContDtl(Mapp_Id, Buy_Sell,PriceType,DealPrice, TCQ, Alloc_Qty,GasDate, Gen_Dt, Cont_End_Dt, Phy_CurFrd_Price, Fin_CurFrd_Price, Slope, PriorCurveGasPrice);
				////////////////////////////////////////////////
		   }
		   sup_tot_comitment=nf.format(sup_tot_comit);
		   bal_tot_comitment=nf.format(bal_tot_comit);
		   
		   //Introduce by Milan 20010916
		   sup_tot_comitment_mmscm=nf.format(sup_tot_comit_mmscm);
		   bal_tot_comitment_mmscm=nf.format(bal_tot_comit_mmscm);
		   
		    System.out.println("VMthYrWisePriceICE_JKM "+VMthYrWisePriceICE_JKM.size());
			System.out.println("VPriceType "+VPriceType.size());
			System.out.println("VDealPriceCurve "+VDealPriceCurve.size());
			System.out.println("VDealPhysCurve "+VDealPhysCurve.size());
			System.out.println("VCargoRefNo "+VCargoRefNo.size());
			System.out.println("VDealTCQ "+VDealTCQ.size());
			System.out.println("VRLNG_PHYS_IN_EXPO "+VRLNG_PHYS_IN_EXPO.size());
			System.out.println("VLNG_ICE_JKM_EXPO "+VLNG_ICE_JKM_EXPO.size());
			System.out.println("VRU_Physical_Leg "+VRU_Physical_Leg.size());
			System.out.println("VRLNG_PHYS_INDIA_EXPOSURE_U "+VRLNG_PHYS_INDIA_EXPOSURE_U.size());
			System.out.println("VRU_Financial_Leg "+VRU_Financial_Leg.size());
			System.out.println("VLNG_ICE_JKM_EXPOSURE_U "+VLNG_ICE_JKM_EXPOSURE_U.size());
			System.out.println("VU_Phy_Leg "+VU_Phy_Leg.size());
			System.out.println("VU_Fin_Leg "+VU_Fin_Leg.size());
			System.out.println("VR_Fin_Leg "+VR_Fin_Leg.size());
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	public void CR_CollateralCalculation() //SB20201118
	{
		try
		{
			String PriceType=""; //FinCurFrdPrice=".5"; //PhyCurFrdPrice="2.5";
		
			double BalanceTotal=0;
			double TotalCollateral=0;
			double TotalCollateralLinked=0;
			double TotalGrossExpoTaxINR=0;
			double TotalLimit=0;

			String PrevCustCd="0";
			String NextCustCd = "0"; //HARSH20210514
			int k=0;//HARSH20210514
			for(int i=0; i<VCollateralValue.size(); i++)
			{
				TotalLimit=TotalLimit+Double.parseDouble(""+VGrossExposureAmtInclTax.elementAt(i));
				
				if(!VGrossExposureAmtInclTax.elementAt(i).equals(""))
				{
					TotalGrossExpoTaxINR=Double.parseDouble(""+VGrossExposureAmtInclTax.elementAt(i));
				}
				else//HARSH20210708
				{
					TotalGrossExpoTaxINR=0;
				}
				if(!VCollateralValue.elementAt(i).equals(""))
				{
					TotalCollateral=Double.parseDouble(""+VCollateralValue.elementAt(i));
				}
				else //HARSH20210708
				{
					TotalCollateral=0;
				}
				if(!VCollateralValueLinked.elementAt(i).equals(""))
				{
					TotalCollateralLinked=Double.parseDouble(""+VCollateralValueLinked.elementAt(i));
				}
				else //HARSH20210708 THIS ISSUE RAISED BY SHI TING 08/07/2021  
				{
					TotalCollateralLinked=0;
				}
				if(BalanceTotal>0)
				{
				//	TotalCollateralLinked=0;
				///	TotalCollateral=0;
				}
				
				//HARSH20210514 LIVE ISSUE LINK SECURITY NOT CALCULATED AS PER SHI TING MAIL 14/05/2021
				k=k+1;
				if(k >= CUSTOMER_CD.size())
				{
					NextCustCd="0";
				}
				else
				{
					NextCustCd=CUSTOMER_CD.elementAt(k).toString();
				}
				///////////////////////////////
				if(!PrevCustCd.equals(CUSTOMER_CD.elementAt(i)))
				{
					if(!NextCustCd.equals(CUSTOMER_CD.elementAt(i))) //HARSH20210514
					{
						double CollLink = 0;
						if(!VCollateralValueLinked.elementAt(i).equals(""))
							CollLink=Double.parseDouble(""+VCollateralValueLinked.elementAt(i));
						BalanceTotal=TotalGrossExpoTaxINR-(TotalCollateral+CollLink);
						VCollateralBalance.add(nf.format(BalanceTotal));
						VNetExposure.add(nf.format(BalanceTotal)); 
					} //HARSH20210514
					else //HARSH20210514
					{
						BalanceTotal=TotalGrossExpoTaxINR-TotalCollateral;
						VCollateralBalance.add(nf.format(BalanceTotal));
						VNetExposure.add(nf.format(BalanceTotal)); //SB20201118
					}
				}
				else
				{
					if(BalanceTotal>=0)
					{
						TotalCollateralLinked=0;
						BalanceTotal=(TotalGrossExpoTaxINR-TotalCollateral-TotalCollateralLinked);//+BalanceTotal;
						VCollateralBalance.add(nf.format(TotalCollateralLinked));
						VNetExposure.add(nf.format(BalanceTotal)); //SB20201118
					}
					else
					{
						if((-1)*BalanceTotal<TotalCollateralLinked)
							TotalCollateralLinked=(-1)*BalanceTotal;
						BalanceTotal=(TotalGrossExpoTaxINR-TotalCollateral-TotalCollateralLinked);//+BalanceTotal;
						VCollateralBalance.add(nf.format(TotalCollateralLinked));
						VNetExposure.add(nf.format(BalanceTotal)); //SB20201118
					}
				}				
				/*VNetExposure.add();//////////////////For Limit/////////////////
				double netExposure=0; double limitValue=0; double creditExceed=0;
				VLimitValue.add(""+VLimitValueLinked.elementAt(i));
				netExposure=BalanceTotal;
				if(!VLimitValueLinked.elementAt(i).equals(""))
					limitValue=Double.parseDouble(""+VLimitValueLinked.elementAt(i));
				if(netExposure>0) 
					//SB20200918: as per Shi email	creditExceed=netExposure;
					creditExceed=netExposure-limitValue; //SB20200918: as per Shi email
				VCreditExceed.add(nf.format(creditExceed));
				
				double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(i));
				VNetExposureUSD.add(nf.format(netExposure/LastExchgRate));
				VCreditExceedUSD.add(nf.format(creditExceed/LastExchgRate));
				*////////////////////////////////////////////////////////////////
				PrevCustCd=""+CUSTOMER_CD.elementAt(i);
			}
			CR_LimitCalculation();
			CR_LTCORA_DEAL(); //HARSH20210609 ONLY APPEAR ON SIGNING DATE
			CR_BuyDeal(); //HARSH20201208 Only For Buy Deal
			
			////////////////////////////////////Logic For Reason Of Exceed////////////////////HARSH20201120
			double collateralValue = 0;double collateralLinkedValue = 0; double limitValue=0;double parentLimitValue=0;double credit_exceed = 0;
			for(int j=0; j<VCollateralValue.size(); j++)
			{
				String reasonExceed="";
				if(!VCollateralValue.elementAt(j).equals(""))
					collateralValue= Double.parseDouble(""+VCollateralValue.elementAt(j));
				else
					collateralValue=0.00;
				if(!VLimitValue.elementAt(j).equals(""))
					limitValue= Double.parseDouble(""+VLimitValue.elementAt(j));
				else
					limitValue=0.00;
				if(!VCollateralValueLinked.elementAt(j).equals(""))
					collateralLinkedValue = Double.parseDouble(""+VCollateralValueLinked.elementAt(j));
				else
					collateralLinkedValue = 0.00;
				if(!VParentLimitValue.elementAt(j).equals(""))
					parentLimitValue = Double.parseDouble(""+VParentLimitValue.elementAt(j));
				else
					parentLimitValue = 0.00;
				
				if(!VCreditExceed.elementAt(j).equals(""))
					credit_exceed = Double.parseDouble(""+VCreditExceed.elementAt(j));
				else
					credit_exceed = 0.00;
				
				//Shi Ting 07/12/20202: //HARSH20201208
				//1)Credit limit exceeded (Logic: If counter partys exposure exceeds credit limit / collateral 
				//(if counter party has parent, it will use parents limit) for any of the exposure date
				//2)For new deals entered on trade date = EOD date, Open deal with counterparty having no credit limit
				//(Logic: if sell deal, counterparty has no limit, but security type entered during deal captured is open account)
				//3)For new deals entered on trade date = EOD date, Security required for counterparty rated C and D
				//(Logic: if buy deal, counterparty is rated C and D but security type entered during deal captured is open account)
				
				//THE PURPOSE IS IF BUY DEAL THEN CHECK START DT == SYSDATE IF YES THEN CHECK CREDIT RATING C OR D & OPEN ACCOUNT IF YES THEN SHOW BUY DEAL IN EXCEED CREDIT REPORT OTHERWISH NOT SHOW AS PER CUSTOMER FEEDBACK ON  19/02/2021
				String ExceedReasonflag = "N"; //only for buy deal HARSH20210223
				
				//HARSH20210607 IF EXCEED > 0 AND CONTERPARTY HAVING NO COLLATERAL AND NO LIMIT THEN IT WILL APPEAR IN EXCEDD REPORT AS FLAG THE EXCEED AS PER SHI TING MAIL ON 07/06/2021 
				if(credit_exceed > 0)
				{
					if((collateralValue > 0.00 || collateralLinkedValue > 0.00) || (limitValue > 0.00 || parentLimitValue > 0.00))
					{
						reasonExceed = "Credit Limit or Collateral Value Exceed";
						ExceedReasonflag = "Y"; //HARSH20210223
					}
					else //HARSH20210607
					{
						reasonExceed = "Credit Limit or Collateral Value Exceed";//HARSH20210607
						ExceedReasonflag = "Y";//HARSH20210607
					}
				}
				String sys_dt="";
				String sysdate = "select to_char(sysdate,'DD/MM/YYYY') from dual";
				rset=stmt.executeQuery(sysdate);
				if(rset.next())
				{
					sys_dt=rset.getString(1)==null?"":rset.getString(1);
				}
				//sys_dt="01/12/2020"; //testing HARSH20201208
				//HARSH20210315 if(VContStDt.elementAt(j).equals(to_date))
				if(SIGNING_DT.elementAt(j).equals(to_date)) //NOW TRAED_DATE IS A SIGNING DATE SO, WE COMPARE WITH REPORT DATE AS PER FEEDBACK ON 15/03/2021 
				{
					String checkOA="";
					if(!VContType.elementAt(j).equals("B"))
					{
						String DealId = VDealUniqueId.elementAt(j).toString();
						if(!VContType.elementAt(j).equals("C"))
						{
							String fgsano = "0";
							String snno="0";
							if(!DealId.equals(""))
							{
								String dealid[] = DealId.split("-");
								fgsano = dealid[0].substring(1,dealid[0].length());
								snno = dealid[2]; 
							}
							DealId = VContType.elementAt(j)+fgsano+"-%-"+snno+"-%";
						}
						checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and link like '"+DealId+"' and sec_type='OA'";// and issu_dt <= to_date('"+to_date+"','dd/mm/yyyy') and exp_dt >= to_date('"+to_date+"','dd/mm/yyyy')";
						//HARSH20210215 USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
					}
					else
					{
						//checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr=(select cust_abbr from fms9_limit_mst where cust_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and (credit_rating='C' or credit_rating='D')) and link='"+VDealUniqueId.elementAt(j)+"' and sec_type='OA'";
						checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and link='"+VDealUniqueId.elementAt(j)+"' and sec_type='OA'";
						//HARSH20210215 USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
					}
					//System.out.println("Open Account:-------"+checkOA);
					rset1 = stmt1.executeQuery(checkOA);
					int found = 0;
					if(rset1.next())
					{
						found = rset1.getInt(1);
					}
					if(found > 0)
					{
						if(VContType.elementAt(j).equals("B"))
						{
							String credit_rating = "";
							queryString="select credit_rating from fms9_limit_mst where cust_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' AND RATING_EFF_DATE=(SELECT MAX(RATING_EFF_DATE) FROM FMS9_LIMIT_MST WHERE CUST_ABBR='"+CUSTOMER_ABBR.elementAt(j)+"')";
							rset3=stmt3.executeQuery(queryString);
							if(rset3.next())
							{
								credit_rating = rset3.getString(1)==null?"":rset3.getString(1);
							}
							
							if(credit_rating.equals(""))//HARSH20210609 AS PER SHI TING MAIL ON 09/06/2021
							{
								reasonExceed = "Security required for counterparty with no rating";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
							else if(credit_rating.equals("C") || credit_rating.equals("D"))
							{
								reasonExceed = "Security required for counterparty rated C and D";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
						}
						else
						{
							if(limitValue <= 0.00){
								reasonExceed = "Open Deal With Counter Party having no Credit Limit";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
						}
					}
					/*else
					{
						//reasonExceed = "Unsecured deal with counterparty having no credit limit";
						//ExceedReasonflag = "N"; //HARSH20210223
					}*/
					
				}
				/*else
				{
					if(limitValue <= 0.00 &&(collateralValue <= 0.00 || collateralLinkedValue <= 0.00))
					{
						//reasonExceed = "Unsecured deal with counterparty having no credit limit";
						//ExceedReasonflag = "N"; //HARSH20210223
					}
				}*/
				VReasonExceedCredit.add(reasonExceed);
				VReasonExceedCreditFlag.add(ExceedReasonflag); //HARSH20210223
			}
				
			/////////////////////////////////////////////////////////////////////////////////
			System.out.println(CUSTOMER_CD.size()+":CUSTOMER_CD: "+CUSTOMER_CD);
			System.out.println(VCollateralValue.size()+":VCollateralValue: "+VCollateralValue);
			System.out.println(VLimitValue.size()+":VLimitValue: "+VLimitValue);
			System.out.println(VCollateralBalance.size()+":VCollateralBalance: "+VCollateralBalance);
			System.out.println(VNetExposure.size()+":VNetExposure: "+VNetExposure);
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	
	//HARSH20211229 AS PER INCIDENT#216 FOLLOWING FUNCATION HAS BEEN CREATED
	public void CR_CollateralCalculation_V2() 
	{
		try
		{
			System.out.println(link_cd);
			double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
			queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI FIRST RATE TT BUY SELL'"; //AS PER FEEDBACK ON 06/04/2021
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
				exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
			}
			queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
					+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				exchgRate = rset1.getDouble(1);
			}
			
			Iterator o = link_cd.keySet().iterator();
		    while (o.hasNext()) 
		    {
		    	String key = (String) o.next();
		        HashMap<String,String> info = new HashMap<String,String>(); 
		        queryString ="SELECT NVL(REF_NO,'*'), VALUE,CURRENCY from FMS9_SECURITY_POST_MST "+  
							" WHERE CUSTOMER_ABBR='"+key+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' AND MAPPING_ID IS NOT NULL "
							+ "AND LINK IS NOT NULL AND LINK != '0' AND LINK NOT LIKE 'B%' "
							+ "GROUP BY REF_NO, VALUE, CURRENCY";
		        rset=stmt.executeQuery(queryString);
		        while(rset.next())
				{
					String LinkedRefNo=rset.getString(1)==null?"":rset.getString(1); 
					double LinkedValue=Double.parseDouble(""+rset.getString(2)==null?"0":rset.getString(2));
					String currency= rset.getString(3)==null?"":rset.getString(3);
					
					double LastExchgRate=exchgRate;
					double TotalLinkedValue=0;
					if(currency.equals("USD"))
					{
						LinkedValue = LinkedValue * LastExchgRate;
					}
					
					info.put(LinkedRefNo, nf.format(LinkedValue));
				}
		        link_cd.replace(key, info);
		        System.out.println(key+" : " + link_cd.get(key));
		    }
			
		    
			for(int i=0; i<VCollateralValue.size(); i++)
			{
				double LastExchRate = Double.parseDouble(""+VExchgRate.elementAt(i));
				double netExposure = 0;
				double prevNetExpo=0;
				double beforeDeducation = 0;
				double TotalGrossExpoTaxINR=0;
				
				if(!VGrossExposureAmtInclTax.elementAt(i).equals(""))
				{
					TotalGrossExpoTaxINR=Double.parseDouble(""+VGrossExposureAmtInclTax.elementAt(i));
				}
				else
				{
					TotalGrossExpoTaxINR=0;
				}
				
				netExposure = TotalGrossExpoTaxINR;
				
				String SecurityDeducationInfo = "";
				
				double SharedSecurity=0;
				double DedicatedSecurity=0;
				
				if(VContType.elementAt(i).equals("C")) 
				{
					queryString ="SELECT REF_NO, VALUE,CURRENCY from FMS9_SECURITY_POST_MST A "
							+ "WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "LINK LIKE '"+VDealUniqueId.elementAt(i)+"' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' "
							+ "GROUP BY VALUE,REF_NO,CURRENCY "
							+ "ORDER BY (SELECT COUNT(REF_NO) FROM FMS9_SECURITY_POST_MST C WHERE C.REF_NO=A.REF_NO) ";
				}
				else
				{
					String DealId = VDealUniqueId.elementAt(i).toString();
					String fgsano = "0";
					String snno="0";
					if(!DealId.equals(""))
					{
						String dealid[] = DealId.split("-");
						fgsano = dealid[0].substring(1,dealid[0].length());
						snno = dealid[2]; 
					}
					queryString ="SELECT REF_NO, VALUE,CURRENCY from FMS9_SECURITY_POST_MST A "
							+ "WHERE CUSTOMER_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND ISSU_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND (EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND "
							+ "LINK LIKE '"+VContType.elementAt(i)+""+fgsano+"-%-"+snno+"-%' AND APRV_BY IS NOT NULL AND FLAG IN ('Y','N','X') AND RECEIVED='R' "
							+ "GROUP BY VALUE,REF_NO,CURRENCY "
							+ "ORDER BY (SELECT COUNT(REF_NO) FROM FMS9_SECURITY_POST_MST C WHERE C.REF_NO=A.REF_NO) ";
					
				}
				
				rset=stmt.executeQuery(queryString);
				//System.out.println("-------------------"+VDealUniqueId.elementAt(i).toString()+"---------------------");
				while(rset.next())
				{
					//System.out.println("Ref No :: "+rset.getString(1));
					//System.out.println("Actual Amt :: "+rset.getString(2));
					
					String security_ref = rset.getString(1)==null?"":rset.getString(1);
					double security_amt = rset.getDouble(2);
					String currency = rset.getString(3)==null?"":rset.getString(3);
					
					double amount = 0;
					
					if(currency.equals("USD"))
					{
						amount = security_amt * LastExchRate;
					}
					else
					{
						amount = security_amt;
					}
					
					int count =0;
					double count_amt = 0;
					
					String selected_key = "";
					String selected_key1 = "";
					
					Iterator q = link_cd.keySet().iterator();
				    while (q.hasNext()) 
				    {
				    	String key = (String) q.next();
				    	if(key.equals(CUSTOMER_ABBR.elementAt(i)))
				    	{
				    		selected_key=key;
				    		HashMap<String, String> qq = link_cd.get(key);
				    		
				    		Iterator ee = qq.keySet().iterator();
				    		while (ee.hasNext()) 
							{
				    			String key1 = (String) ee.next();
				    			//System.out.println("###"+key1+"==>"+qq.get(key1));
				    			String amt = qq.get(key1);
				    			 
				    			if(key1.toString().equals(security_ref))
				    			{ 
				    				selected_key1=key1;
				    				count+=1;
				    				count_amt = Double.parseDouble(amt);
				    			}
							}
				    		
				    		prevNetExpo = netExposure;
						    beforeDeducation = count_amt;
						    
						    if(count >= 1)
						    {
						    	double afterDeducation=0;
						    	if(count_amt > 0)
						    	{
						    		if(netExposure > 0)
						    		{
						    			netExposure = netExposure-count_amt;
						    			
						    			if(netExposure <= 0)
						    			{
						    				netExposure=0;
						    			}
						    			//System.out.println("PreNet-->"+nf.format(prevNetExpo)+"==NetExpo-->"+nf.format(netExposure));
						    			afterDeducation = prevNetExpo - netExposure;
						    			//System.out.println("beforeDeducation-->"+nf.format(beforeDeducation)+"==afterDeducation-->"+nf.format(afterDeducation));
						    			double afterDeducationShared = beforeDeducation - afterDeducation;
						    	
						    			//System.out.println("----------->"+nf.format(afterDeducationShared));
						    			//System.out.println("NetExpo :: "+nf.format(prevNetExpo)+"\nHashMap Value :: "+nf.format(beforeDeducation)+"\nDeducation :: "+nf.format(afterDeducation)+"\nAfterDeducationShared :: "+nf.format(afterDeducationShared));
						    		
						    			qq.replace(selected_key1, nf.format(afterDeducationShared));
						    		}
						    		else
						    		{
						    			afterDeducation = 0;
						    		}
						    	}
						    	else
						    	{
						    		afterDeducation = count_amt;
						    	}
						    	
						    	if(SecurityDeducationInfo.equals(""))
				    			{
				    				SecurityDeducationInfo+="(S) "+selected_key1+" : "+nf.format(afterDeducation);
				    			}
				    			else
				    			{
				    				SecurityDeducationInfo+="\n(S) "+selected_key1+" : "+nf.format(afterDeducation);
				    			}
						    	
						    	SharedSecurity+=amount;
						    }
						    else
						    {
						    	netExposure = netExposure-amount;
						    	
						    	if(SecurityDeducationInfo.equals(""))
				    			{
				    				SecurityDeducationInfo +="(D) "+security_ref+" : "+nf.format(amount);
				    			}
				    			else
				    			{
				    				SecurityDeducationInfo +="\n(D) "+security_ref+" : "+nf.format(amount);
				    			}
						    	
						    	DedicatedSecurity += amount;
						    	//System.out.println("NetExpo :: "+nf.format(netExposure));
						    }
						    link_cd.replace(selected_key,qq);
				    	}
				    }
				    //System.out.println(link_cd.get(selected_key)+"\n");
				}
				//System.out.println("----------------------------------------");
				VSecurityDeducationInfo.add(SecurityDeducationInfo);
				VCollateralValue.remove(i);
				VCollateralValue.add(i, nf.format(DedicatedSecurity));
				VCollateralValueLinked.remove(i);
				VCollateralValueLinked.add(i, nf.format(SharedSecurity));
				VNetExposure.add(nf.format(netExposure));
			}
			CR_LimitCalculation();
			CR_LTCORA_DEAL(); //HARSH20210609 ONLY APPEAR ON SIGNING DATE
			CR_BuyDeal(); //HARSH20201208 Only For Buy Deal
			
			////////////////////////////////////Logic For Reason Of Exceed////////////////////HARSH20201120
			double collateralValue = 0;double collateralLinkedValue = 0; double limitValue=0;double parentLimitValue=0;double credit_exceed = 0;
			for(int j=0; j<VCollateralValue.size(); j++)
			{
				String reasonExceed="";
				if(!VCollateralValue.elementAt(j).equals(""))
					collateralValue= Double.parseDouble(""+VCollateralValue.elementAt(j));
				else
					collateralValue=0.00;
				if(!VLimitValue.elementAt(j).equals(""))
					limitValue= Double.parseDouble(""+VLimitValue.elementAt(j));
				else
					limitValue=0.00;
				if(!VCollateralValueLinked.elementAt(j).equals(""))
					collateralLinkedValue = Double.parseDouble(""+VCollateralValueLinked.elementAt(j));
				else
					collateralLinkedValue = 0.00;
				if(!VParentLimitValue.elementAt(j).equals(""))
					parentLimitValue = Double.parseDouble(""+VParentLimitValue.elementAt(j));
				else
					parentLimitValue = 0.00;
				
				if(!VCreditExceed.elementAt(j).equals(""))
					credit_exceed = Double.parseDouble(""+VCreditExceed.elementAt(j));
				else
					credit_exceed = 0.00;
				
				//Shi Ting 07/12/20202: //HARSH20201208
				//1)Credit limit exceeded (Logic: If counter partys exposure exceeds credit limit / collateral 
				//(if counter party has parent, it will use parents limit) for any of the exposure date
				//2)For new deals entered on trade date = EOD date, Open deal with counterparty having no credit limit
				//(Logic: if sell deal, counterparty has no limit, but security type entered during deal captured is open account)
				//3)For new deals entered on trade date = EOD date, Security required for counterparty rated C and D
				//(Logic: if buy deal, counterparty is rated C and D but security type entered during deal captured is open account)
				
				//THE PURPOSE IS IF BUY DEAL THEN CHECK START DT == SYSDATE IF YES THEN CHECK CREDIT RATING C OR D & OPEN ACCOUNT IF YES THEN SHOW BUY DEAL IN EXCEED CREDIT REPORT OTHERWISH NOT SHOW AS PER CUSTOMER FEEDBACK ON  19/02/2021
				String ExceedReasonflag = "N"; //only for buy deal HARSH20210223
				
				//HARSH20210607 IF EXCEED > 0 AND CONTERPARTY HAVING NO COLLATERAL AND NO LIMIT THEN IT WILL APPEAR IN EXCEDD REPORT AS FLAG THE EXCEED AS PER SHI TING MAIL ON 07/06/2021 
				if(credit_exceed > 0)
				{
					if((collateralValue > 0.00 || collateralLinkedValue > 0.00) || (limitValue > 0.00 || parentLimitValue > 0.00))
					{
						reasonExceed = "Credit Limit or Collateral Value Exceed";
						ExceedReasonflag = "Y"; //HARSH20210223
					}
					else //HARSH20210607
					{
						reasonExceed = "Credit Limit or Collateral Value Exceed";//HARSH20210607
						ExceedReasonflag = "Y";//HARSH20210607
					}
				}
				String sys_dt="";
				String sysdate = "select to_char(sysdate,'DD/MM/YYYY') from dual";
				rset=stmt.executeQuery(sysdate);
				if(rset.next())
				{
					sys_dt=rset.getString(1)==null?"":rset.getString(1);
				}
				//sys_dt="01/12/2020"; //testing HARSH20201208
				//HARSH20210315 if(VContStDt.elementAt(j).equals(to_date))
				if(SIGNING_DT.elementAt(j).equals(to_date)) //NOW TRAED_DATE IS A SIGNING DATE SO, WE COMPARE WITH REPORT DATE AS PER FEEDBACK ON 15/03/2021 
				{
					String checkOA="";
					if(!VContType.elementAt(j).equals("B"))
					{
						String DealId = VDealUniqueId.elementAt(j).toString();
						if(!VContType.elementAt(j).equals("C"))
						{
							String fgsano = "0";
							String snno="0";
							if(!DealId.equals(""))
							{
								String dealid[] = DealId.split("-");
								fgsano = dealid[0].substring(1,dealid[0].length());
								snno = dealid[2]; 
							}
							DealId = VContType.elementAt(j)+fgsano+"-%-"+snno+"-%";
						}
						checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and link like '"+DealId+"' and sec_type='OA'";// and issu_dt <= to_date('"+to_date+"','dd/mm/yyyy') and exp_dt >= to_date('"+to_date+"','dd/mm/yyyy')";
						//HARSH20210215 USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
					}
					else
					{
						//checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr=(select cust_abbr from fms9_limit_mst where cust_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and (credit_rating='C' or credit_rating='D')) and link='"+VDealUniqueId.elementAt(j)+"' and sec_type='OA'";
						checkOA = "select nvl(count(*),0) from fms9_security_post_mst where customer_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' and link='"+VDealUniqueId.elementAt(j)+"' and sec_type='OA'";
						//HARSH20210215 USEDE CUSTOMER_ABBR INSATED OF CUSTOMER_CD
					}
					//System.out.println("Open Account:-------"+checkOA);
					rset1 = stmt1.executeQuery(checkOA);
					int found = 0;
					if(rset1.next())
					{
						found = rset1.getInt(1);
					}
					if(found > 0)
					{
						if(VContType.elementAt(j).equals("B"))
						{
							String credit_rating = "";
							queryString="select credit_rating from fms9_limit_mst where cust_abbr='"+CUSTOMER_ABBR.elementAt(j)+"' AND RATING_EFF_DATE=(SELECT MAX(RATING_EFF_DATE) FROM FMS9_LIMIT_MST WHERE CUST_ABBR='"+CUSTOMER_ABBR.elementAt(j)+"')";
							rset3=stmt3.executeQuery(queryString);
							if(rset3.next())
							{
								credit_rating = rset3.getString(1)==null?"":rset3.getString(1);
							}
							
							if(credit_rating.equals(""))//HARSH20210609 AS PER SHI TING MAIL ON 09/06/2021
							{
								reasonExceed = "Security required for counterparty with no rating";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
							else if(credit_rating.equals("C") || credit_rating.equals("D"))
							{
								reasonExceed = "Security required for counterparty rated C and D";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
						}
						else
						{
							if(limitValue <= 0.00){
								reasonExceed = "Open Deal With Counter Party having no Credit Limit";
								ExceedReasonflag = "Y"; //HARSH20210223
							}
						}
					}
					/*else
					{
						//reasonExceed = "Unsecured deal with counterparty having no credit limit";
						//ExceedReasonflag = "N"; //HARSH20210223
					}*/
					
				}
				/*else
				{
					if(limitValue <= 0.00 &&(collateralValue <= 0.00 || collateralLinkedValue <= 0.00))
					{
						//reasonExceed = "Unsecured deal with counterparty having no credit limit";
						//ExceedReasonflag = "N"; //HARSH20210223
					}
				}*/
				VReasonExceedCredit.add(reasonExceed);
				VReasonExceedCreditFlag.add(ExceedReasonflag); //HARSH20210223
			}
				
			/////////////////////////////////////////////////////////////////////////////////
		}
		catch(Exception e)
		{
			e.printStackTrace();	
		}
	}
	
	Vector VSecurityDeducationInfo = new Vector(); //HARSH20211229
	public Vector getVSecurityDeducationInfo() {return VSecurityDeducationInfo;}//HARSH20211229
	
	////////////////////NEW Fn for Deal Exposure Dtl/////////
	public void CR_LimitCalculation() //SB20201118
	{
		try
		{
			double BalanceTotal=0;
			double TotalNetExpoTaxINR=0;
			double TotalLimit=0;
			double netExposure=0; double limitValue=0; double creditExceed=0;
			String PrevCustCd="0";
			for(int i=0; i<VLimitValueLinked.size(); i++)
			{
				if(!VLimitValueLinked.elementAt(i).equals(""))
					limitValue=Double.parseDouble(""+VLimitValueLinked.elementAt(i));	
				if(!VNetExposure.elementAt(i).equals(""))
					netExposure=Double.parseDouble(""+VNetExposure.elementAt(i));	
				creditExceed=0;
				if(!PrevCustCd.equals(CUSTOMER_CD.elementAt(i)))
				{
					BalanceTotal=netExposure-limitValue;
					if(BalanceTotal>0) 
						//SB20200918: as per Shi email	creditExceed=netExposure;
						creditExceed=netExposure-limitValue; //SB20200918: as per Shi email
					VCreditExceedBalance.add(nf.format(BalanceTotal));
					VCreditExceed.add(nf.format(creditExceed));
					VLimitValueLinkedComp.add("");
					
				}
				else
				{
					if(BalanceTotal>=0)
					{
						limitValue=0;
						BalanceTotal=(netExposure-limitValue);//+BalanceTotal;
						if(BalanceTotal>0) 
							creditExceed=netExposure-limitValue;
						VCreditExceedBalance.add(nf.format(limitValue));
						VCreditExceed.add(nf.format(creditExceed));
						VLimitValueLinkedComp.add(CUSTOMER_CD.elementAt(i));
					}
					else
					{
						if((-1)*BalanceTotal<limitValue)
							limitValue=(-1)*BalanceTotal;
						BalanceTotal=(netExposure-limitValue);//+BalanceTotal;
						if(BalanceTotal>0) 
							creditExceed=netExposure-limitValue;
						VCreditExceedBalance.add(nf.format(limitValue));
						VCreditExceed.add(nf.format(creditExceed));
						VLimitValueLinkedComp.add(CUSTOMER_CD.elementAt(i));
					}
				}				
				///VNetExposure.add();//////////////////For Limit/////////////////
				
				VLimitValue.add(""+VLimitValueLinked.elementAt(i));
				//HARSH20210305 VParentLimitValue.add("");//HARSH20201127
				///netExposure=BalanceTotal;
				
		///		if(netExposure>0) 
					//SB20200918: as per Shi email	creditExceed=netExposure;
			///		creditExceed=netExposure-limitValue; //SB20200918: as per Shi email
			///	VCreditExceed.add(nf.format(creditExceed));
				
				double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(i));
				
				if(LastExchgRate>0)
				{
					VNetExposureUSD.add(nf.format(netExposure/LastExchgRate));
					VCreditExceedUSD.add(nf.format(creditExceed/LastExchgRate));
				}
				else
				{
					VNetExposureUSD.add(nf.format(netExposure));
					VCreditExceedUSD.add(nf.format(creditExceed));
				}
					
				/////////////////////////////////////////////////////////////////
				PrevCustCd=""+CUSTOMER_CD.elementAt(i);
			}
			CR_ParentLimitCalculation();
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	///HARSH20201127//////Parent Limit Calculation//////////
	public void CR_ParentLimitCalculation()
	{
		try
		{
			/*double temp_netExposure = 0; double child_temp_netExposure = 0;
			double temp_Limit = 0; double child_temp_Limit = 0; double child_parent_limit = 0;
			double temp_creditExceed =0; double child_creditExceed=0;
			double temp_totalBalance=0; double child_temp_totalBalance=0; double child_totalBalance=0;
			double used_parent_limit = 0;
			String PrveCustCd="0"; String nextCustCd="0"; String custCd="0"; double prveCustLimit = 0; int k=0;
			for(int i=0; i<VLimitValue.size(); i++)
			{k++;
				if(k != CUSTOMER_CD.size())
				{
					nextCustCd = ""+CUSTOMER_CD.elementAt(k);
				}
				else
				{
					nextCustCd="0";
				}
				custCd = ""+CUSTOMER_CD.elementAt(i);
				
				temp_Limit = Double.parseDouble(""+VLimitValue.elementAt(i));
				temp_netExposure = Double.parseDouble(""+VNetExposure.elementAt(i));
				if(!PrveCustCd.equals(CUSTOMER_CD.elementAt(i)))
				{
					temp_totalBalance = temp_netExposure - temp_Limit;
					prveCustLimit = temp_totalBalance;
				}
				else
				{
					if(prveCustLimit >= 0)
					{
						temp_Limit = 0;
						prveCustLimit = temp_netExposure - temp_Limit;
						temp_totalBalance = prveCustLimit;
					}
					else
					{
						if((-1)*prveCustLimit<temp_Limit)
							temp_Limit=(-1)*prveCustLimit;
						prveCustLimit = temp_netExposure - temp_Limit;
						temp_totalBalance=prveCustLimit;
					}
					//temp_totalBalance = temp_netExposure - temp_Limit;
				}
				//System.out.println(CUSTOMER_CD.elementAt(i)+"temp_totalBalance--#"+nf.format(temp_totalBalance));
				//System.out.println(CUSTOMER_CD.elementAt(i)+"temp limit---#"+nf.format(temp_Limit));
				if(!custCd.equals(nextCustCd))
				{
					queryString = "SELECT CUST_ABBR,PARENT_OWNSHIP FROM FMS9_LIMIT_MST " //	HARSH20201208 CHECK BUY OR SELL
							+ "WHERE PARENT_OWNSHIP_ABBR='"+CUSTOMER_ABBR.elementAt(i)+"' AND PARENT_ENT_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND (PARENT_EXIT_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR PARENT_EXIT_DT IS NULL)"; //HARSH20201204 Added Parent Entry and Exit Date as per customer feedback on 03/12/2020
					rset = stmt.executeQuery(queryString);
					while(rset.next())
					{
						String cust_abbr = rset.getString(1)==null?"":rset.getString(1);
						for(int j=0; j<CUSTOMER_CD.size(); j++)
						{
							if(CUSTOMER_ABBR.elementAt(j).equals(cust_abbr))
							{
								if(temp_totalBalance < 0)
								{
									child_totalBalance=0;
									//System.out.println("-------------"+cust_cd+"------"+CUSTOMER_CD.elementAt(i)+"---------------");
									//System.out.println("Parent Total Limit avaliable--#"+nf.format(temp_totalBalance));
									child_temp_netExposure=Double.parseDouble(""+VNetExposure.elementAt(j));
									child_temp_Limit = Double.parseDouble(""+VLimitValue.elementAt(j));
									child_totalBalance = child_temp_netExposure - child_temp_Limit;
									//System.out.println("Befor IF --#"+nf.format(child_totalBalance));
									if(child_totalBalance>0)
									{
										//child_creditExceed = child_temp_netExposure - child_parent_limit;
										used_parent_limit = ((-1)*temp_totalBalance);
										child_parent_limit = child_temp_Limit + ((-1)*temp_totalBalance);
										if(child_temp_netExposure<0)
											child_temp_netExposure=0;
										child_totalBalance = child_temp_netExposure - child_parent_limit;
										if(child_totalBalance>0)
											child_creditExceed = child_temp_netExposure - child_parent_limit;
										temp_totalBalance=child_totalBalance;
										//used_parent_limit+=child_temp_parentLimit;
										//System.out.println("Child Net Exposuer--#"+nf.format(child_temp_netExposure));
										//System.out.println("Child Limit--#"+nf.format(child_temp_Limit));
										//System.out.println("Child Limit + Parent --#"+nf.format(child_parent_limit));
										//System.out.println("Child Total Balance --#"+nf.format(child_totalBalance));
										//System.out.println("Child creditExceed --#"+nf.format(child_creditExceed));
										//System.out.println("Parent Total Limit avaliable after--#"+nf.format(temp_totalBalance));
										
										VParentLimitValue.remove(j);
										VParentLimitValue.insertElementAt(nf.format(used_parent_limit), j);
										VCreditExceed.remove(j);
										VCreditExceed.insertElementAt(nf.format(child_creditExceed), j);
										double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(j));
										VCreditExceedUSD.remove(j);
										VCreditExceedUSD.insertElementAt(nf.format(child_creditExceed/LastExchgRate),j);
										//System.out.println("VParentLimitValue--"+VParentLimitValue);
										//System.out.println("temp_totalBalance---"+nf.format(temp_totalBalance));
										//System.out.println("----------------------");
									}
								}	
							}
						}
					}
				}
				PrveCustCd = ""+CUSTOMER_CD.elementAt(i);
			}*/
			//Parent Limit calculation for Inactive deal HARSH20210302
			for(int j=0; j < VParentAbbr.size(); j++)
			{
				if(VLimitParentFlag.elementAt(j).equals("Y"))
				{
					String flag = "N"; //Flag N is indicated inactive deal
					for(int i=0; i < CUSTOMER_ABBR.size(); i++)
					{
						if(VParentAbbr.elementAt(j).equals(CUSTOMER_ABBR.elementAt(i)))
						{
							//System.out.println("Yes");
							flag="Y"; //Flag Y is indicated active deal
						}
					}
					
					if(flag.equals("N"))
					{
						double creditExceed = Double.parseDouble(""+VCreditExceed.elementAt(j));
						double parentLimit= 0;
						if(!VParentLimitValue.elementAt(j).equals("")){
							parentLimit = Double.parseDouble(""+VParentLimitValue.elementAt(j));
						}
						double Limit = Double.parseDouble(""+VLimitValue.elementAt(j));
						double netExpo = Double.parseDouble(""+VNetExposure.elementAt(j));
						//System.out.println("##"+creditExceed+"##"+parentLimit);
						if(creditExceed > 0)
						{
							Limit = Limit + parentLimit;
							creditExceed = netExpo - Limit;
							if(creditExceed <= 0)
							{
								creditExceed = 0;
							}	
						}
						VCreditExceed.remove(j);
						VCreditExceed.insertElementAt(nf.format(creditExceed), j);
						double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(j));
						if(LastExchgRate>0)
						{
							VCreditExceedUSD.remove(j);
							VCreditExceedUSD.insertElementAt(nf.format(creditExceed/LastExchgRate),j);
						}
						else
						{
							VCreditExceedUSD.remove(j);
							VCreditExceedUSD.insertElementAt(nf.format(creditExceed),j);
						}
					}
				}
			}
			//Parent Limit calculation for Active deal HARSH20210302
			for(int j=0; j < VParentAbbr.size(); j++)
			{
				double CheckcreditExceed = Double.parseDouble(""+VCreditExceed.elementAt(j));
				if(CheckcreditExceed > 0)
				{
					if(VLimitParentFlag.elementAt(j).equals("Y"))
					{
						double temp_netExposure = 0; double child_temp_netExposure = 0;
						double temp_Limit = 0; double child_temp_Limit = 0; double child_parent_limit = 0;
						double temp_creditExceed =0; double child_creditExceed=0;
						double temp_totalBalance=0; double child_temp_totalBalance=0; double child_totalBalance=0;
						double used_parent_limit = 0;
						int k=0; String nextCustCd="0"; String PrveCustCd="0";double prveCustLimit = 0;String custCd="0";
						for(int i=0; i < CUSTOMER_ABBR.size(); i++)
						{
							k++;
							if(k != CUSTOMER_CD.size())
							{
								nextCustCd = ""+CUSTOMER_CD.elementAt(k);
							}
							else
							{
								nextCustCd="0";
							}
							
							temp_Limit = Double.parseDouble(""+VLimitValue.elementAt(i));
							temp_netExposure = Double.parseDouble(""+VNetExposure.elementAt(i));
							if(!PrveCustCd.equals(CUSTOMER_CD.elementAt(i)))
							{
								temp_totalBalance = temp_netExposure - temp_Limit;
								prveCustLimit = temp_totalBalance;
							}
							else
							{
								if(prveCustLimit >= 0)
								{
									temp_Limit = 0;
									prveCustLimit = temp_netExposure - temp_Limit;
									temp_totalBalance = prveCustLimit;
								}
								else
								{
									if((-1)*prveCustLimit<temp_Limit)
										temp_Limit=(-1)*prveCustLimit;
									prveCustLimit = temp_netExposure - temp_Limit;
									temp_totalBalance=prveCustLimit;
								}
								//temp_totalBalance = temp_netExposure - temp_Limit;
							}
							if(!custCd.equals(nextCustCd))
							{
								if(VParentAbbr.elementAt(j).equals(CUSTOMER_ABBR.elementAt(i)))
								{
									if(temp_totalBalance < 0)
									{
										double creditExceed = Double.parseDouble(""+VCreditExceed.elementAt(j));
										double Limit = Double.parseDouble(""+VLimitValue.elementAt(j));
										double netExpo = Double.parseDouble(""+VNetExposure.elementAt(j));
										if(creditExceed > 0)
										{
											Limit = Limit + (-1)*temp_totalBalance;
											creditExceed = netExpo - Limit;
											if(creditExceed <= 0)
											{
												creditExceed = 0;
											}
										}
										VParentLimitValue.remove(j);
										VParentLimitValue.insertElementAt(nf.format((-1)*temp_totalBalance), j);
										VCreditExceed.remove(j);
										VCreditExceed.insertElementAt(nf.format(creditExceed), j);
										double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(j));
										if(LastExchgRate>0)
										{
											VCreditExceedUSD.remove(j);
											VCreditExceedUSD.insertElementAt(nf.format(creditExceed/LastExchgRate),j);
										}
										else
										{
											VCreditExceedUSD.remove(j);
											VCreditExceedUSD.insertElementAt(nf.format(creditExceed),j);
										}
									}
									else
									{
										VParentLimitValue.remove(j);
										VParentLimitValue.insertElementAt("", j);
									}
								}
							}
							//System.out.println(CUSTOMER_ABBR.elementAt(i)+"##"+prveCustLimit);
							PrveCustCd = ""+CUSTOMER_CD.elementAt(i);
						}
					}	
				}
				else
				{
					VParentLimitValue.remove(j);
					VParentLimitValue.insertElementAt("", j);
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
		
		//HARSH20201208/////ONLY BUY DEAL FOR EXCEED CREDIT REPORT//////
		public void CR_BuyDeal()
		{
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			try
			{
				queryString = "SELECT TO_CHAR(A.DELV_FROM_DT,'DD/MM/YYYY'), TO_CHAR(A.DELV_TO_DT,'DD/MM/YYYY'),A.MAN_CONF_CD,A.CARGO_SEQ_NO,E.TRD_CD, A.MAN_CD, A.MAN_CD, A.CONFIRM_VOL,"
						+ "A.CARGO_REF_CD,to_char(C.MAN_CONF_DT,'dd/mm/yyyy'), A.PRICE,A.EMP_CD,TO_CHAR(A.ENT_DT,'dd/mm/yyyy'), A.EMP_CD,TO_CHAR(A.ENT_DT,'dd/mm/yyyy'), E.PRICE_TYPE, A.PRICE_TO, A.REMARK  "+
						" FROM FMS7_MAN_CONFIRM_CARGO_DTL A, FMS7_MAN_CONFIRM_MST C, FMS7_MAN_REQ_MST E WHERE "+
				///		" A.DELV_FROM_DT BETWEEN TO_DATE('"+SearchDtFrom+"','DD/MM/YYYY') AND TO_DATE('"+SearchDtTo+"','DD/MM/YYYY') "
				///HARSH20210319		" A.DELV_FROM_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND A.DELV_TO_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') "
						" ((C.MAN_CONF_DT = TO_DATE('"+to_date+"','DD/MM/YYYY') AND A.DELV_TO_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY')) "
						+ "OR (A.DELV_FROM_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND A.DELV_TO_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY')) "
						+ "OR (C.MAN_CONF_DT = TO_DATE('"+to_date+"','DD/MM/YYYY') AND A.DELV_FROM_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND A.DELV_TO_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY'))) " ///HARSH20210319
						+ "AND E.MAN_CD=A.MAN_CD AND "+ 
				///		" A.UNIT_CD=C.UNIT_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD='"+VCAR_REF_NO_temp.elementAt(i)+"' "+ 
						" A.MAN_CONF_CD=C.MAN_CONF_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD LIKE '%' "+ 
						" ORDER BY A.MAN_CONF_CD, A.CARGO_REF_CD";
				//(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))
				System.out.println("CARGO: "+queryString);
				rset = stmt.executeQuery(queryString);
				////System.out.println("FOr SN : "+to_date+" "+from_date);
				while(rset.next())
				{		
					String map_id=rset.getString(3)+"-"+rset.getString(4);
					tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
					tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
					//FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
					//TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
					temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
					CARGO_ARRIVAL_DATE.add(temp_dt);				
					SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
					SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));		
					CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));
					String custCD = rset.getString(5)==null?"0":rset.getString(5);
					queryString1 ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST B where TRADER_CD="+custCD+" "
							+ "and eff_dt=(select max(eff_dt) from FMS7_TRADER_MST where TRADER_CD='"+custCD+"' and eff_dt<=to_date('"+tmp_from_dt+"','dd/mm/yyyy'))";
					rset1=stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						CUSTOMER_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
						CUSTOMER_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));	
					}
				  	FGSA_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
				 /// 	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
				  	FGSA_REV_NO.add("0");	 //No Rev no in LoA		  					
				  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
				  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
				  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));			  	
				  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
				  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);	  	
				  	tot_commitment=nf.format(tot_comit);
				  	SN_REF_NO.add(rset.getString(9)==null?"":rset.getString(9));	
				  	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
				  	RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));	
				  	
				  	String TEMP_apr_by=rset.getString(12)==null?"0":rset.getString(12);
				  	sn_apr_dt.add(rset.getString(13)==null?"-":rset.getString(13));
				  	String temp_ent_by=rset.getString(14)==null?"0":rset.getString(14);
				  	sn_ent_dt.add(rset.getString(15)==null?"-":rset.getString(15));
				  	VContType.add("B"); //SB20201108
				  	/////////SB20201205: ///////////////////////////////////////////
					VDealDCQ.add(rset.getString(8)==null?"1":rset.getString(8));
					VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
					VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
					VAdvAmt.add("0");
					VTransValue.add("0");
					double TransCharge=0;
					if(TransCharge==0)
						VContDelv.add("");
					else
						VContDelv.add("(DLV)");
					VDealType.add("LNG"); //SB20201021
					//MAPPING_ID.add("");
					VDealUniqueId.add("B"+map_id);
					VDealId_Display.add("B"+map_id); //HARSH20210722 AS PER INCIDENT ID#112
					VDealUniqueIdColor.add("RED");				
					VContRefno.add("");
					VContTCQ.add(""); //For Temporary	
				  	/////////////////////^^^^^^^///////////////////////////////////////
				  	String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
				  	rset1=stmt1.executeQuery(queryString_nm);
				  	if(rset1.next()){
				  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
				  	}else{
				  		sn_apr_by.add("-");
				  	}
				  //HARSH20201208 VContStDt.add(rset.getString(1)==null?"":rset.getString(1));
				  	//HARSH20201208 VContEndDt.add(rset.getString(2)==null?"":rset.getString(2));
				  	
				  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
				  	rset1=stmt1.executeQuery(queryString_nm);
				  	if(rset1.next()){
				  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
				  	}else{
				  		sn_ent_by.add("-");
				  	}
				 // 	MAPPING_ID.add("C"+rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
				  //	MAPPING_ID.add("B"+rset.getString(3)+"-0-"+rset.getString(6)+"-"+rset.getString(7));
				 //as stored into FMS9_MRCR_CONT_PRICE_DTL  	String Mapp_Id=CUSTOMER_CD.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i)+"-"+SN_REF_NO.elementAt(i)+"-0";
				  	VCreditExceed.add("");
				  	VLimitValue.add("");
				  	VCollateralValue.add("");
				  	VCollateralValueLinked.add("");
				  	VGrossExposureAmtInclTax.add("");
				  	VExchgRate.add("");
				  	VExchgRate_Dt.add("");
				  	VExchgRate_Nm.add("");
				  	VCreditExceedUSD.add("");
				  	VParentLimitValue.add("");//HARSH20210319
				}
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}
		}
		
		//HARSH20210609 ONLY APPEAR ON SIGNING DT
		public void CR_LTCORA_DEAL()
		{
			try
			{
				queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),TO_CHAR(SIGNING_DT,'DD/MM/YYYY'),"
						+ "MAPPING_ID,REV_NO,PRE_APPROVAL_BY,TO_CHAR(PRE_APPROVAL_DATE,'DD/MM/YYYY'),ENT_BY,TO_CHAR(ENT_DT,'DD/MM/YYYY'),NO_OF_CARGO FROM FMS8_LNG_REGAS_MST "
						+ "WHERE SIGNING_DT = TO_DATE('"+to_date+"','DD/MM/YYYY') AND CN_NO != '0'";
				rset = stmt.executeQuery(queryString);
				System.out.println("LTCORA: -"+queryString);
				while(rset.next())
				{				
					
					String map_id=rset.getString(4)==null?"":rset.getString(4);
					
					int count = 0;
					queryString2 ="select count(*) from FMS8_LNG_REGAS_CARGO_DTL"
							 +" where MAPPING_ID='"+map_id+"' ";
					rset3=stmt3.executeQuery(queryString2);
					if(rset3.next())
					{
						count = rset3.getInt(1);
					}
					System.out.println("LTCORA COUNT "+count);
					
					if(count == 0)
					{
						String tempmap_id[]=map_id.split("-");
						
						String temp_regas_no=tempmap_id[3];
						String temp_regas_rev_no=tempmap_id[4];
						String temp_cust_cd=tempmap_id[0];
						
						SN_NO.add("0");
						SN_REV_NO.add("0");			  	
				        FGSA_NO.add(temp_regas_no);	  	
					  	FGSA_REV_NO.add(temp_regas_rev_no);	 //No Rev no in LoA
						CUSTOMER_CD.add(temp_cust_cd);
						queryString1 ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+temp_cust_cd+" "
								+ "and eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+temp_cust_cd+"' and eff_dt<=to_date('"+to_date+"','dd/mm/yyyy'))";
						rset1 = stmt1.executeQuery(queryString1);
						if(rset1.next())
						{
							CUSTOMER_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
							CUSTOMER_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));	
						}
						else
						{
							CUSTOMER_NM.add("");
							CUSTOMER_ABBR.add("");
						}	
						String tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
						String tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
						String temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
						CARGO_ARRIVAL_DATE.add(temp_dt);
						BOOKMMBTU.add("0.00");
						BOOKMMSCM.add("0.00");
					  	double tot_comit = 0;
					  	tot_commitment=nf.format(tot_comit);
					  	double tot_comit_mmscm=(tot_comit/38900);
					  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
					  	SIGNING_DT.add(rset.getString(3)==null?"":rset.getString(3));//HARSH20210609
					  	RATE.add("0.00");
					  	VSalesPriceFlag.add("2"); //SB20201207
					  	//if(rset.getString(15).equals("2"))
					  		VSalesPriceCurr.add("USD"); //SB20201207: USD=2 for Sales Gas
					  	//else
					  		//VSalesPriceCurr.add("INR"); //SB20201207: INR=1 for Sales Gas
					  	VNoOfCargo.add(rset.getString(10)==null?"*":rset.getString(10)); //SB20210125
					  	String TEMP_apr_by="0";
					  	sn_apr_dt.add("");
					  	String temp_ent_by="0";
					  	sn_ent_dt.add("");
					  	VDealDCQ.add("1");
					  	VContStDt.add(tmp_from_dt);
					  	VContEndDt.add(tmp_to_dt);
						VAdvAmt.add("0");
						VTransValue.add("0");
						double TransCharge=0;
						if(TransCharge==0)
							VContDelv.add("");
						else
							VContDelv.add("(DLV)");
						VDealType.add("CAPACITY"); //SB20201021
						//MAPPING_ID.add(map_id);
					  	VDealUniqueId.add("C"+map_id);
					  	VDealId_Display.add("C"+map_id); //HARSH20210722 AS PER INCIDENT ID#112
					  	VDealUniqueIdColor.add("BLUE");
					  	VContType.add("C");
					  	VContRefno.add("");
					  	sn_apr_by.add("-");
					  	sn_ent_by.add("-");
					  	
						VCreditExceed.add("0.00");
					  	VLimitValue.add("0.00");
					  	VCollateralValue.add("0.00");
					  	VCollateralValueLinked.add("0.00");
					  	VGrossExposureAmtInclTax.add("0.00");
					  	VExchgRate.add("");
					  	VExchgRate_Dt.add("");
					  	VExchgRate_Nm.add("");
					  	VCreditExceedUSD.add("0.00");
					  	VParentLimitValue.add("");//HARSH20210319
					}
				}
			}
			catch(Exception e)
			{
				e.printStackTrace();
			}
		}
////////////////////NEW Fn for Deal Exposure Dtl/////////
/////////////////////////Find Out Price Out for JKM ////////////////////////
	public void MRCR_PriceOut2(String ReportDt, String INDEX_TYPE, String GenDate, String MappId, String ContRate)
	{
		try
		{
	////Price Pulling from Table////////////////////////////
	String tempGen_Dt[]=GenDate.split("/");
	String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; 
	//String GenMthYr=GenDate; 
	String GenMthYr=GenMth+"/"+GenYr;
	//INDEX_TYPE="JKM";
	String LNG_ICE_JKM_PriceOut="0"; String Phy_CurFrd_Price="";
	
	String Slope=""; String Constant="";
	
		////////Price Pulling from Table////////////////////////////
	String PriceType="F"; String CurveName="";
	queryString ="SELECT PRICE_TYPE, CURVE_NM, RATE, SEQ_NO FROM FMS9_MRCR_CONT_PRICE_DTL "
			//HARSH20210608 + "WHERE MAPPING_ID='"+MappId+"' AND FROM_DT<=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND FLAG='Y' ";//AND CURVE_NM='"+INDEX_TYPE+"' ";
			+ "WHERE MAPPING_ID LIKE '"+MappId+"' AND FROM_DT<=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND FLAG='Y' ";//AND CURVE_NM='"+INDEX_TYPE+"' ";
	//System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
	rset2 = stmt.executeQuery(queryString);			
	if(rset2.next())
	{
		//VPriceTypeDeal.add(rset2.getString(1)==null?"":rset2.getString(1));  //CR-DATED_BRENT
		PriceType=rset2.getString(1)==null?"":rset2.getString(1);
		if(PriceType.equals("F"))
		{
		//	VPriceTypeDeal.add("Fixed");
		//	VPriceTypeDealRate.add(rset2.getString(3)==null?ContRate:rset2.getString(3));  //CR-DATED_BRENT
		}
		else if(PriceType.equals("M"))
		{
		//	VPriceTypeDeal.add("FLOAT");
		//	VPriceTypeDealRate.add(rset2.getString(3)==null?"":rset2.getString(3));  //CR-DATED_BRENT
		}
		else
		{
		//	VPriceTypeDeal.add("N.A.");
		//	VPriceTypeDealRate.add(rset2.getString(3)==null?"":rset2.getString(3));  //CR-DATED_BRENT
		}
		INDEX_TYPE=rset2.getString(2)==null?"":rset2.getString(2);
	}
	else
	{
		//	VPriceTypeDeal.add("Fixed");
	//	VPriceTypeDealRate.add(ContRate);  //Contract Rate SN_MST
	}
	System.out.println(GenDate+">>>>>>>PriceType: "+PriceType);
			queryString ="SELECT SLOPE, CONST FROM FMS9_MRCR_CONT_PRICE_DTL "
					//HARSH20210608 + "WHERE  MAPPING_ID='"+MappId+"' AND FROM_DT<=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND PRICE_TYPE='"+PriceType+"' AND CURVE_NM='"+INDEX_TYPE+"' ";
					+ "WHERE  MAPPING_ID LIKE '"+MappId+"' AND FROM_DT<=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND PRICE_TYPE='"+PriceType+"' AND CURVE_NM='"+INDEX_TYPE+"' ";
			//System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
			rset2 = stmt.executeQuery(queryString);			
			if(rset2.next())
			{
				VSlope.add(rset2.getString(1)==null?"1":rset2.getString(1));  //Default: LNG_ICE_JKM 
				Constant=rset2.getString(2)==null?"0":rset2.getString(2);
				VConst_ICE_JKM.add(Constant);  //ICE_JKM_FORWARD
				Slope=rset2.getString(1)==null?"1":rset2.getString(1);
			}
			else
			{	
				VSlope.add("1"); //SB20201102
				VConst_ICE_JKM.add("0"); 
				Slope="1";
				Constant="0";
			}
			System.out.println(GenDate+">>>>>>>VSlope: "+VSlope);
	///////////////////////////SB20201006: New Logic To Calculate Pricinging Start-End Date and No. of Days in between ///////////////////////////////		
		//	String IndexSettlePrice="F";  //Price as on Final Settlement Date
			String IndexSettlePrice="A";  //Average Between Start and end date excluding Holidays & Weekly off as Price Settlement Date
			int NoOfDays=1; String IndexSettlePriceAvgStr="";
			if(IndexSettlePrice.length()>1)
			{
				NoOfDays=Integer.parseInt(IndexSettlePrice.substring(1,IndexSettlePrice.length())); //System.out.println("NoOfDays Avg. Days: "+NoOfDays);
				IndexSettlePriceAvgStr="A"+NoOfDays;
			}
			
	//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////		
			///////////////////////////////HOLIDAY CALCULATION///////////////////////////////////
			String HolidayType="";
			if(INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("ICE_JKM")) //HARSH20210429
				HolidayType="J";
			else if(INDEX_TYPE.equals("CR_DATED_BRENT") || INDEX_TYPE.equals("ICE_BRENT")) //SB20201025 //HARSH20210429
				HolidayType="B";
			else
				HolidayType="J";
				
			////HARSH20210428///////////////////////
			String HP_CurveName="";
			if(INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("JKM_PLATTS_SETTLEMENT") || INDEX_TYPE.equals("ICE_JKM")) //SB20210409
			{
				HP_CurveName="ICE_JKM";
			} 
			else if(INDEX_TYPE.equals("CR_DATED_BRENT") || INDEX_TYPE.equals("ICE_BRENT_FIRST_LINE")  || INDEX_TYPE.equals("ICE_BRENT")) //SB20210409 //SB20210402 //SB20201025
			{
				HP_CurveName="ICE_BRENT";
			}
			else 
			{
				HP_CurveName=INDEX_TYPE;
			}
			//////////////////////////////////////////////
	/////////////////////SB20201116: Prev Settlement Date: to find the start date for Contract Month////////////////////////////////////////
			String PrevContMthYr="01/"+GenMthYr;
			String ContMthYr2="01/"+GenMthYr;
			queryString = "SELECT TO_CHAR(TO_DATE('"+ContMthYr2+"','DD/MM/YYYY')-1,'DD/MM/YYYY') FROM DUAL";
				//System.out.println("Get DAY Name: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					PrevContMthYr = rset.getString(1);
				}
				
				String tempPrevContMthYr[]=PrevContMthYr.split("/");
				PrevContMthYr="01/"+tempPrevContMthYr[1]+"/"+tempPrevContMthYr[2];
			
			String ContMthSettleDt="";
			queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr2+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					ContMthSettleDt = rset.getString(1);		
				}
				String PrevMthSettleEndDtPlusOne="";
				if(IndexSettlePrice.equals("A"))
				{
					queryString = "SELECT TO_CHAR(TO_DATE(SETTLE_END_DT,'DD/MM/YYYY')+1,'DD/MM/YY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+PrevContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next()) {
						PrevMthSettleEndDtPlusOne = rset.getString(1);	
					}
				}
				///else if(IndexSettlePrice.equals("A7"))
				else if(IndexSettlePrice.equals("A"+NoOfDays))
				{
					int NoOfDays2=1;
					NoOfDays2=NoOfDays-1;
					queryString = "SELECT TO_CHAR(TO_DATE('"+ContMthSettleDt+"','DD/MM/YYYY')-"+NoOfDays2+",'DD/MM/YYYY') FROM DUAL";
					System.out.println("Get DAY Name: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PrevMthSettleEndDtPlusOne = rset.getString(1);
					}
				}
	////^^/SB20201116: Prev Settlement Date: to find the start date for Contract Month////////////////////////////
	/////////////////////////FORWARD PRICE//////////////////////////////////
				int SettleNoOfDays=0;
				queryString = "SELECT TO_DATE('"+ReportDt+"','DD/MM/YYYY')-TO_DATE('"+ContMthSettleDt+"','DD/MM/YYYY')+1 FROM DUAL" ;
					//System.out.println(" NEXT MTH: DUAL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next()) {
						SettleNoOfDays = rset.getInt(1);
					}		
	////////////////////////////////////////////////////////////////////////
		if(SettleNoOfDays<0)	
		{
			//////////////SB20201105: Introduced due to multiple record on Curve Price Tbl////////////////////////////
			int CountPlattEntDt=0; String PlattEntDt="";
/*HARSH20210428			queryString = "select COUNT(ENT_DT) from FMS9_FORWARD_PRICE_DTL "
					+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
			queryString = "select COUNT(ENT_DT) from FMS9_FORWARD2_PRICE_DTL "
					+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
			//System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				CountPlattEntDt = rset.getInt(1);
			}
			if(CountPlattEntDt>0)
			{
			//	PlattEntDt=Gen_Dt; 
			//	System.out.println("1. PlattEntDt: "+PlattEntDt);
/*HARSH20210428				queryString = "SELECT DISTINCT TO_CHAR(ENT_DT, 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
				queryString = "SELECT DISTINCT TO_CHAR(ENT_DT, 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
			//	System.out.println("A. FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
				}
			}
			else
			{
/*HARSH20210428				queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
						+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
				queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
						+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
			//	System.out.println("B. FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
				}
				if(PlattEntDt.equals(""))
				{
/*HARSH20210428					queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
							+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
					queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
							+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
				//	System.out.println("C. FMS9_CURVE_PRICE_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
					}
					if(PlattEntDt.equals(""))
					{
	/*HARSH20210428					queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
								+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
						queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
								+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
				//		System.out.println("D. FMS9_CURVE_PRICE_DTL: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
						}
					}
				}
			}
			System.out.println("2. PlattEntDt: "+PlattEntDt);
			//////////////////////////^^^^SB20201105////////////////////////////////////////////////////////////////////
			String FrdPriceJKM="0"; String FrdPriceBrent="0"; double Eff_FrdPriceSlopeConst=0; String settle_price="0"; //HARSH20210428
/*HARSH20210428			queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_FORWARD_PRICE_DTL "+ 
					" WHERE CURVE_DD_MM_YR=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND CURVE_TYPE='F' AND FLAG='Y' AND ENT_DT=TO_DATE('"+PlattEntDt+"','DD/MM/YYYY') "; */
			queryString ="SELECT SETTLE_PRICE FROM FMS9_FORWARD2_PRICE_DTL "+ 
					" WHERE CURVE_NM='"+HP_CurveName+"' AND CURVE_DD_MM_YR=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' AND ENT_DT=TO_DATE('"+PlattEntDt+"','DD/MM/YYYY') ";
		System.out.println(PriceType+" :SETTLEMENT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
				rset2 = stmt.executeQuery(queryString);			
				if(rset2.next())
				{
					//HARSH20210428 FrdPriceBrent=rset2.getString(1)==null?"0":rset2.getString(1);
					//HARSH20210428 FrdPriceJKM=rset2.getString(2)==null?"0":rset2.getString(2);
					
					settle_price = rset2.getString(1)==null?"0":rset2.getString(1);
				//	
				//	System.out.println(FrdPriceBrent+" :SETTLEMENT PRICE: BRENT & JKM: "+FrdPriceJKM);		
					if(PriceType.equals("M"))
					{
						if(INDEX_TYPE.equals("LNG_ICE_JKM"))
						{
							//HARSH20210506 if(!FrdPriceJKM.equals("0"))
							if(!settle_price.equals("0"))
							{
								//HARSH20210428 Eff_FrdPriceSlopeConst=Double.parseDouble(""+FrdPriceJKM)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+settle_price)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+nf2.format(Eff_FrdPriceSlopeConst)); //SB20210208
								VPriceTypeDealRate.add(Eff_FrdPriceSlopeConst);  //ICE_JKM_FORWARD
								//HARSH20210428 VEff_PriceA.add("Fwd Price "+FrdPriceJKM+" dt:"+PlattEntDt);  //ICE_JKM_FORWARD
								VEff_Price.add("Fwd Price "+settle_price+" dt:"+PlattEntDt);  //ICE_JKM_FORWARD
							}
							else
							{
								VPriceTypeDealRate.add("0");
								VEff_Price.add("0");
							}
						}
						else
						{
							//HARSH20210506 if(!FrdPriceJKM.equals("0"))
							if(!settle_price.equals("0"))
							{
								//HARSH20210428 Eff_FrdPriceSlopeConst=Double.parseDouble(""+FrdPriceBrent)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+settle_price)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+nf2.format(Eff_FrdPriceSlopeConst)); //SB20210208
								VPriceTypeDealRate.add(Eff_FrdPriceSlopeConst);  //ICE_BRENT_FORWARD
								//HARSH20210428 VEff_PriceA.add("Fwd Price "+FrdPriceBrent+" dt:"+PlattEntDt);
								VEff_Price.add("Fwd Price "+settle_price+" dt:"+PlattEntDt);
							}
							else
							{
								VPriceTypeDealRate.add("0");
								VEff_Price.add("0");
							}
						}									
					}
					else
					{
						VPriceTypeDealRate.add("0");
						VEff_Price.add("0");
					}
				}
				else
				{
					VPriceTypeDealRate.add("0"); //SB20201118	
					VEff_Price.add("0");
				}
				System.out.println(VEff_Price+" :SETTLEMENT PRICE: FMS9_FORWARD_PRICE_DTL: "+VPriceTypeDealRate);	
		}
		///////////////////^^^^^FORWARD PRICE/		
			
		else
		{
		Vector Veff_dt = new Vector();Vector Veff_dtWeeklyOff = new Vector();
		Vector temp_Vcurren_cd = new Vector();
		Vector temp_Vcurren_cd_from = new Vector();
		
		String date_arr = ""; String PriceBegMthDt="";
	
//HARSH20210429		if((INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && IndexSettlePrice.equals("F")) //SB20201027: For BRENT Settlement  Date
		if((INDEX_TYPE.equals("ICE_JKM") || INDEX_TYPE.equals("ICE_BRENT") || INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && IndexSettlePrice.equals("F"))
		{
			String ContMthYr="01/"+GenMthYr;
			queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
			//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					date_arr = rset.getString(1)==null?"31/08/2020":rset.getString(1);					
				}
				else
				{
					date_arr=ContMthYr;
				}
				PriceBegMthDt =date_arr;
				date_arr = PriceBegMthDt;
				Veff_dt.add(date_arr);
		}
		///////////////////For BRENT 30 Days Avg. ///////////////////
//HARSH20210429	else if((INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && (IndexSettlePrice.equals("A") || IndexSettlePrice.equals("A"+NoOfDays)))//if(IndexSettlePrice.equals("A"))
	else if((INDEX_TYPE.equals("ICE_JKM") || INDEX_TYPE.equals("ICE_BRENT") || INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && (IndexSettlePrice.equals("A") || IndexSettlePrice.equals("A"+NoOfDays)))	
		{
			///String start_dt =""; String delv_mth ="01/"+GenMth+"/"+GenYr; int businessMonth=0; int businessYear=0; String StartMonth="";String EndMonth="";
			String ContMthYr="01/"+GenMthYr;
			
			double count=0;		
			String query="select to_date('"+ContMthSettleDt+"','DD/MM/YY')- to_date('"+PrevMthSettleEndDtPlusOne+"','DD/MM/YY')+1 from dual";
			//System.out.println("Date Difference: dual: "+query);
			rset=stmt.executeQuery(query);
			if(rset.next())
			{
				count=rset.getInt(1);
			}
			//PriceBegMthDt =ContMthYr;
			int StratDayCount=0; int StratDayCount2=0; //SB20201017: to check Starting SAT/SUN/HOLIDAY
			
			PriceBegMthDt =PrevMthSettleEndDtPlusOne;
					for(int i=0;i<count;i++)
					{
						String query1="select to_char(to_date('"+PrevMthSettleEndDtPlusOne+"','dd/mm/yy')+ "+i+",'dd/mm/yyyy') from dual";
					///	System.out.println(">>>>>>>dual: "+query1);
						rset=stmt.executeQuery(query1);
						if(rset.next())
						{
							date_arr=rset.getString(1);
						}		
					///////////////////////SB20201017: to check Starting SAT/SUN/HOLIDAY//////////////////////////////					
					if(StratDayCount==StratDayCount2)
					{
						queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
								+ " WHERE HOLIDAY_DT =to_date('"+date_arr+"','dd/mm/yyyy') AND FLAG='Y' AND HOLIDAY_TYPE='"+HolidayType+"' ORDER BY HOLIDAY_DT";
						rset = stmt.executeQuery(queryString);
					//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
						if(rset.next())
						{
							StratDayCount++; System.out.println("Get HOLI DAY Name: ");		
						}
						else
						{
						String WeeklyOff="";
						queryString = "SELECT TO_CHAR(TO_DATE('"+date_arr+"','DD/MM/YYYY'),'DAY') FROM DUAL";
						//	System.out.println("Get DAY Name: "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next())
							{
								WeeklyOff = rset.getString(1);
							}
							if(WeeklyOff.trim().equals("SATURDAY") || WeeklyOff.trim().equals("SUNDAY")) 
							{
								StratDayCount++;
							}
							else
							{							
								Veff_dt.add(date_arr);
								PriceBegMthDt=date_arr; //System.out.println("Get DAY Name: "+WeeklyOff);							
							}
						}
					}
					else
						Veff_dt.add(date_arr); //Ori Line
					StratDayCount2++; //System.out.println(StratDayCount+" : "+StratDayCount2);
					//////////////////////////////////////////////////////////////////////////////////////////
				//SB20201017	Veff_dt.add(date_arr);
				}
				queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					date_arr = rset.getString(1);		
				} 
		}//EoF Avg 7 days	
		/////////////////^^^/////////////////////////////////////////
	//	System.out.println(Veff_dt+">>********FINAL LIST*********>>>>>Veff_dt: "+Veff_dt.size());
				String PriceEndMthDt=date_arr; String PriceSettleDt=date_arr;
//////////////////////////////////Check For Price Range///////////////////////
				int ReportDays=0; int ReportDays2=0;
				queryString = "SELECT TO_DATE('"+ReportDt+"','DD/MM/YYYY')-TO_DATE('"+PriceBegMthDt+"','DD/MM/YYYY') FROM DUAL" ;
				//System.out.println(" DUAL: LAST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
				ReportDays = rset.getInt(1);
				}	
			//	System.out.println(PriceBegMthDt+" DUAL: Begining of ReportDays: "+ReportDt+" ReportDays: "+ReportDays);
				queryString = "SELECT TO_DATE('"+PriceEndMthDt+"','DD/MM/YYYY')-TO_DATE('"+ReportDt+"','DD/MM/YYYY') FROM DUAL" ;
				//System.out.println(" DUAL: LAST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
				ReportDays2 = rset.getInt(1);
				}	
		//		System.out.println(ReportDays+" DUAL: Begining of ReportDays: "+ReportDt+" ReportDays: "+ReportDays2);


//////////////////////////SB20200930///////////////////////////////////////////////////////			
			
/////////////////////////////WEEKDAY LIST///////////////////////////////////////////////
	int NoOfSatSun=0; int NoOfHoliday=0; int StratDayCount=0; int StratDayCount2=0;
	for(int i=0;i<Veff_dt.size();i++)
	{
	///	if(VWeekDayHoliDay.size()<Veff_dt.size())
		{
			String WeeklyOff="";
			queryString = "SELECT TO_CHAR(TO_DATE('"+Veff_dt.elementAt(i)+"','DD/MM/YYYY'),'DAY') FROM DUAL";
			//	System.out.println("Get DAY Name: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					WeeklyOff = rset.getString(1);
				}
				
			queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
					+ " WHERE HOLIDAY_DT BETWEEN to_date('"+Veff_dt.elementAt(i)+"','dd/mm/yyyy') AND to_date('"+Veff_dt.elementAt(i)+"','dd/mm/yyyy') AND FLAG='Y' AND HOLIDAY_TYPE='"+HolidayType+"' ORDER BY HOLIDAY_DT";
			rset = stmt.executeQuery(queryString);
		//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
			if(rset.next())
			{
				NoOfHoliday++;
			}
			else
			{
				if(WeeklyOff.trim().equals("SATURDAY") || WeeklyOff.trim().equals("SUNDAY")) 
				{
					NoOfSatSun++;
				}
			}
		}
		//SB20201015///////////////To get Weekly Off & Holiday/////////////////////////////////
		String WeeklyOffStartDate=""; 
		if(StratDayCount==StratDayCount2)
		{
		queryString = "SELECT TO_CHAR(TO_DATE('"+Veff_dt.elementAt(i)+"','DD/MM/YYYY'),'DAY') FROM DUAL";
		//	System.out.println("Get DAY Name: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				WeeklyOffStartDate = rset.getString(1);
			}
			
			if(WeeklyOffStartDate.trim().equals("SATURDAY") || WeeklyOffStartDate.trim().equals("SUNDAY")) 
			{
				StratDayCount++;
			}
			else
			{
				queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
						+ " WHERE HOLIDAY_DT= to_date('"+Veff_dt.elementAt(i)+"','dd/mm/yyyy') AND FLAG='Y' AND HOLIDAY_TYPE='"+HolidayType+"' ORDER BY HOLIDAY_DT";
				rset = stmt.executeQuery(queryString);
			//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
				if(rset.next())
				{
					StratDayCount++;
				}
			}
		}
			StratDayCount2++;
	//////////////////////////////////////////////////////////////////////////////	
	}
	
			//	System.out.println(PriceEndMthDt+">>>>>>>PRICE 2.VHoliday_Dt: "+VHoliday_Dt);

					PriceSettleDt=PriceEndMthDt;
					String ContMthYr="01/"+GenMthYr;
					queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next()) {
						PriceSettleDt = rset.getString(1);
						PriceEndMthDt = rset.getString(2);
						PriceEndMthDt = PriceSettleDt;  //Need varification
					}
				
				double AvgPrice=0; int PriceAvlCount=1;
	
	//////////////SB20201105: Introduced due to multiple record on Curve Price Tbl////////////////////////////
				int CountPlattEntDt=0; String PlattEntDt="";
/*HARSH20210428				queryString = "select COUNT(ENT_DT) from FMS9_CURVE_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
				queryString = "select COUNT(ENT_DT) from FMS9_CURVE2_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
		//		System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CountPlattEntDt = rset.getInt(1);
				}
				if(CountPlattEntDt>0)
				{
					PlattEntDt=ReportDt;
					//System.out.println("PlattEntDt: "+PlattEntDt);
/*HARSH20210428					queryString = "SELECT TO_CHAR(ENT_DT, 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
							+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
					queryString = "SELECT TO_CHAR(ENT_DT, 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
							+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
				//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
					}
				}
				else
				{
/*HARSH20210428					queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
							+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
					queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
							+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
				//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
					}
					if(PlattEntDt.equals(""))
					{
/*HARSH20210428						queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
								+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
						queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
								+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
					///	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
						}
						if(PlattEntDt.equals(""))
						{
/*HARSH20210428							queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
									+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
							queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
									+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
						//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next())
							{
								PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
							}
						}
					}
				}
				System.out.println("PlattEntDt: "+PlattEntDt);
				//////////////////////////^^^^SB20201105////////////////////////////////////////////////////////////////////
			/*SB20201105	queryString = "select AVG("+INDEX_TYPE+"), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where "+INDEX_TYPE+">0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+SettlePriceDate+"','dd/mm/yyyy') AND CURVE_TYPE='P' ";
				*/
/*HARSH20210428				queryString = "select SUM("+INDEX_TYPE+"), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where "+INDEX_TYPE+">0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND TO_DATE(ENT_DT, 'DD-MON-YY')=TO_DATE('"+PlattEntDt+"', 'DD-MON-YY')"; */
				queryString = "select SUM(SETTLE_PRICE), COUNT(*) from FMS9_CURVE2_PRICE_DTL "
						+ " where SETTLE_PRICE > 0 AND PHYS_FIN='"+HP_CurveName+"' AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT'";// AND TO_DATE(ENT_DT, 'DD-MON-YY')=TO_DATE('"+PlattEntDt+"', 'DD-MON-YY')";
	//			System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
		/*SB		queryString = "select SUM("+INDEX_TYPE+"), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where "+INDEX_TYPE+">0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' ";
			*/
				System.out.println("2. FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					AvgPrice = rset.getDouble(1);
					PriceAvlCount = rset.getInt(2);
				}
				else
				{
					AvgPrice = 0;
					PriceAvlCount = 1;
				}
				System.out.println(AvgPrice+" :AvgPrice: "+PriceAvlCount);
			

			double sumCommodityValue=0; int countNonZero=0; double avgCommodityValue=0; double Eff_avgCommodityValue=0; 
			if(PriceAvlCount>0)
				avgCommodityValue=AvgPrice/PriceAvlCount; 
			else
				avgCommodityValue=0;
			
			int noOfReportDays=0;
			queryString = "SELECT TO_DATE('"+ReportDt+"','DD/MM/YYYY')-TO_DATE('"+PriceEndMthDt+"','DD/MM/YYYY') FROM DUAL" ;
		//	System.out.println(" DUAL: LAST: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				noOfReportDays = rset.getInt(1);
			}		
			
		//	System.out.println(PriceEndMthDt+" noOfReportDays: "+noOfReportDays);
			///////SB20200924/: Based on feedback 24thSep///////////////////////////////////
				if(noOfReportDays<0)  //SB20200915 To Control the availabilty of Settle Price: If Report Dt is less than PriceEndMthDate
					avgCommodityValue=0;	
			////////////////////////////////////////////////////////
			String rate_value=""; String AvgCommodityValue=""; String ContPriceBasedCommodityValue="";
			
			//SB20200918: As per Shiladitya		Eff_avgCommodityValue=avgCommodityValue*Double.parseDouble(""+Slope)-Double.parseDouble(""+Constant);
			Eff_avgCommodityValue=avgCommodityValue*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20200918: As per Shiladitya

			////////////////////////////////////SB20201006: Decide Price start Date & Price end Date /////////////////////////////////////////
							if(IndexSettlePrice.equals("F"))  //F: If Settle Price Date is Final Settle Date
								{
									PriceBegMthDt=PriceSettleDt;
									PriceEndMthDt=PriceSettleDt;
								}
							
							int NoOfWeekOff=0; String WeeklyOff="";
							for(int i=0; i<Veff_dt.size(); i++)
							{
							queryString = "SELECT TO_CHAR(TO_DATE('"+Veff_dt.elementAt(i)+"','DD/MM/YYYY'),'DAY') FROM DUAL";
							//	System.out.println("Get DAY Name: "+queryString);
								rset = stmt.executeQuery(queryString);
								if(rset.next())
								{
									WeeklyOff = rset.getString(1);
									if(WeeklyOff.trim().equals("SATURDAY") || WeeklyOff.trim().equals("SUNDAY")) 
										NoOfWeekOff++;
								}
								Veff_dtWeeklyOff.add(NoOfWeekOff);
							}	
							
					//		System.out.println(PriceBegMthDt+">>>>>>>Veff_dt"+Veff_dt.size());
						///	System.out.println(Veff_dtWeeklyOff+"NoOfWeekOff "+NoOfWeekOff);	
					//		System.out.println(GenDate+">>>>>>>PRICE VHoliday_Dt: "+VHoliday_Dt.size());

			AvgCommodityValue=nf2.format(avgCommodityValue);
	//		System.out.println(GenMthYr+" :AvgCommodityValue: "+AvgCommodityValue);
			if(avgCommodityValue>0 && PriceType.equals("M"))
			{//System.out.println(PriceType+"FLOAT-If: Forward Price "+avgCommodityValue);
				VMthYrWisePriceICE_JKM.add(AvgCommodityValue);
				PrvCurvePrice=""+AvgCommodityValue;
				PriceIndex_SettleDate=PriceSettleDt;
				VPriceIndex_SettleDate.add(PriceSettleDt);
				PriceIndex_StartDate=PriceBegMthDt;
				VPriceIndex_StartDate.add(PriceBegMthDt);
				PriceIndex_EndDate=PriceEndMthDt;
				VPriceIndex_EndDate.add(PriceEndMthDt);
				EffPriceSlopeConst=nf2.format(Eff_avgCommodityValue);
				VEff_Price.add(nf2.format(avgCommodityValue));  //Forward Price
				VPriceTypeDealRate.add(nf2.format(Eff_avgCommodityValue));
			}
			else if(avgCommodityValue==0 && PriceType.equals("M"))
			{//System.out.println(PriceType+"FLOAT-else: VEff_Price "+avgCommodityValue);
				VMthYrWisePriceICE_JKM.add("0");
				PrvCurvePrice=""+avgCommodityValue;
				PriceIndex_SettleDate=PriceSettleDt;
				VPriceIndex_SettleDate.add(PriceSettleDt);
				PriceIndex_StartDate=PriceBegMthDt;
				VPriceIndex_StartDate.add(PriceBegMthDt);
				PriceIndex_EndDate=PriceEndMthDt;
				VPriceIndex_EndDate.add(PriceEndMthDt);
				EffPriceSlopeConst=nf2.format(Eff_avgCommodityValue);
				VEff_Price.add("0");
				VPriceTypeDealRate.add("0");
			}
			else if(PriceType.equals("F"))
			{// System.out.println(PriceType+"FIXED: VEff_Price "+VEff_Price.size());
				VMthYrWisePriceICE_JKM.add("0");
				PrvCurvePrice=""+avgCommodityValue;
				PriceIndex_SettleDate="";
				VPriceIndex_SettleDate.add("");
				PriceIndex_StartDate="";
				VPriceIndex_StartDate.add("");
				PriceIndex_EndDate="";
				VPriceIndex_EndDate.add("");
				EffPriceSlopeConst="";
				VEff_Price.add("0");
				VPriceTypeDealRate.add("0");
			}
	  System.out.println(VEff_Price+" :VEff_Price: "+VEff_Price.size());
	  System.out.println(VPriceTypeDealRate+" :VEff_Price: "+VPriceTypeDealRate.size());
		//	System.out.println(sumCommodityValue+" :COMMODITY: ContPriceBasedCommodityValue  "+ContPriceBasedCommodityValue);
		}
	}
	catch(Exception e)
	{
		  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchFGSASNPRICEList()-->"+e);
		  e.printStackTrace();
	}
}	
//////////////////////////////////////////////////////////////////////////////////
//////////////////////////////FOR TESTING ////////////////////////////////////////
	public void MRCR_PriceOutA(String ReportDt, String INDEX_TYPE, String GenDate, String MappId, String ContRate)
	{
		try
		{
	////Price Pulling from Table////////////////////////////
	String tempGen_Dt[]=GenDate.split("/");
	String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; 
	//String GenMthYr=GenDate; 
	String GenMthYr=GenMth+"/"+GenYr;
	//INDEX_TYPE="JKM";
	String LNG_ICE_JKM_PriceOut="0"; String Phy_CurFrd_Price="";

	String Slope=""; String Constant="";
	
		////////Price Pulling from Table////////////////////////////
	String PriceType="F"; String CurveName="";
	queryString ="SELECT PRICE_TYPE, CURVE_NM, RATE, SEQ_NO FROM FMS9_MRCR_CONT_PRICE_DTL "
			//HARSH20210608 + "WHERE MAPPING_ID='"+MappId+"' AND FROM_DT<=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND FLAG='Y' ";//AND CURVE_NM='"+INDEX_TYPE+"' ";
			+ "WHERE MAPPING_ID LIKE '"+MappId+"' AND FROM_DT<=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+ReportDt+"','DD/MM/YYYY') AND FLAG='Y' ";//AND CURVE_NM='"+INDEX_TYPE+"' ";
	//System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
	rset2 = stmt.executeQuery(queryString);			
	if(rset2.next())
	{
		//VPriceTypeDeal.add(rset2.getString(1)==null?"":rset2.getString(1));  //CR-DATED_BRENT
		PriceType=rset2.getString(1)==null?"":rset2.getString(1);
		if(PriceType.equals("F"))
		{
		//	VPriceTypeDeal.add("Fixed");
		//	VPriceTypeDealRate.add(rset2.getString(3)==null?ContRate:rset2.getString(3));  //CR-DATED_BRENT
		}
		else if(PriceType.equals("M"))
		{
		//	VPriceTypeDeal.add("FLOAT");
		//	VPriceTypeDealRate.add(rset2.getString(3)==null?"":rset2.getString(3));  //CR-DATED_BRENT
		}
		else
		{
		//	VPriceTypeDeal.add("N.A.");
		//	VPriceTypeDealRate.add(rset2.getString(3)==null?"":rset2.getString(3));  //CR-DATED_BRENT
		}
		INDEX_TYPE=rset2.getString(2)==null?"":rset2.getString(2);
	}
	else
	{
		//	VPriceTypeDeal.add("Fixed");
	//	VPriceTypeDealRate.add(ContRate);  //Contract Rate SN_MST
	}
	System.out.println(GenDate+">>>>>>>PriceType: "+PriceType);
			queryString ="SELECT SLOPE, CONST FROM FMS9_MRCR_CONT_PRICE_DTL "
					//HARSH20210608 + "WHERE  MAPPING_ID='"+MappId+"' AND FROM_DT<=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND PRICE_TYPE='"+PriceType+"' AND CURVE_NM='"+INDEX_TYPE+"' ";
					+ "WHERE  MAPPING_ID LIKE '"+MappId+"' AND FROM_DT<=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND TO_DT>=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND PRICE_TYPE='"+PriceType+"' AND CURVE_NM='"+INDEX_TYPE+"' ";
	//		System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
			rset2 = stmt.executeQuery(queryString);			
			if(rset2.next())
			{
			///	VSlope.add(rset2.getString(1)==null?"1":rset2.getString(1));  //Default: LNG_ICE_JKM 
				Constant=rset2.getString(2)==null?"0":rset2.getString(2);
			///	VConst_ICE_JKM.add(Constant);  //ICE_JKM_FORWARD
				Slope=rset2.getString(1)==null?"1":rset2.getString(1);
			}
			else
			{	
			///	VSlope.add("1"); //SB20201102
			///	VConst_ICE_JKM.add("0"); 
				Slope="1";
				Constant="0";
			}
			System.out.println(GenDate+">>>>>>>VSlope: "+VSlope);
	///////////////////////////SB20201006: New Logic To Calculate Pricinging Start-End Date and No. of Days in between ///////////////////////////////		
		//	String IndexSettlePrice="F";  //Price as on Final Settlement Date
			String IndexSettlePrice="A";  //Average Between Start and end date excluding Holidays & Weekly off as Price Settlement Date
			int NoOfDays=1; String IndexSettlePriceAvgStr="";
			if(IndexSettlePrice.length()>1)
			{
				NoOfDays=Integer.parseInt(IndexSettlePrice.substring(1,IndexSettlePrice.length())); //System.out.println("NoOfDays Avg. Days: "+NoOfDays);
				IndexSettlePriceAvgStr="A"+NoOfDays;
			}
			
			//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////		
			///////////////////////////////HOLIDAY CALCULATION///////////////////////////////////
			String HolidayType="";
			if(INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("ICE_JKM")) //HARSH20210429
				HolidayType="J";
			else if(INDEX_TYPE.equals("CR_DATED_BRENT") || INDEX_TYPE.equals("ICE_BRENT")) //SB20201025 //HARSH20210429
				HolidayType="B";
			else
				HolidayType="J";
			
			////HARSH20210428///////////////////////
			String HP_CurveName="";
			if(INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("JKM_PLATTS_SETTLEMENT") || INDEX_TYPE.equals("ICE_JKM")) //SB20210409
			{
				HP_CurveName="ICE_JKM";
			}  
			else if(INDEX_TYPE.equals("CR_DATED_BRENT") || INDEX_TYPE.equals("ICE_BRENT_FIRST_LINE")  || INDEX_TYPE.equals("ICE_BRENT")) //SB20210409 //SB20210402 //SB20201025
			{
				HP_CurveName="ICE_BRENT";
			}
			else 
			{
				HP_CurveName=INDEX_TYPE;
			}
			//////////////////////////////////////////////
				
	/////////////////////SB20201116: Prev Settlement Date: to find the start date for Contract Month////////////////////////////////////////
			String PrevContMthYr="01/"+GenMthYr;
			String ContMthYr2="01/"+GenMthYr;
			queryString = "SELECT TO_CHAR(TO_DATE('"+ContMthYr2+"','DD/MM/YYYY')-1,'DD/MM/YYYY') FROM DUAL";
				//System.out.println("Get DAY Name: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					PrevContMthYr = rset.getString(1);
				}
				
				String tempPrevContMthYr[]=PrevContMthYr.split("/");
				PrevContMthYr="01/"+tempPrevContMthYr[1]+"/"+tempPrevContMthYr[2];
			
			String ContMthSettleDt="";
			queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr2+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
			//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					ContMthSettleDt = rset.getString(1);		
				}
				String PrevMthSettleEndDtPlusOne="";
				if(IndexSettlePrice.equals("A"))
				{
					queryString = "SELECT TO_CHAR(TO_DATE(SETTLE_END_DT,'DD/MM/YYYY')+1,'DD/MM/YY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+PrevContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next()) {
						PrevMthSettleEndDtPlusOne = rset.getString(1);	
					}
				}
				///else if(IndexSettlePrice.equals("A7"))
				else if(IndexSettlePrice.equals("A"+NoOfDays))
				{
					int NoOfDays2=1;
					NoOfDays2=NoOfDays-1;
					queryString = "SELECT TO_CHAR(TO_DATE('"+ContMthSettleDt+"','DD/MM/YYYY')-"+NoOfDays2+",'DD/MM/YYYY') FROM DUAL";
				//	System.out.println("Get DAY Name: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PrevMthSettleEndDtPlusOne = rset.getString(1);
					}
				}
	////^^/SB20201116: Prev Settlement Date: to find the start date for Contract Month////////////////////////////
	/////////////////////////FORWARD PRICE//////////////////////////////////
				int SettleNoOfDays=0;
				queryString = "SELECT TO_DATE('"+ReportDt+"','DD/MM/YYYY')-TO_DATE('"+ContMthSettleDt+"','DD/MM/YYYY')+1 FROM DUAL" ;
					//System.out.println(" NEXT MTH: DUAL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next()) {
						SettleNoOfDays = rset.getInt(1);
					}	
	////////////////////////////////////////////////////////////////////////
		if(SettleNoOfDays<0)	
		{
			//////////////SB20201105: Introduced due to multiple record on Curve Price Tbl////////////////////////////
			int CountPlattEntDt=0; String PlattEntDt="";
/*HARSH20210428			queryString = "select COUNT(ENT_DT) from FMS9_FORWARD_PRICE_DTL "
					+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
			queryString = "select COUNT(ENT_DT) from FMS9_FORWARD2_PRICE_DTL "
					+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
			//System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				CountPlattEntDt = rset.getInt(1);
			}
			if(CountPlattEntDt>0)
			{
			//	PlattEntDt=Gen_Dt; 
			//	System.out.println("1. PlattEntDt: "+PlattEntDt);
/*HARSH20210428				queryString = "SELECT DISTINCT TO_CHAR(ENT_DT, 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
				queryString = "SELECT DISTINCT TO_CHAR(ENT_DT, 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
			//	System.out.println("A. FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
				}
			}
			else
			{
/*HARSH20210428				queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
						+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
				queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
						+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
			//	System.out.println("B. FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
				}
				if(PlattEntDt.equals(""))
				{
/*HARSH20210428					queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
							+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
					queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
							+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
				//	System.out.println("C. FMS9_CURVE_PRICE_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
					}
					if(PlattEntDt.equals(""))
					{
	/*HARSH20210428					queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD_PRICE_DTL "
								+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='F' AND FLAG='Y' "; */
						queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'dd/mm/yyyy')  from FMS9_FORWARD2_PRICE_DTL "
								+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' "; //HARSH20210428
				//		System.out.println("D. FMS9_CURVE_PRICE_DTL: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
						}
					}
				}
			}
			System.out.println("2. PlattEntDt: "+PlattEntDt);
			//////////////////////////^^^^SB20201105////////////////////////////////////////////////////////////////////
			String FrdPriceJKM="0"; String FrdPriceBrent="0"; double Eff_FrdPriceSlopeConst=0; String settle_price="0"; //HARSH20210428
/*HARSH20210428			queryString ="SELECT CR_DATED_BRENT, LNG_ICE_JKM, LNG_JKM, LNG_PHYS_INDIA, RLNG_PHYS_INDIA FROM FMS9_FORWARD_PRICE_DTL "+ 
					" WHERE CURVE_DD_MM_YR=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND CURVE_TYPE='F' AND FLAG='Y' AND ENT_DT=TO_DATE('"+PlattEntDt+"','DD/MM/YYYY') "; */
			queryString ="SELECT SETTLE_PRICE FROM FMS9_FORWARD2_PRICE_DTL "+ 
					" WHERE CURVE_NM='"+HP_CurveName+"' AND CURVE_DD_MM_YR=TO_DATE('"+GenDate+"','DD/MM/YYYY') AND UPPER(CURVE_TYPE)='FORWARD' AND FLAG='Y' AND ENT_DT=TO_DATE('"+PlattEntDt+"','DD/MM/YYYY') ";
		System.out.println(PriceType+" :SETTLEMENT PRICE: FMS9_CURVE_PRICE_DTL: "+queryString);
				rset2 = stmt.executeQuery(queryString);			
				if(rset2.next())
				{
					//HARSH20210428 FrdPriceBrent=rset2.getString(1)==null?"0":rset2.getString(1);
					//HARSH20210428 FrdPriceJKM=rset2.getString(2)==null?"0":rset2.getString(2);
					
					settle_price = rset2.getString(1)==null?"0":rset2.getString(1);
				//	
				//	System.out.println(FrdPriceBrent+" :SETTLEMENT PRICE: BRENT & JKM: "+FrdPriceJKM);		
					if(PriceType.equals("M"))
					{
						if(INDEX_TYPE.equals("LNG_ICE_JKM"))
						{
							//HARSH20210506 if(!FrdPriceJKM.equals("0"))
							if(!settle_price.equals("0"))
							{
								//HARSH20210428 Eff_FrdPriceSlopeConst=Double.parseDouble(""+FrdPriceJKM)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+settle_price)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+nf2.format(Eff_FrdPriceSlopeConst)); //SB20210208
								VPriceTypeDealRateA.add(Eff_FrdPriceSlopeConst);  //ICE_JKM_FORWARD
								//HARSH20210428 VEff_PriceA.add("Fwd Price "+FrdPriceJKM+" dt:"+PlattEntDt);  //ICE_JKM_FORWARD
								VEff_PriceA.add("Fwd Price "+settle_price+" dt:"+PlattEntDt);  //ICE_JKM_FORWARD
							}
							else
							{
								VPriceTypeDealRateA.add("0");
								VEff_PriceA.add("0");
							}
						}
						else
						{
							//HARSH20210506 if(!FrdPriceJKM.equals("0"))
							if(!settle_price.equals("0"))
							{
								//HARSH20210428 Eff_FrdPriceSlopeConst=Double.parseDouble(""+FrdPriceBrent)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+settle_price)*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20201120: As per Rohit
								Eff_FrdPriceSlopeConst=Double.parseDouble(""+nf2.format(Eff_FrdPriceSlopeConst)); //SB20210208
								VPriceTypeDealRateA.add(Eff_FrdPriceSlopeConst);  //ICE_BRENT_FORWARD
								//HARSH20210428 VEff_PriceA.add("Fwd Price "+FrdPriceBrent+" dt:"+PlattEntDt);
								VEff_PriceA.add("Fwd Price "+settle_price+" dt:"+PlattEntDt);
							}
							else
							{
								VPriceTypeDealRateA.add("0");
								VEff_PriceA.add("0");
							}
						}									
					}
					else
					{
						VPriceTypeDealRateA.add("0");
						VEff_PriceA.add("0");
					}
				}
				else
				{
					VPriceTypeDealRateA.add("0"); //SB20201118	
					VEff_PriceA.add("0");
				}
				System.out.println(VEff_PriceA+" :SETTLEMENT PRICE: FMS9_FORWARD_PRICE_DTL: "+VPriceTypeDealRateA);	
		}
		///////////////////^^^^^FORWARD PRICE/		
			
		else
		{
		Vector Veff_dt = new Vector();Vector Veff_dtWeeklyOff = new Vector();
		Vector temp_Vcurren_cd = new Vector();
		Vector temp_Vcurren_cd_from = new Vector();
		
		String date_arr = ""; String PriceBegMthDt="";
		
//HARSH20210429		if((INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && IndexSettlePrice.equals("F")) //SB20201027: For BRENT Settlement  Date
		if((INDEX_TYPE.equals("ICE_JKM") || INDEX_TYPE.equals("ICE_BRENT") || INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && IndexSettlePrice.equals("F"))
		{
			String ContMthYr="01/"+GenMthYr;
			queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					date_arr = rset.getString(1)==null?"31/08/2020":rset.getString(1);					
				}
				else
				{
					date_arr=ContMthYr;
				}
				PriceBegMthDt =date_arr;
				date_arr = PriceBegMthDt;
				Veff_dt.add(date_arr);
		}
		///////////////////For BRENT 30 Days Avg. ///////////////////
//HARSH20210423	else if((INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && (IndexSettlePrice.equals("A") || IndexSettlePrice.equals("A"+NoOfDays)))//if(IndexSettlePrice.equals("A"))
		else if((INDEX_TYPE.equals("ICE_JKM") || INDEX_TYPE.equals("ICE_BRENT") || INDEX_TYPE.equals("LNG_ICE_JKM") || INDEX_TYPE.equals("CR_DATED_BRENT")) && (IndexSettlePrice.equals("A") || IndexSettlePrice.equals("A"+NoOfDays)))//if(IndexSettlePrice.equals("A"))
		{
			///String start_dt =""; String delv_mth ="01/"+GenMth+"/"+GenYr; int businessMonth=0; int businessYear=0; String StartMonth="";String EndMonth="";
			String ContMthYr="01/"+GenMthYr;
			
			double count=0;		
			String query="select to_date('"+ContMthSettleDt+"','DD/MM/YY')- to_date('"+PrevMthSettleEndDtPlusOne+"','DD/MM/YY')+1 from dual";
			//System.out.println("Date Difference: dual: "+query);
			rset=stmt.executeQuery(query);
			if(rset.next())
			{
				count=rset.getInt(1);
			}
			//PriceBegMthDt =ContMthYr;
			int StratDayCount=0; int StratDayCount2=0; //SB20201017: to check Starting SAT/SUN/HOLIDAY
			
			PriceBegMthDt =PrevMthSettleEndDtPlusOne;
					for(int i=0;i<count;i++)
					{
						String query1="select to_char(to_date('"+PrevMthSettleEndDtPlusOne+"','dd/mm/yy')+ "+i+",'dd/mm/yyyy') from dual";
					///	System.out.println(">>>>>>>dual: "+query1);
						rset=stmt.executeQuery(query1);
						if(rset.next())
						{
							date_arr=rset.getString(1);
						}		
					///////////////////////SB20201017: to check Starting SAT/SUN/HOLIDAY//////////////////////////////					
					if(StratDayCount==StratDayCount2)
					{
						queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
								+ " WHERE HOLIDAY_DT =to_date('"+date_arr+"','dd/mm/yyyy') AND FLAG='Y' AND HOLIDAY_TYPE='"+HolidayType+"' ORDER BY HOLIDAY_DT";
						rset = stmt.executeQuery(queryString);
					//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
						if(rset.next())
						{
							StratDayCount++; System.out.println("Get HOLI DAY Name: ");		
						}
						else
						{
						String WeeklyOff="";
						queryString = "SELECT TO_CHAR(TO_DATE('"+date_arr+"','DD/MM/YYYY'),'DAY') FROM DUAL";
						//	System.out.println("Get DAY Name: "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next())
							{
								WeeklyOff = rset.getString(1);
							}
							if(WeeklyOff.trim().equals("SATURDAY") || WeeklyOff.trim().equals("SUNDAY")) 
							{
								StratDayCount++;
							}
							else
							{							
								Veff_dt.add(date_arr);
								PriceBegMthDt=date_arr; //System.out.println("Get DAY Name: "+WeeklyOff);							
							}
						}
					}
					else
						Veff_dt.add(date_arr); //Ori Line
					StratDayCount2++; //System.out.println(StratDayCount+" : "+StratDayCount2);
					//////////////////////////////////////////////////////////////////////////////////////////
				//SB20201017	Veff_dt.add(date_arr);
				}
				queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
			//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
					date_arr = rset.getString(1);		
				}
		}//EoF Avg 7 days	
		/////////////////^^^/////////////////////////////////////////
		System.out.println(Veff_dt+">>********FINAL LIST*********>>>>>Veff_dt: "+Veff_dt.size());
				String PriceEndMthDt=date_arr; String PriceSettleDt=date_arr;
//////////////////////////////////Check For Price Range///////////////////////
				int ReportDays=0; int ReportDays2=0;
				queryString = "SELECT TO_DATE('"+ReportDt+"','DD/MM/YYYY')-TO_DATE('"+PriceBegMthDt+"','DD/MM/YYYY') FROM DUAL" ;
			//	System.out.println(" DUAL: LAST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
				ReportDays = rset.getInt(1);
				}	
			//	System.out.println(PriceBegMthDt+" DUAL: Begining of ReportDays: "+ReportDt+" ReportDays: "+ReportDays);
				queryString = "SELECT TO_DATE('"+PriceEndMthDt+"','DD/MM/YYYY')-TO_DATE('"+ReportDt+"','DD/MM/YYYY') FROM DUAL" ;
			//	System.out.println(" DUAL: LAST: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next()) {
				ReportDays2 = rset.getInt(1);
				}	
				System.out.println(ReportDays+" DUAL: Begining of ReportDays: "+ReportDt+" ReportDays: "+ReportDays2);


//////////////////////////SB20200930///////////////////////////////////////////////////////			
			
/////////////////////////////WEEKDAY LIST///////////////////////////////////////////////
	int NoOfSatSun=0; int NoOfHoliday=0; int StratDayCount=0; int StratDayCount2=0;
	for(int i=0;i<Veff_dt.size();i++)
	{
	///	if(VWeekDayHoliDay.size()<Veff_dt.size())
		{
			String WeeklyOff="";
			queryString = "SELECT TO_CHAR(TO_DATE('"+Veff_dt.elementAt(i)+"','DD/MM/YYYY'),'DAY') FROM DUAL";
			//	System.out.println("Get DAY Name: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					WeeklyOff = rset.getString(1);
				}
				
			queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
					+ " WHERE HOLIDAY_DT BETWEEN to_date('"+Veff_dt.elementAt(i)+"','dd/mm/yyyy') AND to_date('"+Veff_dt.elementAt(i)+"','dd/mm/yyyy') AND FLAG='Y' AND HOLIDAY_TYPE='"+HolidayType+"' ORDER BY HOLIDAY_DT";
			rset = stmt.executeQuery(queryString);
		//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
			if(rset.next())
			{
				NoOfHoliday++;
			}
			else
			{
				if(WeeklyOff.trim().equals("SATURDAY") || WeeklyOff.trim().equals("SUNDAY")) 
				{
					NoOfSatSun++;
				}
			}
		}
		//SB20201015///////////////To get Weekly Off & Holiday/////////////////////////////////
		String WeeklyOffStartDate=""; 
		if(StratDayCount==StratDayCount2)
		{
		queryString = "SELECT TO_CHAR(TO_DATE('"+Veff_dt.elementAt(i)+"','DD/MM/YYYY'),'DAY') FROM DUAL";
		//	System.out.println("Get DAY Name: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				WeeklyOffStartDate = rset.getString(1);
			}
			
			if(WeeklyOffStartDate.trim().equals("SATURDAY") || WeeklyOffStartDate.trim().equals("SUNDAY")) 
			{
				StratDayCount++;
			}
			else
			{
				queryString ="SELECT to_char(HOLIDAY_DT,'dd/mm/yyyy') FROM FMS9_CURVE_HOLIDAY_DTL "
						+ " WHERE HOLIDAY_DT= to_date('"+Veff_dt.elementAt(i)+"','dd/mm/yyyy') AND FLAG='Y' AND HOLIDAY_TYPE='"+HolidayType+"' ORDER BY HOLIDAY_DT";
				rset = stmt.executeQuery(queryString);
			//	System.out.println(">>>>>>>PRICE PUULING: "+queryString);
				if(rset.next())
				{
					StratDayCount++;
				}
			}
		}
			StratDayCount2++;
	//////////////////////////////////////////////////////////////////////////////	
	}

			//	System.out.println(PriceEndMthDt+">>>>>>>PRICE 2.VHoliday_Dt: "+VHoliday_Dt);

					PriceSettleDt=PriceEndMthDt;
					String ContMthYr="01/"+GenMthYr;
					queryString = "SELECT TO_CHAR(SETTLE_DT,'DD/MM/YYYY'), TO_CHAR(SETTLE_END_DT,'DD/MM/YYYY') FROM FMS9_SETTLE_CALND_DTL WHERE CONT_MM_YYYY=TO_DATE('"+ContMthYr+"','DD/MM/YYYY') AND SETTLE_TYPE='"+HolidayType+"' ";
				//	System.out.println(" SETTLE: FMS9_SETTLE_CALND_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next()) {
						PriceSettleDt = rset.getString(1);
						PriceEndMthDt = rset.getString(2);
						PriceEndMthDt = PriceSettleDt;  //Need varification
					}
				
				double AvgPrice=0; int PriceAvlCount=1;
	
	//////////////SB20201105: Introduced due to multiple record on Curve Price Tbl////////////////////////////
				int CountPlattEntDt=0; String PlattEntDt="";
/*HARSH20210428				queryString = "select COUNT(ENT_DT) from FMS9_CURVE_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
				queryString = "select COUNT(ENT_DT) from FMS9_CURVE2_PRICE_DTL "
						+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
		//		System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CountPlattEntDt = rset.getInt(1);
				}
				if(CountPlattEntDt>0)
				{
					PlattEntDt=ReportDt;
					//System.out.println("PlattEntDt: "+PlattEntDt);
/*HARSH20210428					queryString = "SELECT TO_CHAR(ENT_DT, 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
							+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
					queryString = "SELECT TO_CHAR(ENT_DT, 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
							+ " where ENT_DT= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
				//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
					}
				}
				else
				{
/*HARSH20210428					queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
							+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
					queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
							+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428
				//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
					}
					if(PlattEntDt.equals(""))
					{
/*HARSH20210428						queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
								+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
						queryString = "SELECT TO_CHAR(MIN(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
								+ " where ENT_DT>= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' ";//HARSH20210428
					///	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
						rset = stmt.executeQuery(queryString);
						if(rset.next())
						{
							PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
						}
						if(PlattEntDt.equals(""))
						{
/*HARSH20210428							queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE_PRICE_DTL "
									+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND FLAG='Y' "; */
							queryString = "SELECT TO_CHAR(MAX(ENT_DT), 'DD-MON-YY')  from FMS9_CURVE2_PRICE_DTL "
									+ " where ENT_DT<= to_date('"+ReportDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT' AND FLAG='Y' "; //HARSH20210428		
						//	System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
							rset = stmt.executeQuery(queryString);
							if(rset.next())
							{
								PlattEntDt = rset.getString(1)==null?"":rset.getString(1);
							}
						}
					}
				}
				System.out.println("PlattEntDt: "+PlattEntDt);
				//////////////////////////^^^^SB20201105////////////////////////////////////////////////////////////////////
			/*SB20201105	queryString = "select AVG("+INDEX_TYPE+"), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where "+INDEX_TYPE+">0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+SettlePriceDate+"','dd/mm/yyyy') AND CURVE_TYPE='P' ";
				*/
/*HARSH20210428				queryString = "select SUM("+INDEX_TYPE+"), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where "+INDEX_TYPE+">0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' AND TO_DATE(ENT_DT, 'DD-MON-YY')=TO_DATE('"+PlattEntDt+"', 'DD-MON-YY')"; */
				queryString = "select SUM(SETTLE_PRICE), COUNT(*) from FMS9_CURVE2_PRICE_DTL "
						+ " where SETTLE_PRICE > 0 AND PHYS_FIN='"+HP_CurveName+"' AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND UPPER(CURVE_TYPE)='SPOT'";// AND TO_DATE(ENT_DT, 'DD-MON-YY')=TO_DATE('"+PlattEntDt+"', 'DD-MON-YY')";
	//			System.out.println("FMS9_CURVE_PRICE_DTL: "+queryString);
		/*SB		queryString = "select SUM("+INDEX_TYPE+"), COUNT(*) from FMS9_CURVE_PRICE_DTL "
						+ " where "+INDEX_TYPE+">0 AND CURVE_DD_MM_YR BETWEEN to_date('"+PriceBegMthDt+"','dd/mm/yyyy') AND to_date('"+PriceEndMthDt+"','dd/mm/yyyy') AND CURVE_TYPE='P' ";
			*/
				System.out.println("2. FMS9_CURVE_PRICE_DTL: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					AvgPrice = rset.getDouble(1);
					PriceAvlCount = rset.getInt(2);
				}
				else
				{
					AvgPrice = 0;
					PriceAvlCount = 1;
				}
		//		System.out.println(AvgPrice+" :AvgPrice: "+PriceAvlCount);
			

			double sumCommodityValue=0; int countNonZero=0; double avgCommodityValue=0; double Eff_avgCommodityValue=0; 
			if(PriceAvlCount>0)
				avgCommodityValue=AvgPrice/PriceAvlCount; 
			else
				avgCommodityValue=0;
			
			int noOfReportDays=0;
			queryString = "SELECT TO_DATE('"+ReportDt+"','DD/MM/YYYY')-TO_DATE('"+PriceEndMthDt+"','DD/MM/YYYY') FROM DUAL" ;
		//	System.out.println(" DUAL: LAST: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				noOfReportDays = rset.getInt(1);
			}		
			
		//	System.out.println(PriceEndMthDt+" noOfReportDays: "+noOfReportDays);
			///////SB20200924/: Based on feedback 24thSep///////////////////////////////////
				if(noOfReportDays<0)  //SB20200915 To Control the availabilty of Settle Price: If Report Dt is less than PriceEndMthDate
					avgCommodityValue=0;	
			////////////////////////////////////////////////////////
			String rate_value=""; String AvgCommodityValue=""; String ContPriceBasedCommodityValue="";
			
			//SB20200918: As per Shiladitya		Eff_avgCommodityValue=avgCommodityValue*Double.parseDouble(""+Slope)-Double.parseDouble(""+Constant);
			Eff_avgCommodityValue=avgCommodityValue*Double.parseDouble(""+Slope)+Double.parseDouble(""+Constant); //SB20200918: As per Shiladitya

			////////////////////////////////////SB20201006: Decide Price start Date & Price end Date /////////////////////////////////////////
							if(IndexSettlePrice.equals("F"))  //F: If Settle Price Date is Final Settle Date
								{
									PriceBegMthDt=PriceSettleDt;
									PriceEndMthDt=PriceSettleDt;
								}
							
							int NoOfWeekOff=0; String WeeklyOff="";
							for(int i=0; i<Veff_dt.size(); i++)
							{
							queryString = "SELECT TO_CHAR(TO_DATE('"+Veff_dt.elementAt(i)+"','DD/MM/YYYY'),'DAY') FROM DUAL";
							//	System.out.println("Get DAY Name: "+queryString);
								rset = stmt.executeQuery(queryString);
								if(rset.next())
								{
									WeeklyOff = rset.getString(1);
									if(WeeklyOff.trim().equals("SATURDAY") || WeeklyOff.trim().equals("SUNDAY")) 
										NoOfWeekOff++;
								}
							//	Veff_dtWeeklyOff.add(NoOfWeekOff);
							}	
							
					//		System.out.println(PriceBegMthDt+">>>>>>>Veff_dt"+Veff_dt.size());
						///	System.out.println(Veff_dtWeeklyOff+"NoOfWeekOff "+NoOfWeekOff);	
					//		System.out.println(GenDate+">>>>>>>PRICE VHoliday_Dt: "+VHoliday_Dt.size());

			AvgCommodityValue=nf2.format(avgCommodityValue);
	//		System.out.println(GenMthYr+" :AvgCommodityValue: "+AvgCommodityValue);
			if(avgCommodityValue>0 && PriceType.equals("M"))
			{System.out.println(PriceType+"FLOAT-If: Forward Price "+avgCommodityValue);
			///	VMthYrWisePriceICE_JKM.add(AvgCommodityValue);
				PrvCurvePrice=""+AvgCommodityValue;
				PriceIndex_SettleDate=PriceSettleDt;
				VPriceIndex_SettleDateA.add(PriceSettleDt);
				PriceIndex_StartDate=PriceBegMthDt;
			///	VPriceIndex_StartDate.add(PriceBegMthDt);
				PriceIndex_EndDate=PriceEndMthDt;
			///	VPriceIndex_EndDate.add(PriceEndMthDt);
				EffPriceSlopeConst=nf2.format(Eff_avgCommodityValue);
				VEff_PriceA.add(nf2.format(avgCommodityValue));  //Forward Price
				VPriceTypeDealRateA.add(nf2.format(Eff_avgCommodityValue));
			}
			else if(avgCommodityValue==0 && PriceType.equals("M"))
			{System.out.println(PriceType+"FLOAT-else: VEff_Price "+avgCommodityValue);
			///	VMthYrWisePriceICE_JKM.add("0");
				PrvCurvePrice=""+avgCommodityValue;
				PriceIndex_SettleDate=PriceSettleDt;
				VPriceIndex_SettleDateA.add(PriceSettleDt);
				PriceIndex_StartDate=PriceBegMthDt;
			///	VPriceIndex_StartDate.add(PriceBegMthDt);
				PriceIndex_EndDate=PriceEndMthDt;
			///	VPriceIndex_EndDate.add(PriceEndMthDt);
				EffPriceSlopeConst=nf2.format(Eff_avgCommodityValue);
				VEff_PriceA.add("0");
				VPriceTypeDealRateA.add("0");
			}
			else if(PriceType.equals("F"))
			{ System.out.println(PriceType+"FIXED: VEff_Price "+VEff_Price.size());
			///	VMthYrWisePriceICE_JKM.add("0");
				PrvCurvePrice=""+avgCommodityValue;
				PriceIndex_SettleDate="";
				VPriceIndex_SettleDateA.add("");
				PriceIndex_StartDate="";
			///	VPriceIndex_StartDate.add("");
				PriceIndex_EndDate="";
			///	VPriceIndex_EndDate.add("");
				EffPriceSlopeConst="";
				VEff_PriceA.add("0");
				VPriceTypeDealRateA.add("0");
			}
			System.out.println(VPriceIndex_SettleDateA+" :VPriceIndex_SettleDateA: "+VPriceIndex_SettleDateA.size());
	  System.out.println(VEff_PriceA+" :VEff_PriceA: "+VEff_PriceA.size());
	  System.out.println(VPriceTypeDealRateA+" :VEff_PriceA: "+VPriceTypeDealRateA.size());
	  System.out.println(VSalesPriceFlag+" :VSalesPriceFlag INR/USD Value: "+VSalesPriceFlag.size());
	  System.out.println(VSalesPriceCurr+" :VSalesPriceCurr INR/USD: "+VSalesPriceCurr.size());
		//	System.out.println(sumCommodityValue+" :COMMODITY: ContPriceBasedCommodityValue  "+ContPriceBasedCommodityValue);
		}
	}
	catch(Exception e)
	{
		  //System.out.println("Exception in Databean_Contract_MasterReport--->fetchFGSASNPRICEList()-->"+e);
		  e.printStackTrace();
	}
}	

	/////////////////////////SB20201012: Deal Capturing List////////////////////////////
	public void fetchDealCapturingList()
	{
		try
		{			
			String tmp_from_dt = " ";
			String temp_dt="";
			String tmp_to_dt = " ";			
			double tot_comit=0.0;
			double sup_tot_comit=0.0;
			double bal_tot_comit=0.0;
			//Introduce By Milan 20110916 FOR MMSCM
			double tot_comit_mmscm=0.0;
			double sup_tot_comit_mmscm=0.0;
			double bal_tot_comit_mmscm=0.0;
			Vector FRM_DT=new Vector();
			Vector TO_DT=new Vector();						
			Vector RE_GAS_REV_NO=new Vector();
			Vector LTCORA_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector LTCORA_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_REV_NO=new Vector();//ADDED FOR LTCORA AND CN
			Vector CN_MAPPING_ID=new Vector();//ADDED FOR LTCORA AND CN
			Vector MAPPING_ID=new Vector();//MAPP_ID for All
			
			/////////////////////////////////////////////////////////////////////////
			String FirstFortNightEndDt="15"; String FortNightBillStartDt=""; String SecondFortNightBillStartDt=""; String FirstFortNightFlag="";
			String tempGen_Dt[]=to_date.split("/");
			String GenMth=tempGen_Dt[1]; String GenYr=tempGen_Dt[2]; 
			FirstFortNightEndDt = "15/"+GenMth+"/"+GenYr;
			SecondFortNightBillStartDt="16/"+GenMth+"/"+GenYr;
			String NextMth="";
			NextMth = GenMth+"/"+GenYr;
			int DayCount=0;
			queryString = "SELECT TO_DATE('"+FirstFortNightEndDt+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL" ;
		//	System.out.println(" DUAL: "+queryString);
			rset = stmt.executeQuery(queryString);
			if(rset.next()) {
				DayCount = rset.getInt(1);
			}
			if(DayCount<0)
			{
				FortNightBillStartDt="01/"+GenMth+"/"+GenYr;
				FirstFortNightFlag="Y";
			}
			else
			{
				FortNightBillStartDt="16/"+GenMth+"/"+GenYr;
				FirstFortNightFlag="N";
			}
			
			///////////////////////////////^^^Find out the Fortnight ///////////////////////
			//Updated By Milan 20110921
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE from FMS7_SN_MST A where "+ 
			//SB20200912	"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
			"(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			//SB20200919	"(SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			System.out.println("STEP-1: FMS7_SN_MST: "+queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{				
				////System.out.println("FOr SN : "+rset.getString(1)+" "+rset.getString(2));
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
				FGSA_NO.add("S"+rset.getString(6)==null?"0":rset.getString(6));	
				FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
				BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
				BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
				tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));
				
				tot_comit_mmscm=(tot_comit/38900);//MD20110916
				tot_commitment_mmscm=nf.format(tot_comit_mmscm);
				////System.out.println("BOOKEDMMSCM : "+BOOKMMSCM+" TOTAL : "+tot_comit_mmscm);
				
				tot_commitment=nf.format(tot_comit);
				SN_REF_NO.add(rset.getString(9)==null?"0":rset.getString(9));	
				SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
				RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));
				String TEMP_apr_by=rset.getString(12)==null?"0":rset.getString(12);
				sn_apr_dt.add(rset.getString(13)==null?"-":rset.getString(13));
				String temp_ent_by=rset.getString(14)==null?"0":rset.getString(14);
				sn_ent_dt.add(rset.getString(15)==null?"-":rset.getString(15));
				VDealDCQ.add(rset.getString(16)==null?"0":rset.getString(16));
				
				VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
				VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
				VAdvAmt.add(rset.getString(17)==null?"0":rset.getString(17));
				VTransValue.add(rset.getString(18)==null?"0":rset.getString(18));
				double TransCharge=rset.getDouble(18);
				if(TransCharge==0)
					VContDelv.add("");
				else
					VContDelv.add("(DLV)");
				VDealType.add("GAS"); //SB20201021
				String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
				rset1=stmt1.executeQuery(queryString_nm);
				if(rset1.next()){
					sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
				}else{
					sn_apr_by.add("-");
				}
				
				queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
				rset1=stmt1.executeQuery(queryString_nm);
				if(rset1.next()){
					sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
				}else{
					sn_ent_by.add("-");
				}
				MAPPING_ID.add(rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
				VDealUniqueId.add("S"+rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
				VDealUniqueIdColor.add("BLACK");
				VContType.add("S");
				VContRefno.add(rset.getString(9)==null?"":rset.getString(9));
				VContTCQ.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));				
				//////////////////////////Get Exchange Rate////////////////////////////////////////
				String Exchg_Rate_CD="";
				queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
				" FROM FMS7_SN_BILLING_DTL " +
				"WHERE cont_type='S' AND customer_cd="+rset.getString(5)+" AND FGSA_NO="+rset.getString(6)+" AND sn_no="+rset.getString(3)+" ";
				//	System.out.println("STEP-7: DLNG_SN_BILLING_DTL: >>>> "+queryString2);
				rset2 = stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
				Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
				int due_days = Integer.parseInt(rset2.getString(2));
				}
				double AvailableExchgRate=0;
				queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
				" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
				" AND FLAG='Y' ";
				//	System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
				rset2 = stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					AvailableExchgRate =rset2.getDouble(1);		
					VExchgRate.add(AvailableExchgRate); 
					VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
					VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
				}
				else
				{
					VExchgRate.add("0"); 
					VExchgRate_Dt.add("Avg."); 
					VExchgRate_Nm.add("Avg."); 
				}	
				///////////////////////////////^^^^^///////////////////////////////////////////////			
			}
			
/////////////////////////////LOA LIst of Contracts/////////////////////////////////////////////////////////////////
		queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
				"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE  from FMS7_LOA_MST A where "+ 
				"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
				//SB20200919			"(A.SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
				"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
				"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			rset = stmt.executeQuery(queryString);
	//		System.out.println("LOA: "+queryString);
			while(rset.next())
			{				

				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));			  	
			  	FGSA_NO.add("L"+rset.getString(6)==null?"0":rset.getString(6));	
			  	FGSA_REV_NO.add("0");	 //No Rev no in LoA
			  	BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			  	
			  	tot_commitment=nf.format(tot_comit);
			  	SN_REF_NO.add(rset.getString(8)==null?"0":rset.getString(8));	
			  	SIGNING_DT.add(rset.getString(9)==null?"0":rset.getString(9));
			  	RATE.add(nf2.format(Double.parseDouble(rset.getString(10)==null?"0":rset.getString(10))));
			  	String TEMP_apr_by=rset.getString(11)==null?"0":rset.getString(11);
			  	sn_apr_dt.add(rset.getString(12)==null?"-":rset.getString(12));
			  	String temp_ent_by=rset.getString(13)==null?"0":rset.getString(13);
			  	sn_ent_dt.add(rset.getString(14)==null?"-":rset.getString(14));
			  	VDealDCQ.add(rset.getString(15)==null?"0":rset.getString(15));
			  	
			  	VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
			  	VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
				VAdvAmt.add(rset.getString(16)==null?"0":rset.getString(16));
				VTransValue.add(rset.getString(17)==null?"0":rset.getString(17));
				double TransCharge=rset.getDouble(17);
				if(TransCharge==0)
					VContDelv.add("");
				else
					VContDelv.add("(DLV)");
				VDealType.add("GAS"); //SB20201021
			  	String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
			  	rset1=stmt1.executeQuery(queryString_nm);
			  	if(rset1.next()){
			  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			  	}else{
			  		sn_apr_by.add("-");
			  	}
			  	
			  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
			  	rset1=stmt1.executeQuery(queryString_nm);
			  	if(rset1.next()){
			  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			  	}else{
			  		sn_ent_by.add("-");
			  	}
			  	MAPPING_ID.add(rset.getString(6)+"-0"+"-"+rset.getString(3)+"-"+rset.getString(4));
			  	VDealUniqueId.add("L"+rset.getString(6)+"-0"+"-"+rset.getString(3)+"-"+rset.getString(4));
			  	VDealUniqueIdColor.add("BLUE");
			  	VContType.add("L");
			  	VContRefno.add(rset.getString(8)==null?"0":rset.getString(8));
				VContTCQ.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));		
				//////////////////////////Get Exchange Rate////////////////////////////////////////
				String Exchg_Rate_CD="";
				queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
						" FROM FMS7_SN_BILLING_DTL " +
					     "WHERE cont_type='L' AND customer_cd="+rset.getString(5)+" AND FGSA_NO="+rset.getString(6)+" AND sn_no="+rset.getString(3)+" ";
		//		System.out.println("STEP-7: DLNG_SN_BILLING_DTL: >>>> "+queryString2);
				rset2 = stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
					int due_days = Integer.parseInt(rset2.getString(2));
				}
				double AvailableExchgRate=0;
				queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
						" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
						" AND FLAG='Y' ";
		//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
				rset2 = stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					AvailableExchgRate =rset2.getDouble(1);		
					VExchgRate.add(AvailableExchgRate); 
					VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
					VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
				}
				else
				{
					VExchgRate.add("0"); 
					VExchgRate_Dt.add("Avg."); 
					VExchgRate_Nm.add("Avg."); 
				}	
				///////////////////////////////^^^^^///////////////////////////////////////////////
			}
		//// beLOW CODE IS CHANGED FOR PERIOD IN PLCAE OF LTCORA ////
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
			"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
			"C.REV_NO,C.PRE_APPROVAL_BY,TO_CHAR(C.PRE_APPROVAL_DaTE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), DCQ_QTY from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
			"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
			"A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
			"AND C.CN_NO!='0' AND CN_NO >'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
			"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO >'9999' AND " +
			"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
			"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
			//"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +  //RG20191108
			"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd and B.rev_no=D.rev_no and D.rev_no=C.rev_no )) " +  
			"order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
			System.out.println("LTCORA: -"+queryString);
			while(rset.next())
			{				
				
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[3];
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
		//SB20201027		SN_NO.add(temp_regas_no);
		//SB20201027		SN_REV_NO.add(temp_regas_rev_no);	
			///	LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
				SN_NO.add(rset.getString(6)==null?"0":rset.getString(6));
				SN_REV_NO.add("0");			  	
		//SB20201027	  	FGSA_NO.add(tempmap_id[1]);	
		//SB20201027		FGSA_REV_NO.add("0");	 //No Rev no in LoA
			  	FGSA_NO.add(temp_regas_no);	  	
			  	FGSA_REV_NO.add(temp_regas_rev_no);	 //No Rev no in LoA
				CUSTOMER_CD.add(temp_cust_cd);									
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);	
				BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			  	BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			  	tot_commitment=nf.format(tot_comit);
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			  	SN_REF_NO.add("");	
			  	SIGNING_DT.add(rset.getString(1)==null?"0":rset.getString(1));
			  	RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			  	
			  	String TEMP_apr_by=rset.getString(10)==null?"0":rset.getString(10);
			  	sn_apr_dt.add(rset.getString(11)==null?"-":rset.getString(11));
			  	String temp_ent_by=rset.getString(12)==null?"0":rset.getString(12);
			  	sn_ent_dt.add(rset.getString(13)==null?"-":rset.getString(13));
			  	VDealDCQ.add(rset.getString(14)==null?"1":rset.getString(14));
			  	VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
			  	VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
				VAdvAmt.add("0");
				VTransValue.add("0");
				double TransCharge=0;
				if(TransCharge==0)
					VContDelv.add("");
				else
					VContDelv.add("(DLV)");
				VDealType.add("CAPACITY"); //SB20201021
				MAPPING_ID.add(map_id);
			  	VDealUniqueId.add("C"+map_id);
			  	VDealUniqueIdColor.add("BLUE");
			  	VContType.add("C");
			  	VContRefno.add("");
				VContTCQ.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7)))); //For Temporary		
				String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
			  	rset1=stmt1.executeQuery(queryString_nm);
			  	if(rset1.next()){
			  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			  	}else{
			  		sn_apr_by.add("-");
			  	}
			  	
			  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
			  	rset1=stmt1.executeQuery(queryString_nm);
			  	if(rset1.next()){
			  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			  	}else{
			  		sn_ent_by.add("-");
			  	}
				//////////////////////////Get Exchange Rate////////////////////////////////////////
				String Exchg_Rate_CD="";
				queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
						" FROM FMS8_LNG_REGAS_BILLING_DTL " +
					     "WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
			//	System.out.println("STEP-7: FMS8_LNG_REGAS_BILLING_DTL: >>>> "+queryString2);
				rset2 = stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
					int due_days = Integer.parseInt(rset2.getString(2));
				}
				double AvailableExchgRate=0;
				queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
						" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
						" AND FLAG='Y' ";
		//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
				rset2 = stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					AvailableExchgRate =rset2.getDouble(1);		
					VExchgRate.add(AvailableExchgRate); 
					VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
					VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
				}
				else
				{
					VExchgRate.add("0"); 
					VExchgRate_Dt.add("Avg."); 
					VExchgRate_Nm.add("Avg."); 
				}	
				///////////////////////////////^^^^^///////////////////////////////////////////////
			}	
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
					"A.mapping_id,A.mapping_id,A.mapping_id,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
					"C.REV_NO,PRE_APPROVAL_BY,TO_CHAR(PRE_APPROVAL_DATE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), DCQ_QTY  from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
					"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					"A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
					"AND C.CN_NO!='0' AND CN_NO <'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
					"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO <'9999' AND " +
					"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
					"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
					"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd )) " +
					"order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
			System.out.println("CN-LTCORA: -"+queryString);
			while(rset.next())
			{				
			
			String map_id=rset.getString(3)==null?"":rset.getString(3);
			String tempmap_id[]=map_id.split("-");
			
			String temp_regas_no=tempmap_id[3];
			String temp_regas_rev_no=tempmap_id[4];
			String temp_cust_cd=tempmap_id[0];
			
			//SB20201027		SN_NO.add(temp_regas_no);
			//SB20201027		SN_REV_NO.add(temp_regas_rev_no);	
			///	LTCORA_SEQ_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			SN_NO.add(rset.getString(6)==null?"0":rset.getString(6));
			SN_REV_NO.add("0");			  	
			//SB20201027	  	FGSA_NO.add(tempmap_id[1]);	
			//SB20201027		FGSA_REV_NO.add("0");	 //No Rev no in LoA
			FGSA_NO.add(temp_regas_no);	  	
			FGSA_REV_NO.add(temp_regas_rev_no);	 //No Rev no in LoA
			CUSTOMER_CD.add(temp_cust_cd);									
			tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
			tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
			FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
			TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
			temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
			CARGO_ARRIVAL_DATE.add(temp_dt);	
			BOOKMMBTU.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))));
			BOOKMMSCM.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7))/38900));//MD20110916
			tot_comit += Double.parseDouble(rset.getString(7)==null?"0":nf.format(Double.parseDouble(rset.getString(7))));
			tot_commitment=nf.format(tot_comit);
			tot_comit_mmscm=(tot_comit/38900);//MD20110916
			tot_commitment_mmscm=nf.format(tot_comit_mmscm);
			SN_REF_NO.add("");	
			SIGNING_DT.add(rset.getString(1)==null?"0":rset.getString(1));
			RATE.add(nf2.format(Double.parseDouble(rset.getString(8)==null?"0":rset.getString(8))));
			
			String TEMP_apr_by=rset.getString(10)==null?"0":rset.getString(10);
			sn_apr_dt.add(rset.getString(11)==null?"-":rset.getString(11));
			String temp_ent_by=rset.getString(12)==null?"0":rset.getString(12);
			sn_ent_dt.add(rset.getString(13)==null?"-":rset.getString(13));
			VDealDCQ.add(rset.getString(14)==null?"1":rset.getString(14));
			VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
			VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
			VAdvAmt.add("0");
			VTransValue.add("0");
			double TransCharge=0;
			if(TransCharge==0)
				VContDelv.add("");
			else
				VContDelv.add("(DLV)");
			VDealType.add("CAPACITY"); //SB20201021
			MAPPING_ID.add(map_id);
			VDealUniqueId.add("C"+map_id);
			VDealUniqueIdColor.add("BLUE");
			VContType.add("C");
			VContRefno.add("");
			VContTCQ.add(rset.getString(7)==null?"0.00":nf.format(Double.parseDouble(rset.getString(7)))); //For Temporary		
			//////////////////////////Get Exchange Rate////////////////////////////////////////
			
			String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
			rset1=stmt1.executeQuery(queryString_nm);
			if(rset1.next()){
				sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			}else{
				sn_apr_by.add("-");
			}
			
			queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
			rset1=stmt1.executeQuery(queryString_nm);
			if(rset1.next()){
				sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			}else{
				sn_ent_by.add("-");
			}
			//////////////////////////Get Exchange Rate////////////////////////////////////////
			String Exchg_Rate_CD="";
			queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
			" FROM FMS8_LNG_REGAS_BILLING_DTL " +
			"WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
			//	System.out.println("STEP-7: FMS8_LNG_REGAS_BILLING_DTL: >>>> "+queryString2);
			rset2 = stmt2.executeQuery(queryString2);
			if(rset2.next())
			{
				Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
				int due_days = Integer.parseInt(rset2.getString(2));
			}
			double AvailableExchgRate=0;
			queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
			" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
			" AND FLAG='Y' ";
			//		System.out.println("STEP-7A: Last Exchg Rate: >>>> "+queryString2);
			rset2 = stmt2.executeQuery(queryString2);
			if(rset2.next())
			{
				AvailableExchgRate =rset2.getDouble(1);		
				VExchgRate.add(AvailableExchgRate); 
				VExchgRate_Dt.add(rset2.getString(2)==null?"N.A.":rset2.getString(2));
				VExchgRate_Nm.add(rset2.getString(3)==null?"N.A.":rset2.getString(3));
			}
			else
			{
				VExchgRate.add("0"); 
				VExchgRate_Dt.add("Avg."); 
				VExchgRate_Nm.add("Avg."); 
			}	
///////////////////////////////^^^^^///////////////////////////////////////////////
		}
////HP20201204 This is for BUY Deal////////////////////////////////////////////////////////
			
			queryString = "SELECT TO_CHAR(A.DELV_FROM_DT,'DD/MM/YYYY'), TO_CHAR(A.DELV_TO_DT,'DD/MM/YYYY'),A.MAN_CONF_CD,A.CARGO_SEQ_NO,E.TRD_CD, A.MAN_CD, A.MAN_CD, A.CONFIRM_VOL,"
					+ "A.CARGO_REF_CD,to_char(C.MAN_CONF_DT,'dd/mm/yyyy'), A.PRICE,A.EMP_CD,TO_CHAR(A.ENT_DT,'dd/mm/yyyy'), A.EMP_CD,TO_CHAR(A.ENT_DT,'dd/mm/yyyy'), E.PRICE_TYPE, A.PRICE_TO, A.REMARK  "+
					" FROM FMS7_MAN_CONFIRM_CARGO_DTL A, FMS7_MAN_CONFIRM_MST C, FMS7_MAN_REQ_MST E WHERE "+
			///		" A.DELV_FROM_DT BETWEEN TO_DATE('"+SearchDtFrom+"','DD/MM/YYYY') AND TO_DATE('"+SearchDtTo+"','DD/MM/YYYY') "
					" A.DELV_TO_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') "
					+ "AND E.MAN_CD=A.MAN_CD AND "+ 
			///		" A.UNIT_CD=C.UNIT_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD='"+VCAR_REF_NO_temp.elementAt(i)+"' "+ 
					" A.MAN_CONF_CD=C.MAN_CONF_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD LIKE '%' "+ 
					" ORDER BY A.MAN_CONF_CD, A.CARGO_REF_CD";
			//(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+from_date+"','dd/mm/yyyy'))
			System.out.println("CARGO: "+queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{		
				String map_id=rset.getString(3)+"-"+rset.getString(4);
				tmp_from_dt = rset.getString(1)==null?"":rset.getString(1);
				tmp_to_dt = rset.getString(2)==null?"":rset.getString(2);
				FRM_DT.add(rset.getString(1)==null?"":rset.getString(1));
				TO_DT.add(rset.getString(2)==null?"":rset.getString(2));
				temp_dt = tmp_from_dt+"   -   "+tmp_to_dt;
				CARGO_ARRIVAL_DATE.add(temp_dt);				
				SN_NO.add(rset.getString(3)==null?"0":rset.getString(3));
				SN_REV_NO.add(rset.getString(4)==null?"0":rset.getString(4));		
				CUSTOMER_CD.add(rset.getString(5)==null?"0":rset.getString(5));																		  	
			  	FGSA_NO.add(rset.getString(6)==null?"0":rset.getString(6));	
			 /// 	FGSA_REV_NO.add(rset.getString(7)==null?"0":rset.getString(7));	
			  	FGSA_REV_NO.add("0");	 //No Rev no in LoA		  					
			  	BOOKMMBTU.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))));
			  	BOOKMMSCM.add(rset.getString(8)==null?"0.00":nf.format(Double.parseDouble(rset.getString(8))/38900));//MD20110916
			  	tot_comit += Double.parseDouble(rset.getString(8)==null?"0":nf.format(Double.parseDouble(rset.getString(8))));			  	
			  	tot_comit_mmscm=(tot_comit/38900);//MD20110916
			  	tot_commitment_mmscm=nf.format(tot_comit_mmscm);	  	
			  	tot_commitment=nf.format(tot_comit);
			  	SN_REF_NO.add(rset.getString(9)==null?"":rset.getString(9));	
			  	SIGNING_DT.add(rset.getString(10)==null?"0":rset.getString(10));
			  	RATE.add(nf2.format(Double.parseDouble(rset.getString(11)==null?"0":rset.getString(11))));	
			  	
			  	String TEMP_apr_by=rset.getString(12)==null?"0":rset.getString(12);
			  	sn_apr_dt.add(rset.getString(13)==null?"-":rset.getString(13));
			  	String temp_ent_by=rset.getString(14)==null?"0":rset.getString(14);
			  	sn_ent_dt.add(rset.getString(15)==null?"-":rset.getString(15));
			  	VContType.add("B"); //SB20201108
			  	/////////SB20201205: ///////////////////////////////////////////
				VDealDCQ.add(rset.getString(8)==null?"1":rset.getString(8));
				VContStDt.add(rset.getString(1)==null?"0":rset.getString(1));
				VContEndDt.add(rset.getString(2)==null?"0":rset.getString(2));
				VAdvAmt.add("0");
				VTransValue.add("0");
				double TransCharge=0;
				if(TransCharge==0)
					VContDelv.add("");
				else
					VContDelv.add("(DLV)");
				VDealType.add("LNG"); //SB20201021
				MAPPING_ID.add("");
				VDealUniqueId.add("B"+map_id);
				VDealUniqueIdColor.add("RED");				
				VContRefno.add("");
				VContTCQ.add(""); //For Temporary	
			  	/////////////////////^^^^^^^///////////////////////////////////////
			  	String queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+TEMP_apr_by+"'";
			  	rset1=stmt1.executeQuery(queryString_nm);
			  	if(rset1.next()){
			  		sn_apr_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			  	}else{
			  		sn_apr_by.add("-");
			  	}
			  	VContStDt.add(rset.getString(1)==null?"":rset.getString(1));
			  	VContEndDt.add(rset.getString(2)==null?"":rset.getString(2));
			  	
			  	queryString_nm ="SELECT EMP_NM FROM HR_EMP_MST WHERE EMP_CD='"+temp_ent_by+"'";
			  	rset1=stmt1.executeQuery(queryString_nm);
			  	if(rset1.next()){
			  		sn_ent_by.add(rset1.getString(1)==null?"-":rset1.getString(1));
			  	}else{
			  		sn_ent_by.add("-");
			  	}
			 // 	MAPPING_ID.add("C"+rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
			  	MAPPING_ID.add("B"+rset.getString(3)+"-0-"+rset.getString(6)+"-"+rset.getString(7));
			 //as stored into FMS9_MRCR_CONT_PRICE_DTL  	String Mapp_Id=CUSTOMER_CD.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i)+"-"+SN_REF_NO.elementAt(i)+"-0";
			}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////			
			System.out.println(VContType.size()+" CUSTOMER_CD: "+VContType);
			for(int i=0;i<CUSTOMER_CD.size();i++)
			{
				if(!VContType.elementAt(i).equals("B"))
				{
					queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" "
						+ "and eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+CUSTOMER_CD.elementAt(i)+"' and eff_dt<=to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy'))";
				}
				else
				{
					queryString ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST B where TRADER_CD="+CUSTOMER_CD.elementAt(i)+" "
							+ "and eff_dt=(select max(eff_dt) from FMS7_TRADER_MST where TRADER_CD='"+CUSTOMER_CD.elementAt(i)+"' and eff_dt<=to_date('"+FRM_DT.elementAt(i)+"','dd/mm/yyyy'))";	
				}
				System.out.println("CARGO: "+queryString);
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
					CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));	
					System.out.println(MAPPING_ID.elementAt(i)+" :CUSTOMER_NM: >>>>>>>>>>>>>>>>>>>>>> "+rset.getString(2));
				}
				else
				{
					CUSTOMER_NM.add("");
					CUSTOMER_ABBR.add("");
				}	
				
				double AvgExchgRate_AllocatedQty=0;

				SUPPLIEDMBTU.add("0.00");
				SUPPLIEDMMSCM.add("0.00");//MD20110916
				VUnBilledAmtTillPrevMth.add("0");
		//		System.out.println(">PrevMth: >>>AvgExchgRate_AllocatedQty>> "+AvgExchgRate_AllocatedQty);
				
				
			
			////////////////////////////////////////////////////////////////////////////////////////////////////
				double AvgExchgRateAlloc=0; double UnBilledAllocQty=0; 
			
				
				
			//	System.out.println(">UnBilled Current Mth: >>>AvgExchgRate_AllocatedQty>> "+AvgExchgRateAlloc);
				
				VAvgExchgRate.add(AvgExchgRate_AllocatedQty); 
				
				BALANCEMMBTU.add(nf.format(Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i))));
				//MD20110916
				BALANCEMMSCM.add(nf.format(Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i))));
				bal_tot_comit+=Double.parseDouble(""+BOOKMMBTU.elementAt(i))- Double.parseDouble(""+SUPPLIEDMBTU.elementAt(i));
				bal_tot_comit_mmscm+=Double.parseDouble(""+BOOKMMSCM.elementAt(i))- Double.parseDouble(""+SUPPLIEDMMSCM.elementAt(i));
				//System.out.println("SUPLIEDMMSCM : "+SUPPLIEDMMSCM+" TOTAL : "+sup_tot_comit_mmscm);
				//System.out.println("BALANCEMMSCM : "+BALANCEMMSCM+" TOTAL : "+bal_tot_comit_mmscm);
					
				//////////////SB20200817////////////////////////
				String TCQ=""; String Alloc_Qty="";  String Cont_End_Dt="";
				TCQ=""+BOOKMMBTU.elementAt(i); Cont_End_Dt=""+TO_DT.elementAt(i);
				Alloc_Qty=""+SUPPLIEDMBTU.elementAt(i); Cont_End_Dt=""+TO_DT.elementAt(i);
				String Mapp_Id=CUSTOMER_CD.elementAt(i)+"-"+FGSA_NO.elementAt(i)+"-"+FGSA_REV_NO.elementAt(i)+"-"+SN_NO.elementAt(i)+"-"+SN_REV_NO.elementAt(i);
				String Phy_CurFrd_Price="0"; String Fin_CurFrd_Price="0";
				String Buy_Sell="SELL";
				if(CUSTOMER_ABBR.elementAt(i).equals("SEIPL"))
					Buy_Sell="Buy";
				else if(VContType.elementAt(i).equals("B"))
					Buy_Sell="BUY";
				String PriceType="";
				VBuySell.add(Buy_Sell);
				
				
				
			//////////////////Un Delivered Qty and Amt for the Current Mth////OK: Perfect Case1: Cont closes before the mth and after the month@DCQ////////////////////////////////
							double UnDelvAllocQtyCurrMthDaily=0;  double UnDelvAllocQtyCurrMth=0; double UnDelvAllocAmtCurrMth=0; String UnDelvStartDt="";
							if(FirstFortNightFlag.equals("N"))	
								UnDelvStartDt=to_date;
							else
								UnDelvStartDt=SecondFortNightBillStartDt;
							
	
							
							
							
						//	System.out.println("CR: EXPOSURE TRACKING REPORT: VUnDeliveredNextMthAmt: "+VUnDeliveredNextMthAmt);
			//////////////////////////////////////////////////////////////////////////
							
							
							
			//////////////////Un Delivered Qty and Amt for the Next Mth////////////////////////////////////
							
						
					FowardMth=NextMth;
			//		System.out.println("CR: EXPOSURE TRACKING REPORT: VUnDeliveredNextMthAmt: "+VUnDeliveredNextMthAmt);
				
			
				String SecAmt=": ";
				String DueDt=": ";
				String Entby=": ";
				String EntDt=": ";
				String SecType=": ";
				String Temp="";
		/*		queryString ="SELECT SUM(FINAL_LC_AMOUNT) FROM FMS7_LC_MST  where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND END_DATE>=to_date('"+to_date+"','dd/mm/yyyy') "+
						 " AND LC_SEQ_NO IN  (SELECT LC_SEQ_NO FROM FMS7_LC_DTL "
						 + " WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND SN_NO="+SN_NO.elementAt(i)+" AND SN_REV_NO="+SN_REV_NO.elementAt(i)+" "
						 + " AND FGSA_NO="+FGSA_NO.elementAt(i)+" AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND CONT_TYPE='"+VContType.elementAt(i)+"') AND FLAG='Y' ";
				*/
				queryString ="SELECT NVL(FINAL_LC_AMOUNT,''), TO_CHAR(SEC_DT,'dd/mm/yyyy'), EMP_CD,  TO_CHAR(ENT_DT,'dd/mm/yyyy') FROM FMS7_LC_MST  where CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND  LC_SEQ_NO IN  (SELECT LC_SEQ_NO FROM FMS7_LC_DTL "+ 
						" WHERE CUSTOMER_CD="+CUSTOMER_CD.elementAt(i)+" AND SN_NO="+SN_NO.elementAt(i)+" AND SN_REV_NO="+SN_REV_NO.elementAt(i)+" AND FGSA_NO="+FGSA_NO.elementAt(i)+" AND FGSA_REV_NO="+FGSA_REV_NO.elementAt(i)+" AND CONT_TYPE='"+VContType.elementAt(i)+"') AND FLAG='N' ";
				rset = stmt.executeQuery(queryString);
				System.out.println(">>>>>>> "+queryString);
				while(rset.next())
				{
					Temp=rset.getString(1)==null?"":rset.getString(1);
					SecAmt=SecAmt+Temp+": ";
					Temp=rset.getString(2)==null?"":rset.getString(2);
					DueDt=DueDt+Temp+": ";
					Temp=rset.getString(3)==null?"":rset.getString(3);
					Entby=Entby+Temp+": ";
					Temp=rset.getString(4)==null?"":rset.getString(4);
					EntDt=EntDt+Temp+": ";
					//SecType=SecType+rset.getString(5)+": ";
				}	
				VPreDealCapAmt.add(SecAmt);
				VPreDealRecptDueDt.add(DueDt);
				VPreDealCapEntBy.add(Entby);
				VPreDealCapEntDt.add(EntDt);
				///VPreDealSecType.add(SecType);
		   }
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	//////////////////////////SB20201012: Customer List/////////////////////////////////////////
	public void fetchCustomerList()
	{
		try
		{		
			queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where  "
					+ " eff_dt<=(select max(eff_dt) from fms7_customer_mst where eff_dt<=to_date('"+to_date+"','dd/mm/yyyy')) ORDER BY CUSTOMER_NAME";
			System.out.println(" FMS7_CUSTOMER_MST : "+queryString);
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				VCust_Nm.add(rset.getString(2)==null?"":rset.getString(2));
				VCust_Abbr.add(rset.getString(1)==null?"":rset.getString(1));	
				VCust_Cd.add(rset.getString(3)==null?"":rset.getString(3));	
			}
		}
		catch(Exception e)
		{
			//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
			  e.printStackTrace();	
		}
	}
	Vector VCust_Cd = new Vector();
	public Vector getVCust_Cd() {return VCust_Cd;}
	Vector VCust_Nm = new Vector();
	public Vector getVCust_Nm() {return VCust_Nm;}	
	Vector VCust_Abbr = new Vector();
	public Vector getVCust_Abbr() {return VCust_Abbr;}
	//////////////////////////////////////////////////////////////////////////////////////
	
	Vector VPreDealSecType = new Vector();
	public Vector getVPreDealSecType() {return VPreDealSecType;}
	Vector VPreDealCapAmt = new Vector();
	public Vector getVPreDealCapAmt() {return VPreDealCapAmt;}
	Vector VPreDealRecptDueDt = new Vector();
	public Vector getVPreDealRecptDueDt() {return VPreDealRecptDueDt;}
	Vector VPreDealCapEntBy = new Vector();
	public Vector getVPreDealCapEntBy() {return VPreDealCapEntBy;}
	Vector VPreDealCapEntDt = new Vector();
	public Vector getVPreDealCapEntDt() {return VPreDealCapEntDt;}
	//////////////////////////////////////////////////////////////////////////////////////
	String DealCustCd="";
	public void setDealCustCd(String DealCustCd) {this.DealCustCd = DealCustCd;}
	String FgsaNo="";
	public void setFgsaNo(String FgsaNo) {this.FgsaNo = FgsaNo;}
	String FgsaRevNo="";
	public void setFgsaRevNo(String FgsaRevNo) {this.FgsaRevNo = FgsaRevNo;}
	String SnNo="";
	public void setSnNo(String SnNo) {this.SnNo = SnNo;}
	String SnRevNo="";
	public void setSnRevNo(String SnRevNo) {this.SnRevNo = SnRevNo;}
	String GenDt="";
	public void setGenDt(String GenDt) {this.GenDt = GenDt;}
	String BtnType="";
	public void setBtnType(String BtnType) {this.BtnType = BtnType;}
	/////////////////////////////////////////////////////////
	String PrvCurvePrice="0"; //Used for JKM
	String PriceIndex_SettleDate=""; //Used for JKM
	String PriceIndex_StartDate=""; //Used for JKM
	String PriceIndex_EndDate=""; //Used for JKM
	String EffPriceSlopeConst=""; //Used for JKM
	Vector VMthYrWise = new Vector();
	public Vector getVMthYrWise() {return VMthYrWise;}
	Vector VPriceIndex_SettleDate = new Vector();
	public Vector getVPriceIndex_SettleDate() {return VPriceIndex_SettleDate;}
	Vector VPriceIndex_StartDate = new Vector();
	public Vector getVPriceIndex_StartDate() {return VPriceIndex_StartDate;}
	Vector VPriceIndex_EndDate = new Vector();
	public Vector getVPriceIndex_EndDate() {return VPriceIndex_EndDate;}
	Vector VEff_Price = new Vector();
	public Vector getVEff_Price() {return VEff_Price;}
	Vector VMthYrWisePriceICE_JKM = new Vector();
	public Vector getVMthYrWisePriceICE_JKM() {return VMthYrWisePriceICE_JKM;}
	Vector VBuySell = new Vector();
	public Vector getVBuySell() {return VBuySell;}
	Vector VPriceType = new Vector();
	public Vector getVPriceType() {return VPriceType;}
	Vector VDealPriceCurve = new Vector();
	public Vector getVDealPriceCurve() {return VDealPriceCurve;}
	Vector VDealPhysCurve = new Vector();
	public Vector getVDealPhysCurve() {return VDealPhysCurve;}
	Vector VDealTCQ = new Vector();
	public Vector getVDealTCQ() {return VDealTCQ;}
	Vector VDealDCQ = new Vector();
	public Vector getVDealDCQ() {return VDealDCQ;}
	Vector VDealDCQFlag = new Vector();
	public Vector getVDealDCQFlag() {return VDealDCQFlag;}
	Vector VDealAllocQty = new Vector();
	public Vector getVDealAllocQty() {return VDealAllocQty;}
	Vector VRLNG_PHYS_IN_EXPO = new Vector();
	public Vector getVRLNG_PHYS_IN_EXPO() {return VRLNG_PHYS_IN_EXPO;}
	Vector VLNG_ICE_JKM_EXPO = new Vector();
	public Vector getVLNG_ICE_JKM_EXPO() {return VLNG_ICE_JKM_EXPO;}
	Vector VCargoRefNo = new Vector();
	public Vector getVCargoRefNo() {return VCargoRefNo;}
	Vector VDealType= new Vector(); //SB20201021
	public Vector getVDealType() {return VDealType;} //SB20201021
	
	
	Vector VAll_Dt = new Vector(); //SB20200901 Not in Use
	public Vector getVAll_Dt() {return VAll_Dt;}
	
	String Slope_ICE_JKM="0"; //Used for JKM
	String Slope_FLAG="N"; //Used for JKM
	Vector VSlope = new Vector();
	public Vector getVSlope() {return VSlope;}
	Vector VSlope_BRENT = new Vector();
	public Vector getVSlope_BRENT() {return VSlope_BRENT;}
	Vector VSlope_ICE_JKM = new Vector();
	public Vector getVSlope_ICE_JKM() {return VSlope_ICE_JKM;}
	Vector VSlope_JKM = new Vector();
	public Vector getVSlope_JKM() {return VSlope_JKM;}
	Vector VSlope_LNG_PHYS = new Vector();
	public Vector getVSlope_LNG_PHYS() {return VSlope_LNG_PHYS;}
	Vector VSlope_RLNG_PHYS = new Vector();
	public Vector getVSlope_RLNG_PHYS() {return VSlope_RLNG_PHYS;}
	Vector VSlope_FLAG = new Vector();
	public Vector getVSlope_FLAG() {return VSlope_FLAG;}
	
	Vector VSettle_ICE_JKM = new Vector();
	public Vector getVSettle_ICE_JKM() {return VSettle_ICE_JKM;}
	Vector VSettle_RLNG_PHYS = new Vector();
	public Vector getVSettle_RLNG_PHYS() {return VSettle_RLNG_PHYS;}
	Vector VSettle_ICE_JKM_FLAG = new Vector();
	public Vector getVSettle_ICE_JKM_FLAG() {return VSettle_ICE_JKM_FLAG;}
	Vector VSettle_RLNG_PHYS_FLAG = new Vector();
	public Vector getVSettle_RLNG_PHYS_FLAG() {return VSettle_RLNG_PHYS_FLAG;}

	String Const_ICE_JKM="0"; //Used for JKM
	String Const_RLNG_PHYS="0"; 
	String Const_ICE_JKM_FLAG=""; 
	Vector VConst_ICE_JKM = new Vector();
	public Vector getVConst_ICE_JKM() {return VConst_ICE_JKM;}
	Vector VConst_RLNG_PHYS = new Vector();
	public Vector getVConst_RLNG_PHYS() {return VConst_RLNG_PHYS;}
	Vector VConst_ICE_JKM_FLAG = new Vector();
	public Vector getVConst_ICE_JKM_FLAG() {return VConst_ICE_JKM_FLAG;}
	
	Vector VRU_Physical_Leg = new Vector();
	public Vector getVRU_Physical_Leg() {return VRU_Physical_Leg;}
	Vector VRU_Financial_Leg = new Vector();
	public Vector getVRU_Financial_Leg() {return VRU_Financial_Leg;}
	Vector VRLNG_PHYS_INDIA_EXPOSURE_U = new Vector();
	public Vector getVRLNG_PHYS_INDIA_EXPOSURE_U() {return VRLNG_PHYS_INDIA_EXPOSURE_U;}
	Vector VLNG_ICE_JKM_EXPOSURE_U = new Vector();
	public Vector getVLNG_ICE_JKM_EXPOSURE_U() {return VLNG_ICE_JKM_EXPOSURE_U;}
	Vector VU_Phy_Leg = new Vector();
	public Vector getVU_Phy_Leg() {return VU_Phy_Leg;}
	Vector VU_Fin_Leg = new Vector();
	public Vector getVU_Fin_Leg() {return VU_Fin_Leg;}
	Vector VR_Fin_Leg = new Vector();
	public Vector getVR_Fin_Leg() {return VR_Fin_Leg;}
	Vector VTotal = new Vector();
	public Vector getVTotal() {return VTotal;}
	//////////////TOTAL FIGURE: CALCULATION//////////////////////////////////////////////
	String FinalTotal = "";
	public String getFinalTotal() {return FinalTotal;}
	String Total_DCQ_TCQ = "";
	public String getTotal_DCQ_TCQ() {return Total_DCQ_TCQ;}
	String Total_AllocQty = "";
	public String getTotal_AllocQty() {return Total_AllocQty;}
	String Total_RealizedQty = "";
	public String getTotal_RealizedQty() {return Total_RealizedQty;}
	String Total_UnRealizedQty = "";
	public String getTotal_UnRealizedQty() {return Total_UnRealizedQty;}
	//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
	String UnDelvCurrMthFmToDt=""; 
	public String getUnDelvCurrMthFmToDt() {return UnDelvCurrMthFmToDt;}
	String FowardMth=""; 
	public String getFowardMth() {return FowardMth;}
	String UnBilledFmTo=""; 
	public String getUnBilledFmTo() {return UnBilledFmTo;}
	String UnDeliveredFmTo=""; 
	public String getUnDeliveredFmTo() {return UnDeliveredFmTo;}
	String AccRecvUptoDt=""; 
	public String getAccRecvUptoDt() {return AccRecvUptoDt;}
	String LastDatePrevtMth=""; 
	public String getLastDatePrevtMth() {return LastDatePrevtMth;}
	
	Vector VContType = new Vector();
	public Vector getVContType() {return VContType;}
	
	Vector VContStDt = new Vector();
	public Vector getVContStDt() {return VContStDt;}
	Vector VContEndDt = new Vector();
	public Vector getVContEndDt() {return VContEndDt;}
	Vector VContDelv = new Vector();
	public Vector getVContDelv() {return VContDelv;}
	Vector VTransValue = new Vector();
	public Vector getVTransValue() {return VTransValue;}
	Vector VAdvAmt = new Vector();
	public Vector getVAdvAmt() {return VAdvAmt;}
	
	Vector VContRefno = new Vector();
	public Vector getVContRefno() {return VContRefno;}
	Vector VContTCQ = new Vector();
	public Vector getVContTCQ() {return VContTCQ;}
	Vector VAvgTaxUndelivered = new Vector();
	public Vector getVAvgTaxUndelivered() {return VAvgTaxUndelivered;}
	Vector VBilledQtyTCQ = new Vector();
	public Vector getVBilledQtyTCQ() {return VBilledQtyTCQ;}
	Vector VBalanceUnbilledTCQ = new Vector();
	public Vector getVBalanceUnbilledTCQ() {return VBalanceUnbilledTCQ;}
	Vector VBalanceTCQCurrMth = new Vector();
	public Vector getVBalanceTCQCurrMth() {return VBalanceTCQCurrMth;}
	Vector VBalanceTCQNextMth = new Vector();
	public Vector getVBalanceTCQNextMth() {return VBalanceTCQNextMth;}
	Vector VDealUniqueId = new Vector();
	public Vector getVDealUniqueId() {return VDealUniqueId;}
	Vector VDealUniqueIdColor = new Vector();
	public Vector getVDealUniqueIdColor() {return VDealUniqueIdColor;}
	
	Vector VPriceTypeDealRate = new Vector();
	public Vector getVPriceTypeDealRate() {return VPriceTypeDealRate;}
	Vector VPriceTypeDeal = new Vector(); //SB20201111
	public Vector getVPriceTypeDeal() {return VPriceTypeDeal;}  //SB20201111
	Vector VCurve_Nm = new Vector(); //SB20201111
	public Vector getVCurve_Nm() {return VCurve_Nm;}  //SB20201111
	Vector VPriceIndex_SettleDateA = new Vector();
	public Vector getVPriceIndex_SettleDateA() {return VPriceIndex_SettleDateA;}
	Vector VEff_PriceA = new Vector();
	public Vector getVEff_PriceA() {return VEff_PriceA;}
	Vector VPriceTypeDealRateA = new Vector();
	public Vector getVPriceTypeDealRateA() {return VPriceTypeDealRateA;}
	
	Vector VBilledReceivablePaymtRecvd = new Vector(); //SB20200918
	public Vector getVBilledReceivablePaymtRecvd() {return VBilledReceivablePaymtRecvd;} //SB20200918
	Vector VBilledReceivablePaymtRecvdDR = new Vector(); //SB20200918
	public Vector getVBilledReceivablePaymtRecvdDR() {return VBilledReceivablePaymtRecvdDR;} //SB20200918
	Vector VBilledReceivableDR = new Vector(); //SB20200918
	public Vector getVBilledReceivableDR() {return VBilledReceivableDR;} //SB20200918
	Vector VBilledReceivableCR = new Vector(); //SB20200918
	public Vector getVBilledReceivableCR() {return VBilledReceivableCR;} //SB20200918
	
	Vector VUnBilledReceivable = new Vector();
	public Vector getVUnBilledReceivable() {return VUnBilledReceivable;}
	Vector VBilledReceivableDtl = new Vector(); //SB20201206
	public Vector getVBilledReceivableDtl() {return VBilledReceivableDtl;} //SB20201206
	Vector VSalesPriceFlag = new Vector(); //SB20201206
	public Vector getVSalesPriceFlag() {return VSalesPriceFlag;} //SB20201207
	Vector VSalesPriceCurr = new Vector(); //SB20201206
	public Vector getVSalesPriceCurr() {return VSalesPriceCurr;} //SB20201207

	
	Vector VUnBilledReceivablePeriodEndDt = new Vector();
	public Vector getVUnBilledReceivablePeriodEndDt() {return VUnBilledReceivablePeriodEndDt;}
	Vector VUnBilledReceivableTax = new Vector();
	public Vector getVUnBilledReceivableTax() {return VUnBilledReceivableTax;}
	Vector VUnBilledReceivableTaxOnly = new Vector();
	public Vector getVUnBilledReceivableTaxOnly() {return VUnBilledReceivableTaxOnly;}
	Vector VUnBilledReceivableTaxTCS = new Vector(); //SB20200918
	public Vector getVUnBilledReceivableTaxTCS() {return VUnBilledReceivableTaxTCS;} //SB20200918
	Vector VUnBilledReceivableGrossUSD = new Vector();
	public Vector getVUnBilledReceivableGrossUSD() {return VUnBilledReceivableGrossUSD;}
	Vector VBilledReceivableExchgAvg = new Vector();
	public Vector getVBilledReceivableExchgAvg() {return VBilledReceivableExchgAvg;}
	Vector VAvgExchgRate = new Vector();
	public Vector getVAvgExchgRate() {return VAvgExchgRate;}
	Vector VExchgRate = new Vector();
	public Vector getVExchgRate() {return VExchgRate;}
	Vector VExchgRate_Dt = new Vector();
	public Vector getVExchgRate_Dt() {return VExchgRate_Dt;}
	Vector VExchgRate_Nm = new Vector();
	public Vector getVExchgRate_Nm() {return VExchgRate_Nm;}
	
	Vector VReceivableAmtTax = new Vector();
	public Vector getVReceivableAmtTax() {return VReceivableAmtTax;}
	Vector VReceivableAmtTaxCR = new Vector();
	public Vector getVReceivableAmtTaxCR() {return VReceivableAmtTaxCR;}
	Vector VReceivableAmtTaxDR = new Vector();
	public Vector getVReceivableAmtTaxDR() {return VReceivableAmtTaxDR;}
	
	Vector VUnBilledAmtTillPrevMth = new Vector();
	public Vector getVUnBilledAmtTillPrevMth() {return VUnBilledAmtTillPrevMth;}
	Vector VUnBilledAvgSalesRate = new Vector();
	public Vector getVUnBilledAvgSalesRate() {return VUnBilledAvgSalesRate;}
	Vector VUnBilledAvgExchgRate = new Vector();
	public Vector getVUnBilledAvgExchgRate() {return VUnBilledAvgExchgRate;}
	Vector VUnBilledAmtCurrMth = new Vector();
	public Vector getVUnBilledAmtCurrMth() {return VUnBilledAmtCurrMth;}
	Vector VUnBilledAmtCurrMthDt = new Vector();
	public Vector getVUnBilledAmtCurrMthDt() {return VUnBilledAmtCurrMthDt;}
	Vector VUnBilledQtyCurrMth = new Vector();
	public Vector getVUnBilledQtyCurrMth() {return VUnBilledQtyCurrMth;}
	Vector VUnDeliveredCurrMth = new Vector();
	public Vector getVUnDeliveredCurrMth() {return VUnDeliveredCurrMth;}
	Vector VUnDeliveredCurrMthEndDt = new Vector();
	public Vector getVUnDeliveredCurrMthEndDt() {return VUnDeliveredCurrMthEndDt;}
	Vector VUnDeliveredCurrMthAmt = new Vector();
	public Vector getVUnDeliveredCurrMthAmt() {return VUnDeliveredCurrMthAmt;}
	Vector VUnDeliveredNextMth = new Vector();
	public Vector getVUnDeliveredNextMth() {return VUnDeliveredNextMth;}
	Vector VUnDeliveredNextMthEndDt = new Vector();
	public Vector getVUnDeliveredNextMthEndDt() {return VUnDeliveredNextMthEndDt;}
	Vector VUnDeliveredNextMthAmt = new Vector();
	public Vector getVUnDeliveredNextMthAmt() {return VUnDeliveredNextMthAmt;}
	
	Vector VNoOfCargo = new Vector(); //SB20201206
	public Vector getVNoOfCargo() {return VNoOfCargo;} //SB20201207
	Vector VInvoiceReceivableGrossINR = new Vector(); //SB20201215
	public Vector getVInvoiceReceivableGrossINR() {return VInvoiceReceivableGrossINR;} //SB20201215
	
	Vector VCargoDealNo = new Vector(); //SB20210124
	public Vector getVCargoDealNo() {return VCargoDealNo;} //SB20210124
	Vector VCargoSeqNo = new Vector(); //SB20210124
	public Vector getVCargoSeqNo() {return VCargoSeqNo;} //SB20210124
	Vector VCargoBOEQty = new Vector(); //SB20210124
	public Vector getVCargoBOEQty() {return VCargoBOEQty;} //SB20210124
	Vector VCargoQTS = new Vector(); //SB20210124
	public Vector getVCargoQTS() {return VCargoQTS;} //SB20210124
	Vector VCargoDCQ = new Vector(); //SB20210124
	public Vector getVCargoDCQ() {return VCargoDCQ;} //SB20210124
	Vector VCargoContStartDt = new Vector(); //SB20210124
	public Vector getVCargoContStartDt() {return VCargoContStartDt;} //SB20210124
	Vector VCargoContEndDt = new Vector(); //SB20210124
	public Vector getVCargoContEndDt() {return VCargoContEndDt;} //SB20210124
	Vector VCargoNo = new Vector(); //SB20210124
	public Vector getVCargoNo() {return VCargoNo;} //SB20210124
	Vector VCargoWiseBilledQty = new Vector(); //SB20210124
	public Vector getVCargoWiseBilledQty() {return VCargoWiseBilledQty;} //SB20210124
	Vector VCargoWiseBalanceQty = new Vector(); //SB20210124
	public Vector getVCargoWiseBalanceQty() {return VCargoWiseBalanceQty;} //SB20210124
	
	Vector VCapDealNo = new Vector(); //SB20210124
	public Vector getVCapDealNo() {return VCapDealNo;} //SB20210124
	Vector VCapDealInvNo = new Vector(); //SB20210124
	public Vector getVCapDealInvNo() {return VCapDealInvNo;} //SB20210124
	Vector VCapDealInvType = new Vector(); //SB20210124
	public Vector getVCapDealInvType() {return VCapDealInvType;} //SB20210124
	Vector VCapGrossAmt = new Vector(); //SB20210124
	public Vector getVCapGrossAmt() {return VCapGrossAmt;} //SB20210124
	Vector VCapNetAmt = new Vector(); //SB20210124
	public Vector getVCapNetAmt() {return VCapNetAmt;} //SB20210124
	Vector VCapTaxAmt = new Vector(); //SB20210124
	public Vector getVCapTaxAmt() {return VCapTaxAmt;} //SB20210124
	Vector VCapExchRate = new Vector(); //SB20210124
	public Vector getVCapExchRate() {return VCapExchRate;} //SB20210124
	Vector VCapBillQty = new Vector(); //SB20210124
	public Vector getVCapBillQty() {return VCapBillQty;} //SB20210124
	Vector VCapCargoSeqNo = new Vector(); //SB20210124
	public Vector getVCapCargoSeqNo() {return VCapCargoSeqNo;} //SB20210124
	
	String Tcs_FY="";
	public String getTcs_FY() {return Tcs_FY;}
	Vector VTcsApplicableAmt = new Vector(); //SB20210124
	public Vector getVTcsApplicableAmt() {return VTcsApplicableAmt;} //SB20210124
	Vector VTcsGrossAmtFY = new Vector(); //SB20210124
	public Vector getVTcsGrossAmtFY() {return VTcsGrossAmtFY;} //SB20210124
	Vector VTcsAmt = new Vector(); //SB20210124
	public Vector getVTcsAmt() {return VTcsAmt;} //SB20210124
	Vector VColumn1 = new Vector(); //SB20210124
	public Vector getVColumn1() {return VColumn1;} //SB20210124
	Vector VColumn2 = new Vector(); //SB20210124
	public Vector getVColumn2() {return VColumn2;} //SB20210124
	
	Vector VGrossExposureAmt = new Vector();
	public Vector getVGrossExposureAmt() {return VGrossExposureAmt;}
	Vector VGrossExposureAmtInclTax = new Vector();
	public Vector getVGrossExposureAmtInclTax() {return VGrossExposureAmtInclTax;}
	
	Vector VCollateralValue = new Vector();
	public Vector getVCollateralValue() {return VCollateralValue;}
	Vector VCollateralValueLinked = new Vector(); //SB20201112
	public Vector getVCollateralValueLinked() {return VCollateralValueLinked;} //SB20201112
	Vector VCollateralRefLinked = new Vector(); //SB20201112
	public Vector getVCollateralRefLinked() {return VCollateralRefLinked;} //SB20201112
	Vector VCollateralBalance = new Vector(); //SB20201112
	public Vector getVCollateralBalance() {return VCollateralBalance;} //SB20201112
	Vector VLimitValue = new Vector();
	public Vector getVLimitValue() {return VLimitValue;}
	Vector VLimitValueLinked = new Vector(); //SB20201118
	public Vector getVLimitValueLinked() {return VLimitValueLinked;}  //SB20201118
	Vector VLimitValueLinkedComp = new Vector(); //SB20201118
	public Vector getVLimitValueLinkedComp() {return VLimitValueLinkedComp;}  //SB20201118
	Vector VNetExposure = new Vector();
	Vector VLC_AMT = new Vector(); //HARSH20210305
	public Vector getVLC_AMT() {return VLC_AMT;} //HARSH20210305
	Vector VOTH_COLLAT = new Vector(); //HARSH20210305
	public Vector getVOTH_COLLAT() {return VOTH_COLLAT;} //HARSH20210305
	
	public Vector getVNetExposure() {return VNetExposure;}
	Vector VCreditExceed = new Vector();
	public Vector getVCreditExceed() {return VCreditExceed;}
	Vector VCreditExceedBalance = new Vector(); //SB20201118
	public Vector getVCreditExceedBalance() {return VCreditExceedBalance;} //SB20201118
	
	Vector VParentLimitValue= new Vector(); 
	public Vector getVParentLimitValue() {return VParentLimitValue;} //HARSH20201127
	Vector VParentAbbr= new Vector(); //HARSH20210302
	public Vector getVParentAbbr() {return VParentAbbr;} //HARSH20210302
	Vector VLimitParentFlag= new Vector(); //HARSH20210302
	public Vector getVLimitParentFlag() {return VLimitParentFlag;} //HARSH20210302
	
	Vector VNetExposureUSD = new Vector();
	public Vector getVNetExposureUSD() {return VNetExposureUSD;}
	Vector VCreditExceedUSD = new Vector();
	public Vector getVCreditExceedUSD() {return VCreditExceedUSD;}
//////////////////////////////////////////////////////////////////////////////////////
	/////////Reason of Exceed Credit////////
	Vector VReasonExceedCredit = new Vector();
	public Vector getVReasonExceedCredit() {return VReasonExceedCredit;} //HARSH20201119
	
	Vector VReasonExceedCreditFlag = new Vector();//HARSH20210223
	public Vector getVReasonExceedCreditFlag() {return VReasonExceedCreditFlag;} //HARSH20210223
	////////////////////////////////////////
	public void setCallFlag(String callFlag) {this.callFlag = callFlag;}	
	public void setCargo_ref_cd(String cargo_ref_cd) {this.cargo_ref_cd = cargo_ref_cd;}
	public void setMandate_conf_no(String mandate_conf_no) {Mandate_conf_no = mandate_conf_no;}	
	public void setShip_cd(String ship_cd) {this.ship_cd = ship_cd;}	
	public void setFrom_date(String from_date) {this.from_date = from_date;}
	public void setTo_date(String to_date) {this.to_date = to_date;}	
	public void setCargo_ref_no(String cargo_ref_no) {this.cargo_ref_no = cargo_ref_no;}
	public void setYear(String year) {this.year = year;}		
	public void setSELLER_NAME(String seller_name) {SELLER_NAME = seller_name;}		
		
	public Vector getTRADER_ABBR() {return TRADER_ABBR;}
	public Vector getTRADER_CD() {return TRADER_CD;}
	public Vector getTRADER_NAME() {return TRADER_NAME;}
	public Vector getMAN_CD() {return MAN_CD;}		
	public Vector getMAN_CONF_CD() {return MAN_CONF_CD;}			
	public Vector getCARGO_REF_CD() {return CARGO_REF_CD;}	
	public Vector getSHIP_CD() {return SHIP_CD;}	
	public Vector getSHIP_NAME() {return SHIP_NAME;}	
	public Vector getCUSTOMER_CD() {return CUSTOMER_CD;}
	public Vector getCUSTOMER_NM() {return CUSTOMER_NM;}				
	public Vector getMAN_CONF_DT() {return MAN_CONF_DT;}
	public Vector getCARGO_ARRIVAL_DATE() {return CARGO_ARRIVAL_DATE;}	
	
	public Vector getFGSA_NO() {return FGSA_NO;}
	public Vector getFGSA_REV_NO() {return FGSA_REV_NO;}
	public Vector getSN_REV_NO() {return SN_REV_NO;}
	public Vector getSN_NO() {return SN_NO;}
	public Vector getBOOKMMBTU() {return BOOKMMBTU;}
	public Vector getSUPPLIEDMBTU() {return SUPPLIEDMBTU;}
	public Vector getBALANCEMMBTU() {return BALANCEMMBTU;}	
			
	public String getMandate_conf_no() {return Mandate_conf_no;}		
	public String getSELLER_NAME() {return SELLER_NAME;}
	public String getSHIPNAME() {return SHIPNAME;}		
	public String getTot_commitment() {return tot_commitment;}


	public Vector getLOA_BALANCEMMBTU() {return LOA_BALANCEMMBTU;}
	public Vector getLOA_BOOKMMBTU() {return LOA_BOOKMMBTU;}
	public Vector getLOA_CARGO_ARRIVAL_DATE() {return LOA_CARGO_ARRIVAL_DATE;}
	public Vector getLOA_CUSTOMER_CD() {return LOA_CUSTOMER_CD;}
	public Vector getLOA_CUSTOMER_NM() {return LOA_CUSTOMER_NM;}
	public Vector getLOA_NO() {return LOA_NO;}
	public Vector getLOA_REV_NO() {return LOA_REV_NO;}
	public Vector getLOA_SUPPLIEDMBTU() {return LOA_SUPPLIEDMBTU;}
	public String getLoa_tot_commitment() {return loa_tot_commitment;}
	public Vector getTENDER_NO() {return TENDER_NO;}
	public String getRe_gas_tot_commit() {return re_gas_tot_commit;}
	public Vector getRE_GAS_BALANCEMMBTU() {return RE_GAS_BALANCEMMBTU;}
	public Vector getRE_GAS_BOOKMMBTU() {return RE_GAS_BOOKMMBTU;}
	public Vector getRE_GAS_CARGO_ARRIVAL_DATE() {return RE_GAS_CARGO_ARRIVAL_DATE;}
	public Vector getRE_GAS_CUSTOMER_CD() {return RE_GAS_CUSTOMER_CD;}
	public Vector getRE_GAS_CUSTOMER_NM() {return RE_GAS_CUSTOMER_NM;}
	public Vector getRE_GAS_NO() {return RE_GAS_NO;}
	public Vector getRE_GAS_SEQ_NO() {return RE_GAS_SEQ_NO;}
	public Vector getRE_GAS_SUPPLIEDMBTU() {return RE_GAS_SUPPLIEDMBTU;}
	
	Vector VUnBilledReceivable_RG = new Vector();
	public Vector getVUnBilledReceivable_RG() {
		return VUnBilledReceivable_RG;
	}
	public String getBal_tot_comitment() {
		return bal_tot_comitment;
	}


	public String getSup_tot_comitment() {
		return sup_tot_comitment;
	}


	public String getLoa_bal_tot_comitment() {
		return loa_bal_tot_comitment;
	}


	public String getLoa_sup_tot_comitment() {
		return loa_sup_tot_comitment;
	}


	public String getRe_gas_bal_tot_comitment() {
		return re_gas_bal_tot_comitment;
	}


	public String getRe_gas_sup_tot_comitment() {
		return re_gas_sup_tot_comitment;
	}


	public Vector getLOA_REF_NO() {
		return LOA_REF_NO;
	}


	public Vector getSN_REF_NO() {
		return SN_REF_NO;
	}


	public Vector getSN_CLOSURE_CLOSE() {
		return SN_CLOSURE_CLOSE;
	}


	public Vector getSN_CLOSURE_DT() {
		return SN_CLOSURE_DT;
	}


	public Vector getTCQ_REQUEST_QTY() {
		return TCQ_REQUEST_QTY;
	}


	public Vector getLOA_TCQ_REQUEST_QTY() {
		return LOA_TCQ_REQUEST_QTY;
	}


	public Vector getACTUAL_TCQ() {
		return ACTUAL_TCQ;
	}


	public Vector getLOA_ACTUAL_TCQ() {
		return LOA_ACTUAL_TCQ;
	}


	public Vector getSN_CLOSURE_QTY() {
		return SN_CLOSURE_QTY;
	}


	public Vector getTCQ_REQUEST_SIGN() {
		return TCQ_REQUEST_SIGN;
	}


	public Vector getLOA_TCQ_REQUEST_SIGN() {
		return LOA_TCQ_REQUEST_SIGN;
	}

	public Vector getRATE() {
		return RATE;
	}

	public Vector getSIGNING_DT() {
		return SIGNING_DT;
	}

	public Vector getLOA_SIGNING_DT() {
		return LOA_SIGNING_DT;
	}

	public Vector getLOA_RATE() {
		return LOA_RATE;
	}

	public Vector getREGAS_RATE() {
		return REGAS_RATE;
	}

	public Vector getREGAS_SIGNING_DT() {
		return REGAS_SIGNING_DT;
	}


	public Vector getBOOKMMSCM() {
		return BOOKMMSCM;
	}


	public Vector getSUPPLIEDMMSCM() {
		return SUPPLIEDMMSCM;
	}


	public Vector getBALANCEMMSCM() {
		return BALANCEMMSCM;
	}


	public String getBal_tot_comitment_mmscm() {
		return bal_tot_comitment_mmscm;
	}


	public String getSup_tot_comitment_mmscm() {
		return sup_tot_comitment_mmscm;
	}


	public String getTot_commitment_mmscm() {
		return tot_commitment_mmscm;
	}


	public String getLoa_bal_tot_comitment_mmscm() {
		return loa_bal_tot_comitment_mmscm;
	}


	public Vector getLOA_BALANCEMMSCM() {
		return LOA_BALANCEMMSCM;
	}


	public Vector getLOA_BOOKMMSCM() {
		return LOA_BOOKMMSCM;
	}


	public String getLoa_sup_tot_comitment_mmscm() {
		return loa_sup_tot_comitment_mmscm;
	}


	public Vector getLOA_SUPPLIEDMMSCM() {
		return LOA_SUPPLIEDMMSCM;
	}


	public String getLoa_tot_commitment_mmscm() {
		return loa_tot_commitment_mmscm;
	}


	public Vector getRE_GAS_BALANCEMMSCM() {
		return RE_GAS_BALANCEMMSCM;
	}


	public Vector getRE_GAS_BOOKMMSCM() {
		return RE_GAS_BOOKMMSCM;
	}


	public Vector getRE_GAS_SUPPLIEDMMSCM() {
		return RE_GAS_SUPPLIEDMMSCM;
	}


	public String getRe_gas_tot_commit_mmscm() {
		return re_gas_tot_commit_mmscm;
	}


	public String getRe_gas_sup_tot_comitment_mmscm() {
		return re_gas_sup_tot_comitment_mmscm;
	}


	public String getRe_gas_bal_tot_comitment_mmscm() {
		return re_gas_bal_tot_comitment_mmscm;
	}
	public Vector getCUSTOMER_ABR_FGSA() {
		return CUSTOMER_ABR_FGSA;
	}
	public Vector getCUSTOMER_CD_FGSA() {
		return CUSTOMER_CD_FGSA;
	}
	public Vector getEMP_ABR_FGSA() {
		return EMP_ABR_FGSA;
	}
	public Vector getEMP_CD_FGSA() {
		return EMP_CD_FGSA;
	}
	public Vector getEND_DT_FGSA() {
		return END_DT_FGSA;
	}
	public Vector getRENEWAL_DT_FGSA() {
		return RENEWAL_DT_FGSA;
	}
	public Vector getSIGNING_DT_FGSA() {
		return SIGNING_DT_FGSA;
	}
	public Vector getSTART_DT_FGSA() {
		return START_DT_FGSA;
	}
	public Vector getFGSA_NO_NEW() {
		return FGSA_NO_NEW;
	}
	public Vector getREV_NO_FGSA() {
		return REV_NO_FGSA;
	}
	public void setREV_NO_FGSA(Vector rev_no_fgsa) {
		REV_NO_FGSA = rev_no_fgsa;
	}
	public Vector getREV_DT_FGSA() {
		return REV_DT_FGSA;
	}

	public Vector getCUST_CD() {
		return CUST_CD;
	}

	public Vector getCUST_NM() {
		return CUST_NM;
	}

	public String getCust_nm() {
		return cust_nm;
	}

	public void setCust_nm(String cust_nm) {
		this.cust_nm = cust_nm;
	}

	public Vector getDELV_POINT() {
		return DELV_POINT;
	}


	public Vector getCUSTOMER_ABBR() {
		return CUSTOMER_ABBR;
	}


	public Vector getLOA_CUSTOMER_ABBR() {
		return LOA_CUSTOMER_ABBR;
	}


	public Vector getRE_GAS_CUSTOMER_ABBR() {
		return RE_GAS_CUSTOMER_ABBR;
	}


	public Vector getCUSTOMER_CD_SN_P() {
		return CUSTOMER_CD_SN_P;
	}


	public Vector getCUSTOMER_ABR_SN_P() {
		return CUSTOMER_ABR_SN_P;
	}


	public Vector getSN_NO_P() {
		return SN_NO_P;
	}


	public Vector getSN_REV_NO_P() {
		return SN_REV_NO_P;
	}


	public Vector getFGSA_NO_P() {
		return FGSA_NO_P;
	}


	public Vector getFGSA_REV_NO_P() {
		return FGSA_REV_NO_P;
	}


	public Vector getSTART_DT_SN_P() {
		return START_DT_SN_P;
	}


	public Vector getEND_DT_SN_P() {
		return END_DT_SN_P;
	}


	public Vector getRATE_SN_P() {
		return RATE_SN_P;
	}

	public Vector getCARGO_MARGIN_SN_P() {
		return CARGO_MARGIN_SN_P;
	}


	public Vector getCARGO_REF_NO_SN_P() {
		return CARGO_REF_NO_SN_P;
	}


	public Vector getCARGO_CONF_PRICE_DT_SN_P() {
		return CARGO_CONF_PRICE_DT_SN_P;
	}


	public Vector getCARGO_CUSTOM_DUTY_SN_P() {
		return CARGO_CUSTOM_DUTY_SN_P;
	}


	public ResultSet getRset_tmpl() {
		return rset_tmpl;
	}


	public Vector getCOLOR_FLAG_CONF_PRICE_SN_P() {
		return COLOR_FLAG_CONF_PRICE_SN_P;
	}


	public Vector getCOLOR_FLAG_CUSTOM_SN_P() {
		return COLOR_FLAG_CUSTOM_SN_P;
	}


	public Vector getCOLOR_FLAG_MARGIN_SN_P() {
		return COLOR_FLAG_MARGIN_SN_P;
	}


	public Vector getCOLOR_FLAG_RATE_SN_P() {
		return COLOR_FLAG_RATE_SN_P;
	}
	public Vector getVgas_date() {
		return Vgas_date;
	}
	public Vector[] getSUPPLIEDMBTU1() {
		return SUPPLIEDMBTU1;
	}
	public Vector[] getSUPPLIEDMMSCM1() {
		return SUPPLIEDMMSCM1;
	}
	public Vector[] getRE_GAS_SUPPLIEDMBTU1() {
		return RE_GAS_SUPPLIEDMBTU1;
	}
	public Vector[] getRE_GAS_SUPPLIEDMMSCM1() {
		return RE_GAS_SUPPLIEDMMSCM1;
	}
	public Vector[] getLOA_SUPPLIEDMBTU1() {
		return LOA_SUPPLIEDMBTU1;
	}
	public Vector[] getLOA_SUPPLIEDMMSCM1() {
		return LOA_SUPPLIEDMMSCM1;
	}
	public Vector getRegas_cargo_ref_no() {
		return Regas_cargo_ref_no;
	}
	public void setBuyer_cd(String buyer_cd) {
		Buyer_cd = buyer_cd;
	}
	public void setRe_gas_no(String re_gas_no) {
		this.re_gas_no = re_gas_no;
	}
	public void setNo_of_cargo(String no_of_cargo) {
		this.no_of_cargo = no_of_cargo;
	}
	public void setFrm_dt(String frm_dt) {
		this.frm_dt = frm_dt;
	}
	public void setTo_dt(String to_dt) {
		this.to_dt = to_dt;
	}
	public void setRe_gas_rev_no(String re_gas_rev_no) {
		this.re_gas_rev_no = re_gas_rev_no;
	}
	public Vector getEDQ_FROM_DT() {
		return EDQ_FROM_DT;
	}
	public Vector getEDQ_TO_DT() {
		return EDQ_TO_DT;
	}
	public Vector getACTUAL_RECPT_DT() {
		return ACTUAL_RECPT_DT;
	}
	public Vector getCONTRACT_START_DT() {
		return CONTRACT_START_DT;
	}
	public Vector getCONTRACT_END_DT() {
		return CONTRACT_END_DT;
	}
	public Vector getADQ_QTY() {
		return ADQ_QTY;
	}
	public Vector getSYS_USE_GAS() {
		return SYS_USE_GAS;
	}
	public Vector getQTY_TO_BE_SUPPLY() {
		return QTY_TO_BE_SUPPLY;
	}
	public Vector getDCQ_QTY() {
		return DCQ_QTY;
	}
	public Vector getQTY_UNIT_CD() {
		return QTY_UNIT_CD;
	}
	public Vector getQTY_UNIT_ABR() {
		return QTY_UNIT_ABR;
	}
	public Vector getBOE_QTY() {
		return BOE_QTY;
	}
	public Vector getSUPP_CD() {
		return SUPP_CD;
	}
	public Vector getSUPP_NM() {
		return SUPP_NM;
	}
	public Vector getBOE_NO() {
		return BOE_NO;
	}
	public Vector getBOE_DT() {
		return BOE_DT;
	}
	public Vector getCARGO_REF_NO() {
		return CARGO_REF_NO;
	}
	public Vector getSUPP_SEQ_NO() {
		return SUPP_SEQ_NO;
	}
	public Vector getSUPP_CONTACT_PERSON() {
		return SUPP_CONTACT_PERSON;
	}
	public Vector getSUPP_CONTACT_PERSON_DESG() {
		return SUPP_CONTACT_PERSON_DESG;
	}
	public String getSetcargo_ref_no() {
		return setcargo_ref_no;
	}
	public void setSetcargo_ref_no(String setcargo_ref_no) {
		this.setcargo_ref_no = setcargo_ref_no;
	}
	public Vector getCust_plant_cd() {
		return cust_plant_cd;
	}
	public Vector getCust_plant_nm() {
		return cust_plant_nm;
	}
	public Vector getVdatewise_plant_tot() {
		return Vdatewise_plant_tot;
	}
	public String getContact_Customer_Person_Address() {
		return contact_Customer_Person_Address;
	}
	public String getContact_Customer_Person_City() {
		return contact_Customer_Person_City;
	}
	public String getContact_Customer_Person_Country() {
		return contact_Customer_Person_Country;
	}
	public String getContact_Customer_Person_Fax() {
		return contact_Customer_Person_Fax;
	}
	public String getContact_Customer_Person_Phone() {
		return contact_Customer_Person_Phone;
	}
	public String getContact_Customer_Person_Pin() {
		return contact_Customer_Person_Pin;
	}
	public String getContact_Customer_Person_State() {
		return contact_Customer_Person_State;
	}
	public void setSign_dt(String sign_dt) {
		Sign_dt = sign_dt;
	}
	public String getSign_dt() {
		return Sign_dt;
	}
	public Vector getQQ_DT() {
		return QQ_DT;
	}
	public Vector getQQ_NO() {
		return QQ_NO;
	}
	public String getSuppl_abbr() {
		return Suppl_abbr;
	}
	public String getSuppl_Name() {
		return Suppl_Name;
	}
	public Vector getVplant_inv_no() {
		return Vplant_inv_no;
	}

	public String getBoe_no_dated() {
		return boe_no_dated;
	}

	public void setBoe_no_dated(String boe_no_dated) {
		this.boe_no_dated = boe_no_dated;
	}

	public String getDear_sir() {
		return dear_sir;
	}

	public void setDear_sir(String dear_sir) {
		this.dear_sir = dear_sir;
	}

	public String getFaithful() {
		return faithful;
	}

	public void setFaithful(String faithful) {
		this.faithful = faithful;
	}

	public String getHlpl() {
		return hlpl;
	}

	public void setHlpl(String hlpl) {
		this.hlpl = hlpl;
	}

	public String getKind_attn() {
		return kind_attn;
	}

	public void setKind_attn(String kind_attn) {
		this.kind_attn = kind_attn;
	}

	public String getLess() {
		return less;
	}

	public void setLess(String less) {
		this.less = less;
	}

	public String getLng_unloaded() {
		return lng_unloaded;
	}

	public void setLng_unloaded(String lng_unloaded) {
		this.lng_unloaded = lng_unloaded;
	}

	public String[] getPara() {
		return para;
	}

	public void setPara(String[] para) {
		this.para = para;
	}

	public String getQuantity_quality_ref_no() {
		return quantity_quality_ref_no;
	}

	public void setQuantity_quality_ref_no(String quantity_quality_ref_no) {
		this.quantity_quality_ref_no = quantity_quality_ref_no;
	}

	public String getStorage_end_dt() {
		return storage_end_dt;
	}

	public void setStorage_end_dt(String storage_end_dt) {
		this.storage_end_dt = storage_end_dt;
	}

	public String getStorage_st_dt() {
		return storage_st_dt;
	}

	public void setStorage_st_dt(String storage_st_dt) {
		this.storage_st_dt = storage_st_dt;
	}

	public String getSubject() {
		return subject;
	}

	public void setSubject(String subject) {
		this.subject = subject;
	}

	public String getSug_unloaded() {
		return sug_unloaded;
	}

	public void setSug_unloaded(String sug_unloaded) {
		this.sug_unloaded = sug_unloaded;
	}

	public String getTbl_statmnt() {
		return tbl_statmnt;
	}

	public void setTbl_statmnt(String tbl_statmnt) {
		this.tbl_statmnt = tbl_statmnt;
	}

	public String getThanks() {
		return thanks;
	}

	public void setThanks(String thanks) {
		this.thanks = thanks;
	}

	public String[] getTotal_lng() {
		return total_lng;
	}

	public void setTotal_lng(String[] total_lng) {
		this.total_lng = total_lng;
	}

	public String getVessel_arrival_dt() {
		return vessel_arrival_dt;
	}

	public void setVessel_arrival_dt(String vessel_arrival_dt) {
		this.vessel_arrival_dt = vessel_arrival_dt;
	}

	public String getVessel_name() {
		return vessel_name;
	}

	public void setVessel_name(String vessel_name) {
		this.vessel_name = vessel_name;
	}

	public Vector getBOE_DT_1() {
		return BOE_DT_1;
	}

	public void setBOE_DT_1(Vector boe_dt_1) {
		BOE_DT_1 = boe_dt_1;
	}

	public Vector getLTCORA_BALANCEMMBTU() {
		return LTCORA_BALANCEMMBTU;
	}

	public void setLTCORA_BALANCEMMBTU(Vector ltcora_balancemmbtu) {
		LTCORA_BALANCEMMBTU = ltcora_balancemmbtu;
	}

	public Vector getLTCORA_BALANCEMMSCM() {
		return LTCORA_BALANCEMMSCM;
	}

	public void setLTCORA_BALANCEMMSCM(Vector ltcora_balancemmscm) {
		LTCORA_BALANCEMMSCM = ltcora_balancemmscm;
	}

	public Vector getLTCORA_BOOKMMBTU() {
		return LTCORA_BOOKMMBTU;
	}

	public void setLTCORA_BOOKMMBTU(Vector ltcora_bookmmbtu) {
		LTCORA_BOOKMMBTU = ltcora_bookmmbtu;
	}

	public Vector getLTCORA_BOOKMMSCM() {
		return LTCORA_BOOKMMSCM;
	}

	public void setLTCORA_BOOKMMSCM(Vector ltcora_bookmmscm) {
		LTCORA_BOOKMMSCM = ltcora_bookmmscm;
	}

	public Vector getLTCORA_CARGO_ARRIVAL_DATE() {
		return LTCORA_CARGO_ARRIVAL_DATE;
	}

	public void setLTCORA_CARGO_ARRIVAL_DATE(Vector ltcora_cargo_arrival_date) {
		LTCORA_CARGO_ARRIVAL_DATE = ltcora_cargo_arrival_date;
	}

	public Vector getLTCORA_cargo_ref_no() {
		return LTCORA_cargo_ref_no;
	}

	public void setLTCORA_cargo_ref_no(Vector ltcora_cargo_ref_no) {
		LTCORA_cargo_ref_no = ltcora_cargo_ref_no;
	}

	public Vector getLTCORA_CUSTOMER_ABBR() {
		return LTCORA_CUSTOMER_ABBR;
	}

	public void setLTCORA_CUSTOMER_ABBR(Vector ltcora_customer_abbr) {
		LTCORA_CUSTOMER_ABBR = ltcora_customer_abbr;
	}

	public Vector getLTCORA_CUSTOMER_CD() {
		return LTCORA_CUSTOMER_CD;
	}

	public void setLTCORA_CUSTOMER_CD(Vector ltcora_customer_cd) {
		LTCORA_CUSTOMER_CD = ltcora_customer_cd;
	}

	public Vector getLTCORA_CUSTOMER_NM() {
		return LTCORA_CUSTOMER_NM;
	}

	public void setLTCORA_CUSTOMER_NM(Vector ltcora_customer_nm) {
		LTCORA_CUSTOMER_NM = ltcora_customer_nm;
	}

	public Vector getLTCORA_NO() {
		return LTCORA_NO;
	}

	public void setLTCORA_NO(Vector ltcora_no) {
		LTCORA_NO = ltcora_no;
	}

	public Vector getLTCORA_RATE() {
		return LTCORA_RATE;
	}

	public void setLTCORA_RATE(Vector ltcora_rate) {
		LTCORA_RATE = ltcora_rate;
	}

	public Vector getLTCORA_SEQ_NO() {
		return LTCORA_SEQ_NO;
	}

	public void setLTCORA_SEQ_NO(Vector ltcora_seq_no) {
		LTCORA_SEQ_NO = ltcora_seq_no;
	}

	public Vector getLTCORA_SIGNING_DT() {
		return LTCORA_SIGNING_DT;
	}

	public void setLTCORA_SIGNING_DT(Vector ltcora_signing_dt) {
		LTCORA_SIGNING_DT = ltcora_signing_dt;
	}

	public Vector getLTCORA_SUPPLIEDMBTU() {
		return LTCORA_SUPPLIEDMBTU;
	}

	public void setLTCORA_SUPPLIEDMBTU(Vector ltcora_suppliedmbtu) {
		LTCORA_SUPPLIEDMBTU = ltcora_suppliedmbtu;
	}

	public Vector[] getLTCORA_SUPPLIEDMBTU1() {
		return LTCORA_SUPPLIEDMBTU1;
	}

	public void setLTCORA_SUPPLIEDMBTU1(Vector[] ltcora_suppliedmbtu1) {
		LTCORA_SUPPLIEDMBTU1 = ltcora_suppliedmbtu1;
	}

	public Vector getLTCORA_SUPPLIEDMMSCM() {
		return LTCORA_SUPPLIEDMMSCM;
	}

	public void setLTCORA_SUPPLIEDMMSCM(Vector ltcora_suppliedmmscm) {
		LTCORA_SUPPLIEDMMSCM = ltcora_suppliedmmscm;
	}

	public Vector[] getLTCORA_SUPPLIEDMMSCM1() {
		return LTCORA_SUPPLIEDMMSCM1;
	}

	public void setLTCORA_SUPPLIEDMMSCM1(Vector[] ltcora_suppliedmmscm1) {
		LTCORA_SUPPLIEDMMSCM1 = ltcora_suppliedmmscm1;
	}

	public String getLTCORA_bal_tot_comitment() {
		return LTCORA_bal_tot_comitment;
	}

	public void setLTCORA_bal_tot_comitment(String ltcora_bal_tot_comitment) {
		LTCORA_bal_tot_comitment = ltcora_bal_tot_comitment;
	}

	public String getLTCORA_bal_tot_comitment_mmscm() {
		return LTCORA_bal_tot_comitment_mmscm;
	}

	public void setLTCORA_bal_tot_comitment_mmscm(
			String ltcora_bal_tot_comitment_mmscm) {
		LTCORA_bal_tot_comitment_mmscm = ltcora_bal_tot_comitment_mmscm;
	}

	public String getLTCORA_sup_tot_comitment() {
		return LTCORA_sup_tot_comitment;
	}

	public void setLTCORA_sup_tot_comitment(String ltcora_sup_tot_comitment) {
		LTCORA_sup_tot_comitment = ltcora_sup_tot_comitment;
	}

	public String getLTCORA_sup_tot_comitment_mmscm() {
		return LTCORA_sup_tot_comitment_mmscm;
	}

	public void setLTCORA_sup_tot_comitment_mmscm(
			String ltcora_sup_tot_comitment_mmscm) {
		LTCORA_sup_tot_comitment_mmscm = ltcora_sup_tot_comitment_mmscm;
	}

	public String getLTCORA_tot_commit() {
		return LTCORA_tot_commit;
	}

	public void setLTCORA_tot_commit(String ltcora_tot_commit) {
		LTCORA_tot_commit = ltcora_tot_commit;
	}

	public String getLTCORA_tot_commit_mmscm() {
		return LTCORA_tot_commit_mmscm;
	}

	public void setLTCORA_tot_commit_mmscm(String ltcora_tot_commit_mmscm) {
		LTCORA_tot_commit_mmscm = ltcora_tot_commit_mmscm;
	}

	public Vector getCN_BALANCEMMBTU() {
		return CN_BALANCEMMBTU;
	}

	public void setCN_BALANCEMMBTU(Vector cn_balancemmbtu) {
		CN_BALANCEMMBTU = cn_balancemmbtu;
	}

	public Vector getCN_BALANCEMMSCM() {
		return CN_BALANCEMMSCM;
	}

	public void setCN_BALANCEMMSCM(Vector cn_balancemmscm) {
		CN_BALANCEMMSCM = cn_balancemmscm;
	}

	public Vector getCN_BOOKMMBTU() {
		return CN_BOOKMMBTU;
	}

	public void setCN_BOOKMMBTU(Vector cn_bookmmbtu) {
		CN_BOOKMMBTU = cn_bookmmbtu;
	}

	public Vector getCN_BOOKMMSCM() {
		return CN_BOOKMMSCM;
	}

	public void setCN_BOOKMMSCM(Vector cn_bookmmscm) {
		CN_BOOKMMSCM = cn_bookmmscm;
	}

	public Vector getCN_CARGO_ARRIVAL_DATE() {
		return CN_CARGO_ARRIVAL_DATE;
	}

	public void setCN_CARGO_ARRIVAL_DATE(Vector cn_cargo_arrival_date) {
		CN_CARGO_ARRIVAL_DATE = cn_cargo_arrival_date;
	}

	public Vector getCN_cargo_ref_no() {
		return CN_cargo_ref_no;
	}

	public void setCN_cargo_ref_no(Vector cn_cargo_ref_no) {
		CN_cargo_ref_no = cn_cargo_ref_no;
	}

	public Vector getCN_CUSTOMER_ABBR() {
		return CN_CUSTOMER_ABBR;
	}

	public void setCN_CUSTOMER_ABBR(Vector cn_customer_abbr) {
		CN_CUSTOMER_ABBR = cn_customer_abbr;
	}

	public Vector getCN_CUSTOMER_CD() {
		return CN_CUSTOMER_CD;
	}

	public void setCN_CUSTOMER_CD(Vector cn_customer_cd) {
		CN_CUSTOMER_CD = cn_customer_cd;
	}

	public Vector getCN_CUSTOMER_NM() {
		return CN_CUSTOMER_NM;
	}

	public void setCN_CUSTOMER_NM(Vector cn_customer_nm) {
		CN_CUSTOMER_NM = cn_customer_nm;
	}

	public Vector getCN_NO() {
		return CN_NO;
	}

	public void setCN_NO(Vector cn_no) {
		CN_NO = cn_no;
	}

	public Vector getCN_RATE() {
		return CN_RATE;
	}

	public void setCN_RATE(Vector cn_rate) {
		CN_RATE = cn_rate;
	}

	public Vector getCN_SEQ_NO() {
		return CN_SEQ_NO;
	}

	public void setCN_SEQ_NO(Vector cn_seq_no) {
		CN_SEQ_NO = cn_seq_no;
	}

	public Vector getCN_SIGNING_DT() {
		return CN_SIGNING_DT;
	}

	public void setCN_SIGNING_DT(Vector cn_signing_dt) {
		CN_SIGNING_DT = cn_signing_dt;
	}

	public Vector getCN_SUPPLIEDMBTU() {
		return CN_SUPPLIEDMBTU;
	}

	public void setCN_SUPPLIEDMBTU(Vector cn_suppliedmbtu) {
		CN_SUPPLIEDMBTU = cn_suppliedmbtu;
	}

	public Vector[] getCN_SUPPLIEDMBTU1() {
		return CN_SUPPLIEDMBTU1;
	}

	public void setCN_SUPPLIEDMBTU1(Vector[] cn_suppliedmbtu1) {
		CN_SUPPLIEDMBTU1 = cn_suppliedmbtu1;
	}

	public Vector getCN_SUPPLIEDMMSCM() {
		return CN_SUPPLIEDMMSCM;
	}

	public void setCN_SUPPLIEDMMSCM(Vector cn_suppliedmmscm) {
		CN_SUPPLIEDMMSCM = cn_suppliedmmscm;
	}

	public Vector[] getCN_SUPPLIEDMMSCM1() {
		return CN_SUPPLIEDMMSCM1;
	}

	public void setCN_SUPPLIEDMMSCM1(Vector[] cn_suppliedmmscm1) {
		CN_SUPPLIEDMMSCM1 = cn_suppliedmmscm1;
	}

	public String getCN_bal_tot_comitment() {
		return CN_bal_tot_comitment;
	}

	public void setCN_bal_tot_comitment(String cn_bal_tot_comitment) {
		CN_bal_tot_comitment = cn_bal_tot_comitment;
	}

	public String getCN_bal_tot_comitment_mmscm() {
		return CN_bal_tot_comitment_mmscm;
	}

	public void setCN_bal_tot_comitment_mmscm(String cn_bal_tot_comitment_mmscm) {
		CN_bal_tot_comitment_mmscm = cn_bal_tot_comitment_mmscm;
	}

	public String getCN_sup_tot_comitment() {
		return CN_sup_tot_comitment;
	}

	public void setCN_sup_tot_comitment(String cn_sup_tot_comitment) {
		CN_sup_tot_comitment = cn_sup_tot_comitment;
	}

	public String getCN_sup_tot_comitment_mmscm() {
		return CN_sup_tot_comitment_mmscm;
	}

	public void setCN_sup_tot_comitment_mmscm(String cn_sup_tot_comitment_mmscm) {
		CN_sup_tot_comitment_mmscm = cn_sup_tot_comitment_mmscm;
	}

	public String getCN_tot_commit() {
		return CN_tot_commit;
	}

	public void setCN_tot_commit(String cn_tot_commit) {
		CN_tot_commit = cn_tot_commit;
	}

	public String getCN_tot_commit_mmscm() {
		return CN_tot_commit_mmscm;
	}

	public void setCN_tot_commit_mmscm(String cn_tot_commit_mmscm) {
		CN_tot_commit_mmscm = cn_tot_commit_mmscm;
	}

	public String getEmp_cd() {
		return Emp_cd;
	}

	public void setEmp_cd(String emp_cd) {
		Emp_cd = emp_cd;
	}

	public String getCustomer_access_flag() {
		return Customer_access_flag;
	}

	public void setCustomer_access_flag(String customer_access_flag) {
		Customer_access_flag = customer_access_flag;
	}

	public Vector getDeal_NO() {
		return Deal_NO;
	}

	public void setDeal_NO(Vector deal_NO) {
		Deal_NO = deal_NO;
	}

	public Vector getDeal_Signing_dt() {
		return Deal_Signing_dt;
	}

	public void setDeal_Signing_dt(Vector deal_Signing_dt) {
		Deal_Signing_dt = deal_Signing_dt;
	}

	public Vector getDeal_cust_nm() {
		return Deal_cust_nm;
	}

	public void setDeal_cust_nm(Vector deal_cust_nm) {
		Deal_cust_nm = deal_cust_nm;
	}

	public Vector getDeal_cust_cd() {
		return Deal_cust_cd;
	}

	public void setDeal_cust_cd(Vector deal_cust_cd) {
		Deal_cust_cd = deal_cust_cd;
	}

	public Vector getDeal_cust_abbr() {
		return Deal_cust_abbr;
	}

	public void setDeal_cust_abbr(Vector deal_cust_abbr) {
		Deal_cust_abbr = deal_cust_abbr;
	}

	public Vector getDeal_typ() {
		return Deal_typ;
	}

	public void setDeal_typ(Vector deal_typ) {
		Deal_typ = deal_typ;
	}

	public Vector getDeal_cargo_seq_no() {
		return Deal_cargo_seq_no;
	}

	public void setDeal_cargo_seq_no(Vector deal_cargo_seq_no) {
		Deal_cargo_seq_no = deal_cargo_seq_no;
	}

	public Vector getDeal_ENT_DT() {
		return Deal_ENT_DT;
	}

	public void setDeal_ENT_DT(Vector deal_ENT_DT) {
		Deal_ENT_DT = deal_ENT_DT;
	}

	public Vector getDeal_ENT_BY() {
		return Deal_ENT_BY;
	}

	public void setDeal_ENT_BY(Vector deal_ENT_BY) {
		Deal_ENT_BY = deal_ENT_BY;
	}

	public Vector getDeal_Price() {
		return Deal_Price;
	}

	public void setDeal_Price(Vector deal_Price) {
		Deal_Price = deal_Price;
	}

	public Vector getDeal_ST_DT() {
		return Deal_ST_DT;
	}

	public void setDeal_ST_DT(Vector deal_ST_DT) {
		Deal_ST_DT = deal_ST_DT;
	}

	public Vector getDeal_END_DT() {
		return Deal_END_DT;
	}

	public void setDeal_END_DT(Vector deal_END_DT) {
		Deal_END_DT = deal_END_DT;
	}

	public Vector getDeal_qty_booked() {
		return Deal_qty_booked;
	}

	public void setDeal_qty_booked(Vector deal_qty_booked) {
		Deal_qty_booked = deal_qty_booked;
	}

	public Vector getDeal_DCQ() {
		return Deal_DCQ;
	}

	public void setDeal_DCQ(Vector deal_DCQ) {
		Deal_DCQ = deal_DCQ;
	}

	public Vector getDeal_qty_Supplied() {
		return Deal_qty_Supplied;
	}

	public void setDeal_qty_Supplied(Vector deal_qty_Supplied) {
		Deal_qty_Supplied = deal_qty_Supplied;
	}

	public Vector getDeal_sts() {
		return Deal_sts;
	}

	public void setDeal_sts(Vector deal_sts) {
		Deal_sts = deal_sts;
	}

	public Vector getDeal_duration() {
		return Deal_duration;
	}

	public void setDeal_duration(Vector deal_duration) {
		Deal_duration = deal_duration;
	}

	public Vector getDeal_amt_wout_tax() {
		return Deal_amt_wout_tax;
	}

	public void setDeal_amt_wout_tax(Vector deal_amt_wout_tax) {
		Deal_amt_wout_tax = deal_amt_wout_tax;
	}

	public Vector getDeal_amt_PAY_NOT_RECV() {
		return Deal_amt_PAY_NOT_RECV;
	}

	public void setDeal_amt_PAY_NOT_RECV(Vector deal_amt_PAY_NOT_RECV) {
		Deal_amt_PAY_NOT_RECV = deal_amt_PAY_NOT_RECV;
	}

	public Vector getDeal_adv_amt() {
		return Deal_adv_amt;
	}

	public void setDeal_adv_amt(Vector deal_adv_amt) {
		Deal_adv_amt = deal_adv_amt;
	}

	public Vector getDeal_cont_no() {
		return Deal_cont_no;
	}

	public void setDeal_cont_no(Vector deal_cont_no) {
		Deal_cont_no = deal_cont_no;
	}

	public Vector getDeal_typ_nm() {
		return Deal_typ_nm;
	}

	public void setDeal_typ_nm(Vector deal_typ_nm) {
		Deal_typ_nm = deal_typ_nm;
	}

	public Vector getDeal_curr() {
		return Deal_curr;
	}

	public void setDeal_curr(Vector deal_curr) {
		Deal_curr = deal_curr;
	}

	public Vector getLtcora_agr_no() {
		return ltcora_agr_no;
	}

	public void setLtcora_agr_no(Vector ltcora_agr_no) {
		this.ltcora_agr_no = ltcora_agr_no;
	}

	public Vector getCn_agr_no() {
		return cn_agr_no;
	}

	public void setCn_agr_no(Vector cn_agr_no) {
		this.cn_agr_no = cn_agr_no;
	}

	public Vector getSn_ent_by() {
		return sn_ent_by;
	}

	public void setSn_ent_by(Vector sn_ent_by) {
		this.sn_ent_by = sn_ent_by;
	}

	public Vector getSn_ent_dt() {
		return sn_ent_dt;
	}

	public void setSn_ent_dt(Vector sn_ent_dt) {
		this.sn_ent_dt = sn_ent_dt;
	}

	public Vector getLoa_ent_by() {
		return loa_ent_by;
	}

	public void setLoa_ent_by(Vector loa_ent_by) {
		this.loa_ent_by = loa_ent_by;
	}

	public Vector getLoa_ent_dt() {
		return loa_ent_dt;
	}

	public void setLoa_ent_dt(Vector loa_ent_dt) {
		this.loa_ent_dt = loa_ent_dt;
	}

	public Vector getLtcora_ent_by() {
		return ltcora_ent_by;
	}

	public void setLtcora_ent_by(Vector ltcora_ent_by) {
		this.ltcora_ent_by = ltcora_ent_by;
	}

	public Vector getLtcora_ent_dt() {
		return ltcora_ent_dt;
	}

	public void setLtcora_ent_dt(Vector ltcora_ent_dt) {
		this.ltcora_ent_dt = ltcora_ent_dt;
	}

	public Vector getCn_ent_by() {
		return cn_ent_by;
	}

	public void setCn_ent_by(Vector cn_ent_by) {
		this.cn_ent_by = cn_ent_by;
	}

	public Vector getCn_ent_dt() {
		return cn_ent_dt;
	}

	public void setCn_ent_dt(Vector cn_ent_dt) {
		this.cn_ent_dt = cn_ent_dt;
	}

	public Vector getSn_apr_by() {
		return sn_apr_by;
	}

	public void setSn_apr_by(Vector sn_apr_by) {
		this.sn_apr_by = sn_apr_by;
	}

	public Vector getSn_apr_dt() {
		return sn_apr_dt;
	}

	public void setSn_apr_dt(Vector sn_apr_dt) {
		this.sn_apr_dt = sn_apr_dt;
	}

	public Vector getLoa_apr_by() {
		return loa_apr_by;
	}

	public void setLoa_apr_by(Vector loa_apr_by) {
		this.loa_apr_by = loa_apr_by;
	}

	public Vector getLoa_apr_dt() {
		return loa_apr_dt;
	}

	public void setLoa_apr_dt(Vector loa_apr_dt) {
		this.loa_apr_dt = loa_apr_dt;
	}

	public Vector getLtcora_apr_by() {
		return ltcora_apr_by;
	}

	public void setLtcora_apr_by(Vector ltcora_apr_by) {
		this.ltcora_apr_by = ltcora_apr_by;
	}

	public Vector getLtcora_apr_dt() {
		return ltcora_apr_dt;
	}

	public void setLtcora_apr_dt(Vector ltcora_apr_dt) {
		this.ltcora_apr_dt = ltcora_apr_dt;
	}

	public Vector getCn_apr_by() {
		return cn_apr_by;
	}

	public void setCn_apr_by(Vector cn_apr_by) {
		this.cn_apr_by = cn_apr_by;
	}

	public Vector getCn_apr_dt() {
		return cn_apr_dt;
	}

	public void setCn_apr_dt(Vector cn_apr_dt) {
		this.cn_apr_dt = cn_apr_dt;
	}

//////////////////////SB20200927: For CR Security New //////////////////////
	public void fetch_LC_SEQ_NO_List()
	{
	try
	{		
		String Trans_Cd="";
	queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Buyer_cd+"' and " +
		   "eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Buyer_cd+"') order by CUSTOMER_CD";
	rset1 = stmt1.executeQuery(queryString1);
	if(rset1.next())
	{
	CUSTOMER_CD.add(Buyer_cd);
	CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
//		buyer_Credit_Rate.add(rset1.getString(2)==null?"":rset1.getString(2));
	}
	String MappId="";
	String FlagSecurity=""; String SecurityType=""; String AprvDt="";

	queryString = "SELECT A.FINANCIAL_YEAR, A.LC_SEQ_NO, A.CUSTOMER_CD, " +
		  "CREDIT_RATING, TO_CHAR(RATING_EFF_DATE,'DD/MM/YYYY'), TO_CHAR(LC_REF_DATE,'DD/MM/YYYY'), " +
		  "TO_CHAR(A.START_DATE,'DD/MM/YYYY'), TO_CHAR(A.END_DATE,'DD/MM/YYYY'), " +
		  "MANUAL_EXCHG_FLAG, MANUAL_EXCHG_RATE, USER_DEFINED_FLAG, " +
		  "USER_DEFINED_DCQ, CALC_LC_AMOUNT, FINAL_LC_AMOUNT, A.REMARKS "
		  + ",CONT_TYPE, FGSA_NO,FGSA_REV_NO, SN_NO, SN_REV_NO, LC_METHOD, A.FLAG,TO_CHAR(SEC_DT,'DD/MM/YYYY'),SEC_REF_NO, A.APRV_BY,TO_CHAR(A.APRV_DT,'DD/MM/YYYY'), MAPPING_ID,B.EXISTING " + //HARSH20201020 Added Existing column
		  "FROM FMS7_LC_MST A, FMS7_LC_DTL B WHERE "
	//SB20201001  + "A.CUSTOMER_CD="+Buyer_cd+" AND A.FLAG = 'Y' "
		  + "B.FGSA_NO='"+FgsaNo+"' AND B.FGSA_REV_NO='"+FgsaRevNo+"' AND B.SN_NO='"+SnNo+"' AND B.SN_REV_NO='"+SnRevNo+"' AND "
		  + "A.CUSTOMER_CD="+Buyer_cd+"  "
		  + "AND A.FINANCIAL_YEAR=B.FINANCIAL_YEAR " +
		 "AND A.LC_SEQ_NO=B.LC_SEQ_NO AND A.CUSTOMER_CD=B.CUSTOMER_CD ORDER BY a.FINANCIAL_YEAR,a.LC_SEQ_NO" ;

	System.out.println("SECURITY: FMS7_LC_MST: "+queryString);
	rset = stmt.executeQuery(queryString);		

	while(rset.next())
	{
		int lc_seq_no = rset.getInt(2);
		String fin_year = rset.getString(1);
		String LC_SEQ_NO = "";
		
		if(lc_seq_no<10)
		{
			LC_SEQ_NO = "000"+lc_seq_no+"/"+fin_year;
		}
		else if(lc_seq_no<100)
		{
			LC_SEQ_NO = "00"+lc_seq_no+"/"+fin_year;
		}
		else if(lc_seq_no<1000)
		{
			LC_SEQ_NO = "0"+lc_seq_no+"/"+fin_year;
		}
		else
		{
			LC_SEQ_NO = ""+lc_seq_no+"/"+fin_year;
		}
		Vfin_yr.add(rset.getString(1)==null?"0":rset.getString(1));
		VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
		VSecuritySeqNo.add(LC_SEQ_NO);
		
		VSecurityRating.add(rset.getString(4)==null?"0":rset.getString(4));
		VSecurityRatingEffDt.add(rset.getString(5)==null?"":rset.getString(5));
		VSecurityDueDt.add(rset.getString(6)==null?"":rset.getString(6));
		VSecurityStartDt.add(rset.getString(7)==null?"":rset.getString(7));
		VSecurityEndDt.add(rset.getString(8)==null?"":rset.getString(8));
		VSecurityAmt.add(rset.getString(14)==null?"":rset.getString(14));
		VSecurityRmk.add(rset.getString(15)==null?"":rset.getString(15));	
		VflagSecurity.add(rset.getString(22)==null?"":rset.getString(22));
		Vsec_dt.add(rset.getString(23)==null?"":rset.getString(23));
		Vsec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
		VAprv_By.add(rset.getString(25)==null?"0":rset.getString(25));
		VAprv_Dt.add(rset.getString(26)==null?"":rset.getString(26));
		
		SecurityType=rset.getString(21)==null?"":rset.getString(21);
		AprvDt=rset.getString(26)==null?"":rset.getString(26);
		
		if(SecurityType.equals("OA"))		//HARSH20201014
			VSecurityStatus.add("No action required"); //HARSH20201014
		else
			if(AprvDt.equals(""))
				VSecurityStatus.add("Pending");
			else
				VSecurityStatus.add("Approved");
		
		MappId=rset.getString(16)+rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
		
		
		if(SecurityType.equals("PCG"))
			VSecurityDealCd.add("All");
		else
			VSecurityDealCd.add(MappId);
		
		FlagSecurity=rset.getString(22)==null?"0":rset.getString(22);
		if(FlagSecurity.equals("Y"))
			VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
		else if(FlagSecurity.equals("O"))
			VSecurityTypeDesc.add(rset.getString(21)+" (Issuance)");
		else
			VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
		
		VSecurityType.add(rset.getString(21)==null?"0":rset.getString(21));
		
		queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Trans_Cd+"' and " +
				   "eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Trans_Cd+"') order by CUSTOMER_CD";
			rset1 = stmt1.executeQuery(queryString1);
			if(rset1.next())
				VSecurityTransCd.add(rset1.getString(1)==null?"":rset1.getString(1));
			else
				VSecurityTransCd.add("");
		Vexisting_cont.add(rset.getString(28)==null?"":rset.getString(28));
	}
	double SumSecurity=0;
	for(int i=0; i<VSecurityAmt.size(); i++)
	{
		if(!VSecurityAmt.elementAt(i).equals(""))
		SumSecurity+=Double.parseDouble(""+VSecurityAmt.elementAt(i));
	}
	TotalSecurityAmt=nf.format(SumSecurity);
	}
	catch(Exception e)
	{
	//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
	e.printStackTrace();	
	}
	}
//////////////////////SB20201012: For CR Security Pre Receipt: OUTGOING List //////////////////////
	public void fetch_LC_IncomingOutgoing_List()
	{
		try
		{		
		
		queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Buyer_cd+"' and " +
			   "eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Buyer_cd+"') order by CUSTOMER_CD";
		rset1 = stmt1.executeQuery(queryString1);
		if(rset1.next())
		{
		CUSTOMER_CD.add(Buyer_cd);
		CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
		//	buyer_Credit_Rate.add(rset1.getString(2)==null?"":rset1.getString(2));
		}
		String MappId=""; String Trans_Cd="";
		String FlagSecurity=""; String SecurityType=""; String AprvDt=""; 
		String FlagButton="";
		if(BtnType.equalsIgnoreCase("Outgoing"))
			FlagButton="O";
		else
			FlagButton="N";
		queryString = "SELECT A.FINANCIAL_YEAR, A.LC_SEQ_NO, A.CUSTOMER_CD, " +
			  "CREDIT_RATING, TO_CHAR(RATING_EFF_DATE,'DD/MM/YYYY'), TO_CHAR(LC_REF_DATE,'DD/MM/YYYY'), " +
			  "TO_CHAR(A.START_DATE,'DD/MM/YYYY'), TO_CHAR(A.END_DATE,'DD/MM/YYYY'), " +
			  "MANUAL_EXCHG_FLAG, MANUAL_EXCHG_RATE, USER_DEFINED_FLAG, " +
			  "USER_DEFINED_DCQ, CALC_LC_AMOUNT, FINAL_LC_AMOUNT, A.REMARKS "
			  + ",CONT_TYPE, FGSA_NO,FGSA_REV_NO, SN_NO, SN_REV_NO, LC_METHOD, A.FLAG,TO_CHAR(SEC_DT,'DD/MM/YYYY'),SEC_REF_NO, A.APRV_BY,TO_CHAR(A.APRV_DT,'DD/MM/YYYY'), MAPPING_ID  " +
			  "FROM FMS7_LC_MST A, FMS7_LC_DTL B WHERE "
			  + "B.FGSA_NO='"+FgsaNo+"' AND B.FGSA_REV_NO='"+FgsaRevNo+"' AND B.SN_NO='"+SnNo+"' AND B.SN_REV_NO='"+SnRevNo+"' AND "
			  + "A.CUSTOMER_CD="+Buyer_cd+" AND A.FLAG = '"+FlagButton+"' "
			  + "AND A.FINANCIAL_YEAR=B.FINANCIAL_YEAR " +
			 "AND A.LC_SEQ_NO=B.LC_SEQ_NO AND A.CUSTOMER_CD=B.CUSTOMER_CD ORDER BY a.FINANCIAL_YEAR,a.LC_SEQ_NO" ;	
		System.out.println("SECURITY: FMS7_LC_MST: "+queryString);
		rset = stmt.executeQuery(queryString);		
		
		while(rset.next())
		{
			int lc_seq_no = rset.getInt(2);
			String fin_year = rset.getString(1);
			String LC_SEQ_NO = "";
			
			if(lc_seq_no<10)
			{
				LC_SEQ_NO = "000"+lc_seq_no+"/"+fin_year;
			}
			else if(lc_seq_no<100)
			{
				LC_SEQ_NO = "00"+lc_seq_no+"/"+fin_year;
			}
			else if(lc_seq_no<1000)
			{
				LC_SEQ_NO = "0"+lc_seq_no+"/"+fin_year;
			}
			else
			{
				LC_SEQ_NO = ""+lc_seq_no+"/"+fin_year;
			}
			Vfin_yr.add(rset.getString(1)==null?"0":rset.getString(1));
			VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
			VSecuritySeqNo.add(LC_SEQ_NO);
			
			VSecurityRating.add(rset.getString(4)==null?"0":rset.getString(4));
			VSecurityRatingEffDt.add(rset.getString(5)==null?"":rset.getString(5));
			VSecurityDueDt.add(rset.getString(6)==null?"":rset.getString(6));
			VSecurityStartDt.add(rset.getString(7)==null?"":rset.getString(7));
			VSecurityEndDt.add(rset.getString(8)==null?"":rset.getString(8));
			VSecurityAmt.add(rset.getString(14)==null?"":rset.getString(14));
			VSecurityRmk.add(rset.getString(15)==null?"":rset.getString(15));	
			VflagSecurity.add(rset.getString(22)==null?"":rset.getString(22));
			Vsec_dt.add(rset.getString(23)==null?"":rset.getString(23));
			Vsec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
			VAprv_By.add(rset.getString(25)==null?"0":rset.getString(25));
			VAprv_Dt.add(rset.getString(26)==null?"":rset.getString(26));
			AprvDt=rset.getString(26)==null?"":rset.getString(26);
			Trans_Cd=rset.getString(27)==null?"":rset.getString(27);
			if(AprvDt.equals(""))
				VSecurityStatus.add("Pending");
			else
				VSecurityStatus.add("Approved");
			
			MappId=rset.getString(16)+rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
			
			SecurityType=rset.getString(21)==null?"":rset.getString(21);
			if(SecurityType.equals("PCG"))
				VSecurityDealCd.add("All");
			else
				VSecurityDealCd.add(MappId);
			
			FlagSecurity=rset.getString(22)==null?"0":rset.getString(22);
			if(FlagSecurity.equals("Y"))
				VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
			else if(FlagSecurity.equals("O"))
				VSecurityTypeDesc.add(rset.getString(21)+" (Issuance)");
			else
				VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
			
			VSecurityType.add(rset.getString(21)==null?"0":rset.getString(21));
			
			queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Trans_Cd+"' and " +
					   "eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Trans_Cd+"') order by CUSTOMER_CD";
				rset1 = stmt1.executeQuery(queryString1);
				if(rset1.next())
					VSecurityTransCd.add(rset1.getString(1)==null?"":rset1.getString(1));
				else
					VSecurityTransCd.add("");
		}
		double SumSecurity=0;
		for(int i=0; i<VSecurityAmt.size(); i++)
		{
			if(!VSecurityAmt.elementAt(i).equals(""))
			SumSecurity+=Double.parseDouble(""+VSecurityAmt.elementAt(i));
		}
		TotalSecurityAmt=nf.format(SumSecurity);
		}
		catch(Exception e)
		{
		//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
		e.printStackTrace();	
		}
	}
	Vector Vfin_yr = new Vector();
	Vector VActual_seq_no = new Vector();
	Vector VSecuritySeqNo = new Vector();
	public Vector getVSecuritySeqNo() {return VSecuritySeqNo;}
	Vector VSecurityStartDt = new Vector();
	public Vector getVSecurityStartDt() {return VSecurityStartDt;}
	Vector VSecurityEndDt = new Vector();
	public Vector getVSecurityEndDt() {return VSecurityEndDt;}
	Vector VSecurityAmt = new Vector();
	public Vector getVSecurityAmt() {return VSecurityAmt;}
	Vector VSecurityStatus = new Vector();
	public Vector getVSecurityStatus() {return VSecurityStatus;}
	Vector VSecurityRating = new Vector();
	public Vector getVSecurityRating() {return VSecurityRating;}
	Vector VSecurityRatingEffDt = new Vector();
	public Vector getVSecurityRatingEffDt() {return VSecurityRatingEffDt;}
	Vector VSecurityDueDt = new Vector();
	public Vector getVSecurityDueDt() {return VSecurityDueDt;}
	Vector VSecurityRmk = new Vector();
	public Vector getVSecurityRmk() {return VSecurityRmk;}
	Vector VSecurityEntBy = new Vector();
	public Vector getVSecurityEntBy() {return VSecurityEntBy;}
	Vector VSecurityEntDt = new Vector();
	public Vector getVSecurityEntDt() {return VSecurityEntDt;}
	Vector VSecurityAprvBy = new Vector();
	public Vector getVSecurityAprvBy() {return VSecurityAprvBy;}
	Vector VSecurityAprvDt = new Vector();
	public Vector getVSecurityAprvDt() {return VSecurityAprvDt;}
	Vector VSecurityTransCd = new Vector();
	public Vector getVSecurityTransCd() {return VSecurityTransCd;}
	
	Vector VSecurityDealCd = new Vector();
	public Vector getVSecurityDealCd() {return VSecurityDealCd;}
	Vector VSecurityType = new Vector();
	Vector VSecurityTypeDesc = new Vector();
	public Vector getVSecurityType() {return VSecurityType;}
	String TotalSecurityAmt = "";
	public String getTotalSecurityAmt() {return TotalSecurityAmt;}
	Vector VflagSecurity = new Vector();
	Vector Vsec_dt = new Vector();
	Vector Vsec_ref_no = new Vector();
	String contSt_dt="";
	String contEnd_dt="";
////////////////////////////////////////////////////////////////////////////
	
	///////////////////////////Harsh///////////////////////////////
	public void fetch_EXCEED_CREDIT_LIST()
	{
		try
		{
			String SysDate="";
			String findDate = "Select to_char(sysdate,'dd/mm/yyyy') from dual";
			rset1=stmt1.executeQuery(findDate);
			if(rset1.next())
			{
				SysDate=rset1.getString(1)==null?"":rset1.getString(1);
			}
			queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Buyer_cd+"' and " +
			"eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Buyer_cd+"') order by CUSTOMER_CD";
			rset1 = stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				CUSTOMER_CD.add(Buyer_cd);
				CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
			}
			
			/*queryString = "SELECT LC_SEQ_NO,CONT_TYPE,FGSA_NO,FGSA_REV_NO,SN_NO,SN_REV_NO,LC_METHOD,EMP_CD,TO_CHAR(ENT_DT,'DD/MM/YYYY') FROM FMS7_LC_DTL where CUSTOMER_CD = '"+Buyer_cd+"'";
			System.out.println(queryString);
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
			String cont_ref = rset.getString(2)+""+rset.getString(3)+"-"+rset.getString(4)+"-"+rset.getString(5)+"-"+rset.getString(6);
			//System.out.println("-"+cont_ref);
			ECContract_ref.add(cont_ref);
			LC_method.add(rset.getString(7)==null?"":rset.getString(7));
			
			String qury_emp_nm = "select EMP_NM from HR_EMP_MST where EMP_CD = '"+rset.getString(8)+"'";
			rset2 = stmt2.executeQuery(qury_emp_nm);
			if(rset2.next())
			{
			Emp_nm.add(rset2.getString(1)==null?"":rset2.getString(1));
			}
			Ent_dt.add(rset.getString(9)==null?"":rset.getString(9));
			}*/
			String Exchg_Rate_CD="";
			queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
					" FROM FMS7_SN_BILLING_DTL " +
				     "WHERE cont_type='"+LC_cont_type+"' AND customer_cd='"+Buyer_cd+"' AND FGSA_NO='"+FgsaNo+"' AND sn_no='"+SnNo+"'";
			//System.out.println(queryString2);
			rset2 = stmt2.executeQuery(queryString2);
			if(rset2.next())
			{
				Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
			}
			double AvailableExchgRate=0;
			queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
					" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
					" AND FLAG='Y' ";
			rset2 = stmt2.executeQuery(queryString2);
			if(rset2.next())
			{
				AvailableExchgRate =rset2.getDouble(1);		
				VExchgRate.add(AvailableExchgRate); 
			}
			else
			{
				VExchgRate.add("0"); 
			}
			
			String cr_limit = "select value,currency from fms9_security_post_mst where customer_cd='"+Buyer_cd+"' and sec_type ='PCG' and issu_dt <= to_date('"+to_date+"','dd/mm/yyyy') and exp_dt >= to_date('"+to_date+"','dd/mm/yyyy') and aprv_dt is not null";
			/*String credit_limit = "select a.final_lc_amount from fms7_lc_mst a, fms7_lc_dtl b where a.customer_cd='"+Buyer_cd+"' and b.customer_cd='"+Buyer_cd+"'"
			+ "and a.start_date between TO_DATE('"+from_date+"','DD/MM/YYYY') and TO_DATE('"+to_date+"','DD/MM/YYYY') and a.lc_seq_no = b.lc_seq_no and a.financial_year = b.financial_year and b.lc_method='PCG'";*/
			//System.out.println("CL----"+cr_limit);
			rset = stmt.executeQuery(cr_limit);
			double crdit_limit_amt = 0;
			double sum_cl = 0;
			while(rset.next())
			{
				sum_cl = Double.parseDouble(rset.getString(1)==null?"0":rset.getString(1));
				String currency = rset.getString(2)==null?"":rset.getString(2);
				if(currency.equals("USD"))
				{
					sum_cl = sum_cl * AvailableExchgRate;
				}
				else
				{
					sum_cl = Double.parseDouble(rset.getString(1)==null?"0":rset.getString(1));
				}
				crdit_limit_amt = crdit_limit_amt + sum_cl;
			}
			Credit_limit.add(nf.format(crdit_limit_amt));
			if(crdit_limit_amt != 0.0)
			{
				VResonsOfExceed.add("Credit Limit or Collateral Value Exceed");
				VResonsOfAmt.add("Parent Company Guarantee:<strong>[ INR "+nf.format(crdit_limit_amt)+"]</strong>");//
			}
			//System.out.println("PCG-"+crdit_limit_amt );
			String open_deal = "select nvl(count(*),0) from fms9_security_post_mst where customer_cd='"+Buyer_cd+"' and link='"+contRef+"' and sec_type='OA'";// and issu_dt <= to_date('"+to_date+"','dd/mm/yyyy') and exp_dt >= to_date('"+to_date+"','dd/mm/yyyy')";
			/*String Open_deal = "select a.final_lc_amount from fms7_lc_mst a, fms7_lc_dtl b where a.customer_cd='"+Buyer_cd+"' and b.customer_cd='"+Buyer_cd+"'"
			+ " and a.start_date between TO_DATE('"+from_date+"','DD/MM/YYYY') and TO_DATE('"+to_date+"','DD/MM/YYYY') and a.lc_seq_no = b.lc_seq_no and a.financial_year = b.financial_year and b.lc_method='OA'";*/
			//System.out.println(""+Open_deal);
			rset1 = stmt1.executeQuery(open_deal);
			int found = 0;
			double opendeal_amt = 0;
			double sum_od = 0;
			if(rset1.next())
			{
				//sum_od = Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1));
				//opendeal_amt = opendeal_amt + sum_od;
				found = rset1.getInt(1);
			}
			Open_deal_amt.add(nf.format(opendeal_amt));
			if(found > 0)
			{
				VResonsOfExceed.add("Open Deal With Counter Party having no Credit Limit");
				VResonsOfAmt.add("Open Account");
			}
			/*double cr_rating_amt = 0;
			int found1 = 0;
			String cr_rating = "select nvl(count(*),0) from fms9_security_post_mst where customer_cd=(select cust_cd from fms9_limit_mst where cust_cd='"+Buyer_cd+"' and (credit_rating='C' or credit_rating='D')) and sec_type='OA' and link='"+contRef+"'";// and issu_dt <= to_date('"+to_date+"','dd/mm/yyyy') and exp_dt >= to_date('"+to_date+"','dd/mm/yyyy')";
			String cr_rating = "select a.final_lc_amount from fms7_lc_mst a, fms7_lc_dtl b where (a.credit_rating='3' or a.credit_rating='4') and a.customer_cd='"+Buyer_cd+"' and b.customer_cd='"+Buyer_cd+"'"
			+ "and a.start_date between TO_DATE('"+from_date+"','DD/MM/YYYY') and TO_DATE('"+to_date+"','DD/MM/YYYY') and a.lc_seq_no = b.lc_seq_no and a.financial_year = b.financial_year and b.lc_method='OA'";
			//System.out.println(cr_rating);
			rset = stmt.executeQuery(cr_rating);
			double sum_cr = 0;
			if(rset.next())
			{
				//sum_cr = Double.parseDouble(rset.getString(1)==null?"0":rset.getString(1));
				//cr_rating_amt = cr_rating_amt + sum_cr;
				found1 = rset.getInt(1);
			}
			Cr_rating_amt.add(nf.format(cr_rating_amt));
			if(found1 > 0)
			{
				VResonsOfExceed.add("Security required for Counter Party Rated C/3 and D/4");
				VResonsOfAmt.add("Open Account");
			}*/
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	String contRef = "";
	public void setContRef(String contRef) {this.contRef = contRef;}
	Vector VResonsOfExceed = new Vector();
	public Vector getVResonsOfExceed() {return VResonsOfExceed;}
	Vector VResonsOfAmt = new Vector();
	public Vector getVResonsOfAmt() {return VResonsOfAmt;}

////////////Harsh20201005////////////////////////////
public void fetch_upcoming_security_list()
{
	try
	{
		queryString="select to_char(TO_DATE('"+from_date_us+"', 'DD/MM/YYYY')+14,'dd/mm/yyyy') from dual";
		rset=stmt.executeQuery(queryString);
		if(rset.next()){
			to_date_us=rset.getString(1)==null?"":rset.getString(1);
		}
		String us_query1 = "select customer_cd,sec_type,deal_type,value,to_char(rec_dt,'dd/mm/yyyy'),to_char(issu_dt,'dd/mm/yyyy'),to_char(exp_dt,'dd/mm/yyyy'),to_char(aprv_dt,'dd/mm/yyyy'),link,iss_bank_ref,mapping_id,seq_no,"
				+ "issued,received,currency,variation_value,value_fluc,iss_bank_cd,adv_bank_cd,adv_bank_ref,confirm_bank_cd,confirm_bank_ref,tenor,ref_no,remarks,status,customer_abbr "
				+ "from fms9_security_post_mst "
				+ "where STATUS IN ('Pending','Pending for amendment') and  sec_type!='OA' and received='R' order by rec_dt"; //rec_dt between TO_DATE('"+from_date_us+"', 'DD/MM/YYYY') and TO_DATE('"+to_date_us+"','DD/MM/YYYY')
		
		// ENH 226 : Upcoming Security Report should show all Securities with status in 'pending' | ''pending for Amd'', even though it's a past date.
		// To implement above ENH removed DATE RANGE(FROM REPORT DT TO NEXT 14DAYS) AND ADDED ONE MORE CONDITION ON STATUS HARSH20220110
		//System.out.println("Upcoming_security--"+us_query1);
		rset = stmt.executeQuery(us_query1);
		while(rset.next())
		{
			String status = rset.getString(26)==null?"":rset.getString(26);
			int count=0; 
			if(status.equals("Pending") || status.equals("Pending for amendment")) //AS PER SHI TING MAIL ON 27/01/2022
			{
				String cont_mapId=rset.getString(9)==null?"":rset.getString(9);
				String cust_abbr = rset.getString(27)==null?"":rset.getString(27);
				count=checkContractPeriod(from_date_us, cont_mapId,cust_abbr);
			}
			if(count == 0) //AS PER SHI TING MAIL ON 27/01/2022
			{
				if(rset.getString(8)==null)
				{
					String c_cd = rset.getString(1)==null?"":rset.getString(1);
					/*SB20201205
					String cust_query = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+c_cd+"'";
					//System.out.println("cucccc---"+cust_query);
					rset1 = stmt1.executeQuery(cust_query);
					if(rset1.next())
					{
						CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
						CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
						//System.out.println("cnnnnnnn-"+rset1.getString(1));
					}
					*/
				//SB20201205	Us_deal_type.add(rset.getString(3)==null?"":rset.getString(3));
					String securityType = rset.getString(2)==null?"":rset.getString(2);
					
					//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
					/*HARSH20210130 if(securityType.equals("PCG"))
					{
						Us_contract_ref.add("All");
					}
					else
					{*/
						//Us_contract_ref.add(us_cont_ref);
						//Us_contract_ref.add(rset.getString(9)==null?"":rset.getString(9));
						String dealno = rset.getString(9)==null?"":rset.getString(9);
						Us_contract_ref.add(""+getDisplayDealId(dealno)); //HARSH20220228
						VDealId_Display.add(""+getDisplayDealId(dealno)); //HARSH20220228
					//}
					Us_security_type.add(securityType);
					double amt = Double.parseDouble(rset.getString(4)==null?"0":rset.getString(4));
					Us_security_amt.add(nf.format(amt));
					Us_security_due_date.add(rset.getString(5)==null?"":rset.getString(5));
					Us_issuing_dt.add(rset.getString(6)==null?"":rset.getString(6));
					Us_expire_dt.add(rset.getString(7)==null?"":rset.getString(7));
					Us_sec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
					Us_Existing_ref.add(rset.getString(11)==null?"":rset.getString(11));
					/*Us_Fgsa_no.add(rset.getString(2)==null?"":rset.getString(2));
					Us_Fgsa_rev_no.add(rset.getString(3)==null?"":rset.getString(3));
					Us_Sn_no.add(rset.getString(4)==null?"":rset.getString(4));
					Us_Sn_rev_no.add(rset.getString(5)==null?"":rset.getString(5));
					Us_cont_typ.add(rset.getString(6)==null?"":rset.getString(6));
					
					String us_fgsa_no = rset.getString(2)==null?"":rset.getString(2);
					String us_fgsa_rev_no = rset.getString(3)==null?"":rset.getString(3);
					String us_sn_no = rset.getString(4)==null?"":rset.getString(4);
					String us_sn_rev_no = rset.getString(5)==null?"":rset.getString(5);
					String us_cont_type = rset.getString(6)==null?"":rset.getString(6);
					
					String us_cont_ref = us_cont_type+""+us_fgsa_no+"-"+us_fgsa_rev_no+"-"+us_sn_no+"-"+us_sn_rev_no;*/
					//String securityType = rset.getString(7)==null?"":rset.getString(7);
					
					
					/*String deal_date_query = "select TO_CHAR(signing_dt,'DD/MM/YYYY') from fms7_sn_mst where customer_cd='"+c_cd+"' and fgsa_no='"+us_fgsa_no+"' and fgsa_rev_no='"+us_fgsa_rev_no+"' and sn_no='"+us_sn_no+"' and sn_rev_no='"+us_sn_rev_no+"'";
					rset2 = stmt2.executeQuery(deal_date_query);
					if(rset2.next())
					{
						Us_deal_date.add(rset2.getString(1)==null?"":rset2.getString(1));
					}
					else
					{
						Us_deal_date.add("");
					}*/
					
					//Us_security_due_date.add(rset.getString(8)==null?"":rset.getString(8));
					
					/*double amt = Double.parseDouble(rset.getString(9)==null?"0":rset.getString(9));
					Us_security_amt.add(nf.format(amt));*/
					
					//Us_Existing_ref.add(rset.getString(10)==null?"":rset.getString(10));
					//Us_Modify_dt.add(rset.getString(12)==null?"":rset.getString(12));
					//modify by  rset.getString(13)==null?"":rset.getString(13)
					//Us_sec_ref_no.add(rset.getString(14)==null?"":rset.getString(14));
					Us_LC_seq_no.add(rset.getString(12)==null?"":rset.getString(12));
					if(rset.getString(13)!=null && rset.getString(14)==null)
					{
						Us_issued_received.add(rset.getString(13)==null?"":rset.getString(13));
					}else if(rset.getString(13)==null && rset.getString(14)!=null)
					{
						Us_issued_received.add(rset.getString(14)==null?"":rset.getString(14));
					}
					Us_currency.add(rset.getString(15)==null?"":rset.getString(15));
					//Us_contract_ref.add(rset.getString(9)==null?"":rset.getString(9));
					Us_value_vari.add(rset.getString(16)==null?"":rset.getString(16));
					Us_value_fluc.add(rset.getString(17)==null?"":rset.getString(17));
					Us_iss_bank_cd.add(rset.getString(18)==null?"":rset.getString(18));
					Us_adv_bank_cd.add(rset.getString(19)==null?"":rset.getString(19));
					Us_adv_bank_ref.add(rset.getString(20)==null?"":rset.getString(20));
					Us_con_bank_cd.add(rset.getString(21)==null?"":rset.getString(21));
					Us_con_bank_ref.add(rset.getString(22)==null?"":rset.getString(22));
					Us_tenor.add(rset.getString(23)==null?"":rset.getString(23));
					Us_remarks.add(rset.getString(25)==null?"":rset.getString(25));
					Us_status.add(rset.getString(26)==null?"":rset.getString(26));
					String split_cont_ref=rset.getString(9)==null?"":rset.getString(9);
					//System.out.println(split_cont_ref);
					String act_cont_type[]= split_cont_ref.split("-"); //SB20201205
					String c_ty = act_cont_type[0].charAt(0)+""; //SB20201205
					
					if(c_ty.equals("B"))  //SB20201205
					{
						Us_deal_type.add("LNG"); //SB20201205
						Us_Buy_Sell.add("BUY"); //HARSH20201210
					}
					else if(c_ty.equals("C"))  //SB20201205
					{
						Us_deal_type.add("CAPACITY"); //SB20201205
						Us_Buy_Sell.add("SELL"); //HARSH20201210
					}
					else if(c_ty.equals("S") || c_ty.equals("L"))  //SB20201205
					{
						Us_deal_type.add("GAS"); //SB20201205
						Us_Buy_Sell.add("SELL"); //HARSH20201210
					}
					else
					{
						Us_deal_type.add(rset.getString(3)==null?"":rset.getString(3)); //HARSH20210128
						Us_Buy_Sell.add("SELL"); //HARSH20201210
					}
					//SB20201205	if(!split_cont_ref.equals(""))
					/*HARSH20210213 if(!c_ty.equals("B")) //SB20201205
					{
						String cust_query = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+c_cd+"'";
						//System.out.println("cucccc---"+cust_query);
						rset1 = stmt1.executeQuery(cust_query);
					}
					else //SB20201205
					{
						String cust_query ="select TRADER_NAME,TRADER_ABBR,TRADER_CD from FMS7_TRADER_MST B where TRADER_CD="+c_cd+" "
								+ "and eff_dt=(select max(eff_dt) from FMS7_TRADER_MST where TRADER_CD='"+c_cd+"')";	
						rset1 = stmt1.executeQuery(cust_query);
					}*/
					String cust_abbr = rset.getString(27)==null?"":rset.getString(27);
					String cust_query = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"'";
					rset1 = stmt1.executeQuery(cust_query);
					if(rset1.next())
					{
						CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
						CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
					}else{
					    cust_query ="select TRADER_NAME,TRADER_ABBR,TRADER_CD from FMS7_TRADER_MST where TRADER_ABBR='"+cust_abbr+"'";
						rset1 = stmt1.executeQuery(cust_query);
						if(rset1.next())
						{
							CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
							CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
						}
						else
						{
							CUSTOMER_CD.add("");
							CUSTOMER_NM.add("");
						}
					}
					if(!split_cont_ref.equals("") && !c_ty.equals("B"))
					{
						//SB20201205String act_cont_type[]= split_cont_ref.split("-");
						//SB20201205 String c_ty = act_cont_type[0].charAt(0)+"";
						
						//AS PER SHI THING MAIL ON 12/01/2022
						String mapid="";
						String fgsa ="";
						String fgsa_rev ="";
						String sn ="";
						String sn_rev ="";
						if(!split_cont_ref.equals("0") && !split_cont_ref.equals(""))
						{
							String dealNo[] = split_cont_ref.substring(1,split_cont_ref.length()).split("-");
							mapid = split_cont_ref.substring(1,split_cont_ref.length()); //HARSH20210213
							fgsa = dealNo[0];
							fgsa_rev = dealNo[1];
							sn = dealNo[2];
							sn_rev = dealNo[3];
						}
						//System.out.println(c_ty+"----"+fgsa+"---"+fgsa_rev+"---"+sn+"---"+sn_rev);
						
						//LIVE ISSUE HARSH20210429
						String cust_cd ="";
						queryString2 = "SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"'";
						rset2=stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							cust_cd=rset2.getString(1)==null?"":rset2.getString(1);
						}
						//System.out.println("CUST CD :: "+cust_cd);
						if(c_ty.equals("S"))
						{
							String queryString1 ="select TO_CHAR(signing_dt,'DD/MM/YYYY') from fms7_sn_mst where customer_cd='"+cust_cd+"' and fgsa_no='"+fgsa+"' and fgsa_rev_no='"+fgsa_rev+"' and sn_no='"+sn+"' and sn_rev_no='"+sn_rev+"'";
							rset1=stmt1.executeQuery(queryString1);
							if(rset1.next())
							{
								Us_deal_date.add(rset1.getString(1)==null?"":rset1.getString(1));
							}
							else
							{
								Us_deal_date.add("");
							}
						}
						else if(c_ty.equals("L"))
						{
							String queryString2="select TO_CHAR(signing_dt,'DD/MM/YYYY') from fms7_loa_mst where customer_cd='"+cust_cd+"' and LOA_NO='"+sn+"' and LOA_REV_NO='"+sn_rev+"' and TENDER_NO='"+fgsa+"'";
							rset2= stmt2.executeQuery(queryString2);
							if(rset2.next())
							{
								Us_deal_date.add(rset2.getString(1)==null?"":rset2.getString(1));
							}
							else
							{
								Us_deal_date.add("");
							}
							
						}
						else if(c_ty.equals("C"))
						{
							String queryString2="select TO_CHAR(signing_dt,'DD/MM/YYYY') from fms8_lng_regas_mst where customer_cd='"+cust_cd+"' and mapping_id='"+mapid+"'";
							rset2= stmt2.executeQuery(queryString2);
							if(rset2.next())
							{
								Us_deal_date.add(rset2.getString(1)==null?"":rset2.getString(1));
							}
							else
							{
								Us_deal_date.add("");
							}
						}
						else
						{
							Us_deal_date.add("");
						}	
					}
					else
					{
						Us_deal_date.add("");
					}
				}
			}
		}
	}
	catch(Exception e)
	{
		e.printStackTrace();
		System.out.println("Exception In Upcoming Security----");
	}
}

//AS PER SHI TING MAIL ON 27/01/2022
public int checkContractPeriod(String report_dt,String cont_mapId, String Customer_ABBR)
{
	int count=0;
	try
	{
		String cont_type="";
		String fgsa="";
		String sn="";
		if(!cont_mapId.equals("") && !cont_mapId.equals("0"))
		{
			cont_type=cont_mapId.substring(0,1);
			String temp[] = cont_mapId.split("-");
			if(cont_type.equals("B"))
			{
				fgsa=temp[0].toString().substring(1,temp[0].toString().length());
				sn = temp[1].toString();
			}
			else
			{
				fgsa=temp[0].toString().substring(1,temp[0].toString().length());
				sn = temp[2].toString();
			}
		}
		
		if(cont_type.equals("S"))
		{
			String segment="";
			String temp_1[] = cont_mapId.split("-");
			if(temp_1.length>4)
			{
				segment = temp_1[4];
			}
			String queryString1="";
			if(segment.equals("DLNG"))
			{
				queryString1 ="SELECT COUNT(*) FROM DLNG_SN_MST A "
				 		+ "WHERE A.SN_NO='"+sn+"' AND A.FLSA_NO='"+fgsa+"' AND "
				 		+ "A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
				 		+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "
				 		+ "A.END_DT < to_date('"+report_dt+"','dd/mm/yyyy') AND "
				 		+ "A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM DLNG_SN_MST B where A.SN_NO=B.SN_NO AND A.FLSA_NO=B.FLSA_NO AND "
				 		+ "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FLSA_REV_NO=B.FLSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			}
			else
			{
				queryString1 ="SELECT COUNT(*) FROM FMS7_SN_MST A "
				 		+ "WHERE A.SN_NO='"+sn+"' AND A.FGSA_NO='"+fgsa+"' AND "
				 		+ "A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
				 		+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "
				 		+ "A.END_DT < to_date('"+report_dt+"','dd/mm/yyyy') AND "
				 		+ "A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND "
				 		+ "A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			}
			//System.out.println(queryString1);
			rset3 = stmt3.executeQuery(queryString1);
			if(rset3.next())
			{
				count = rset3.getInt(1);
			}
		}
		else if(cont_type.equals("L"))
		{
			String segment="";
			String temp_1[] = cont_mapId.split("-");
			if(temp_1.length>4)
			{
				segment = temp_1[4];
			}
			String queryString2="";
			if(segment.equals("DLNG"))
			{
				queryString2 =   "SELECT COUNT(*) FROM DLNG_LOA_MST A "
						+ "WHERE A.LOA_NO='"+sn+"' AND A.TENDER_NO='"+fgsa+"' AND "
						+ "A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
						+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "
						+ "A.END_DT < to_date('"+report_dt+"','dd/mm/yyyy') AND "
						+ "A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM DLNG_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND "
						+ "A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			}
			else
			{
				queryString2 =   "SELECT COUNT(*) FROM FMS7_LOA_MST A "
						+ "WHERE A.LOA_NO='"+sn+"' AND A.TENDER_NO='"+fgsa+"' AND "
						+ "A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
						+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "
						+ "A.END_DT < to_date('"+report_dt+"','dd/mm/yyyy') AND "
						+ "A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND "
						+ "A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			}
			//System.out.println(queryString2);
			rset1 = stmt1.executeQuery(queryString2);
			if(rset1.next())
			{
				count = rset1.getInt(1);
			}
		}
		else if(cont_type.equals("C"))
		{
			String queryString3 = "SELECT COUNT(*) "
					+ "FROM FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C "
					+ "WHERE A.MAPPING_ID = '"+cont_mapId.substring(1,cont_mapId.length())+"' AND A.CONTRACT_END_DT < to_date('"+report_dt+"','dd/mm/yyyy') AND "
					+ "C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) "
					+ "AND C.MAPPING_ID = A.MAPPING_ID";
			rset2 = stmt2.executeQuery(queryString3);
			if(rset2.next())
			{
				count=rset2.getInt(1);
			}
		}
		else if(cont_type.equals("B"))
		{
			queryString = "SELECT COUNT(*) "
					+ "FROM FMS7_MAN_CONFIRM_CARGO_DTL A, FMS7_MAN_CONFIRM_MST C, FMS7_MAN_REQ_MST E "
					+ "WHERE A.MAN_CONF_CD='"+fgsa+"' AND A.CARGO_SEQ_NO='"+sn+"' AND "
					+ "E.TRD_CD=(SELECT TRADER_CD FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"')) "
					+ "AND A.DELV_TO_DT < TO_DATE('"+report_dt+"','DD/MM/YYYY') "
					+ "AND E.MAN_CD=A.MAN_CD AND "+ 
					" A.MAN_CONF_CD=C.MAN_CONF_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD LIKE '%' "+ 
					" ORDER BY A.MAN_CONF_CD, A.CARGO_REF_CD";
			//System.out.println("CARGO: "+queryString);
			rset3 = stmt3.executeQuery(queryString);
			if(rset3.next())
			{		
				count=rset3.getInt(1);
			}
			
			queryString = "SELECT COUNT(*) "
					+ "FROM FMS9_MAN_CANCEL_CARGO_DTL A, FMS7_MAN_CONFIRM_MST C, FMS7_MAN_REQ_MST E "
					+ "WHERE A.MAN_CONF_CD='"+fgsa+"' AND A.CARGO_SEQ_NO='"+sn+"' AND "
					+ "E.TRD_CD=(SELECT TRADER_CD FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"')) "
					//+ "AND A.DELV_TO_DT < TO_DATE('"+report_dt+"','DD/MM/YYYY') "
					+ "AND E.MAN_CD=A.MAN_CD AND "+ 
					" A.MAN_CONF_CD=C.MAN_CONF_CD AND A.CARGO_STATUS='X' AND CARGO_REF_CD LIKE '%' "+ 
					" ORDER BY A.MAN_CONF_CD, A.CARGO_REF_CD";
			//System.out.println("CARGO: "+queryString);
			rset3 = stmt3.executeQuery(queryString);
			if(rset3.next())
			{		
				count=rset3.getInt(1);
			}
		}
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
	return count;
}
String from_date_us = "";
public void setFrom_date_us(String from_date_us) {this.from_date_us = from_date_us;}
String to_date_us = "";
public void setTo_date_us(String to_date_us) {this.to_date_us = to_date_us;}

Vector Us_issuing_dt = new Vector();
public Vector getUs_issuing_dt() {return Us_issuing_dt;}
Vector Us_expire_dt = new Vector();
public Vector getUs_expire_dt() {return Us_expire_dt;}
Vector Us_issued_received = new Vector();
public Vector getUs_issued_received() {return Us_issued_received;}
Vector Us_deal_type = new Vector();
public Vector getUs_deal_type() {return Us_deal_type;}
Vector Us_currency = new Vector();
public Vector getUs_currency() {return Us_currency;}

Vector Us_LC_seq_no = new Vector();
public Vector getUs_LC_seq_no() {return Us_LC_seq_no;}
Vector Us_Existing_ref = new Vector();
public Vector getUs_Existing_ref() {return Us_Existing_ref;}
Vector Us_contract_ref = new Vector();
public Vector getUs_contract_ref() {return Us_contract_ref;}
Vector Us_security_type = new Vector();
public Vector getUs_security_type() {return Us_security_type;}
Vector Us_security_due_date = new Vector();
public Vector getUs_security_due_date() {return Us_security_due_date;}
Vector Us_security_amt = new Vector();
public Vector getUs_security_amt() {return Us_security_amt;}
Vector Us_deal_date = new Vector();
public Vector getUs_deal_date() {return Us_deal_date;}
Vector Us_Fgsa_no = new Vector();
public Vector getUs_Fgsa_no() {return Us_Fgsa_no;}
Vector Us_Fgsa_rev_no = new Vector();
public Vector getUs_Fgsa_rev_no() {return Us_Fgsa_rev_no;}
Vector Us_Sn_no = new Vector();
public Vector getUs_Sn_no() {return Us_Sn_no;}
Vector Us_Sn_rev_no = new Vector();
public Vector getUs_Sn_rev_no() {return Us_Sn_rev_no;}
Vector Us_cont_typ = new Vector();
public Vector getUs_cont_typ() {return Us_cont_typ;}
Vector Us_Modify_dt = new Vector();
public Vector getUs_Modify_by() {return Us_Modify_dt;}
Vector Us_sec_ref_no = new Vector();
public Vector getUs_sec_ref_no() {return Us_sec_ref_no;}
Vector Us_value_vari = new Vector();
public Vector getUs_value_vari() {return Us_value_vari;}
Vector Us_value_fluc = new Vector();
public Vector getUs_value_fluc() {return Us_value_fluc;}
Vector Us_iss_bank_cd = new Vector();
public Vector getUs_iss_bank_cd() {return Us_iss_bank_cd;}
Vector Us_adv_bank_cd = new Vector();
public Vector getUs_adv_bank_cd() {return Us_adv_bank_cd;}
Vector Us_adv_bank_ref = new Vector();
public Vector getUs_adv_bank_ref() {return Us_adv_bank_ref;}
Vector Us_con_bank_cd = new Vector();
public Vector getUs_con_bank_cd() {return Us_con_bank_cd;}
Vector Us_con_bank_ref = new Vector();
public Vector getUs_con_bank_ref() {return Us_con_bank_ref;}
Vector Us_tenor = new Vector();
public Vector getUs_tenor() {return Us_tenor;}
Vector Us_remarks = new Vector();
public Vector getUs_remarks() {return Us_remarks;}
Vector Us_status = new Vector();
public Vector getUs_status() {return Us_status;}
Vector Us_Buy_Sell = new Vector();//HARSH20201210
public Vector getUs_Buy_Sell() {return Us_Buy_Sell;}//HARSH20201210


/////////////////////////////////////////////////////
////////////Harsh20201005////////////////////////////
public void fetch_security_general_list()
{
try
{
	String SecurityGeneral = "select customer_cd,sec_type,deal_type,guarantor_nm,currency,variation_value,value,value_fluc,iss_bank_cd,iss_bank_ref,adv_bank_cd,adv_bank_ref,confirm_bank_cd,confirm_bank_ref,"
			+ "to_char(rec_dt,'dd/mm/yyyy'),to_char(issu_dt,'dd/mm/yyyy'),to_char(exp_dt,'dd/mm/yyyy'),to_char(renew_dt,'dd/mm/yyyy'),tenor,remarks,link,issued,received,ent_cd,to_char(ent_dt,'dd/mm/yyyy'),to_char(modify_dt,'dd/mm/yyyy'),modify_by,to_char(aprv_dt,'dd/mm/yyyy'),aprv_by,status,seq_no,ref_no,customer_abbr,guarantor_abbr "
			+ "from fms9_security_post_mst order by customer_abbr";
	/*String gen_lc_query="SELECT a.customer_cd,b.fgsa_no,b.fgsa_rev_no,b.sn_no,b.sn_rev_no,b.cont_type,to_char(a.start_date,'DD/MM/YYYY'),to_char(a.end_date,'DD/MM/YYYY'),a.credit_rating,"
			+ "to_char(a.rating_eff_date,'DD/MM/YYYY'),to_char(a.lc_ref_date,'DD/MM/YYYY'),a.manual_exchg_rate,a.calc_lc_amount,a.final_lc_amount,to_char(a.sec_dt,'DD/MM/YYYY'),b.sn_duration,b.dcq,b.tcq,b.sales_rate,"
			+ "b.tax_percentage,b.lc_method,b.lc_base,b.exchg_rate,a.financial_year,a.remarks,a.sec_ref_no,to_char(a.ent_dt,'dd/mm/yyyy'),a.emp_cd,to_char(b.SN_START_DATE,'dd/mm/yyyy'),to_char(b.SN_END_DATE,'dd/mm/yyyy'),to_char(a.aprv_dt,'dd/mm/yyyy'),a.aprv_by from fms7_lc_mst a, fms7_lc_dtl b "
			+ "where a.customer_cd = b.customer_cd and a.lc_seq_no = b.lc_seq_no and a.financial_year = b.financial_year order by a.customer_cd";*/
	System.out.println("General Security list---"+SecurityGeneral);
	rset = stmt.executeQuery(SecurityGeneral);
	while(rset.next())
	{
		String split_cont_type="";//HARSH20201210
		String g_cont_ref = rset.getString(21)==null?"":rset.getString(21);
		if(g_cont_ref.contains("-"))
		{
			String act_cont_type[]= g_cont_ref.split("-"); //HARSH20201210
			split_cont_type = act_cont_type[0].charAt(0)+""; //HARSH20201210
		}
		String c_cd = rset.getString(1)==null?"":rset.getString(1);
		String cust_abbr = rset.getString(33)==null?"":rset.getString(33); //HARSH20210213
		String cust_query = "";//HARSH20201210
		/*if(split_cont_type.equals("B"))//HARSH20201210
		{
			cust_query ="select TRADER_NAME,TRADER_CD from FMS7_TRADER_MST B where TRADER_CD="+c_cd+" ";//HARSH20201210
		}
		else
		{
			cust_query = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+c_cd+"'";//HARSH20201210
		}*/
		cust_query = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"'";//HARSH20210213
		rset1 = stmt1.executeQuery(cust_query);
		if(rset1.next())
		{
			CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
			CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
		}else{
			cust_query ="select TRADER_NAME,TRADER_CD from FMS7_TRADER_MST where TRADER_ABBR='"+cust_abbr+"'";
			rset1 = stmt1.executeQuery(cust_query);
			if(rset1.next())
			{
				CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
				CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
			}else{
				CUSTOMER_CD.add("");
				CUSTOMER_NM.add("");
			}
		}
		String security_type = rset.getString(2)==null?"":rset.getString(2);
		//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
		/*if(security_type.equals("PCG"))
		{
			G_cont_ref.add("All");
		}
		else
		{*/
			//G_cont_ref.add(g_cont_ref==null?"":g_cont_ref);
			G_cont_ref.add(""+getDisplayDealId(g_cont_ref==null?"":g_cont_ref));
		//}
		G_lc_ty.add(security_type);
		G_deal_type.add(rset.getString(3)==null?"":rset.getString(3));
		//String guaran_cd = rset.getString(4)==null?"":rset.getString(4);
		String guaran_abbr = rset.getString(34)==null?"":rset.getString(34);//HARSH20210213
		String guaran_nm = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+guaran_abbr+"'";
		rset2=stmt2.executeQuery(guaran_nm);
		if(rset2.next())
		{
			G_guarantor_nm.add(rset2.getString(1)==null?"":rset2.getString(1));
		}
		else
		{
			guaran_nm = "SELECT TRADER_NAME FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+guaran_abbr+"'";
			rset2=stmt2.executeQuery(guaran_nm);
			if(rset2.next())
			{
				G_guarantor_nm.add(rset2.getString(1)==null?"":rset2.getString(1));
			}
			else
			{
				G_guarantor_nm.add("");
			}
		}
		G_currency.add(rset.getString(5)==null?"":rset.getString(5));
		G_value_vari.add(rset.getString(6)==null?"":rset.getString(6));
		double final_amt = Double.parseDouble(rset.getString(7)==null?"0":rset.getString(7));
		G_final_amt.add(nf.format(final_amt));
		G_value_fluc.add(rset.getString(8)==null?"":rset.getString(8));
		String iss_b_cd = rset.getString(9)==null?"":rset.getString(9);
		String iss_b_nm = "select bank_cd,bank_name,branch_name from fms7_bank_mst where bank_cd='"+iss_b_cd+"'";
		rset3 = stmt3.executeQuery(iss_b_nm);
		if(rset3.next())
		{
			G_iss_b_nm.add(rset3.getString(2)==null?"":rset3.getString(2));
		}
		else
		{
			G_iss_b_nm.add("");
		}
		G_iss_b_ref.add(rset.getString(10)==null?"":rset.getString(10));
		String avd_b_cd = rset.getString(11)==null?"":rset.getString(11);
		String avd_b_nm = "select bank_cd,bank_name,branch_name from fms7_bank_mst where bank_cd='"+avd_b_cd+"'";
		rset3 = stmt3.executeQuery(avd_b_nm);
		if(rset3.next())
		{
			G_avd_b_nm.add(rset3.getString(2)==null?"":rset3.getString(2));
		}
		else
		{
			G_avd_b_nm.add("");
		}
		G_avd_b_ref.add(rset.getString(12)==null?"":rset.getString(12));
		String confirm_b_cd = rset.getString(13)==null?"":rset.getString(13);
		String confirm_b_nm = "select bank_cd,bank_name,branch_name from fms7_bank_mst where bank_cd='"+confirm_b_cd+"'";
		rset3 = stmt3.executeQuery(confirm_b_nm);
		if(rset3.next())
		{
			G_confirm_b_nm.add(rset3.getString(2)==null?"":rset3.getString(2));
		}
		else
		{
			G_confirm_b_nm.add("");
		}
		G_confirm_b_ref.add(rset.getString(14)==null?"":rset.getString(14));
		G_sec_date.add(rset.getString(15)==null?"":rset.getString(15));
		G_st_date.add(rset.getString(16)==null?"":rset.getString(16));
		G_end_date.add(rset.getString(17)==null?"":rset.getString(17));
		G_renew_dt.add(rset.getString(18)==null?"":rset.getString(18));
		G_tenor.add(rset.getString(19)==null?"":rset.getString(19));
		G_remark.add(rset.getString(20)==null?"":rset.getString(20));
		if(rset.getString(22)!=null && rset.getString(23)==null)
		{
			G_iss_rece.add(rset.getString(22)==null?"":rset.getString(22));
		}else if(rset.getString(22)==null && rset.getString(23)!=null)
		{
			G_iss_rece.add(rset.getString(23)==null?"":rset.getString(23));
		}
		G_ent_dt.add(rset.getString(25)==null?"":rset.getString(25));
		String emp_cd = rset.getString(24)==null?"":rset.getString(24);
		String emp_nm_query = "select emp_nm from HR_EMP_MST where emp_cd = '"+emp_cd+"'";
		rset2 = stmt2.executeQuery(emp_nm_query);
		if(rset2.next())
		{
			G_emp_nm.add(rset2.getString(1)==null?"":rset2.getString(1));
		}
		G_aprv_dt.add(rset.getString(28)==null?"":rset.getString(28));
		String ap_emp = rset.getString(29)==null?"":rset.getString(29);
		//System.out.println("-------------------"+ap_emp);
		String ap_emp_nm_query = "select emp_nm from HR_EMP_MST where emp_cd = '"+ap_emp+"'";
		//System.out.println(ap_emp_nm_query);
		rset3 = stmt3.executeQuery(ap_emp_nm_query);
		if(rset3.next())
		{
			//System.out.println(rset3.getString(1));
			G_aprv_by.add(rset3.getString(1)==null?"":rset3.getString(1));
		}
		else
		{
			G_aprv_by.add("");
		}
		G_status.add(rset.getString(30)==null?"":rset.getString(30));
		G_seq_no.add(rset.getString(31)==null?"":rset.getString(31));
		G_sec_ref_no.add(rset.getString(32)==null?"":rset.getString(32));
		/*String g_fgsa_no = rset.getString(2)==null?"":rset.getString(2);
		String g_fgsa_rev_no = rset.getString(3)==null?"":rset.getString(3);
		String g_sn_no = rset.getString(4)==null?"":rset.getString(4);
		String g_sn_rev_no = rset.getString(5)==null?"":rset.getString(5);
		String g_cont_type = rset.getString(6)==null?"":rset.getString(6);*/
		
		//String g_cont_ref = g_cont_type+""+g_fgsa_no+"-"+g_fgsa_rev_no+"-"+g_sn_no+"-"+g_sn_rev_no;
		/*String security_type = rset.getString(21)==null?"":rset.getString(21);
		
		if(security_type.equals("PCG"))
		{
			G_cont_ref.add("All");
		}
		else
		{
			G_cont_ref.add(g_cont_ref==null?"":g_cont_ref);
		}*/
		//G_cont_ref.add(g_cont_ref==null?"":g_cont_ref);
		//G_st_date.add(rset.getString(7)==null?"":rset.getString(7));
		//G_end_date.add(rset.getString(8)==null?"":rset.getString(8));
		/*G_credit_rat.add(rset.getString(9)==null?"":rset.getString(9));
		G_rat_eff_date.add(rset.getString(10)==null?"":rset.getString(10));
		G_lc_ref_date.add(rset.getString(11)==null?"":rset.getString(11));
		double me_rate = Double.parseDouble(rset.getString(12)==null?"0":rset.getString(12));
		G_m_ex_rate.add(nf.format(me_rate));
		double clc_amt = Double.parseDouble(rset.getString(13)==null?"0":rset.getString(13));
		G_clc_amt.add(nf.format(clc_amt));
		double final_amt = Double.parseDouble(rset.getString(14)==null?"0":rset.getString(14));
		G_final_amt.add(nf.format(final_amt));
		//G_sec_date.add(rset.getString(15)==null?"":rset.getString(15));
		G_sn_du.add(rset.getString(16)==null?"":rset.getString(16));
		G_dcq.add(rset.getString(17)==null?"":rset.getString(17));
		G_lcq.add(rset.getString(18)==null?"":rset.getString(18));
		double s_rate = Double.parseDouble(rset.getString(19)==null?"0":rset.getString(19));
		G_s_rate.add(nf.format(s_rate));
		G_tax_per.add(rset.getString(20)==null?"":rset.getString(20));
		G_lc_ty.add(security_type);
		G_lc_base.add(rset.getString(22)==null?"":rset.getString(22));
		double e_rate = Double.parseDouble(rset.getString(23)==null?"0":rset.getString(23));
		G_e_rate.add(nf.format(e_rate));
		G_financial_y.add(rset.getString(24)==null?"":rset.getString(24));
		//G_remark.add(rset.getString(25)==null?"":rset.getString(25));
		//G_sec_ref_no.add(rset.getString(26)==null?"":rset.getString(26));
		//G_ent_dt.add(rset.getString(27)==null?"":rset.getString(27));
		//String emp_cd = rset.getString(28)==null?"":rset.getString(28);
		VCont_St_Dt.add(rset.getString(29)==null?"":rset.getString(29));
		VCont_End_Dt.add(rset.getString(30)==null?"":rset.getString(30));*/
		/*String emp_nm_query = "select emp_nm from HR_EMP_MST where emp_cd = '"+emp_cd+"'";
		rset2 = stmt2.executeQuery(emp_nm_query);
		if(rset2.next())
		{
			G_emp_nm.add(rset2.getString(1)==null?"":rset2.getString(1));
		}*/
		/*G_aprv_dt.add(rset.getString(31)==null?"":rset.getString(31));
		String ap_emp = rset.getString(32)==null?"":rset.getString(32);
		//System.out.println("-------------------"+ap_emp);
		String ap_emp_nm_query = "select emp_nm from HR_EMP_MST where emp_cd = '"+ap_emp+"'";
		//System.out.println(ap_emp_nm_query);
		rset3 = stmt3.executeQuery(ap_emp_nm_query);
		if(rset3.next())
		{
			//System.out.println(rset3.getString(1));
			G_aprv_by.add(rset3.getString(1)==null?"":rset3.getString(1));
		}
		else
		{
			G_aprv_by.add("");
		}*/
		
	}
}
catch(Exception e)
{
	e.printStackTrace();
}
}
Vector G_deal_type = new Vector();
public Vector getG_deal_type() {return G_deal_type;}
Vector G_guarantor_nm = new Vector();
public Vector getG_guarantor_nm() {return G_guarantor_nm;}
Vector G_currency = new Vector();
public Vector getG_currency() {return G_currency;}
Vector G_value_vari = new Vector();
public Vector getG_value_vari() {return G_value_vari;}
Vector G_value_fluc = new Vector();
public Vector getG_value_fluc() {return G_value_fluc;}
Vector G_iss_b_nm = new Vector();
public Vector getG_iss_b_nm() {return G_iss_b_nm;}
Vector G_iss_b_ref = new Vector();
public Vector getG_iss_b_ref() {return G_iss_b_ref;}
Vector G_avd_b_nm = new Vector();
public Vector getG_avd_b_nm() {return G_avd_b_nm;}
Vector G_avd_b_ref = new Vector();
public Vector getG_avd_b_ref() {return G_avd_b_ref;}
Vector G_confirm_b_nm = new Vector();
public Vector getG_confirm_b_nm() {return G_confirm_b_nm;}
Vector G_confirm_b_ref = new Vector();
public Vector getG_confirm_b_ref() {return G_confirm_b_ref;}
Vector G_renew_dt = new Vector();
public Vector getG_renew_dt() {return G_renew_dt;}
Vector G_tenor = new Vector();
public Vector getG_tenor() {return G_tenor;}
Vector G_iss_rece = new Vector();
public Vector getG_iss_rece() {return G_iss_rece;}
Vector G_status = new Vector();
public Vector getG_status() {return G_status;}

Vector G_seq_no = new Vector();
public Vector getG_seq_no() {return G_seq_no;}
Vector G_cont_ref = new Vector();
public Vector getG_cont_ref() {return G_cont_ref;}
Vector G_st_date = new Vector();
public Vector getG_st_date() {return G_st_date;}
Vector G_end_date = new Vector();
public Vector getG_end_date() {return G_end_date;}
Vector G_credit_rat = new Vector();
public Vector getG_credit_rat() {return G_credit_rat;}
Vector G_rat_eff_date = new Vector();
public Vector getG_rat_eff_date() {return G_rat_eff_date;}
Vector G_lc_ref_date = new Vector();
public Vector getG_lc_ref_date() {return G_lc_ref_date;}
Vector G_m_ex_rate = new Vector();
public Vector getG_m_ex_rate() {return G_m_ex_rate;}
Vector G_clc_amt = new Vector();
public Vector getG_clc_amt() {return G_clc_amt;}
Vector G_final_amt = new Vector();
public Vector getG_final_amt() {return G_final_amt;}
Vector G_sec_date = new Vector();
public Vector getG_sec_date() {return G_sec_date;}
Vector G_sn_du = new Vector();
public Vector getG_sn_du() {return G_sn_du;}
Vector G_dcq = new Vector();
public Vector getG_dcq() {return G_dcq;}
Vector G_lcq = new Vector();
public Vector getG_lcq() {return G_lcq;}
Vector G_s_rate = new Vector();
public Vector getG_s_rate() {return G_s_rate;}
Vector G_tax_per = new Vector();
public Vector getG_tax_per() {return G_tax_per;}
Vector G_lc_ty = new Vector();
public Vector getG_lc_ty() {return G_lc_ty;}
Vector G_lc_base = new Vector();
public Vector getG_lc_base() {return G_lc_base;}
Vector G_e_rate = new Vector();
public Vector getG_e_rate() {return G_e_rate;}
Vector G_financial_y = new Vector();
public Vector getG_financial_y() {return G_financial_y;}
Vector G_remark = new Vector();
public Vector getG_remark() {return G_remark;}
Vector G_sec_ref_no = new Vector();
public Vector getG_sec_ref_no() {return G_sec_ref_no;}
Vector G_ent_dt = new Vector();
public Vector getG_ent_dt() {return G_ent_dt;}
Vector G_emp_nm = new Vector();
public Vector getG_emp_nm() {return G_emp_nm;}
Vector G_aprv_dt = new Vector();
public Vector getG_aprv_dt() {return G_aprv_dt;}
Vector G_aprv_by = new Vector();
public Vector getG_aprv_by() {return G_aprv_by;}


Vector VCont_St_Dt = new Vector();
public Vector getVCont_St_Dt() {return VCont_St_Dt;}
Vector VCont_End_Dt = new Vector();
public Vector getVCont_End_Dt() {return VCont_End_Dt;}

////////////////////////////////////////////////////
	public String getContSt_dt() {
		return contSt_dt;
	}

	public void setContSt_dt(String contSt_dt) {
		this.contSt_dt = contSt_dt;
	}

	Vector ECContract_ref = new Vector();
	public Vector getECContract_ref() {return ECContract_ref;}
	Vector LC_method = new Vector();
	public Vector getLC_method() {return LC_method;}
	Vector Emp_nm = new Vector();
	public Vector getEmp_nm() {return Emp_nm;}
	Vector Ent_dt = new Vector();
	public Vector getEnt_dt() {return Ent_dt;}
	Vector Credit_limit = new Vector();
	public Vector getCredit_limit() {return Credit_limit;}
	Vector Cr_rating_amt = new Vector();
	public Vector getCr_rating_amt() {return Cr_rating_amt;}
	Vector Open_deal_amt = new Vector();
	public Vector getOpen_deal_amt() {return Open_deal_amt;}

	public Vector getVsec_dt() {
		return Vsec_dt;
	}

	public Vector getVSecurityTypeDesc() {
		return VSecurityTypeDesc;
	}

	public Vector getVfin_yr() {
		return Vfin_yr;
	}

	public Vector getVActual_seq_no() {
		return VActual_seq_no;
	}
	public String getContEnd_dt() {
		return contEnd_dt;
	}

	public void setContEnd_dt(String contEnd_dt) {
		this.contEnd_dt = contEnd_dt;
	}

	public Vector getVsec_ref_no() {
		return Vsec_ref_no;
	}

	public Vector getVflagSecurity() {
		return VflagSecurity;
	}
	////////////////////////SB20201010///////////////////////////////
	Vector VAprv_By = new Vector();
	public Vector getVAprv_By() {return VAprv_By;}
	Vector VAprv_Dt = new Vector();
	public Vector getVAprv_Dt() {return VAprv_Dt;}
///////////////////////////////////////////////////////////////

////////////MALVIKA20201016////////////////////////////

public void fetch_report_list() {
try {
String rpt_query = "SELECT a.customer_cd,b.fgsa_no,b.fgsa_rev_no,b.sn_no,b.sn_rev_no,b.cont_type,to_char(a.start_date,'DD/MM/YYYY'),to_char(a.end_date,'DD/MM/YYYY'),a.credit_rating,"
		+ "to_char(a.rating_eff_date,'DD/MM/YYYY'),to_char(a.lc_ref_date,'DD/MM/YYYY'),a.manual_exchg_rate,a.calc_lc_amount,a.final_lc_amount,to_char(a.sec_dt,'DD/MM/YYYY'),b.sn_duration,b.dcq,b.tcq,b.sales_rate,"
		+ "b.tax_percentage,b.lc_method,b.lc_base,b.exchg_rate,a.financial_year,a.remarks,a.sec_ref_no,to_char(a.ent_dt,'dd/mm/yyyy'),a.emp_cd,to_char(b.SN_START_DATE,'dd/mm/yyyy'),to_char(b.SN_END_DATE,'dd/mm/yyyy'),a.lc_seq_no,to_char(a.aprv_dt,'dd/mm/yyyy'),a.aprv_by,b.existing from fms7_lc_mst a, fms7_lc_dtl b "
		+ "where a.customer_cd = b.customer_cd and b.lc_method != 'OA' and a.lc_seq_no = b.lc_seq_no and a.financial_year = b.financial_year order by a.customer_cd";
System.out.println("Approve Report list---" + rpt_query);
rset = stmt.executeQuery(rpt_query);
while (rset.next()) {
	String c_cd = rset.getString(1) == null ? "" : rset.getString(1);
	String cust_query = "SELECT CUSTOMER_NAME,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='" + c_cd
			+ "'";
	rset1 = stmt1.executeQuery(cust_query);
	if (rset1.next()) {
		CUSTOMER_CD.add(rset1.getString(2) == null ? "" : rset1.getString(2));
		CUSTOMER_NM.add(rset1.getString(1) == null ? "" : rset1.getString(1));
	}

	String r_fgsa_no = rset.getString(2) == null ? "" : rset.getString(2);
	String r_fgsa_rev_no = rset.getString(3) == null ? "" : rset.getString(3);
	String r_sn_no = rset.getString(4) == null ? "" : rset.getString(4);
	String r_sn_rev_no = rset.getString(5) == null ? "" : rset.getString(5);
	String r_cont_type = rset.getString(6) == null ? "" : rset.getString(6);

	String r_cont_ref = r_cont_type + "" + r_fgsa_no + "-" + r_fgsa_rev_no + "-" + r_sn_no + "-"
			+ r_sn_rev_no;
	String security_type = rset.getString(21) == null ? "" : rset.getString(21);

	if (security_type.equals("PCG")) {
		R_cont_ref.add("All");
	} else {
		R_cont_ref.add(r_cont_ref == null ? "" : r_cont_ref);
	}
	// G_cont_ref.add(g_cont_ref==null?"":g_cont_ref);

	
	  R_fgsa_no.add(rset.getString(2)==null?"":rset.getString(2));
	  R_fgsa_rev_no.add(rset.getString(3)==null?"":rset.getString(3));
	 R_sn_no.add(rset.getString(4)==null?"":rset.getString(4));
	  R_sn_rev_no.add(rset.getString(5)==null?"":rset.getString(5));
	 

	R_st_date.add(rset.getString(7) == null ? "" : rset.getString(7));
	R_end_date.add(rset.getString(8) == null ? "" : rset.getString(8));
	R_credit_rat.add(rset.getString(9) == null ? "" : rset.getString(9));
	R_rat_eff_date.add(rset.getString(10) == null ? "" : rset.getString(10));
	R_lc_ref_date.add(rset.getString(11) == null ? "" : rset.getString(11));
	double me_rate = Double.parseDouble(rset.getString(12) == null ? "0" : rset.getString(12));
	R_m_ex_rate.add(nf.format(me_rate));
	double clc_amt = Double.parseDouble(rset.getString(13) == null ? "0" : rset.getString(13));
	R_clc_amt.add(nf.format(clc_amt));
	double final_amt = Double.parseDouble(rset.getString(14) == null ? "0" : rset.getString(14));
	R_final_amt.add(nf.format(final_amt));
	R_sec_date.add(rset.getString(15) == null ? "" : rset.getString(15));
	R_sn_du.add(rset.getString(16) == null ? "" : rset.getString(16));
	R_dcq.add(rset.getString(17) == null ? "" : rset.getString(17));
	R_lcq.add(rset.getString(18) == null ? "" : rset.getString(18));
	double s_rate = Double.parseDouble(rset.getString(19) == null ? "0" : rset.getString(19));
	R_s_rate.add(nf.format(s_rate));
	R_tax_per.add(rset.getString(20) == null ? "" : rset.getString(20));
	R_lc_ty.add(security_type);
	R_lc_base.add(rset.getString(22) == null ? "" : rset.getString(22));
	double e_rate = Double.parseDouble(rset.getString(23) == null ? "0" : rset.getString(23));
	R_e_rate.add(nf.format(e_rate));
	R_financial_y.add(rset.getString(24) == null ? "" : rset.getString(24));
	R_remark.add(rset.getString(25) == null ? "" : rset.getString(25));
	R_sec_ref_no.add(rset.getString(26) == null ? "" : rset.getString(26));
	R_ent_dt.add(rset.getString(27) == null ? "" : rset.getString(27));
	String emp_cd = rset.getString(28) == null ? "" : rset.getString(28);
	R_VCont_St_Dt.add(rset.getString(29) == null ? "" : rset.getString(29));
	R_VCont_End_Dt.add(rset.getString(30) == null ? "" : rset.getString(30));

	 R_lc_seq_no.add(rset.getString(31) == null ? "" : rset.getString(31));

	String emp_nm_query = "select emp_nm from HR_EMP_MST where emp_cd = '" + emp_cd + "'";
	rset2 = stmt2.executeQuery(emp_nm_query);
	if (rset2.next()) {
		R_emp_nm.add(rset2.getString(1) == null ? "" : rset2.getString(1));
	}
	if(rset.getString(32)== null)
	{
		R_aprv_status.add("Pending");
	}
	else
	{
		R_aprv_status.add("Approved");
	}
	R_aprv_dt.add(rset.getString(32)==null?"":rset.getString(32));
	String ap_emp = rset.getString(33)==null?"":rset.getString(33);
	String ap_emp_nm_query = "select emp_nm from HR_EMP_MST where emp_cd = '"+ap_emp+"'";
	rset3 = stmt3.executeQuery(ap_emp_nm_query);
	if(rset3.next())
	{
		R_aprv_by.add(rset3.getString(1)==null?"":rset3.getString(1));
	}
	else
	{
		R_aprv_by.add("");
	}
	R_exist.add(rset.getString(34)==null?"":rset.getString(34));
}
} catch (Exception e) {
e.printStackTrace();
}
}

Vector R_cont_ref = new Vector();

public Vector getR_cont_ref() {
return R_cont_ref;
}

Vector R_st_date = new Vector();

public Vector getR_st_date() {
return R_st_date;
}

Vector R_end_date = new Vector();

public Vector getR_end_date() {
return R_end_date;
}

Vector R_credit_rat = new Vector();

public Vector getR_credit_rat() {
return R_credit_rat;
}

Vector R_rat_eff_date = new Vector();

public Vector getR_rat_eff_date() {
return R_rat_eff_date;
}

Vector R_lc_ref_date = new Vector();

public Vector getR_lc_ref_date() {
return R_lc_ref_date;
}

Vector R_m_ex_rate = new Vector();

public Vector getR_m_ex_rate() {
return R_m_ex_rate;
}

Vector R_clc_amt = new Vector();

public Vector getR_clc_amt() {
return R_clc_amt;
}

Vector R_final_amt = new Vector();

public Vector getR_final_amt() {
return R_final_amt;
}

Vector R_sec_date = new Vector();

public Vector getR_sec_date() {
return R_sec_date;
}

Vector R_sn_du = new Vector();

public Vector getR_sn_du() {
return R_sn_du;
}

Vector R_dcq = new Vector();

public Vector getR_dcq() {
return R_dcq;
}

Vector R_lcq = new Vector();

public Vector getR_lcq() {
return R_lcq;
}

Vector R_s_rate = new Vector();

public Vector getR_s_rate() {
return R_s_rate;
}

Vector R_tax_per = new Vector();

public Vector getR_tax_per() {
return R_tax_per;
}

Vector R_lc_ty = new Vector();

public Vector getR_lc_ty() {
return R_lc_ty;
}

Vector R_lc_base = new Vector();

public Vector getR_lc_base() {
return R_lc_base;
}

Vector R_e_rate = new Vector();

public Vector getR_e_rate() {
return R_e_rate;
}

Vector R_financial_y = new Vector();

public Vector getR_financial_y() {
return R_financial_y;
}

Vector R_remark = new Vector();

public Vector getR_remark() {
return R_remark;
}

Vector R_sec_ref_no = new Vector();

public Vector getR_sec_ref_no() {
return R_sec_ref_no;
}

Vector R_ent_dt = new Vector();

public Vector getR_ent_dt() {
return R_ent_dt;
}

Vector R_emp_nm = new Vector();

public Vector getR_emp_nm() {
return R_emp_nm;
}

Vector R_VCont_St_Dt = new Vector();

public Vector getR_VCont_St_Dt() {
return R_VCont_St_Dt;
}

Vector R_VCont_End_Dt = new Vector();

public Vector getR_VCont_End_Dt() {
return R_VCont_End_Dt;
}


Vector R_lc_seq_no = new Vector(); public Vector getR_lc_seq_no() {return
R_lc_seq_no;}


Vector R_fgsa_no = new Vector(); public Vector getR_fgsa_no() {return
R_fgsa_no;}

Vector R_fgsa_rev_no = new Vector(); public Vector getR_fgsa_rev_no() {return
R_fgsa_rev_no;}

Vector R_sn_no = new Vector(); public Vector getR_sn_no() {return R_sn_no;}

Vector R_sn_rev_no = new Vector(); public Vector getR_sn_rev_no() {return
R_sn_rev_no;}

Vector R_aprv_dt = new Vector();            //HARSH20201021
public Vector getR_aprv_dt() {return R_aprv_dt;}
Vector R_aprv_status = new Vector();            //HARSH20201021
public Vector getR_aprv_status() {return R_aprv_status;}

Vector R_aprv_by = new Vector();
public Vector getR_aprv_by() {return R_aprv_by;}
Vector R_exist = new Vector(); //HARSH20201023
public Vector getR_exist() {return R_exist;}

/////////////////////////////////////////////////////	
//////////////////////HARSH20201026/////////////////////
private void AddColumnInLimitMst() throws SQLException
{
	try {
		int count=0;
		String s="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+
				" AND UPPER(COLUMN_NAME) LIKE 'BANK_CD'";
//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s);
		if(rset.next())
		{
			count=rset.getInt(1);
		}
		if(count==0)
		{
			s="ALTER TABLE FMS9_LIMIT_MST ADD BANK_CD NUMBER(6)";
			stmt.executeUpdate(s);
			conn.commit();
		}
		conn.commit();
	}
	catch(Exception e)
	{
		conn.rollback();
		e.printStackTrace();
	}
	
}
/////////////////////////////////////////////////////

////////////////////////HARSH20201017///////////////////////
public void fetch_credit_limit_list()
{
	try
	{
		Check_Credit_Limit_Expired(); //HARSH20210331
		
		int count=0;
		String s="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'PARENT_ENT_DT'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s);
		if(rset.next())
		{
			count=rset.getInt(1);
		}
		if(count==0)
		{
			s="ALTER TABLE FMS9_LIMIT_MST ADD PARENT_ENT_DT DATE";
			stmt.executeUpdate(s);
			conn.commit();
		}
		int count1=0;
		String s1="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'PARENT_EXIT_DT'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s1);
		if(rset.next())
		{
			count1=rset.getInt(1);
		}
		if(count1==0)
		{
			s1="ALTER TABLE FMS9_LIMIT_MST ADD PARENT_EXIT_DT DATE";
			stmt.executeUpdate(s1);
			conn.commit();
		}
		int count2=0; 
		String s2="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+ //HARSH20201208
				" AND UPPER(COLUMN_NAME) LIKE 'BUY_SELL'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s2);
		if(rset.next())
		{
			count2=rset.getInt(1);
		}
		if(count2==0)
		{
			s2="ALTER TABLE FMS9_LIMIT_MST ADD BUY_SELL CHAR(1)";
			stmt.executeUpdate(s2);
			conn.commit();
		}
		int count3=0; 
		String s3="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_DTL' "+ //HARSH20201208
				" AND UPPER(COLUMN_NAME) LIKE 'BUY_SELL'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s3);
		if(rset.next())
		{
			count3=rset.getInt(1);
		}
		if(count3==0)
		{
			s3="ALTER TABLE FMS9_LIMIT_DTL ADD BUY_SELL CHAR(1)";
			stmt.executeUpdate(s3);
			conn.commit();
		}
		int count4=0; 
		String s4="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+ //HARSH20201208
				" AND UPPER(COLUMN_NAME) LIKE 'CUST_ABBR'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s4);
		if(rset.next())
		{
			count4=rset.getInt(1);
		}
		if(count4==0)
		{
			s4="ALTER TABLE FMS9_LIMIT_MST ADD CUST_ABBR VARCHAR2(10)";
			stmt.executeUpdate(s4);
			conn.commit();
		}
		int count5=0; 
		String s5="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_DTL' "+ //HARSH20201208
				" AND UPPER(COLUMN_NAME) LIKE 'CUST_ABBR'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s5);
		if(rset.next())
		{
			count5=rset.getInt(1);
		}
		if(count5==0)
		{
			s5="ALTER TABLE FMS9_LIMIT_DTL ADD CUST_ABBR VARCHAR2(10)";
			stmt.executeUpdate(s5);
			conn.commit();
		}
		int count6=0; 
		String s6="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+ //HARSH20201208
				" AND UPPER(COLUMN_NAME) LIKE 'PARENT_OWNSHIP_ABBR'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s6);
		if(rset.next())
		{
			count6=rset.getInt(1);
		}
		if(count6==0)
		{
			s6="ALTER TABLE FMS9_LIMIT_MST ADD PARENT_OWNSHIP_ABBR VARCHAR2(10)";
			stmt.executeUpdate(s6);
			conn.commit();
		}
		
		int count7=0; 
		String s7="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_DTL' "+ //HARSH20210127
				" AND UPPER(COLUMN_NAME) LIKE 'REF_NO'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s7);
		if(rset.next())
		{
			count7=rset.getInt(1);
		}
		if(count7==0)
		{
			s7="ALTER TABLE FMS9_LIMIT_DTL ADD REF_NO VARCHAR2(20)";
			stmt.executeUpdate(s7);
			conn.commit();
		}
		int count8=0; 
		String s8="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_DTL' "+ //HARSH20210127
				" AND UPPER(COLUMN_NAME) LIKE 'INACTIVATION_DT'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s8);
		if(rset.next())
		{
			count8=rset.getInt(1);
		}
		if(count8==0)
		{
			s8="ALTER TABLE FMS9_LIMIT_DTL ADD INACTIVATION_DT DATE";
			stmt.executeUpdate(s8);
			conn.commit();
		}
		int count9=0; 
		String s9="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_LIMIT_MST' "+ //HARSH20210127
				" AND UPPER(COLUMN_NAME) LIKE 'REF_NO'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s9);
		if(rset.next())
		{
			count9=rset.getInt(1);
		}
		if(count9==0)
		{
			s9="ALTER TABLE FMS9_LIMIT_MST ADD REF_NO VARCHAR2(20)";
			stmt.executeUpdate(s9);
			conn.commit();
		}
		int count10=0; 
		String s10="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS7_BANK_MST' "+ //HARSH20210127
				" AND UPPER(COLUMN_NAME) LIKE 'BANK_ABBR'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s10);
		if(rset.next())
		{
			count10=rset.getInt(1);
		}
		if(count10==0)
		{
			s10="ALTER TABLE FMS7_BANK_MST ADD BANK_ABBR VARCHAR2(20)";
			stmt.executeUpdate(s10);
			conn.commit();
		}
		/*queryString="select bank_cd,bank_name from fms7_bank_mst where bank_abbr is null";
		rset=stmt.executeQuery(queryString);
		while(rset.next())
		{
			String bankcd = rset.getString(1)==null?"":rset.getString(1);
			String bank_nm = rset.getString(2)==null?"":rset.getString(2);
			String split_b_nm[] = bank_nm.split(" ");
			String bankAbbr="";
			for(int a=0;a<split_b_nm.length; a++)
			{
				bankAbbr+=split_b_nm[a].charAt(0);
			}
			bankAbbr=bankAbbr.toUpperCase();
			queryString1="UPDATE FMS7_BANK_MST SET BANK_ABBR='"+bankAbbr+"' WHERE BANK_CD='"+bankcd+"'";
			stmt1.executeUpdate(queryString1);
			conn.commit();
		}*/
		//////////////////////////
		String bank_name = "select bank_cd,bank_name,branch_name from fms7_bank_mst order by bank_name";
		rset1 = stmt.executeQuery(bank_name);
		while(rset1.next())
		{
			VLimit_bank_cd.add(rset1.getString(1)==null?"":rset1.getString(1));
			VLimit_bank_nm.add(rset1.getString(2)==null?"":rset1.getString(2));
			VLimit_bank_branch_nm.add(rset1.getString(3)==null?"":rset1.getString(3));
		}
		////////////////////////////
		String parent_cust_nm="";
		/*HARSH20201229 if(sell_buy.equals("B"))
		{*/
			//parent_cust_nm = "select TRADER_NAME,TRADER_CD from FMS7_TRADER_MST order by TRADER_NAME";
			
		/*HARSH20201229 }
		else
		{*/
			//parent_cust_nm = "select customer_name,customer_cd from FMS7_CUSTOMER_MST order by customer_name";
		//}
		createCustomerMst();//HARSH20210107
		/*HARSH20210107 parent_cust_nm = "select customer_name,customer_cd,customer_abbr from FMS7_CUSTOMER_MST order by customer_name";
		rset1 = stmt1.executeQuery(parent_cust_nm);
		while(rset1.next())
		{
			VParent_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
			VParent_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
			VParent_abbr.add(rset1.getString(3)==null?"":rset1.getString(3));//HARSH20210106
			VSell_Buy_Indicator.add("S");//HARSH20201229
		}
		parent_cust_nm = "select TRADER_NAME,TRADER_CD,trader_abbr from FMS7_TRADER_MST order by TRADER_NAME";
		rset1 = stmt1.executeQuery(parent_cust_nm);
		while(rset1.next())
		{
			VParent_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
			VParent_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
			VParent_abbr.add(rset1.getString(3)==null?"":rset1.getString(3));//HARSH20210106
			VSell_Buy_Indicator.add("B");//HARSH20201229
		}*/
		//////////////////////////////////////////
		//HARSH20210107 String rating_dtl = "select credit_rating,to_char(rating_eff_date,'dd/mm/yyyy'),parent_ownship_cd,parent_ownship,remarks,status,limit_id,bank_cd,cust_cd,to_char(parent_ent_dt,'dd/mm/yyyy'),to_char(parent_exit_dt,'dd/mm/yyyy'),to_char(ent_dt,'dd/mm/yyyy') from fms9_limit_mst where (cust_abbr='"+Lcust_cd+"' or bank_cd='"+Lbank_cd+"') order by limit_id desc"; //and buy_sell='"+sell_buy+"'
		String rating_dtl = "select credit_rating,to_char(rating_eff_date,'dd/mm/yyyy'),parent_ownship_abbr,parent_ownship,remarks,status,limit_id,bank_cd,cust_abbr,to_char(parent_ent_dt,'dd/mm/yyyy'),to_char(parent_exit_dt,'dd/mm/yyyy'),to_char(ent_dt,'dd/mm/yyyy'),ref_no,cust_abbr from fms9_limit_mst where (cust_abbr='"+Lcust_cd+"' or bank_cd='"+Lbank_cd+"') order by limit_id desc"; //and buy_sell='"+sell_buy+"' 
		//System.out.println(rating_dtl);
		rset = stmt.executeQuery(rating_dtl);
		while(rset.next())
		{	//For radio btn enable disabled
			String tempId = rset.getString(7)==null?"":rset.getString(7);
			if(rset.getRow()>1){
				queryString = "select nvl(count(*),0) from fms9_limit_mst where (cust_abbr='"+Lcust_cd+"' or bank_cd='"+Lbank_cd+"') and limit_id='"+tempId+"' and parent_ownship_abbr is not null and parent_exit_dt <= to_date((select to_char(sysdate,'dd/mm/yyyy') from dual),'dd/mm/yyyy')";
				rset1=stmt1.executeQuery(queryString);
				if(rset1.next())
				{
					if(rset1.getInt(1)==0){
						VYesNo.add("N");
					}else{
						VYesNo.add("Y");
					}
				}
			}else{
				VYesNo.add("N");
			}
			///////////////////////////////
			Vcredit_rating.add(rset.getString(1)==null?"":rset.getString(1));
			Vrating_eff_dt.add(rset.getString(2)==null?"":rset.getString(2));
			String cabbr = rset.getString(14)==null?"":rset.getString(14); //HARSH20210302
			String par_cd = rset.getString(3)==null?"0":rset.getString(3);
			if(cabbr.equalsIgnoreCase("BANK")) //HARSH20210302
			{
				String par_cust_nm = "select bank_name,bank_cd from fms7_bank_mst where bank_abbr='"+par_cd+"'";
				rset1 = stmt1.executeQuery(par_cust_nm);
				if(rset1.next())
				{
					Vparent_ownship_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
					Vparent_ownship_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
				}
				else
				{
					Vparent_ownship_cd.add("");
					Vparent_ownship_nm.add("");
				}
			}
			else //HARSH20210302
			{
				String par_cust_nm = "select customer_name,customer_abbr from FMS7_CUSTOMER_MST where customer_abbr='"+par_cd+"'";
				rset1 = stmt1.executeQuery(par_cust_nm);
				if(rset1.next())
				{
					Vparent_ownship_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
					Vparent_ownship_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
				}
				else
				{
					par_cust_nm = "select trader_name,trader_abbr from FMS7_TRADER_MST where trader_abbr='"+par_cd+"'";
					rset1 = stmt1.executeQuery(par_cust_nm);
					if(rset1.next())
					{
						Vparent_ownship_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
						Vparent_ownship_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
					}else{
						Vparent_ownship_cd.add("");
						Vparent_ownship_nm.add("");
					}
				}
			}
			//Vparent_ownship_nm.add();
			Vparent_ownship_per.add(rset.getString(4)==null?"":rset.getString(4));
			Vremarks.add(rset.getString(5)==null?"":rset.getString(5));
			Vstatus.add(rset.getString(6)==null?"":rset.getString(6));
			Vlimit_id_mst.add(rset.getString(7)==null?"":rset.getString(7));
			Vparent_ent_dt.add(rset.getString(10)==null?"":rset.getString(10));
			Vparent_exit_dt.add(rset.getString(11)==null?"":rset.getString(11));
			Vent_dt.add(rset.getString(12)==null?"":rset.getString(12));
			Vrating_ref_no.add(rset.getString(13)==null?"":rset.getString(13));//HARSH20210127
		}
		////////////////////////
		String q_cust_nm ="";
		q_cust_nm = "select customer_name,customer_cd,customer_abbr from FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Lcust_cd+"'";
		rset1 = stmt1.executeQuery(q_cust_nm);
		if(rset1.next())
		{
			CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
			CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
			CUSTOMER_ABBR.add(rset1.getString(3)==null?"":rset1.getString(3));  //HARSH20210122
		}else{
			q_cust_nm = "select TRADER_NAME,TRADER_CD,TRADER_ABBR from FMS7_TRADER_MST where TRADER_ABBR = '"+Lcust_cd+"'";
			rset1 = stmt1.executeQuery(q_cust_nm);
			if(rset1.next())
			{
				CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
				CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
				CUSTOMER_ABBR.add(rset1.getString(3)==null?"":rset1.getString(3));  //HARSH20210122
			}
		}
		String show_bank_name = "select bank_cd,bank_name,branch_name,bank_abbr from fms7_bank_mst where bank_cd='"+Lbank_cd+"'";
		rset1 = stmt.executeQuery(show_bank_name);
		while(rset1.next())
		{
			VShow_bank_cd.add(rset1.getString(1)==null?"":rset1.getString(1));
			VShow_bank_nm.add(rset1.getString(2)==null?"":rset1.getString(2));
			VShow_bank_branch_nm.add(rset1.getString(3)==null?"":rset1.getString(3));
			VShow_bank_abbr.add(rset1.getString(4)==null?"":rset1.getString(4));//HARSH20210128
		}
		String SysDate="";
		String findDate = "Select to_char(sysdate,'dd/mm/yyyy'),to_char(sysdate+6,'dd/mm/yyyy') from dual";
		rset=stmt.executeQuery(findDate);
		if(rset.next())
		{
			SysDate=rset.getString(1)==null?"":rset.getString(1);
			NextSevenDayDt = rset.getString(2)==null?"":rset.getString(2);
		}
		String q_limit_mgt_list = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,b.cust_abbr,b.remarks,b.flag,to_char(b.inactivation_dt,'dd/mm/yyyy'),b.ref_no,to_char(b.ent_dt,'dd/mm/yyyy') from fms9_limit_mst a,fms9_limit_dtl b "
				+ "where (a.cust_abbr='"+Lcust_cd+"' or a.bank_cd='"+Lbank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id order by b.eff_dt";// and b.flag='Y'  //and a.buy_sell = b.buy_sell and a.buy_sell = '"+sell_buy+"' 
		//HARSH20210122 and (b.exp_dt >= TO_DATE('"+SysDate+"','DD/MM/YYYY') or b.exp_dt is null)
		//HARSH20210122 WE ADD CONDITION LIKE EXP_DT IS NULL AS PER CUSTOMER FEEDBACK NOW EXP_DT IS NOT MANDATORY FIELD
		rset1 = stmt1.executeQuery(q_limit_mgt_list);
		while(rset1.next())
		{
			Vamt.add(nf.format(Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1))));
			Vamt_unit.add(nf.format(Double.parseDouble(rset1.getString(2)==null?"0":rset1.getString(2))));
			Vamt_adj.add(nf.format(Double.parseDouble(rset1.getString(3)==null?"0":rset1.getString(3))));
			Vusage_amt.add(nf.format(Double.parseDouble(rset1.getString(4)==null?"0":rset1.getString(4))));
			/*double amt = Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1));
			double usage_amt = Double.parseDouble(rset1.getString(4)==null?"0":rset1.getString(4));
			double total_amt = amt - usage_amt ;
			System.out.println("Toatl amt -----"+total_amt);
			Vamt.add(nf.format(total_amt));*/
			
			Vlimitid.add(rset1.getString(5)==null?"":rset1.getString(5));
			Vlimitty.add(rset1.getString(6)==null?"":rset1.getString(6));
			if(rset1.getString(6)!= null)
			{
				if(rset1.getString(6).equals("Unsecured"))
				{
					Vunsecu_amt.add(nf.format(Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1))));
					Vtemp_amt.add(nf.format(0));
				}
				else if(rset1.getString(6).equals("Temporary"))
				{
					Vtemp_amt.add(nf.format(Double.parseDouble(rset1.getString(1)==null?"0":rset1.getString(1))));
					Vunsecu_amt.add(nf.format(0));
				}
				else
				{
					Vunsecu_amt.add(nf.format(0));
					Vtemp_amt.add(nf.format(0));
				}
			}
			else
			{
				Vunsecu_amt.add(nf.format(0));
				Vtemp_amt.add(nf.format(0));
			}
			Vseq_no.add(rset1.getString(7)==null?"":rset1.getString(7));
			Vaction_type.add(rset1.getString(8)==null?"":rset1.getString(8));
			Veff_dt.add(rset1.getString(9)==null?"":rset1.getString(9));
			Vexp_dt.add(rset1.getString(10)==null?"":rset1.getString(10));
			Vreview_dt.add(rset1.getString(11)==null?"":rset1.getString(11));
			Vuser_type.add(rset1.getString(12)==null?"":rset1.getString(12));
			String dtl_cust_cd = rset1.getString(13)==null?"":rset1.getString(13);
			/*HARSH20210107 if(!dtl_cust_cd.equals("0"))
			{
				String cust_nm = "select customer_name,customer_cd from FMS7_CUSTOMER_MST where customer_abbr='"+dtl_cust_cd+"'";
				//System.out.println(cust_nm);
				rset3 = stmt3.executeQuery(cust_nm);
				if(rset3.next())
				{
					VDtl_cust_cd.add(rset3.getString(2)==null?"":rset3.getString(2));
					VDtl_cust_nm.add(rset3.getString(1)==null?"":rset3.getString(1));
				}
			}
			else
			{
				VDtl_cust_cd.add("");
				VDtl_cust_nm.add("");
			}*/
			VDtl_cust_cd.add(dtl_cust_cd);
			Vdtl_rmk.add(rset1.getString(14)==null?"":rset1.getString(14));
			String status = rset1.getString(15)==null?"":rset1.getString(15);
			if(status.equals("Y"))
			{
				Vlimit_status.add("Active");
			}
			else if(status.equals("N"))
			{
				Vlimit_status.add("Inactive");
			}
			else
			{
				Vlimit_status.add("");
			}
			Vinactivation_dt.add(rset1.getString(16)==null?"":rset1.getString(16)); //HARSH20210127
			Vref_no.add(rset1.getString(17)==null?"":rset1.getString(17)); //HARSH20210127
			Vactivation_dt.add(rset1.getString(18)==null?"":rset1.getString(18)); //HARSH20210128
			
			//HARSH20210331 IF EFFECTIVE_DATE <= SYSDATE THEN RADIO BUTTON IS DISABLED AS PER FEEDBACK ON 30/03/2021
			String eff_dt = rset1.getString(9)==null?"":rset1.getString(9);
			queryString = "SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+eff_dt+"','DD/MM/YYYY') <= TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY'),'DD/MM/YYYY')";
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				if(rset.getInt(1) > 0)
				{
					Veff_dt_flag.add("Y");
				}
				else
				{
					Veff_dt_flag.add("N");
				}
			}
		}
		double available = 0;
		double total_limit = 0;
		double unsecured = 0;
		double temporary =0;
		double adjust_usage = 0;
		double net_usage = 0;
		double usage = 0;
		double used = 0;
		
		/*HARSH20210127 String limitSummray = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,b.cust_abbr,b.remarks from fms9_limit_mst a,fms9_limit_dtl b "
				+ "where (a.cust_abbr='"+Lcust_cd+"' or a.bank_cd='"+Lbank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id and eff_dt <= to_date('"+SysDate+"','dd/mm/yyyy') and (exp_dt >= to_date('"+SysDate+"','dd/mm/yyyy') or exp_dt is null) "; //and a.buy_sell = b.buy_sell and a.buy_sell = '"+sell_buy+"' */
		/*HARSH20210130 String limitSummray = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,b.cust_abbr,b.remarks from fms9_limit_mst a,fms9_limit_dtl b "
				+ "where (a.cust_abbr='"+Lcust_cd+"' or a.bank_cd='"+Lbank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id and eff_dt <= to_date('"+SysDate+"','dd/mm/yyyy') and ((inactivation_dt < exp_dt) and (inactivation_dt > to_date('"+SysDate+"','dd/mm/yyyy')) or ((exp_dt < inactivation_dt) and (exp_dt >= to_date('"+SysDate+"','dd/mm/yyyy'))) or (exp_dt is null and inactivation_dt > to_date('"+SysDate+"','dd/mm/yyyy')) or (exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+SysDate+"','dd/mm/yyyy')))";*/ //and a.buy_sell = b.buy_sell and a.buy_sell = '"+sell_buy+"'
		String limitSummray = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,b.cust_abbr,b.remarks from fms9_limit_mst a,fms9_limit_dtl b "
				+ "where (a.cust_abbr='"+Lcust_cd+"' or a.bank_cd='"+Lbank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id and eff_dt <= to_date('"+SysDate+"','dd/mm/yyyy') and ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+SysDate+"','DD/MM/YYYY') and inactivation_dt is null) or ((exp_dt >= to_date('"+SysDate+"','DD/MM/YYYY') or exp_dt is null) and inactivation_dt-1 >= to_date('"+SysDate+"','DD/MM/YYYY')))";
		//HARSH20210130 ONLY CHANGE QUERY LOGIC AND "INACTIVATION_DT-1" AS PER CUSTOMER FEEDBACK ON 29/01/2021
		//HARSH20210127 NOW MATCH EXP_DT AND INACTIVATION_DT WHICH ONE IS LESS DATE THAT IS OUR EXPIRATION DAYE AS PER CUSTOMER FEEDBACK ON 27/01/2021
		//HARSH20210122 and b.flag='Y'"
		//HARSH20210122 WE ADD CONDITION LIKE EXP_DT IS NULL AS PER CUSTOMER FEEDBACK NOW EXP_DT IS NOT MANDATORY FIELD
		System.out.println("limitSummray--"+limitSummray);
		rset2 = stmt2.executeQuery(limitSummray);
		while(rset2.next())
		{
			//Calculation for Limit summary
			String action_ty = rset2.getString(8)==null?"":rset2.getString(8);
			String limit_ty = rset2.getString(6)==null?"":rset2.getString(6);
			double amt = Double.parseDouble(rset2.getString(1)==null?"0":rset2.getString(1));
						
			if(!limit_ty.equals("Unsecured") && action_ty.equals("Adjust Usage"))
			{
				adjust_usage = adjust_usage + amt;
			}
			if(limit_ty.equals("Unsecured") && action_ty.equals("Adjust Limit"))
			{
				unsecured = unsecured + amt;
			}
			if(limit_ty.equals("Temporary") && action_ty.equals("Adjust Limit"))
			{
				temporary = temporary + amt;
			}	
			if(action_ty.equals("Adjust Limit"))
			{
				total_limit = total_limit + amt;
			}
		}
		
		//HARSH20210303 USAGE CALCULATION
		if(!Lcust_cd.equals(""))
		{
			usage = limit_usage_calculation(Lcust_cd);
		}
		System.out.println("usage ## "+nf.format(usage));
		////
		available = total_limit + adjust_usage - usage;
		net_usage = usage - adjust_usage;
		if(total_limit > 0)
			used = usage / total_limit;
		else
			used = 0;
		
		Vavailable.add(nf.format(available));
		Vtotal_limit.add(nf.format(total_limit));
		Vunsecured.add(nf.format(unsecured));
		Vtemporary.add(nf.format(temporary));
		Vadjust_usage.add(nf.format(adjust_usage));
		Vusage.add(nf.format(usage));
		Vnet_usage.add(nf.format(net_usage));
		Vused.add(nf.format(used));
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}
String NextSevenDayDt = new String(); //HARSH20210303
public String getNextSevenDayDt(){return NextSevenDayDt;} //HARSH20210303

Vector VYesNo = new Vector();
public Vector getVYesNo() {return VYesNo;} //For enable/disable radio btn

Vector VSell_Buy_Indicator = new Vector();//HARSH20201229
public Vector getVSell_Buy_Indicator() {return VSell_Buy_Indicator;} // Sell/Buy Indicator HARSH20201229


String Lcust_cd = "";
public void setLcust_cd(String Lcust_cd) {this.Lcust_cd = Lcust_cd;}
String Lbank_cd = "";
public void setLbank_cd(String Lbank_cd) {this.Lbank_cd = Lbank_cd;}

Vector VParent_cd = new Vector();
public Vector getVParent_cd() {return VParent_cd;}
Vector VParent_nm = new Vector();
public Vector getVParent_nm() {return VParent_nm;}
Vector VParent_abbr = new Vector(); //HARSH20210106
public Vector getVParent_abbr() {return VParent_abbr;} //HARSH20210106

Vector VDtl_cust_cd = new Vector();
public Vector getVDtl_cust_cd() {return VDtl_cust_cd;}
Vector VDtl_cust_nm = new Vector();
public Vector getVDtl_cust_nm() {return VDtl_cust_nm;}


Vector VShow_bank_cd = new Vector();
public Vector getVShow_bank_cd() {return VShow_bank_cd;}
Vector VShow_bank_nm = new Vector();
public Vector getVShow_bank_nm() {return VShow_bank_nm;}
Vector VShow_bank_branch_nm = new Vector();
public Vector getVShow_bank_branch_nm() {return VShow_bank_branch_nm;}
Vector VShow_bank_abbr = new Vector();//HARSH20210128
public Vector getVShow_bank_abbr() {return VShow_bank_abbr;}//HARSH20210128

Vector VLimit_bank_cd = new Vector();
public Vector getVLimit_bank_cd() {return VLimit_bank_cd;}
Vector VLimit_bank_nm = new Vector();
public Vector getVLimit_bank_nm() {return VLimit_bank_nm;}
Vector VLimit_bank_branch_nm = new Vector();
public Vector getVLimit_bank_branch_nm() {return VLimit_bank_branch_nm;}

Vector VLbank_cd = new Vector();
public Vector getVLbank_cd() {return VLbank_cd;}
Vector VLbank_nm = new Vector();
public Vector getVLbank_nm() {return VLbank_nm;}
Vector Vcredit_rating = new Vector();
public Vector getVcredit_rating() {return Vcredit_rating;}
Vector Vrating_eff_dt = new Vector();
public Vector getVrating_eff_dt() {return Vrating_eff_dt;}
Vector Vparent_ownship_cd = new Vector();
public Vector getVparent_ownship_cd() {return Vparent_ownship_cd;}
Vector Vparent_ownship_nm = new Vector();
public Vector getVparent_ownship_nm() {return Vparent_ownship_nm;}
Vector Vparent_ownship_per = new Vector();
public Vector getVparent_ownship_per() {return Vparent_ownship_per;}
Vector Vremarks = new Vector();
public Vector getVremarks() {return Vremarks;}
Vector Vstatus = new Vector();
public Vector getVstatus() {return Vstatus;}
Vector Vlimit_id_mst = new Vector();
public Vector getVlimit_id_mst() {return Vlimit_id_mst;}
Vector Vparent_ent_dt = new Vector();
public Vector getVparent_ent_dt() {return Vparent_ent_dt;}
Vector Vparent_exit_dt = new Vector();
public Vector getVparent_exit_dt() {return Vparent_exit_dt;}
Vector Vent_dt = new Vector();
public Vector getVent_dt() {return Vent_dt;}


Vector Vamt = new Vector();
public Vector getVamt() {return Vamt;}
Vector Vamt_unit = new Vector();
public Vector getVamt_unit() {return Vamt_unit;}
Vector Vamt_adj = new Vector();
public Vector getVamt_adj() {return Vamt_adj;}
Vector Vusage_amt = new Vector();
public Vector getVusage_amt() {return Vusage_amt;}
Vector Vlimitid = new Vector();
public Vector getVlimitid() {return Vlimitid;}
Vector Vunsecu_amt = new Vector();
public Vector getVunsecu_amt() {return Vunsecu_amt;}
Vector Vtemp_amt = new Vector();
public Vector getVtemp_amt() {return Vtemp_amt;}
Vector Vseq_no = new Vector();
public Vector getVseq_no() {return Vseq_no;}
Vector Vlimitty = new Vector();
public Vector getVlimitty() {return Vlimitty;}
Vector Vaction_type = new Vector();
public Vector getVaction_type() {return Vaction_type;}
Vector Veff_dt = new Vector();
public Vector getVeff_dt() {return Veff_dt;}
Vector Veff_dt_flag = new Vector(); //HARSH20210331
public Vector getVeff_dt_flag() {return Veff_dt_flag;} //HARSH20210331
Vector Vexp_dt = new Vector();
public Vector getVexp_dt() {return Vexp_dt;}
Vector Vreview_dt = new Vector();
public Vector getVreview_dt() {return Vreview_dt;}
Vector Vuser_type = new Vector();
public Vector getVuser_type() {return Vuser_type;}
Vector Vdtl_rmk = new Vector();
public Vector getVdtl_rmk() {return Vdtl_rmk;}
Vector Vlimit_status = new Vector();
public Vector getVlimit_status() {return Vlimit_status;}

Vector Vinactivation_dt = new Vector();//HARSH20210127
public Vector getVinactivation_dt() {return Vinactivation_dt;}//HARSH20210127
Vector Vref_no = new Vector();//HARSH20210127
public Vector getVref_no() {return Vref_no;}//HARSH20210127
Vector Vrating_ref_no = new Vector();//HARSH20210127
public Vector getVrating_ref_no() {return Vrating_ref_no;}//HARSH20210127
Vector Vactivation_dt = new Vector();//HARSH20210128
public Vector getVactivation_dt() {return Vactivation_dt;}//HARSH20210128

Vector Vavailable = new Vector();
public Vector getVavailable() {return Vavailable;}
Vector Vtotal_limit = new Vector();
public Vector getVtotal_limit() {return Vtotal_limit;}
Vector Vunsecured = new Vector();
public Vector getVunsecured() {return Vunsecured;}
Vector Vtemporary = new Vector();
public Vector getVtemporary() {return Vtemporary;}
Vector Vadjust_usage = new Vector();
public Vector getVadjust_usage() {return Vadjust_usage;}
Vector Vusage = new Vector();
public Vector getVusage() {return Vusage;}
Vector Vnet_usage = new Vector();
public Vector getVnet_usage() {return Vnet_usage;}
Vector Vused = new Vector();
public Vector getVused() {return Vused;}
///////////////////////////////////////////////////////////
////////////////HARSH20201023////////////////////////////

public void fetch_security_post()
{
	try
	{
		int count=0;
		String s="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'MAPPING_ID'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s);
		if(rset.next())
		{
			count=rset.getInt(1);
		}
		if(count==0)
		{
			s="ALTER TABLE FMS9_SECURITY_POST_MST ADD MAPPING_ID VARCHAR2(40 BYTE)";
			stmt.executeUpdate(s);
			conn.commit();
		}
		String custcd = "select customer_name,customer_cd from FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+cust_cd+"'";
		rset = stmt.executeQuery(custcd);
		if(rset.next()) {
			CUSTOMER_CD.add(rset.getString(2) == null ? "" : rset.getString(2));
			CUSTOMER_NM.add(rset.getString(1) == null ? "" : rset.getString(1));
		}
		String bank_name = "select bank_cd,bank_name,branch_name from fms7_bank_mst order by bank_name";
		rset1 = stmt.executeQuery(bank_name);
		while(rset1.next())
		{
			Vbank_cd.add(rset1.getString(1)==null?"":rset1.getString(1));
			Vbank_nm.add(rset1.getString(2)==null?"":rset1.getString(2));
			Vbank_branch_nm.add(rset1.getString(3)==null?"":rset1.getString(3));
		}
		
		String fetch_list = "select SEC_TYPE,DEAL_TYPE,CURRENCY,VARIATION_VALUE,VALUE,VALUE_FLUC,ISS_BANK_CD,ISS_BANK_REF,ADV_BANK_CD,"
				+ " ADV_BANK_REF,CONFIRM_BANK_CD,CONFIRM_BANK_REF,TO_CHAR(REC_DT,'DD/MM/YYYY'),TO_CHAR(ISSU_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),"
				+ " TENOR,STATUS,REMARKS,MAPPING_ID,ISSUED,RECEIVED,SEQ_NO,TO_CHAR(RENEW_DT,'DD/MM/YYYY'),MAPPING_ID,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,TO_CHAR(APRV_DT,'DD/MM/YYYY'),APRV_BY,GUARANTOR_NM,LINK from FMS9_SECURITY_POST_MST where customer_cd='"+cust_cd+"' and LINK='"+mappingID+"'";
		System.out.println(fetch_list);
		rset2 = stmt2.executeQuery(fetch_list);
		while(rset2.next())
		{
			VSec_ty.add(rset2.getString(1)==null?"":rset2.getString(1));
			VDeal_ty.add(rset2.getString(2)==null?"":rset2.getString(2));
			VCurrency.add(rset2.getString(3)==null?"":rset2.getString(3));
			VValue_vari.add(rset2.getString(4)==null?"":rset2.getString(4));
			VValue.add(rset2.getString(5)==null?"":rset2.getString(5));
			VValue_fluc.add(rset2.getString(6)==null?"":rset2.getString(6));
			String b1_cd=rset2.getString(7)==null?"":rset2.getString(7);
			String b1 = "select bank_cd,bank_name,branch_name from fms7_bank_mst where bank_cd='"+b1_cd+"'";
			rset=stmt.executeQuery(b1);
			if(rset.next())
			{
				VIss_bank_cd.add(rset.getString(1)==null?"":rset.getString(1));
				VIss_bank_nm.add(rset.getString(2)==null?"":rset.getString(2));
				//VIss_bank_nm.add(rset.getString(3)==null?"":rset.getString(3));
			}
			else
			{
				VIss_bank_cd.add("");
				VIss_bank_nm.add("");
				//VIss_bank_branch_nm.add("");
			}
			VIss_bank_ref.add(rset2.getString(8)==null?"":rset2.getString(8));
			String b2_cd=rset2.getString(9)==null?"":rset2.getString(9);
			String b2 = "select bank_cd,bank_name,branch_name from fms7_bank_mst where bank_cd='"+b2_cd+"'";
			rset=stmt.executeQuery(b2);
			if(rset.next())
			{
				VAdv_bank_cd.add(rset.getString(1)==null?"":rset.getString(1));
				VAdv_bank_nm.add(rset.getString(2)==null?"":rset.getString(2));
				//VAdv_bank_branch_nm.add(rset.getString(3)==null?"":rset.getString(3));
			}
			else
			{
				VAdv_bank_cd.add("");
				VAdv_bank_nm.add("");
				//VAdv_bank_branch_nm.add("");
			}
			VAdv_bank_ref.add(rset2.getString(10)==null?"":rset2.getString(10));
			String b3_cd=rset2.getString(11)==null?"":rset2.getString(11);
			String b3 = "select bank_cd,bank_name,branch_name from fms7_bank_mst where bank_cd='"+b3_cd+"'";
			rset=stmt.executeQuery(b3);
			if(rset.next())
			{
				VConfi_bank_cd.add(rset.getString(1)==null?"":rset.getString(1));
				VConfi_bank_nm.add(rset.getString(2)==null?"":rset.getString(2));
				//VConfi_bank_branch_nm.add(rset.getString(3)==null?"":rset.getString(3));
			}
			else
			{
				VConfi_bank_cd.add("");
				VConfi_bank_nm.add("");
				//VConfi_bank_branch_nm.add("");
			}
			VConfi_bank_ref.add(rset2.getString(12)==null?"":rset2.getString(12));
			VReceived_dt.add(rset2.getString(13)==null?"":rset2.getString(13));
			VIssuance_dt.add(rset2.getString(14)==null?"":rset2.getString(14));
			VExpire_dt.add(rset2.getString(15)==null?"":rset2.getString(15));
			VTenor.add(rset2.getString(16)==null?"":rset2.getString(16));
			VStatus.add(rset2.getString(17)==null?"":rset2.getString(17));
			VRemarks.add(rset2.getString(18)==null?"":rset2.getString(18));
			VLink.add(rset2.getString(19)==null?"":rset2.getString(19));
			if(rset2.getString(20)!=null && rset2.getString(21)==null)
			{
				VIssuedReceived.add(rset2.getString(20)==null?"":rset2.getString(20));
			}else if(rset2.getString(20)==null && rset2.getString(21)!=null)
			{
				VIssuedReceived.add(rset2.getString(21)==null?"":rset2.getString(21));
			}
			//VIssuedReceived.add(rset2.getString(20)==null?"":rset2.getString(20));
			//VIssuedReceived.add(rset2.getString(21)==null?"":rset2.getString(21));
			VSeq_no.add(rset2.getString(22)==null?"":rset2.getString(22));
			VRenew_dt.add(rset2.getString(23)==null?"":rset2.getString(23));
			VLinked.add(rset2.getString(24)==null?"":rset2.getString(24));
			VModify_dt.add(rset2.getString(25)==null?"":rset2.getString(25));
			String md_cd = rset2.getString(26)==null?"":rset2.getString(26);
			String md_emp_nm = "select emp_nm from HR_EMP_MST where emp_cd = '"+md_cd+"'";
			rset3=stmt3.executeQuery(md_emp_nm);
			if(rset3.next())
			{
				VModify_by.add(rset3.getString(1)==null?"":rset3.getString(1));
			}
			else
			{
				VModify_by.add("");
			}
			VAprv_dt.add(rset2.getString(27)==null?"":rset2.getString(27));
			String ap_cd = rset2.getString(28)==null?"":rset2.getString(28);
			String ap_emp_nm = "select emp_nm from HR_EMP_MST where emp_cd = '"+ap_cd+"'";
			rset3=stmt3.executeQuery(ap_emp_nm);
			if(rset3.next())
			{
				VAprv_by.add(rset3.getString(1)==null?"":rset3.getString(1));
			}
			else
			{
				VAprv_by.add("");
			}
			String guranator_cd = rset2.getString(29)==null?"":rset2.getString(29);
			String guranator_nm = "select customer_name,customer_cd from FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+guranator_cd+"'";
			rset1 = stmt1.executeQuery(guranator_nm);
			if(rset1.next())
			{
				Vguranator_cd.add(rset1.getString(2) == null ? "" : rset1.getString(2));
				Vguranator_nm.add(rset1.getString(1) == null ? "" : rset1.getString(1));
			}
			else
			{
				Vguranator_cd.add("");
				Vguranator_nm.add("");
			}
			String secTy = rset2.getString(1)==null?"":rset2.getString(1);
			if(secTy.equals("PCG"))
			{
				Vmapping_id.add("All");
			}
			else
			{
				Vmapping_id.add(rset2.getString(30)==null?"":rset2.getString(30));
			}
			//Vmapping_id.add(rset2.getString(30)==null?"":rset2.getString(30));
		}
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}

public void fetch_CR_security_post()
{
	try
	{
		int count=0;
		String s="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'MAPPING_ID'";
		rset=stmt.executeQuery(s);
		if(rset.next()){
			count=rset.getInt(1);
		}
		if(count==0){
			s="ALTER TABLE FMS9_SECURITY_POST_MST ADD MAPPING_ID VARCHAR2(40 BYTE)";
			stmt.executeUpdate(s);
			conn.commit();
		}
		int count1=0;
		String s1="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'REVIEW_DT'";
		rset=stmt.executeQuery(s1);
		if(rset.next()){
			count1=rset.getInt(1);
		}
		if(count1==0){
			s1="ALTER TABLE FMS9_SECURITY_POST_MST ADD REVIEW_DT DATE";
			stmt.executeUpdate(s1);
			conn.commit();
		}
		int count2=0;
		String s2="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'REF_NO'";
		rset=stmt.executeQuery(s2);
		if(rset.next()){
			count2=rset.getInt(1);
		}
		if(count2==0){
			s2="ALTER TABLE FMS9_SECURITY_POST_MST ADD REF_NO VARCHAR2(20 BYTE)";
			stmt.executeUpdate(s2);
			conn.commit();
		}
		int count3=0;
		String s3="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'CUSTOMER_ABBR'";
		rset=stmt.executeQuery(s3);
		if(rset.next()){
			count3=rset.getInt(1);
		}
		if(count3==0){
			s3="ALTER TABLE FMS9_SECURITY_POST_MST ADD CUSTOMER_ABBR VARCHAR2(10 BYTE)";
			stmt.executeUpdate(s3);
			conn.commit();
		}
		int count4=0;
		String s4="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'GUARANTOR_ABBR'";
		rset=stmt.executeQuery(s4);
		if(rset.next()){
			count4=rset.getInt(1);
		}
		if(count4==0){
			s4="ALTER TABLE FMS9_SECURITY_POST_MST ADD GUARANTOR_ABBR VARCHAR2(10 BYTE)";
			stmt.executeUpdate(s4);
			conn.commit();
		}
		////HARSH20210410
		int count5=0;
		String s5="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'CANCEL_DT'";
		rset=stmt.executeQuery(s5);
		if(rset.next()){
			count5=rset.getInt(1);
		}
		if(count5==0){
			s5="ALTER TABLE FMS9_SECURITY_POST_MST ADD CANCEL_DT DATE";
			stmt.executeUpdate(s5);
			conn.commit();
		}
		int count6=0;
		String s6="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'LOG_FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'CANCEL_DT'";
		rset=stmt.executeQuery(s6);
		if(rset.next()){
			count6=rset.getInt(1);
		}
		if(count6==0){
			s6="ALTER TABLE LOG_FMS9_SECURITY_POST_MST ADD CANCEL_DT DATE";
			stmt.executeUpdate(s6);
			conn.commit();
		}
		int count7=0;
		String s7="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'INORDER_HIST'";
		rset=stmt.executeQuery(s7);
		if(rset.next()){
			count7=rset.getInt(1);
		}
		if(count7==0){
			s7="ALTER TABLE FMS9_SECURITY_POST_MST ADD INORDER_HIST CHAR(1)";
			stmt.executeUpdate(s7);
			conn.commit();
		}
		int count8=0;
		String s8="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'LOG_FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'INORDER_HIST'";
		rset=stmt.executeQuery(s8);
		if(rset.next()){
			count8=rset.getInt(1);
		}
		if(count8==0){
			s8="ALTER TABLE LOG_FMS9_SECURITY_POST_MST ADD INORDER_HIST CHAR(1)";
			stmt.executeUpdate(s8);
			conn.commit();
		}
		//replaceData();
		/////////////////////HARSH20201230////Merge Sell/Buy both customer mst and treder mst/////////
	/*HARSH20210213	queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where  "
				+ " eff_dt<=(select max(eff_dt) from fms7_customer_mst where eff_dt<=to_date('"+to_date+"','dd/mm/yyyy')) ORDER BY CUSTOMER_NAME";
		rset = stmt.executeQuery(queryString);
		while(rset.next())
		{
			VCust_Nm.add(rset.getString(2)==null?"":rset.getString(2));
			VCust_Abbr.add(rset.getString(1)==null?"":rset.getString(1));	
			VCust_Cd.add(rset.getString(3)==null?"":rset.getString(3));	
			VSell_Buy_Indicator.add("S"); //HARSH20201230
		}
		queryString ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST order by trader_name";
		rset = stmt.executeQuery(queryString);
		while(rset.next())
		{
			VCust_Nm.add(rset.getString(2)==null?"":rset.getString(2));
			VCust_Abbr.add(rset.getString(1)==null?"":rset.getString(1));	
			VCust_Cd.add(rset.getString(3)==null?"":rset.getString(3));	
			VSell_Buy_Indicator.add("B"); //HARSH20201230
		} */
		////////////////////////////////////////////////////
		
		/////////////HARSH20210213///Merge Sell/Buy both customer mst and treder mst/////////
		queryString="select distinct(a.CUSTOMER_CD),a.customer_name,a.customer_abbr from FMS7_CUSTOMER_MST a "
				+ "where a.eff_dt = (select max(b.Eff_dt) from FMS7_CUSTOMER_MST b where a.customer_cd=b.customer_cd) " 
				+ " order by a.customer_name";
		//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
		rset=stmt.executeQuery(queryString);
		while(rset.next())
		{
			VCust_Cd.add(rset.getString(1)==null?"":rset.getString(1));
			VCust_Nm.add(rset.getString(2)==null?"":rset.getString(2));
			VCust_Abbr.add(rset.getString(3)==null?"":rset.getString(3));//HARSH20210106
			VTemp_CustAbbr.add(rset.getString(3)==null?"":rset.getString(3));
		}
		queryString = "select distinct(a.TRADER_CD),a.TRADER_NAME,a.trader_abbr from FMS7_TRADER_MST a "
				+ "where a.eff_dt = (select max(b.eff_Dt) from FMS7_TRADER_MST b where a.TRADER_CD=b.TRADER_CD) order by a.TRADER_NAME";
		//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
		rset1 = stmt1.executeQuery(queryString);
		while(rset1.next())
		{
			String abbr = rset1.getString(3)==null?"":rset1.getString(3);
			int j =0;
			for(int i=0; i<VTemp_CustAbbr.size(); i++)
			{
				if(VTemp_CustAbbr.elementAt(i).equals(abbr))
				{
					j=j+1;
				}
			}
			if(j==0)
			{
				VCust_Cd.add(rset1.getString(1)==null?"":rset1.getString(1));
				VCust_Nm.add(rset1.getString(2)==null?"":rset1.getString(2));
				VCust_Abbr.add(rset1.getString(3)==null?"":rset1.getString(3));//HARSH20210106
			}
		}
		/////////////////////////////////////////////////////////////////////////////////////
		String q = ""; String cust_abbr="";
		/*HARSH20210213 if(sell_buy.equals("B"))
		{
			q="like 'B%'";
			cust_abbr = "select TRADER_ABBR from FMS7_TRADER_MST where TRADER_CD='"+cust_cd+"'";
		}
		else
		{
			q="not like 'B%'";
			cust_abbr = "select customer_abbr from fms7_customer_mst where customer_cd='"+cust_cd+"'";
		}
		//////cust abbr
		 System.out.println("cust_abbr--"+cust_abbr);
		rset=stmt.executeQuery(cust_abbr);
		if(rset.next())
		{
			CUSTOMER_ABBR.add(rset.getString(1)==null?"":rset.getString(1));
		}*/
		//////////////////////
		queryString="select customer_cd from fms7_customer_mst where customer_abbr='"+Customer_ABBR+"'";
		rset=stmt.executeQuery(queryString);
		if(rset.next())
		{
			VTEMP_CUST_CD.add(rset.getString(1)==null?"":rset.getString(1));
		}else{
			queryString="select TRADER_CD from FMS7_TRADER_MST where TRADER_ABBR='"+Customer_ABBR+"'";
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				VTEMP_CUST_CD.add(rset.getString(1)==null?"":rset.getString(1));
			}
		}
		String bank_name = "select bank_cd,bank_name,branch_name from fms7_bank_mst order by bank_name";
		rset1 = stmt.executeQuery(bank_name);
		while(rset1.next())
		{
			Vbank_cd.add(rset1.getString(1)==null?"":rset1.getString(1));
			Vbank_nm.add(rset1.getString(2)==null?"":rset1.getString(2));
			Vbank_branch_nm.add(rset1.getString(3)==null?"":rset1.getString(3));
		}
		String SysDate="";
		String findDate = "Select to_char(sysdate,'dd/mm/yyyy') from dual";
		rset=stmt.executeQuery(findDate);
		if(rset.next())
		{
			SysDate=rset.getString(1)==null?"":rset.getString(1);
		}
		
//HARSH20210213		String fetch_list = "select SEC_TYPE,DEAL_TYPE,CURRENCY,VARIATION_VALUE,VALUE,VALUE_FLUC,ISS_BANK_CD,ISS_BANK_REF,ADV_BANK_CD,"
//				+ " ADV_BANK_REF,CONFIRM_BANK_CD,CONFIRM_BANK_REF,TO_CHAR(REC_DT,'DD/MM/YYYY'),TO_CHAR(ISSU_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),"
//				+ " TENOR,STATUS,REMARKS,MAPPING_ID,ISSUED,RECEIVED,SEQ_NO,TO_CHAR(RENEW_DT,'DD/MM/YYYY'),MAPPING_ID,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,TO_CHAR(APRV_DT,'DD/MM/YYYY'),APRV_BY,CUSTOMER_CD,GUARANTOR_NM,LINK,TO_CHAR(REVIEW_DT,'DD/MM/YYYY'),REF_NO from FMS9_SECURITY_POST_MST"
//				+ " where customer_cd='"+cust_cd+"' and sec_type != 'OA' and ((exp_dt >= to_date('"+SysDate+"','dd/mm/yyyy') or status !='In order') or exp_dt IS NULL) and link "+q+" order by ent_dt DESC";
				
		String fetch_list = "select SEC_TYPE,DEAL_TYPE,CURRENCY,VARIATION_VALUE,VALUE,VALUE_FLUC,ISS_BANK_CD,ISS_BANK_REF,ADV_BANK_CD,"
				+ " ADV_BANK_REF,CONFIRM_BANK_CD,CONFIRM_BANK_REF,TO_CHAR(REC_DT,'DD/MM/YYYY'),TO_CHAR(ISSU_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),"
				+ " TENOR,STATUS,REMARKS,MAPPING_ID,ISSUED,RECEIVED,SEQ_NO,TO_CHAR(RENEW_DT,'DD/MM/YYYY'),MAPPING_ID,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,TO_CHAR(APRV_DT,'DD/MM/YYYY'),APRV_BY,CUSTOMER_CD,GUARANTOR_ABBR,LINK,TO_CHAR(REVIEW_DT,'DD/MM/YYYY'),REF_NO,CUSTOMER_ABBR,TO_CHAR(CANCEL_DT,'DD/MM/YYYY') "
				+ "from FMS9_SECURITY_POST_MST"
				+ " WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' and sec_type != 'OA' and ((exp_dt >= to_date('"+SysDate+"','dd/mm/yyyy') or status !='In order') or exp_dt IS NULL) and (flag!='N' or flag is null) order by ent_dt DESC";
		//HARSH20210212 ADDED CUSTOMER_ABBR //NOW WE USE CUSTOMER_ABBR INSTAED OF CUSTOMER_CD
		System.out.println("fetch_list--"+fetch_list);
		rset2 = stmt2.executeQuery(fetch_list);
		while(rset2.next())
		{
			String contType = rset2.getString(31)==null?"":rset2.getString(31);//HARSH20201206
			String macth_contType="";
			if(contType.contains("-"))
			{
				String act_cont_type[]= contType.split("-");
				macth_contType=act_cont_type[0].charAt(0)+"";
			}
			/*if(!macth_contType.equals("B"))
			{*/
				VSec_ty.add(rset2.getString(1)==null?"":rset2.getString(1));
				VDeal_ty.add(rset2.getString(2)==null?"":rset2.getString(2));
				VCurrency.add(rset2.getString(3)==null?"":rset2.getString(3));
				VValue_vari.add(rset2.getString(4)==null?"":rset2.getString(4));
				VValue.add(rset2.getString(5)==null?"":rset2.getString(5));
				VValue_fluc.add(rset2.getString(6)==null?"":rset2.getString(6));
				
				String b1_cd=rset2.getString(7)==null?"":rset2.getString(7);
				String iss_bank_nm = BankName(b1_cd);
				VIss_bank_cd.add(b1_cd);
				VIss_bank_nm.add(iss_bank_nm);
				VIss_bank_ref.add(rset2.getString(8)==null?"":rset2.getString(8));
				
				String b2_cd=rset2.getString(9)==null?"":rset2.getString(9);
				String adv_bank_nm = BankName(b2_cd);
				VAdv_bank_cd.add(b2_cd);
				VAdv_bank_nm.add(adv_bank_nm);
				VAdv_bank_ref.add(rset2.getString(10)==null?"":rset2.getString(10));
				
				String b3_cd=rset2.getString(11)==null?"":rset2.getString(11);
				String confi_bank_nm = BankName(b3_cd);
				VConfi_bank_cd.add(b3_cd);
				VConfi_bank_nm.add(confi_bank_nm);
				VConfi_bank_ref.add(rset2.getString(12)==null?"":rset2.getString(12));
				
				VReceived_dt.add(rset2.getString(13)==null?"":rset2.getString(13));
				VIssuance_dt.add(rset2.getString(14)==null?"":rset2.getString(14));
				VExpire_dt.add(rset2.getString(15)==null?"":rset2.getString(15));
				VTenor.add(rset2.getString(16)==null?"":rset2.getString(16));
				VStatus.add(rset2.getString(17)==null?"":rset2.getString(17));
				VRemarks.add(rset2.getString(18)==null?"":rset2.getString(18));
				VLink.add(rset2.getString(19)==null?"":rset2.getString(19));
				if(rset2.getString(20)!=null && rset2.getString(21)==null)
				{
					VIssuedReceived.add(rset2.getString(20)==null?"":rset2.getString(20));
				}else if(rset2.getString(20)==null && rset2.getString(21)!=null)
				{
					VIssuedReceived.add(rset2.getString(21)==null?"":rset2.getString(21));
				}
				//VIssuedReceived.add(rset2.getString(20)==null?"":rset2.getString(20));
				//VIssuedReceived.add(rset2.getString(21)==null?"":rset2.getString(21));
				VSeq_no.add(rset2.getString(22)==null?"":rset2.getString(22));
				VRenew_dt.add(rset2.getString(23)==null?"":rset2.getString(23));
				VLinked.add(rset2.getString(24)==null?"":rset2.getString(24));
				VModify_dt.add(rset2.getString(25)==null?"":rset2.getString(25));
				String md_cd = rset2.getString(26)==null?"":rset2.getString(26);
				String md_emp_nm = "select emp_nm from HR_EMP_MST where emp_cd = '"+md_cd+"'";
				rset3=stmt3.executeQuery(md_emp_nm);
				if(rset3.next())
				{
					VModify_by.add(rset3.getString(1)==null?"":rset3.getString(1));
				}
				else
				{
					VModify_by.add("");
				}
				VAprv_dt.add(rset2.getString(27)==null?"":rset2.getString(27));
				String ap_cd = rset2.getString(28)==null?"":rset2.getString(28);
				String ap_emp_nm = "select emp_nm from HR_EMP_MST where emp_cd = '"+ap_cd+"'";
				rset3=stmt3.executeQuery(ap_emp_nm);
				if(rset3.next())
				{
					VAprv_by.add(rset3.getString(1)==null?"":rset3.getString(1));
				}
				else
				{
					VAprv_by.add("");
				}
				/*String p_c_cd = rset2.getString(29)==null?"":rset2.getString(29);
				String custcd ="";
				if(macth_contType.equals("B"))
				{
					custcd = "select TRADER_NAME,TRADER_CD from FMS7_TRADER_MST where TRADER_CD='"+p_c_cd+"'";
				}
				else
				{
					custcd = "select customer_name,customer_cd from FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+p_c_cd+"'";
				}*/
				//HARSH20210213
				String abbr = rset2.getString(34)==null?"":rset2.getString(34);
				String c_abbr="";
				c_abbr = "select customer_name,customer_cd,customer_abbr from FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+abbr+"'";
				rset = stmt.executeQuery(c_abbr);
				if(rset.next()) {
					CUSTOMER_CD.add(rset.getString(2) == null ? "" : rset.getString(2));
					CUSTOMER_NM.add(rset.getString(1) == null ? "" : rset.getString(1));
					CUSTOMER_ABBR.add(rset.getString(3) == null ? "" : rset.getString(3));
				}else{
					c_abbr = "select TRADER_NAME,TRADER_CD,TRADER_ABBR from FMS7_TRADER_MST where TRADER_ABBR='"+abbr+"'";
					rset = stmt.executeQuery(c_abbr);
					if(rset.next()) {
						CUSTOMER_CD.add(rset.getString(2) == null ? "" : rset.getString(2));
						CUSTOMER_NM.add(rset.getString(1) == null ? "" : rset.getString(1));
						CUSTOMER_ABBR.add(rset.getString(3) == null ? "" : rset.getString(3));
					}else{
						CUSTOMER_CD.add("0");
						CUSTOMER_NM.add("");
						CUSTOMER_ABBR.add("");
					}
				}
				////
				String guranator_ABBR = rset2.getString(30)==null?"":rset2.getString(30);
				String guranator_nm = "select customer_name,customer_cd,customer_abbr from FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+guranator_ABBR+"'";
				rset1 = stmt1.executeQuery(guranator_nm);
				if(rset1.next())
				{
					Vguranator_abbr.add(rset1.getString(3) == null ? "" : rset1.getString(3));
					Vguranator_cd.add(rset1.getString(2) == null ? "" : rset1.getString(2));
					Vguranator_nm.add(rset1.getString(1) == null ? "" : rset1.getString(1));
				}else{
					guranator_nm = "select trader_name,trader_cd,trader_abbr from FMS7_TRADER_MST WHERE TRADER_ABBR='"+guranator_ABBR+"'";
					rset1 = stmt1.executeQuery(guranator_nm);
					if(rset1.next())
					{
						Vguranator_abbr.add(rset1.getString(3) == null ? "" : rset1.getString(3));
						Vguranator_cd.add(rset1.getString(2) == null ? "" : rset1.getString(2));
						Vguranator_nm.add(rset1.getString(1) == null ? "" : rset1.getString(1));
					}else{
						Vguranator_abbr.add("");
						Vguranator_cd.add("");
						Vguranator_nm.add("");
					}
				}
				String secTy = rset2.getString(1)==null?"":rset2.getString(1);
				
				//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
				/*HARSH20210130 if(secTy.equals("PCG"))
				{
					Vmapping_id.add("All");
				}
				else
				{*/
				
					Vmapping_id.add(rset2.getString(31)==null?"":rset2.getString(31));
					String dealno = rset2.getString(31)==null?"":rset2.getString(31);
					VDeal_NO.add(""+getDisplayDealId(dealno)); //HARSH20220228
					VDealId_Display.add(""+getDisplayDealId(dealno)); //HARSH20220228
				//}
				VReview_dt.add(rset2.getString(32)==null?"":rset2.getString(32));
				VRef_no.add(rset2.getString(33)==null?"":rset2.getString(33));
				VLink_seq_no.add("");
				VCancelled_DT.add(rset2.getString(35)==null?"":rset2.getString(35));
			//}
				
			//FOR CANCELLED STATUS HARSH20210331
			/*String modify_dt = rset2.getString(25)==null?"":rset2.getString(25);
			queryString = "SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+modify_dt+"','DD/MM/YYYY') > TO_DATE(TO_CHAR(SYSDATE,'DD/MM/YYYY'),'DD/MM/YYYY')";
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				if(rset.getInt(1) > 0)
				{
					VCancelled_Flag.add("Y");
				}
				else
				{
					VCancelled_Flag.add("N");
				}
			}*/
		}
		String fromdt="";
		String enddt="";
		String temp = "";
		System.out.println("#######"+sell_buy);
		//if(sell_buy.equals("S"))
		//{
			String queryString1 ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE from FMS7_SN_MST A where A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "+ 
			 	//SB20200912	"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
			 	//HARSH20210319	"(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			 		" END_DT >= to_date('"+to_date+"','dd/mm/yyyy') AND "+ //HARSH20210319
			 		//SB20200919	"(SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			//System.out.println(queryString1);
			rset = stmt.executeQuery(queryString1);
			while(rset.next())
			{
				VDealUniqueId.add("S"+rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4));
				String sn_ref_no = rset.getString(9)==null?"":rset.getString(9);
				if(!sn_ref_no.equals("")) {
					sn_ref_no = "["+sn_ref_no+"]";
				}
				VCollMgmtDealId_Display.add("S"+rset.getString(6)+"-"+rset.getString(3)+"  "+sn_ref_no); //HARSH20210722 AS PER INCIDENT ID#112
				fromdt = rset.getString(1)==null?"":rset.getString(1);
				enddt = rset.getString(2)==null?"":rset.getString(2);
				temp = fromdt+"   -   "+enddt;
				CARGO_ARRIVAL_DATE.add(temp);
				VSegment.add("");//HARSH20211220
			}
			String queryString2 =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
					"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE  from FMS7_LOA_MST A where A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "+ 
					//HARSH20210319 "(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND " +
					" A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy') AND " +//HARSH20210319
					//SB20200919			"(A.SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
					"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
					"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			//System.out.println(queryString2);
			rset1 = stmt1.executeQuery(queryString2);
			while(rset1.next())
			{
				VDealUniqueId.add("L"+rset1.getString(6)+"-0"+"-"+rset1.getString(3)+"-"+rset1.getString(4));
				String sn_ref_no = rset1.getString(8)==null?"":rset1.getString(8);
				if(!sn_ref_no.equals("")) {
					sn_ref_no = "["+sn_ref_no+"]";
				}
				VCollMgmtDealId_Display.add("L"+rset1.getString(6)+"-"+rset1.getString(3)+"  "+sn_ref_no);//HARSH20210722 AS PER INCIDENT ID#112
				fromdt = rset1.getString(1)==null?"":rset1.getString(1);
				enddt = rset1.getString(2)==null?"":rset1.getString(2);
				temp = fromdt+"   -   "+enddt;
				CARGO_ARRIVAL_DATE.add(temp);
				VSegment.add("");//HARSH20211220
			}
			String queryString3 = "select TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'), " +
					"mapping_id from FMS8_LNG_REGAS_MST C where " +
					//HARSH20210319 "(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					//"A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy') AND C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND C.MAPPING_ID = A.MAPPING_ID";
					" CN_NO != 0 AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy') AND C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) ";
			//System.out.println(queryString3);
			rset2 = stmt2.executeQuery(queryString3);
			while(rset2.next())
			{
				String map_id=rset2.getString(3)==null?"":rset2.getString(3);
				String[] deal_temp = map_id.split("-");
				VDealUniqueId.add("C"+map_id);
				VCollMgmtDealId_Display.add("C"+deal_temp[1]+"-"+deal_temp[3]);
				fromdt = rset2.getString(1)==null?"":rset2.getString(1);
				enddt = rset2.getString(2)==null?"":rset2.getString(2);
				temp = fromdt+"   -   "+enddt;
				CARGO_ARRIVAL_DATE.add(temp);
				VSegment.add("");//HARSH20211220
			}
		//}
		//else if(sell_buy.equals("B"))
		//{
			queryString = "SELECT TO_CHAR(A.DELV_FROM_DT,'DD/MM/YYYY'), TO_CHAR(A.DELV_TO_DT,'DD/MM/YYYY'),A.MAN_CONF_CD,A.CARGO_SEQ_NO,E.TRD_CD, A.MAN_CD, A.MAN_CD, A.CONFIRM_VOL,"
					+ "A.CARGO_REF_CD,to_char(C.MAN_CONF_DT,'dd/mm/yyyy'), A.PRICE,A.EMP_CD,TO_CHAR(A.ENT_DT,'dd/mm/yyyy'), A.EMP_CD,TO_CHAR(A.ENT_DT,'dd/mm/yyyy'), E.PRICE_TYPE, A.PRICE_TO, A.REMARK  "+
					" FROM FMS7_MAN_CONFIRM_CARGO_DTL A, FMS7_MAN_CONFIRM_MST C, FMS7_MAN_REQ_MST E WHERE E.TRD_CD=(SELECT TRADER_CD FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"')) AND "+
			///		" A.DELV_FROM_DT BETWEEN TO_DATE('"+SearchDtFrom+"','DD/MM/YYYY') AND TO_DATE('"+SearchDtTo+"','DD/MM/YYYY') "
					" A.DELV_TO_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') "
					+ "AND E.MAN_CD=A.MAN_CD AND "+ 
			///		" A.UNIT_CD=C.UNIT_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD='"+VCAR_REF_NO_temp.elementAt(i)+"' "+ 
					" A.MAN_CONF_CD=C.MAN_CONF_CD AND A.CARGO_STATUS='T' AND CARGO_REF_CD LIKE '%' "+ 
					" ORDER BY A.MAN_CONF_CD, A.CARGO_REF_CD";
			System.out.println("CARGO: "+queryString);
			rset = stmt.executeQuery(queryString);
			////System.out.println("FOr SN : "+to_date+" "+from_date);
			while(rset.next())
			{		
				String map_id=rset.getString(3)+"-"+rset.getString(4);
				VDealUniqueId.add("B"+map_id);
				VCollMgmtDealId_Display.add("B"+map_id);
				fromdt = rset.getString(1)==null?"":rset.getString(1);
				enddt = rset.getString(2)==null?"":rset.getString(2);
				temp = fromdt+"   -   "+enddt;
				CARGO_ARRIVAL_DATE.add(temp);
				VSegment.add("");//HARSH20211220
			}
			
			////HARSH20211220 DLNG DEAL NO 
			queryString1 ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FLSA_NO,A.FLSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE "
			 		+ "from DLNG_SN_MST A where A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "+ 
			 	//SB20200912	"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
			 	//HARSH20210319	"(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			 		" END_DT >= to_date('"+to_date+"','dd/mm/yyyy') AND "+ //HARSH20210319
			 		//SB20200919	"(SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM DLNG_SN_MST B where A.SN_NO=B.SN_NO AND A.FLSA_NO=B.FLSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FLSA_REV_NO=B.FLSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			//System.out.println(queryString1);
			rset = stmt.executeQuery(queryString1);
			while(rset.next())
			{
				VDealUniqueId.add("S"+rset.getString(6)+"-"+rset.getString(7)+"-"+rset.getString(3)+"-"+rset.getString(4)+"-DLNG");
				String sn_ref_no = rset.getString(9)==null?"":rset.getString(9);
				if(!sn_ref_no.equals("")) {
					sn_ref_no = "["+sn_ref_no+"]";
				}
				VCollMgmtDealId_Display.add("S"+rset.getString(6)+"-"+rset.getString(3)+"-DLNG  "+sn_ref_no); //HARSH20210722 AS PER INCIDENT ID#112
				fromdt = rset.getString(1)==null?"":rset.getString(1);
				enddt = rset.getString(2)==null?"":rset.getString(2);
				temp = fromdt+"   -   "+enddt;
				CARGO_ARRIVAL_DATE.add(temp);
				VSegment.add("DLNG");//HARSH20211220
				
				//HARSH20211221 TOP-UP JENNIE MAIL ON 21/12/2021
				//String deal_type = getDealType(rset.getString(5), rset.getString(6), rset.getString(7), rset.getString(3), rset.getString(4), "DLNG", "S");
			}
			queryString2 =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
					"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE  "
					+ "from DLNG_LOA_MST A where A.CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND "+ 
					//HARSH20210319 "(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND " +
					" A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy') AND " +//HARSH20210319
					//SB20200919			"(A.SIGNING_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+from_date+"','dd/mm/yyyy')) AND " +
					"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM DLNG_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
					"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			//System.out.println(queryString2);
			rset1 = stmt1.executeQuery(queryString2);
			while(rset1.next())
			{
				VDealUniqueId.add("L"+rset1.getString(6)+"-0"+"-"+rset1.getString(3)+"-"+rset1.getString(4)+"-DLNG");
				String sn_ref_no = rset1.getString(8)==null?"":rset1.getString(8);
				if(!sn_ref_no.equals("")) {
					sn_ref_no = "["+sn_ref_no+"]";
				}
				VCollMgmtDealId_Display.add("L"+rset1.getString(6)+"-"+rset1.getString(3)+"-DLNG  "+sn_ref_no);//HARSH20210722 AS PER INCIDENT ID#112
				fromdt = rset1.getString(1)==null?"":rset1.getString(1);
				enddt = rset1.getString(2)==null?"":rset1.getString(2);
				temp = fromdt+"   -   "+enddt;
				CARGO_ARRIVAL_DATE.add(temp);
				VSegment.add("DLNG");//HARSH20211220
				
				//HARSH20211221 TOP-UP JENNIE MAIL ON 21/12/2021
				//String deal_type = getDealType(rset1.getString(5), rset1.getString(6), "0", rset1.getString(3), rset1.getString(4), "DLNG", "L");
			}
		//}
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}

Vector VSegment=new Vector(); //HARSH20211220
public Vector getVSegment() {return VSegment;} //HARSH20211220

Vector VCollMgmtDealId_Display = new Vector();//HARSH20210722
public Vector getVCollMgmtDealId_Display() {return VCollMgmtDealId_Display;} //HARSH20210722

String sell_buy = "";
public void setsell_buy(String sell_buy) {this.sell_buy = sell_buy;}
String cust_cd = "";
public void setCust_cd(String Cust_cd) {this.cust_cd = Cust_cd;}
String mappingID = "";
public void setMappingID(String MappingID) {this.mappingID = MappingID;}

Vector Vbank_cd = new Vector();
public Vector getVbank_cd() {return Vbank_cd;}
Vector Vbank_nm = new Vector();
public Vector getVbank_nm() {return Vbank_nm;}
Vector Vbank_branch_nm = new Vector();
public Vector getVbank_branch_nm() {return Vbank_branch_nm;}

Vector VTEMP_CUST_CD = new Vector(); //HARSH20210213
public Vector getVTEMP_CUST_CD() {return VTEMP_CUST_CD;} //HARSH20210213

Vector VSec_ty = new Vector();
public Vector getVSec_ty() {return VSec_ty;}
Vector VDeal_ty = new Vector();
public Vector getVDeal_ty() {return VDeal_ty;}
Vector VCurrency = new Vector();
public Vector getVCurrency() {return VCurrency;}
Vector VValue_vari = new Vector();
public Vector getVValue_vari() {return VValue_vari;}
Vector VValue = new Vector();
public Vector getVValue() {return VValue;}
Vector VValue_fluc = new Vector();
public Vector getVValue_fluc() {return VValue_fluc;}
Vector VIss_bank_nm = new Vector();
public Vector getVIss_bank_nm() {return VIss_bank_nm;}
Vector VIss_bank_branch_nm = new Vector();
public Vector getVIss_bank_branch_nm() {return VIss_bank_branch_nm;}
Vector VIss_bank_cd = new Vector();
public Vector getVIss_bank_cd() {return VIss_bank_cd;}
Vector VIss_bank_ref = new Vector();
public Vector getVIss_bank_ref() {return VIss_bank_ref;}
Vector VAdv_bank_branch_nm = new Vector();
public Vector getVAdv_bank_branch_nm() {return VAdv_bank_branch_nm;}
Vector VAdv_bank_nm = new Vector();
public Vector getVAdv_bank_nm() {return VAdv_bank_nm;}
Vector VAdv_bank_cd = new Vector();
public Vector getVAdv_bank_cd() {return VAdv_bank_cd;}
Vector VAdv_bank_ref = new Vector();
public Vector getVAdv_bank_ref() {return VAdv_bank_ref;}
Vector VConfi_bank_nm = new Vector();
public Vector getVConfi_bank_nm() {return VConfi_bank_nm;}
Vector VConfi_bank_branch_nm = new Vector();
public Vector getVConfi_bank_branch_nm() {return VConfi_bank_branch_nm;}
Vector VConfi_bank_cd = new Vector();
public Vector getVConfi_bank_cd() {return VConfi_bank_cd;}
Vector VConfi_bank_ref = new Vector();
public Vector getVConfi_bank_ref() {return VConfi_bank_ref;}
Vector VReceived_dt = new Vector();
public Vector getVReceived_dt() {return VReceived_dt;}
Vector VIssuance_dt = new Vector();
public Vector getVIssuance_dt() {return VIssuance_dt;}
Vector VExpire_dt = new Vector();
public Vector getVExpire_dt() {return VExpire_dt;}
Vector VRenew_dt = new Vector();
public Vector getVRenew_dt() {return VRenew_dt;}
Vector VTenor = new Vector();
public Vector getVTenor() {return VTenor;}
Vector VStatus = new Vector();
public Vector getVStatus() {return VStatus;}
Vector VRemarks = new Vector();
public Vector getVRemarks() {return VRemarks;}
Vector VLink = new Vector();
public Vector getVLink() {return VLink;}
Vector VIssuedReceived = new Vector();
public Vector getVIssuedReceived() {return VIssuedReceived;}
Vector VSeq_no = new Vector();
public Vector getVSeq_no() {return VSeq_no;}
Vector VLinked = new Vector();
public Vector getVLinked() {return VLinked;}
Vector VModify_dt = new Vector();
public Vector getVModify_dt() {return VModify_dt;}
Vector VModify_by = new Vector();
public Vector getVModify_by() {return VModify_by;}
Vector VAprv_dt = new Vector();
public Vector getVAprv_dt() {return VAprv_dt;}
Vector VAprv_by = new Vector();
public Vector getVAprv_by() {return VAprv_by;}
Vector Vguranator_cd = new Vector();
public Vector getVguranator_cd() {return Vguranator_cd;}
Vector Vguranator_abbr = new Vector();//HARSH20210213
public Vector getVguranator_abbr() {return Vguranator_abbr;} //HARSH20210213
Vector Vguranator_nm = new Vector();
public Vector getVguranator_nm() {return Vguranator_nm;}
Vector Vmapping_id = new Vector();
public Vector getVmapping_id() {return Vmapping_id;}
Vector VReview_dt = new Vector();
public Vector getVReview_dt() {return VReview_dt;}
Vector VRef_no = new Vector();
public Vector getVRef_no() {return VRef_no;}
Vector VLink_seq_no = new Vector();
public Vector getVLink_seq_no() {return VLink_seq_no;}
Vector VCancelled_Flag = new Vector(); //HARSH20210331
public Vector getVCancelled_Flag() {return VCancelled_Flag;}//HARSH20210331
Vector VCancelled_DT = new Vector(); //HARSH20210410
public Vector getVCancelled_DT() {return VCancelled_DT;}//HARSH20210410
/////////////////////////////////////////////////////////////

///////////////////////HARSH20201024/////////////////////////
public void FetchExistingSecurityListPost()
{
	try
	{		
		String MappId="";
		String FlagSecurity=""; String SecurityType="";
		String avail_map_id=FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
		
		queryString = "SELECT A.FINANCIAL_YEAR, A.LC_SEQ_NO, A.CUSTOMER_CD, " +
			  "CREDIT_RATING, TO_CHAR(RATING_EFF_DATE,'DD/MM/YYYY'), TO_CHAR(LC_REF_DATE,'DD/MM/YYYY'), " +
			  "TO_CHAR(A.START_DATE,'DD/MM/YYYY'), TO_CHAR(A.END_DATE,'DD/MM/YYYY'), " +
			  "MANUAL_EXCHG_FLAG, MANUAL_EXCHG_RATE, USER_DEFINED_FLAG, " +
			  "USER_DEFINED_DCQ, CALC_LC_AMOUNT, FINAL_LC_AMOUNT, A.REMARKS "
			  + ",CONT_TYPE, FGSA_NO,FGSA_REV_NO, SN_NO, SN_REV_NO, LC_METHOD, A.FLAG,TO_CHAR(SEC_DT,'DD/MM/YYYY'),SEC_REF_NO,TO_CHAR(a.aprv_dt,'dd/mm/yyyy'),b.existing " +
			  " FROM FMS7_LC_MST A, FMS7_LC_DTL B WHERE "
			  + " A.CUSTOMER_CD="+Buyer_cd+" "
			  + " AND A.FINANCIAL_YEAR=B.FINANCIAL_YEAR " +
			 "AND A.LC_SEQ_NO=B.LC_SEQ_NO AND A.CUSTOMER_CD=B.CUSTOMER_CD ORDER BY a.FINANCIAL_YEAR,a.LC_SEQ_NO" ;
		
		System.out.println("SECURITY: FMS7_LC_MST: "+queryString);
		rset = stmt.executeQuery(queryString);		
		
		while(rset.next())
		{
			if(rset.getString(25)!=null)
			{
				if(rset.getString(26)==null) ///HARSH20201020
				{
					String temp_map=rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
					System.out.println(temp_map+"----"+avail_map_id);
					if(!avail_map_id.equals(temp_map)) {
						int lc_seq_no = rset.getInt(2);
						String fin_year = rset.getString(1);
						String LC_SEQ_NO = "";
						
						if(lc_seq_no<10)
						{
							LC_SEQ_NO = "000"+lc_seq_no+"/"+fin_year;
						}
						else if(lc_seq_no<100)
						{
							LC_SEQ_NO = "00"+lc_seq_no+"/"+fin_year;
						}
						else if(lc_seq_no<1000)
						{
							LC_SEQ_NO = "0"+lc_seq_no+"/"+fin_year;
						}
						else
						{
							LC_SEQ_NO = ""+lc_seq_no+"/"+fin_year;
						}
						Vfin_yr.add(rset.getString(1)==null?"0":rset.getString(1));
						VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
						VSecuritySeqNo.add(LC_SEQ_NO);
						//VSecurityStatus.add("");
						VSecurityRating.add(rset.getString(4)==null?"0":rset.getString(4));
						VSecurityRatingEffDt.add(rset.getString(5)==null?"":rset.getString(5));
						VSecurityDueDt.add(rset.getString(6)==null?"":rset.getString(6));
						VSecurityStartDt.add(rset.getString(7)==null?"":rset.getString(7));
						VSecurityEndDt.add(rset.getString(8)==null?"":rset.getString(8));
						VSecurityAmt.add(rset.getString(14)==null?"":rset.getString(14));
						VSecurityRmk.add(rset.getString(15)==null?"":rset.getString(15));	
						VflagSecurity.add(rset.getString(22)==null?"":rset.getString(22));
						Vsec_dt.add(rset.getString(23)==null?"":rset.getString(23));
						Vsec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
						
						MappId=rset.getString(16)+rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
						
						SecurityType=rset.getString(21)==null?"":rset.getString(21);
						if(SecurityType.equals("PCG"))
							VSecurityDealCd.add("All");
						else
							VSecurityDealCd.add(MappId);
						
						FlagSecurity=rset.getString(22)==null?"0":rset.getString(22);
						if(FlagSecurity.equals("Y"))
							VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
						else if(FlagSecurity.equals("O"))
							VSecurityTypeDesc.add(rset.getString(21)+" (Issuance)");
						else
							VSecurityTypeDesc.add(rset.getString(21)==null?"0":rset.getString(21));
						
						VSecurityType.add(rset.getString(21)==null?"0":rset.getString(21));
						String status = rset.getString(25)==null?"":rset.getString(25); //HARSH20201019
						if(status == "")
						{
							VSecurityStatus.add("Pending");
						}else{
							VSecurityStatus.add("Approved");
						}//
						if(rset.getString(26)!=null)   ///HARSH20201020
						{
							Vexisting_cont.add("LINKED");
						}
						else
						{
							Vexisting_cont.add("");
						} //
						}
						double SumSecurity=0;
						for(int i=0; i<VSecurityAmt.size(); i++)
						{
							SumSecurity+=Double.parseDouble(""+VSecurityAmt.elementAt(i));
						}
						TotalSecurityAmt=nf.format(SumSecurity);
				}	
			}
		}
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}
////////////////////////////////////////////////////////////
public void fetchExsitingSecurityRefNoPost()
{
	try
	{
		String mappingID=LC_Mapping_Id; 
		String avail_map_id="";
		//System.out.println("mappingID----"+mappingID);
		if(!mappingID.equals(""))
		{
			avail_map_id=mappingID.substring(1,mappingID.length());
			//System.out.println("avail_map_id----"+avail_map_id);
		}
		
		String cont_type=LC_Mapping_Id.substring(0,1);
		
		int record_found=0;

		String SysDate="";
		String findDate = "Select to_char(sysdate,'dd/mm/yyyy') from dual";
		rset1=stmt1.executeQuery(findDate);
		if(rset1.next())
		{
			SysDate=rset1.getString(1)==null?"":rset1.getString(1);
		}
		String qury="";
		if(cont_type.equals("B")){//HARSH20201208 For Buy and LNG
			qury = "like 'B%' or link = '0'"; //LINK='0'(without deal asso) ADDED AS PER INCIDENT#216
		}
		else if(cont_type.equals("C")){//HARSH20201208 For Sell and Capacity
			qury="like 'C%' or link = '0'"; //LINK='0'(without deal asso) ADDED AS PER INCIDENT#216
		}
		else{//HARSH20201208 For Sell and GAS
			qury="like 'S%' or link like 'L%' or link = '0'"; //LINK='0'(without deal asso) ADDED AS PER INCIDENT#216
		}
		
		String Existing_Pre = "select link,sec_type,to_char(issu_dt,'dd/mm/yyyy'),to_char(exp_dt,'dd/mm/yyyy'),value,remarks,status,to_char(aprv_dt,'dd/mm/yyyy'),issued,received,to_char(rec_dt,'dd/mm/yyyy'),iss_bank_ref,currency,deal_type,"
				+ "variation_value,value_fluc,iss_bank_cd,adv_bank_cd,adv_bank_ref,confirm_bank_cd,confirm_bank_ref,tenor,seq_no,ref_no,mapping_id"
				+ " from fms9_security_post_mst where customer_abbr='"+Customer_ABBR+"' and (link "+qury+") and exp_dt >= TO_DATE('"+SysDate+"','DD/MM/YYYY') and ((aprv_dt is not null and flag='Y') or (aprv_dt is null and status='Dummy')) "
				+ "and link is not null and mapping_id is null AND SEC_TYPE != 'PCG'";
		//HARSH20210521 DUMMY TO BE LINKED AS REQUESTED BY JENNIE ON 21/05/2021
		System.out.println(Existing_Pre);
		rset = stmt.executeQuery(Existing_Pre);
		while(rset.next())
		{
			String st=rset.getString(3)==null?"":rset.getString(3); // AS PER INCIDENT#216
			String end=rset.getString(4)==null?"":rset.getString(4); // AS PER INCIDENT#216
			
			String secrefno = rset.getString(24)==null?"":rset.getString(24);
			//HARSH20210604
			String Fgsa_Sn = "";
			if(cont_type.equals("C"))
			{
				Fgsa_Sn = avail_map_id;
			}
			else if(cont_type.equals("B"))
			{
				Fgsa_Sn = avail_map_id;
			}
			else
			{
				if(!avail_map_id.equals(""))
				{
					String split[] = avail_map_id.split("-");
					Fgsa_Sn = split[0]+"-%-"+split[2]+"-%";		
				}
			}
			String check = "select nvl(count(*),0) from fms9_security_post_mst where ref_no='"+secrefno+"' and link like '"+cont_type+""+Fgsa_Sn+"'";
			//System.out.println("HPPP ::: "+check);
			rset2= stmt2.executeQuery(check);
			if(rset2.next())
			{
				record_found = rset2.getInt(1);
				if(record_found==0) 
				{
					String mapID = rset.getString(25)==null?"":rset.getString(25);
					String ap_dt = rset.getString(8);
					String link = rset.getString(1)==null?"":rset.getString(1);
					String link_sub = "";
					if(!link.equals("")) //AS PER INCIDENT#216
					{
						link_sub=link.substring(1, link.length());
					}
					if(!avail_map_id.equals(link_sub)) 
					{
						int count = compareDate(LC_Mapping_Id, link,end,st,"POST");//HARSH20210216 //end, st AS PER INCIDENT#216
						if(count != 0) //HARSH20210216
						{	
							//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
							/*HARSH20210130 if(rset.getString(2)== "PCG")
							{
								VSecurityDealCd.add("All");
							}
							else
							{*/
								VSecurityDealCd.add(link);
								Vlink_sec_st_dt.add(st); // AS PER INCIDENT#216
								Vlink_sec_end_dt.add(end); // AS PER INCIDENT#216
							//}
							Vsec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
						}
					}
				}
			}
		}	
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}

Vector Vlink_sec_st_dt=new Vector();
public Vector getVlink_sec_st_dt() {return Vlink_sec_st_dt;}
Vector Vlink_sec_end_dt=new Vector();
public Vector getVlink_sec_end_dt() {return Vlink_sec_end_dt;}
////////////////////////HARSH20201029////////////////////////
public void FetchExistingSecurityListPre()
{
	try
	{
		String SysDate="";
		String findDate = "Select to_char(sysdate,'dd/mm/yyyy') from dual";
		rset1=stmt1.executeQuery(findDate);
		if(rset1.next())
		{
			SysDate=rset1.getString(1)==null?"":rset1.getString(1);
		}
		
		int record_found=0;
		String MappId="";
		String FlagSecurity=""; String SecurityType="";
		String avail_map_id=LC_Mapping_Id.substring(1,LC_Mapping_Id.length());	//HARSH20201203 FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
		String qury="";
		
		if(cont_type.equals("B")){//HARSH20201208 For Buy and LNG
			qury = "like 'B%' or link = '0'"; //LINK='0'(without deal asso) ADDED AS PER INCIDENT#216
		}
		else if(cont_type.equals("C")){//HARSH20201208 For Sell and Capacity
			qury="like 'C%' or link = '0'"; //LINK='0'(without deal asso) ADDED AS PER INCIDENT#216
		}
		else{//HARSH20201208 For Sell and GAS
			qury="like 'S%' or link like 'L%' or link = '0'"; //LINK='0'(without deal asso) ADDED AS PER INCIDENT#216
		}
		
		String Existing_Pre = "select link,sec_type,to_char(issu_dt,'dd/mm/yyyy'),to_char(exp_dt,'dd/mm/yyyy'),value,remarks,status,to_char(aprv_dt,'dd/mm/yyyy'),issued,received,to_char(rec_dt,'dd/mm/yyyy'),iss_bank_ref,currency,deal_type,"
					+ "variation_value,value_fluc,iss_bank_cd,adv_bank_cd,adv_bank_ref,confirm_bank_cd,confirm_bank_ref,tenor,seq_no,ref_no,mapping_id"
					+ " from fms9_security_post_mst where customer_abbr='"+Customer_ABBR+"' and (link "+qury+") and flag='Y' and exp_dt >= TO_DATE('"+SysDate+"','DD/MM/YYYY') "
					+ "and aprv_dt is not null and link is not null and mapping_id is null AND SEC_TYPE!='PCG'"; //HARSH20201208 Link column added
		//HARSH20210212 ADDED CUSTOMER_ABBR //NOW WE USE CUSTOMER_ABBR INSTAED OF CUSTOMER_CD
		rset = stmt.executeQuery(Existing_Pre);
		while(rset.next())
		{
			String st=rset.getString(3)==null?"":rset.getString(3); // AS PER INCIDENT#216
			String end=rset.getString(4)==null?"":rset.getString(4); // AS PER INCIDENT#216
			
			String secrefno = rset.getString(24)==null?"":rset.getString(24);
			//HARSH20210604
			String Fgsa_Sn = "";
			if(cont_type.equals("C"))
			{
				Fgsa_Sn = avail_map_id;
			}
			else if(cont_type.equals("B"))
			{
				Fgsa_Sn = avail_map_id;
			}
			else
			{
				if(!avail_map_id.equals(""))
				{
					String split[] = avail_map_id.split("-");
					Fgsa_Sn = split[0]+"-%-"+split[2]+"-%";		
				}
			}
			
			
			String check = "select nvl(count(*),0) from fms9_security_post_mst where ref_no='"+secrefno+"' and link like '"+cont_type+Fgsa_Sn+"'";
			System.out.println(check);
			rset2= stmt2.executeQuery(check);
			if(rset2.next())
			{
				record_found = rset2.getInt(1);
				//System.out.println("record_found--"+record_found);
				if(record_found==0) 
				{
					String mapID = rset.getString(25)==null?"":rset.getString(25);
					String ap_dt = rset.getString(8);
					String link = rset.getString(1)==null?"":rset.getString(1);
					String link_sub = "";
					if(!link.equals("")) //AS PER INCIDENT#216
					{
						link_sub=link.substring(1, link.length());
					}
					
					if(!avail_map_id.equals(link_sub)) 
					{
						int count = compareDate(LC_Mapping_Id, link,end,st,"PRE");//HARSH20210216 //end, st AS PER INCIDENT#216
						if(count != 0)//HARSH20210216
						{	
							String sec = rset.getString(2)==null?"":rset.getString(2);
							//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
							/*HARSH20210130 if(sec.equals("PCG"))
							{
								VSecurityDealCd.add("All");
							}
							else
							{*/
								VSecurityDealCd.add(link);
							//}
							
							VSecurityTypeDesc.add(rset.getString(2)==null?"":rset.getString(2));
							VSecurityStartDt.add(rset.getString(3)==null?"":rset.getString(3));
							VSecurityEndDt.add(rset.getString(4)==null?"":rset.getString(4));
							VSecurityAmt.add(rset.getString(5)==null?"":rset.getString(5));
							VSecurityRmk.add(rset.getString(6)==null?"":rset.getString(6));
							VSecStatus.add(rset.getString(7)==null?"":rset.getString(7));
							
							VSecurityStatus.add("Approved");
							if(rset.getString(9)!=null && rset.getString(10)==null)
							{
								VflagSecurity.add(rset.getString(9)==null?"":rset.getString(9));
							}else if(rset.getString(9)==null && rset.getString(10)!=null)
							{
								VflagSecurity.add(rset.getString(10)==null?"":rset.getString(10));
							}
							Vsec_due_dt.add(rset.getString(11)==null?"":rset.getString(11));
							Vcurrency.add(rset.getString(13)==null?"":rset.getString(13));
							Vdeal_type.add(rset.getString(14)==null?"":rset.getString(14));
							Vvalue_vari.add(rset.getString(15)==null?"":rset.getString(15));
							Vvalue_fluc.add(rset.getString(16)==null?"":rset.getString(16));
							Viss_bank_cd.add(rset.getString(17)==null?"":rset.getString(17));
							Viss_bank_ref.add(rset.getString(12)==null?"":rset.getString(12));
							Vadv_bank_cd.add(rset.getString(18)==null?"":rset.getString(18));
							Vadv_bank_ref.add(rset.getString(19)==null?"":rset.getString(19));
							Vcon_bank_cd.add(rset.getString(20)==null?"":rset.getString(20));
							Vcon_bank_ref.add(rset.getString(21)==null?"":rset.getString(21));
							Vtenor.add(rset.getString(22)==null?"":rset.getString(22));
							VActual_seq_no.add(rset.getString(23)==null?"0":rset.getString(23));
							Vsec_ref_no.add(rset.getString(24)==null?"":rset.getString(24));
						}
					}
				}
			}
		}
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}
///NEW FUNCTION FOR LINK EXISTING SECURITY /// HARSH20210216/////
public int compareDate(String avail_map_id, String link_map_id, String end, String st, String pre_post)
{
	int count=0;
	try
	{
		String avail_contTy = avail_map_id.substring(0,1);
		String link_contTy = "";
		
		if(!link_map_id.equals(""))
		{
			link_contTy=link_map_id.substring(0,1);
		}
		String AvailContStartDt = "",LinkContStartDt = "";
		String AvailContEndDt=""; //AS PER INCIDENT#216
		
		///FOR AVAIL DEAL ID
		if(avail_contTy.equals("S"))
		{
			String split[] = avail_map_id.split("-");
			String fgsano = split[0].substring(1,split[0].length());
			String fgsa_rev_no = split[1];
			String snno = split[2];
			String sn_rev_no = split[3];
			String segment="";
			if(split.length > 4)
			{
				segment=split[4];
			}System.out.println(segment);
			//System.out.println(avail_contTy+"  "+fgsano+"  "+fgsa_rev_no+"  "+snno+"  "+sn_rev_no);
			if(segment.equals("DLNG"))
			{
				queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY') FROM DLNG_SN_MST "
						+ "WHERE CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
						+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND FLSA_NO='"+fgsano+"' AND"
						+ " FLSA_REV_NO='"+fgsa_rev_no+"' AND SN_NO='"+snno+"' AND SN_REV_NO = '"+sn_rev_no+"'";
			}
			else
			{
				queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY') FROM FMS7_SN_MST "
						+ "WHERE CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
						+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND FGSA_NO='"+fgsano+"' AND"
						+ " FGSA_REV_NO='"+fgsa_rev_no+"' AND SN_NO='"+snno+"' AND SN_REV_NO = '"+sn_rev_no+"'";
			}
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				AvailContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
				AvailContEndDt=rset1.getString(2)==null?"":rset1.getString(2);//AS PER INCIDENT#216
			}
		}
		else if(avail_contTy.equals("L"))
		{
			String split[] = avail_map_id.split("-");
			String fgsano = split[0].substring(1,split[0].length());
			String fgsa_rev_no = split[1];
			String snno = split[2];
			String sn_rev_no = split[3];
			String segment="";
			if(split.length > 4);
			{
				segment=split[4];
			}System.out.println(segment);
			//System.out.println(avail_contTy+"  "+fgsano+"  "+fgsa_rev_no+"  "+snno+"  "+sn_rev_no);
			if(segment.equals("DLNG"))
			{
				queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY') FROM DLNG_LOA_MST "
						+ "WHERE CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
						+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND TENDER_NO='"+fgsano+"' AND"
						+ " LOA_NO='"+snno+"' AND LOA_REV_NO = '"+sn_rev_no+"'";
			}
			else
			{
				queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY') FROM FMS7_LOA_MST "
						+ "WHERE CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' "
						+ "AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND TENDER_NO='"+fgsano+"' AND"
						+ " LOA_NO='"+snno+"' AND LOA_REV_NO = '"+sn_rev_no+"'";
			}
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				AvailContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
				AvailContEndDt=rset1.getString(2)==null?"":rset1.getString(2);//AS PER INCIDENT#216
			}
		}
		else if(avail_contTy.equals("C"))
		{
			String mapping_id = avail_map_id.substring(1,avail_map_id.length());
			//System.out.println(avail_contTy+"  "+mapping_id);
			/*queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C "
					+ "WHERE C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND C.MAPPING_ID = '"+mapping_id+"' AND C.MAPPING_ID = A.MAPPING_ID";*/
			queryString="select TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_MST C "
					+ "WHERE C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND C.MAPPING_ID = '"+mapping_id+"' ";
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				AvailContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
				AvailContEndDt=rset1.getString(2)==null?"":rset1.getString(2);//AS PER INCIDENT#216
			}
		}
		else if(avail_contTy.equals("B"))
		{
			String split[] = avail_map_id.split("-");
			String man_conf_cd = split[0].substring(1,split[0].length());
			String cargo_seq_no = split[1];
			//System.out.println(avail_contTy+"  "+man_conf_cd+"  "+cargo_seq_no);
			queryString = "SELECT TO_CHAR(A.DELV_FROM_DT,'DD/MM/YYYY'),TO_CHAR(A.DELV_TO_DT,'DD/MM/YYYY') FROM FMS7_MAN_CONFIRM_CARGO_DTL A, FMS7_MAN_REQ_MST E "
					+ "WHERE E.TRD_CD=(SELECT TRADER_CD FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"')) AND A.MAN_CONF_CD = '"+man_conf_cd+"' AND A.CARGO_SEQ_NO='"+cargo_seq_no+"' "
					+ "AND E.MAN_CD=A.MAN_CD";
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				AvailContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
				AvailContEndDt=rset1.getString(2)==null?"":rset1.getString(2);//AS PER INCIDENT#216
			}
		}
		
		///FOR LINK DEAL ID
		/*AS PER INCIDENT#216
		if(link_contTy.equals("S"))
		{
			String split[] = link_map_id.split("-");
			String fgsano = split[0].substring(1,split[0].length());
			String fgsa_rev_no = split[1];
			String snno = split[2];
			String sn_rev_no = split[3];
			System.out.println(link_contTy+"  "+fgsano+"  "+fgsa_rev_no+"  "+snno+"  "+sn_rev_no);
			queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY') FROM FMS7_SN_MST "
					+ "WHERE CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND FGSA_NO='"+fgsano+"' AND"
					+ " FGSA_REV_NO='"+fgsa_rev_no+"' AND SN_NO='"+snno+"' AND SN_REV_NO = '"+sn_rev_no+"'";
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				LinkContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
			}
		}
		else if(link_contTy.equals("L"))
		{
			String split[] = link_map_id.split("-");
			String fgsano = split[0].substring(1,split[0].length());
			String fgsa_rev_no = split[1];
			String snno = split[2];
			String sn_rev_no = split[3];
			System.out.println(link_contTy+"  "+fgsano+"  "+fgsa_rev_no+"  "+snno+"  "+sn_rev_no);
			queryString="SELECT TO_CHAR(START_DT,'DD/MM/YYYY') FROM FMS7_LOA_MST "
					+ "WHERE CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND TENDER_NO='"+fgsano+"' AND"
					+ " LOA_NO='"+snno+"' AND LOA_REV_NO = '"+sn_rev_no+"'";
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				LinkContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
			}
		}
		else if(link_contTy.equals("C"))
		{
			String mapping_id = link_map_id.substring(1,avail_map_id.length());
			System.out.println(link_contTy+"  "+mapping_id);
			queryString="select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY') FROM FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C "
					+ "WHERE C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"')) AND C.MAPPING_ID = '"+mapping_id+"' AND C.MAPPING_ID = A.MAPPING_ID";
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				LinkContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
			}
		}
		else if(link_contTy.equals("B"))
		{
			String split[] = link_map_id.split("-");
			String man_conf_cd = split[0].substring(1,split[0].length());
			String cargo_seq_no = split[1];
			System.out.println(link_contTy+"  "+man_conf_cd+"  "+cargo_seq_no);
			queryString = "SELECT TO_CHAR(A.DELV_FROM_DT,'DD/MM/YYYY') FROM FMS7_MAN_CONFIRM_CARGO_DTL A, FMS7_MAN_REQ_MST E "
					+ "WHERE E.TRD_CD=(SELECT TRADER_CD FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+Customer_ABBR+"')) AND A.MAN_CONF_CD = '"+man_conf_cd+"' AND A.CARGO_SEQ_NO='"+cargo_seq_no+"' "
					+ "AND E.MAN_CD=A.MAN_CD1";
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				LinkContStartDt = rset1.getString(1)==null?"":rset1.getString(1);
			}
		}*/
		
		//System.out.println(AvailContStartDt+"   >   "+LinkContStartDt);
		/*AS PER INCIDENT#216queryString="SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+AvailContStartDt+"','DD/MM/YYYY') > TO_DATE('"+LinkContStartDt+"','DD/MM/YYYY')";
		rset1=stmt1.executeQuery(queryString);
		if(rset1.next())
		{
			count = rset1.getInt(1);
		}*/
		
		//AS PER INCIDENT#216 // MATCH SECURITY DATE & CONTRACT DATE(Avail contract)
		
		if(pre_post.equals("PRE"))
		{
			if(AvailContStartDt.equals("")) {AvailContStartDt=from_date;}
			if(AvailContEndDt.equals("")) {AvailContEndDt=to_date;}
		}
		queryString="SELECT COUNT(*) FROM DUAL WHERE "
				+ "(TO_DATE('"+AvailContStartDt+"','DD/MM/YYYY') <= TO_DATE('"+st+"','DD/MM/YYYY') AND TO_DATE('"+AvailContEndDt+"','DD/MM/YYYY') >= TO_DATE('"+end+"','DD/MM/YYYY')) "
				+ "OR "
				+ "(TO_DATE('"+AvailContStartDt+"','DD/MM/YYYY') >= TO_DATE('"+st+"','DD/MM/YYYY') AND TO_DATE('"+AvailContEndDt+"','DD/MM/YYYY') <= TO_DATE('"+end+"','DD/MM/YYYY')) "
				+ "OR "
				+ "(TO_DATE('"+AvailContStartDt+"','DD/MM/YYYY') <= TO_DATE('"+st+"','DD/MM/YYYY') AND TO_DATE('"+AvailContEndDt+"','DD/MM/YYYY') <= TO_DATE('"+end+"','DD/MM/YYYY') AND TO_DATE('"+AvailContEndDt+"','DD/MM/YYYY') >= TO_DATE('"+st+"','DD/MM/YYYY')) "
				+ "OR "
				+ "(TO_DATE('"+AvailContStartDt+"','DD/MM/YYYY') >= TO_DATE('"+st+"','DD/MM/YYYY') AND TO_DATE('"+AvailContEndDt+"','DD/MM/YYYY') >= TO_DATE('"+end+"','DD/MM/YYYY') AND TO_DATE('"+AvailContStartDt+"','DD/MM/YYYY') <= TO_DATE('"+end+"','DD/MM/YYYY'))";
		System.out.println(queryString);
		rset1=stmt1.executeQuery(queryString);
		if(rset1.next())
		{
			count = rset1.getInt(1);
		}
		
		System.out.println("count :: "+count);
		
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
	return count;
}
////////////////////////////////////////////////////////////////////////////
Vector Vsec_due_dt = new Vector();
public Vector getVsec_due_dt() {return Vsec_due_dt;}
Vector Vdeal_type = new Vector();
public Vector getVdeal_type() {return Vdeal_type;}
Vector Vvalue_vari = new Vector();
public Vector getVvalue_vari() {return Vvalue_vari;}
Vector Vvalue_fluc = new Vector();
public Vector getVvalue_fluc() {return Vvalue_fluc;}
Vector Viss_bank_cd = new Vector();
public Vector getViss_bank_cd() {return Viss_bank_cd;}
Vector Viss_bank_ref = new Vector();
public Vector getViss_bank_ref() {return Viss_bank_ref;}
Vector Vadv_bank_cd = new Vector();
public Vector getVadv_bank_cd() {return Vadv_bank_cd;}
Vector Vadv_bank_ref = new Vector();
public Vector getVadv_bank_ref() {return Vadv_bank_ref;}
Vector Vcon_bank_cd = new Vector();
public Vector getVcon_bank_cd() {return Vcon_bank_cd;}
Vector Vcon_bank_ref = new Vector();
public Vector getVcon_bank_ref() {return Vcon_bank_ref;}
Vector Vtenor = new Vector();
public Vector getVtenor() {return Vtenor;}


/////////////////////////////////////////////////////////////
/////////////////////////SB20201101////////////////////////////
//////////////////////SB20200927: For CR Security New //////////////////////
public void fetch_Collateral_List()
{
	try
	{		
		//String mappingID=LC_cont_type+FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo; //HARSH20201104
		//String mappingID=FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
		String mappingID=LC_Mapping_Id;
		mappingID=mappingID.substring(1,mappingID.length());
		String Trans_Cd="";
		queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Buyer_cd+"' and " +
		"eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Buyer_cd+"') order by CUSTOMER_CD";
		rset1 = stmt1.executeQuery(queryString1);
		if(rset1.next())
		{
		CUSTOMER_CD.add(Buyer_cd);
		CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
		//buyer_Credit_Rate.add(rset1.getString(2)==null?"":rset1.getString(2));
		}
		String MappId="";
		String FlagSecurity=""; String SecurityType=""; String AprvDt="";
		
		queryString = "SELECT A.FINANCIAL_YEAR, A.LC_SEQ_NO, A.CUSTOMER_CD, " +
		"CREDIT_RATING, TO_CHAR(RATING_EFF_DATE,'DD/MM/YYYY'), TO_CHAR(LC_REF_DATE,'DD/MM/YYYY'), " +
		"TO_CHAR(A.START_DATE,'DD/MM/YYYY'), TO_CHAR(A.END_DATE,'DD/MM/YYYY'), " +
		"MANUAL_EXCHG_FLAG, MANUAL_EXCHG_RATE, USER_DEFINED_FLAG, " +
		"USER_DEFINED_DCQ, CALC_LC_AMOUNT, FINAL_LC_AMOUNT, A.REMARKS "
		+ ",CONT_TYPE, FGSA_NO,FGSA_REV_NO, SN_NO, SN_REV_NO, LC_METHOD, A.FLAG,TO_CHAR(SEC_DT,'DD/MM/YYYY'),SEC_REF_NO, A.APRV_BY,TO_CHAR(A.APRV_DT,'DD/MM/YYYY'), MAPPING_ID,B.EXISTING " + //HARSH20201020 Added Existing column
		"FROM FMS7_LC_MST A, FMS7_LC_DTL B WHERE "
		//SB20201001  + "A.CUSTOMER_CD="+Buyer_cd+" AND A.FLAG = 'Y' "
		+ "B.FGSA_NO='"+FgsaNo+"' AND B.FGSA_REV_NO='"+FgsaRevNo+"' AND B.SN_NO='"+SnNo+"' AND B.SN_REV_NO='"+SnRevNo+"' AND "
		+ "A.CUSTOMER_CD="+Buyer_cd+"  "
		+ "AND A.FINANCIAL_YEAR=B.FINANCIAL_YEAR " +
		"AND A.LC_SEQ_NO=B.LC_SEQ_NO AND A.CUSTOMER_CD=B.CUSTOMER_CD ORDER BY a.FINANCIAL_YEAR,a.LC_SEQ_NO" ;
		
		queryString = "SELECT SEC_TYPE, SEQ_NO, CUSTOMER_CD,  TO_CHAR(ISSU_DT,'DD/MM/YYYY'), TO_CHAR(EXP_DT,'DD/MM/YYYY'),VALUE, "+
		 "REMARKS,FLAG,TO_CHAR(REC_DT,'DD/MM/YYYY'),CONFIRM_BANK_REF, APRV_BY,TO_CHAR(APRV_DT,'DD/MM/YYYY'), LINK, TO_CHAR(REC_DT,'DD/MM/YYYY'),REF_NO,CURRENCY,STATUS  FROM FMS9_SECURITY_POST_MST "+   //HARSH20201118 Added REF_NO,CURRENCY,STATUS
		 " WHERE CUSTOMER_ABBR=(SELECT CUSTOMER_ABBR FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD="+Buyer_cd+") and LINK LIKE '"+LC_Mapping_Id+"' AND RECEIVED='R' and ((EXP_DT >= TO_DATE('"+to_date+"','dd/mm/yyyy') or EXP_DT IS NULL) AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY') >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL))"+  //added Link HARSH20201104  
		" ORDER BY EXP_DT ";
		System.out.println("SECURITY: FMS7_LC_MST: "+queryString);
		rset = stmt.executeQuery(queryString);		
		
		while(rset.next())
		{
			int lc_seq_no = rset.getInt(2);
			String fin_year = rset.getString(1);
			String LC_SEQ_NO = "";
			
			if(lc_seq_no<10)
			{
			LC_SEQ_NO = "000"+lc_seq_no+"/"+fin_year;
			}
			else if(lc_seq_no<100)
			{
			LC_SEQ_NO = "00"+lc_seq_no+"/"+fin_year;
			}
			else if(lc_seq_no<1000)
			{
			LC_SEQ_NO = "0"+lc_seq_no+"/"+fin_year;
			}
			else
			{
			LC_SEQ_NO = ""+lc_seq_no+"/"+fin_year;
			}
			Vfin_yr.add(rset.getString(1)==null?"0":rset.getString(1));
			VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
			VSecuritySeqNo.add(LC_SEQ_NO);
			
			VSecurityRating.add(rset.getString(4)==null?"0":rset.getString(4));
			VSecurityRatingEffDt.add(rset.getString(5)==null?"":rset.getString(5));
		
			VSecurityStartDt.add(rset.getString(4)==null?"":rset.getString(4)); //
			VSecurityEndDt.add(rset.getString(5)==null?"":rset.getString(5)); //
			VSecurityAmt.add(rset.getString(6)==null?"":rset.getString(6));//
			VSecurityRmk.add(rset.getString(7)==null?"":rset.getString(7));	//
			VflagSecurity.add(rset.getString(8)==null?"":rset.getString(8));
			Vsec_dt.add(rset.getString(9)==null?"":rset.getString(9));
			Vsec_ref_no.add(rset.getString(10)==null?"":rset.getString(10));
			VAprv_By.add(rset.getString(11)==null?"0":rset.getString(11));
			VAprv_Dt.add(rset.getString(12)==null?"":rset.getString(12));
			
			SecurityType=rset.getString(1)==null?"":rset.getString(1);
			AprvDt=rset.getString(12)==null?"":rset.getString(12);
			
			if(SecurityType.equals("OA"))		//HARSH20201014
			VSecurityStatus.add("No action required"); //HARSH20201014
			else
				VSecurityStatus.add(rset.getString(17)==null?"":rset.getString(17));//HARSH20201118
			/*if(AprvDt.equals(""))
			VSecurityStatus.add("Pending");
			else
			VSecurityStatus.add("Approved");*/
			
		//	MappId=rset.getString(16)+rset.getString(17)+"-"+rset.getString(18)+"-"+rset.getString(19)+"-"+rset.getString(20);
			
			//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
			/*HARSH20210130 if(SecurityType.equals("PCG"))
				VSecurityDealCd.add("All");
			else*/
				
			VSecurityDealCd.add(rset.getString(13)==null?"":rset.getString(13));
			
			VSecurityDueDt.add(rset.getString(14)==null?"":rset.getString(14));
			VSecRefNo.add(rset.getString(15)==null?"":rset.getString(15));//HARSH20201118
			VSecCurrency.add(rset.getString(16)==null?"":rset.getString(16));//HARSH20201118
			
			FlagSecurity=rset.getString(8)==null?"0":rset.getString(8);
			if(FlagSecurity.equals("Y"))
			VSecurityTypeDesc.add("");
			else if(FlagSecurity.equals("O"))
			VSecurityTypeDesc.add("");
			else
			VSecurityTypeDesc.add("");
			
			VSecurityType.add(rset.getString(1)==null?"0":rset.getString(1));
			
			queryString1 = "SELECT CUSTOMER_NAME,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Trans_Cd+"' and " +
			"eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Trans_Cd+"') order by CUSTOMER_CD";
			rset1 = stmt1.executeQuery(queryString1);
			if(rset1.next())
			VSecurityTransCd.add(rset1.getString(1)==null?"":rset1.getString(1));
			else
			VSecurityTransCd.add("");
		//	Vexisting_cont.add(rset.getString(28)==null?"":rset.getString(28));
		}
		String Exchg_Rate_CD="";
		queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
				" FROM FMS7_SN_BILLING_DTL " +
			     "WHERE cont_type='"+LC_cont_type+"' AND customer_cd="+Buyer_cd+" AND FGSA_NO="+FgsaNo+" AND sn_no="+SnNo+" ";
		System.out.println(queryString2);
		rset2 = stmt2.executeQuery(queryString2);
		if(rset2.next())
		{
			Exchg_Rate_CD=rset2.getString(3)==null?"1":rset2.getString(3);
		}
		//System.out.println(queryString2);
		double AvailableExchgRate=0;
		queryString2 = "SELECT EXCHG_VAL, TO_CHAR(EFF_DT,'dd/mm/yyyy'), REMARK FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' "+ 
				" AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+Exchg_Rate_CD+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) "+
				" AND FLAG='Y' ";
		System.out.println(queryString2);
		rset2 = stmt2.executeQuery(queryString2);
		if(rset2.next())
		{
			AvailableExchgRate =rset2.getDouble(1);		
			VExchgRate.add(AvailableExchgRate); 
		}
		else
		{
			VExchgRate.add("0"); 
		}
		double SumSecurity=0;
		double LastExchgRate=Double.parseDouble(""+VExchgRate.elementAt(0));
		for(int i=0; i<VSecurityAmt.size(); i++)
		{
			//System.out.println("LastExchgRate-"+LastExchgRate);
		/*if(!VSecurityAmt.elementAt(i).equals(""))
		SumSecurity+=Double.parseDouble(""+VSecurityAmt.elementAt(i));*/
			double USDAmt=0;
			if(VSecurityStatus.elementAt(i).equals("In order"))
			{
				if(VSecCurrency.elementAt(i).equals("USD"))
				{
					//System.out.println("inUSD");
					USDAmt = Double.parseDouble(""+VSecurityAmt.elementAt(i));
					SumSecurity+= USDAmt*LastExchgRate;
				}
				else
				{
					//System.out.println("inINR");
					SumSecurity+=Double.parseDouble(""+VSecurityAmt.elementAt(i));
				}
			}
		}
		TotalSecurityAmt=nf.format(SumSecurity);
	}
	catch(Exception e)
	{
		//System.out.println("Exception in Databean_Contract_MasterReport--->fetchcustomer()-->"+e);
		e.printStackTrace();	
	}
}
String LC_cont_type = "";
public void setLC_cont_type(String LC_cont_type) {this.LC_cont_type = LC_cont_type;}
String LC_Mapping_Id = "";
public void setLC_Mapping_Id(String LC_Mapping_Id) {this.LC_Mapping_Id = LC_Mapping_Id;}
Vector VSecCurrency = new Vector();
public Vector getVSecCurrency() {return VSecCurrency;}
Vector VSecRefNo = new Vector();
public Vector getVSecRefNo() {return VSecRefNo;}

/////////////////////////////////////////////////////////////
/////////////////////////////////HARSH20201031///////////////////
public void fetchPreReceiptIncomingOutgoingSecurityList()
{
	try
	{
		int count=0;
		String issued="";
		String received="";
		String s="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'MAPPING_ID'";
		//		System.out.println("s****"+s);
		rset=stmt.executeQuery(s);
		if(rset.next())
		{
			count=rset.getInt(1);
		}
		if(count==0)
		{
			s="ALTER TABLE FMS9_SECURITY_POST_MST ADD MAPPING_ID VARCHAR2(40 BYTE)";
			stmt.executeUpdate(s);
			conn.commit();
		}
		//////////////////////////////
		int count3=0;
		String s3="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
		" AND UPPER(COLUMN_NAME) LIKE 'CUSTOMER_ABBR'";
		rset=stmt.executeQuery(s3);
		if(rset.next()){
			count3=rset.getInt(1);
		}
		if(count3==0){
			s3="ALTER TABLE FMS9_SECURITY_POST_MST ADD CUSTOMER_ABBR VARCHAR2(10 BYTE)";
			stmt.executeUpdate(s3);
			conn.commit();
		}
		
		//replaceData();
		////////////////////////////////
		String SysDate="";
		String findDate = "Select to_char(sysdate,'dd/mm/yyyy') from dual";
		rset1=stmt1.executeQuery(findDate);
		if(rset1.next())
		{
			SysDate=rset1.getString(1)==null?"":rset1.getString(1);
		}
		String Trans_Cd="";//System.out.println("cont_type****"+cont_type);
		/*HARSH20210212 if(!cont_type.equals("B")) //SB20201205
		{
		queryString1 = "SELECT CUSTOMER_NAME,CUSTOMER_ABBR,CREDIT_RATING FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Buyer_cd+"' and " +
		"eff_dt=(select max(eff_dt) from fms7_customer_mst where customer_cd='"+Buyer_cd+"') order by CUSTOMER_CD";
		}
		else //SB20201205
		{
			queryString1 ="select TRADER_NAME,TRADER_ABBR,TRADER_CD from FMS7_TRADER_MST B where TRADER_CD="+Buyer_cd+" "
					+ "and eff_dt=(select max(eff_dt) from FMS7_TRADER_MST where TRADER_CD='"+Buyer_cd+"')";	
		}*/
		//System.out.println("queryString: "+queryString);
		
		/////HARSH20210212/////////////
		queryString1 = "SELECT CUSTOMER_NAME,CUSTOMER_ABBR,CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"'";
		rset1 = stmt1.executeQuery(queryString1);
		if(rset1.next())
		{
			CUSTOMER_CD.add(rset1.getString(3)==null?"":rset1.getString(3));
			CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
			CUSTOMER_ABBR.add(rset1.getString(2)==null?"":rset1.getString(2));
		}else{
			queryString1 ="select TRADER_NAME,TRADER_ABBR,TRADER_CD from FMS7_TRADER_MST B where TRADER_ABBR='"+Customer_ABBR+"'";
			rset1 = stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				CUSTOMER_CD.add(rset1.getString(3)==null?"":rset1.getString(3));
				CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
				CUSTOMER_ABBR.add(rset1.getString(2)==null?"":rset1.getString(2));
			}
		}
		///////////////////////
		
		//String match_mappingID = cont_type+""+FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
		//HARSH20201203 String match_mappingID = FgsaNo+"-"+FgsaRevNo+"-"+SnNo+"-"+SnRevNo;
		String mapID ="";
		if(!LC_Mapping_Id.equals(""))
		{
			mapID=LC_Mapping_Id.substring(1,LC_Mapping_Id.length());
		}
		//System.out.println("mmmmm------"+match_mappingID);
		String securityList = "select CUSTOMER_CD,SEQ_NO,SEC_TYPE,VALUE,ISS_BANK_REF,TO_CHAR(REC_DT,'DD/MM/YYYY'),TO_CHAR(ISSU_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),REMARKS,MAPPING_ID,ISSUED,RECEIVED,APRV_DT,LINK,CURRENCY,REF_NO,STATUS,CUSTOMER_ABBR "
				+ "from FMS9_SECURITY_POST_MST where CUSTOMER_ABBR='"+Customer_ABBR+"' and LINK = '"+LC_Mapping_Id+"' and (EXP_DT >= TO_DATE('"+SysDate+"','DD/MM/YYYY') or EXP_DT IS NULL)";
		//HARSH20210212 ADDED CUSTOMER_ABBR //NOW WE USE CUSTOMER_ABBR INSTAED OF CUSTOMER_CD
		System.out.println(securityList);
		rset = stmt.executeQuery(securityList);
		while(rset.next())
		{
			issued=rset.getString(11)==null?"":rset.getString(11);
			received=rset.getString(12)==null?"":rset.getString(12);
			//System.out.println(issued+"----------"+received);
			if(issued.equals("") && received.equals(received_type))
			{	
				VflagSecurity.add(received);
				VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
				String SecurityType=rset.getString(3)==null?"":rset.getString(3);
				String AprvDt=rset.getString(13)==null?"":rset.getString(13);
				if(SecurityType.equals("OA"))
				{
					VSecurityStatus.add("No action required"); 
					VSecStatus.add("No action required");
				}
				else
				{
					VSecStatus.add(rset.getString(17)==null?"":rset.getString(17));
					if(AprvDt.equals(""))
						VSecurityStatus.add("Pending");
					else
						VSecurityStatus.add("Approved");
				}
				VSecurityTypeDesc.add(SecurityType);
				//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
				/*if(SecurityType.equals("PCG"))
					VSecurityDealCd.add("All");
				else*/
					
				VSecurityDealCd.add(rset.getString(14)==null?"":rset.getString(14));
			
				VSecurityAmt.add(rset.getString(4)==null?"":rset.getString(4));
				VSecurityDueDt.add(rset.getString(6)==null?"":rset.getString(6));
				VSecurityStartDt.add(rset.getString(7)==null?"":rset.getString(7));
				VSecurityEndDt.add(rset.getString(8)==null?"":rset.getString(8));
				VSecurityRmk.add(rset.getString(9)==null?"":rset.getString(9));
				Vexisting_cont.add(rset.getString(10)==null?"":rset.getString(10));
				Vsec_ref_no.add(rset.getString(16)==null?"":rset.getString(16));
				Vcurrency.add(rset.getString(15)==null?"":rset.getString(15));	
			}
			else if(issued.equals(issued_type) && received.equals(""))
			{
				
				VflagSecurity.add(issued);
				VActual_seq_no.add(rset.getString(2)==null?"0":rset.getString(2));
				String SecurityType=rset.getString(3)==null?"":rset.getString(3);
				String AprvDt=rset.getString(13)==null?"":rset.getString(13);
				if(SecurityType.equals("OA"))		
					VSecurityStatus.add("No action required"); 
				else
					if(AprvDt.equals(""))
						VSecurityStatus.add("Pending");
					else
						VSecurityStatus.add("Approved");
				VSecurityTypeDesc.add(SecurityType);
				//HARSH20210130 AS PER CUSTOMER FEEDBACK ON 29/01/2021
				/*if(SecurityType.equals("PCG"))
					VSecurityDealCd.add("All");
				else*/
					
				VSecurityDealCd.add(rset.getString(14)==null?"":rset.getString(14));
				
				VSecurityAmt.add(rset.getString(4)==null?"":rset.getString(4));
				VSecurityDueDt.add(rset.getString(6)==null?"":rset.getString(6));
				VSecurityStartDt.add(rset.getString(7)==null?"":rset.getString(7));
				VSecurityEndDt.add(rset.getString(8)==null?"":rset.getString(8));
				VSecurityRmk.add(rset.getString(9)==null?"":rset.getString(9));
				Vexisting_cont.add(rset.getString(10)==null?"":rset.getString(10));
				Vsec_ref_no.add(rset.getString(16)==null?"":rset.getString(16));
				Vcurrency.add(rset.getString(15)==null?"":rset.getString(15));
				VSecStatus.add(rset.getString(17)==null?"":rset.getString(17));
			}
		}
	}
	catch(Exception e)
	{
		e.printStackTrace();
	}
}
String cont_type = "";
public void setCont_type(String Cont_type) {this.cont_type = Cont_type;}
String issued_type = "";
public void setIssued_type(String Issued_type) {this.issued_type = Issued_type;}
String received_type = "";
public void setReceived_type(String Received_type) {this.received_type = Received_type;}
Vector Vcurrency = new Vector();
public Vector getVcurrency() {return Vcurrency;}
Vector VSecStatus = new Vector();
public Vector getVSecStatus() {return VSecStatus;}

/////////////////////////////////////////////////////////////////

///////////////////////////HARSH20201104/////////////////////////
	public void fetchAllCustomerLimitSummary()
	{
		try
		{
			String SysDate="";
			String findDate = "Select to_char(sysdate,'dd/mm/yyyy'),to_char(sysdate+6,'dd/mm/yyyy') from dual";
			rset1=stmt1.executeQuery(findDate);
			if(rset1.next())
			{
				SysDate=rset1.getString(1)==null?"":rset1.getString(1);
				NextSevenDayDt = rset1.getString(2)==null?"":rset1.getString(2); 
			}
			
			//String LimitAllData = "select cust_cd,limit_id,bank_cd,credit_rating from fms9_limit_mst ";
			String LimitAllData = "select DISTINCT cust_abbr,bank_cd from fms9_limit_mst";//HARSH20201208 ADDED BUY OR SELL COLUMN
			rset=stmt.executeQuery(LimitAllData);
			while(rset.next())
			{
				String lcust_cd = rset.getString(1)==null?"":rset.getString(1);
				String lbank_cd = rset.getString(2)==null?"":rset.getString(2);
				/*String buy_sell = rset.getString(3)==null?"":rset.getString(3); //HARSH20201208
				if(buy_sell.equals("B"))//HARSH20201208
				{
					VLSellBuy.add("BUY");//HARSH20201208
				}
				else
				{
					VLSellBuy.add("SELL");//HARSH20201208
				}*/
				//String limit_id = rset.getString(2)==null?"":rset.getString(2);
	
				queryString="select credit_rating from fms9_limit_mst where cust_abbr='"+lcust_cd+"' and bank_cd='"+lbank_cd+"' and limit_id=(select max(limit_id) from fms9_limit_mst where cust_abbr='"+lcust_cd+"' and bank_cd='"+lbank_cd+"')"; // and buy_sell='"+buy_sell+"' // and buy_sell='"+buy_sell+"'
				rset1=stmt1.executeQuery(queryString);
				if(rset1.next())
				{
					VcreditRating.add(rset1.getString(1)==null?"":rset1.getString(1));
				}
				if(!lcust_cd.equals("BANK"))
				{
					String cnm = "";
					//if(buy_sell.equals("B"))//HARSH20201208
					//{
						//cnm = "SELECT TRADER_NAME from FMS7_TRADER_MST where TRADER_CD='"+lcust_cd+"'";//HARSH20201208
					//}
					//else
					//{
						cnm = "SELECT CUSTOMER_NAME from fms7_customer_mst where CUSTOMER_ABBR='"+lcust_cd+"'";
					//}
					rset3=stmt3.executeQuery(cnm);
					if(rset3.next())
					{
						Vc_b_nm.add(rset3.getString(1)==null?"":rset3.getString(1));
					}
					else
					{
						cnm = "SELECT TRADER_NAME from FMS7_TRADER_MST where TRADER_ABBR='"+lcust_cd+"'";//HARSH20201208
						rset3=stmt3.executeQuery(cnm);
						if(rset3.next())
						{
							Vc_b_nm.add(rset3.getString(1)==null?"":rset3.getString(1));
						}
						else
						{
							Vc_b_nm.add("");
						}
					}
				}
				else if(!lbank_cd.equals("0"))
				{
					String bnm="select bank_name,branch_name from fms7_bank_mst where bank_cd='"+lbank_cd+"'";
					rset3=stmt3.executeQuery(bnm);
					if(rset3.next())
					{
						Vc_b_nm.add(rset3.getString(1)==null?"":rset3.getString(1));
					}
				}
				else
				{
					Vc_b_nm.add("");
				}
				double available = 0;
				double total_limit = 0;
				double unsecured = 0;
				double temporary =0;
				double adjust_usage = 0;
				double net_usage = 0;
				double usage = 0;
				double used = 0;
				
				String limitSummray = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,a.cust_abbr,a.bank_cd,b.remarks from fms9_limit_mst a,fms9_limit_dtl b "
						+ "where (a.cust_abbr='"+lcust_cd+"' and a.bank_cd='"+lbank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id and eff_dt <= to_date('"+SysDate+"','dd/mm/yyyy') and ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+SysDate+"','DD/MM/YYYY') and inactivation_dt is null) or ((exp_dt >= to_date('"+SysDate+"','DD/MM/YYYY') or exp_dt is null) and inactivation_dt-1 >= to_date('"+SysDate+"','DD/MM/YYYY')))";  //and a.buy_sell='"+buy_sell+"' and a.buy_sell=b.buy_sell  
				//HARSH20210128 NOW MATCH EXP_DT AND INACTIVATION_DT WHICH ONE IS LESS DATE THAT IS OUR EXPIRATION DAYE AS PER CUSTOMER FEEDBACK ON 27/01/2021
				//HARSH20210122 and b.flag='Y'
				//HARSH20210122 WE ADD CONDITION LIKE EXP_DT IS NULL AS PER CUSTOMER FEEDBACK NOW EXP_DT IS NOT MANDATORY FIELD
				rset2 = stmt2.executeQuery(limitSummray);
				while(rset2.next())
				{
					String action_ty = rset2.getString(8)==null?"":rset2.getString(8);
					String limit_ty = rset2.getString(6)==null?"":rset2.getString(6);
					double amt = Double.parseDouble(rset2.getString(1)==null?"0":rset2.getString(1));
								
					if(!limit_ty.equals("Unsecured") && action_ty.equals("Adjust Usage"))
					{
						adjust_usage = adjust_usage + amt;
					}
					if(limit_ty.equals("Unsecured") && action_ty.equals("Adjust Limit"))
					{
						unsecured = unsecured + amt;
					}
					if(limit_ty.equals("Temporary") && action_ty.equals("Adjust Limit"))
					{
						temporary = temporary + amt;
					}	
					if(action_ty.equals("Adjust Limit"))
					{
						total_limit = total_limit + amt;
					}
				}
				//HARSH20210303 USAGE CALCULATION
				if(!lcust_cd.equals("BANK"))
				{
					usage = limit_usage_calculation(lcust_cd);
				}
				//System.out.println("usage ## "+nf.format(usage));
				////
				available = total_limit + adjust_usage - usage;
				net_usage = usage - adjust_usage;
				if(total_limit > 0)
					used = usage / total_limit;
				else
					used = 0;

				Vavailable.add(nf.format(available));
				Vtotal_limit.add(nf.format(total_limit));
				Vunsecured.add(nf.format(unsecured));
				Vtemporary.add(nf.format(temporary));
				Vadjust_usage.add(nf.format(adjust_usage));
				Vusage.add(nf.format(usage));
				Vnet_usage.add(nf.format(net_usage));
				Vused.add(nf.format(used));
				
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	Vector Vc_b_nm = new Vector();
	public Vector getVc_b_nm() {return Vc_b_nm;}
	Vector VcreditRating = new Vector();
	public Vector getVcreditRating() {return VcreditRating;}
	Vector VLSellBuy = new Vector();
	public Vector getVLSellBuy() {return VLSellBuy;}
/////////////////////////////////////////////////////////////////
////////////////////////HARSH20201110///////////////////////////	
	public void fetchAuditReport()
	{
		try
		{
			////////////HARSH20210106//////////////////////////////////
	    	int count1=0;
			String s1="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'SEC_LOG_DETAILS' "+
			" AND UPPER(COLUMN_NAME) LIKE 'NEW_VALUE'";
			rset=stmt.executeQuery(s1);
			if(rset.next()){
				count1=rset.getInt(1);
			}
			if(count1==0){
				s1="ALTER TABLE SEC_LOG_DETAILS ADD NEW_VALUE VARCHAR2(1024 BYTE)";
				stmt.executeUpdate(s1);
				conn.commit();
			}
			int count2=0;
			String s2="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'SEC_LOG_DETAILS' "+
			" AND UPPER(COLUMN_NAME) LIKE 'OLD_VALUE'";
			rset=stmt.executeQuery(s2);
			if(rset.next()){
				count2=rset.getInt(1);
			}
			if(count2==0){
				s2="ALTER TABLE SEC_LOG_DETAILS ADD OLD_VALUE VARCHAR2(1024 BYTE)";
				stmt.executeUpdate(s2);
				conn.commit();
			}
			///////////////////////////////////////////////////////////////
			if(sell_buy.equals("Buy")) //HARSH20201217
			{
				queryString ="select TRADER_CD,TRADER_NAME from FMS7_TRADER_MST order by trader_name";//HARSH20201217
			}
			else
			{
				queryString="select customer_cd,customer_name from fms7_customer_mst order by customer_name";
			}
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				CUSTOMER_CD.add(rset.getString(1)==null?"":rset.getString(1));
				CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
			}
			if(sell_buy.equals("Buy"))//HARSH20201217
			{
				queryString ="select TRADER_CD,TRADER_NAME from FMS7_TRADER_MST where trader_cd='"+Buyer_cd+"'";//HARSH20201217
			}
			else
			{
				queryString="select customer_cd,customer_name from fms7_customer_mst where customer_cd='"+Buyer_cd+"'";
			}
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				//CUSTOMER_CD.add(rset.getString(1)==null?"":rset.getString(1));
				//CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
				TempCustName=rset.getString(2)==null?"":rset.getString(2);
			}
			queryString="select new_value,old_value,log_time,to_char(log_dt,'dd/mm/yyyy'),log_uid from SEC_LOG_DETAILS where FORM_NAME IN ('Supply Notice','LoA Master','Confirmation Notice','Period Agreement','Mandate Confirmation') AND LOG_DT = to_date('"+to_date+"','dd/mm/yyyy') order by LOG_TIME DESC";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				String new_values = rset.getString(1)==null?"":rset.getString(1);
				String old_values = rset.getString(2)==null?"":rset.getString(2);
				String time = rset.getString(3)==null?"":rset.getString(3);
				String update_dt=rset.getString(4)==null?"":rset.getString(4);
				String update_by=rset.getString(5)==null?"":rset.getString(5);
				
				if(!new_values.equals(""))
				{	String cust_nm="";
					String cust_cd="",cust_abbr="",sec_ref_no="",deal_no="",sec_ty="",due_dt="",currency="",amt="",rmk="",InOut="";
					
					String old_cust_cd="",old_cust_abbr="",old_sec_ref_no="",old_deal_no="",old_sec_ty="",old_due_dt="",old_currency="",old_amt="",old_rmk="",old_InOut="";
					
					String split_New_Value[] = new_values.split("#");
					//System.out.println("########NEW Value##############");
					for(int i=0; i<split_New_Value.length; i++)
					{
						if(split_New_Value[i].startsWith("CustCd=")){
							String temp[] = split_New_Value[i].split("CustCd=");
							if(temp.length>0){
								cust_cd=temp[1];
								//System.out.println(temp[1]);
							}
						}
						if(split_New_Value[i].startsWith("CustABBR=")){
							String temp[] = split_New_Value[i].split("CustABBR=");
							if(temp.length>0){
								cust_abbr=temp[1];
								//System.out.println(temp[1]);
							}
						}
						if(split_New_Value[i].startsWith("SecRefNo=")){
							String temp[] = split_New_Value[i].split("SecRefNo=");
							if(temp.length>0){
								sec_ref_no=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("DealNo=")){
							String temp[] = split_New_Value[i].split("DealNo=");
							if(temp.length>0){
								deal_no=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("SecTy=")){
							String temp[] = split_New_Value[i].split("SecTy=");
							if(temp.length>0){
								sec_ty=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("DueDt=")){
							String temp[] = split_New_Value[i].split("DueDt=");
							if(temp.length>0){
								due_dt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Currency=")){
							String temp[] = split_New_Value[i].split("Currency=");
							if(temp.length>0){
								currency=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Amt=")){
							String temp[] = split_New_Value[i].split("Amt=");
							if(temp.length>0){
								amt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Rmk=")){
							String temp[] = split_New_Value[i].split("Rmk=");
							if(temp.length>0){
								rmk=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("InOut=")){
							String temp[] = split_New_Value[i].split("InOut=");
							if(temp.length>0){
								InOut=temp[1];
							}
						}
					}//End for i
					
					if(!old_values.equals(""))
					{
						String split_Old_Value[] = old_values.split("#");
						for(int j=0; j<split_Old_Value.length; j++)
						{
							if(split_Old_Value[j].startsWith("SecTy=")){
								String temp[] = split_Old_Value[j].split("SecTy=");
								if(temp.length>0){
									old_sec_ty=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("DueDt=")){
								String temp[] = split_Old_Value[j].split("DueDt=");
								if(temp.length>0){
									old_due_dt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Currency=")){
								String temp[] = split_Old_Value[j].split("Currency=");
								if(temp.length>0){
									old_currency=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Amt=")){
								String temp[] = split_Old_Value[j].split("Amt=");
								if(temp.length>0){
									old_amt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Rmk=")){
								String temp[] = split_Old_Value[j].split("Rmk=");
								if(temp.length>0){
									old_rmk=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("InOut=")){
								String temp[] = split_Old_Value[j].split("InOut=");
								if(temp.length>0){
									old_InOut=temp[1];
								}
							}
						}//end for j
					}else{
						old_cust_cd="";old_cust_abbr="";old_sec_ref_no="";old_deal_no="";old_sec_ty="";old_due_dt="";old_currency="";old_amt="";old_rmk="";old_InOut="";
					}//End else old_value
					
					/*HARSH20210213 String cont_ty = deal_no.substring(0,1);
					if(cont_ty.equals("B")){
						queryString ="select TRADER_NAME from FMS7_TRADER_MST where trader_cd='"+cust_cd+"'";
					}else{
						queryString="select customer_name from fms7_customer_mst where customer_cd='"+cust_cd+"'";
					}
					rset1=stmt1.executeQuery(queryString);
					if(rset1.next())
					{
						cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
					}*/
					
					deal_no=getDisplayDealId(deal_no); //HARSH20220228
					
					queryString="select customer_name from fms7_customer_mst where customer_abbr='"+cust_abbr+"'";
					rset1=stmt1.executeQuery(queryString);
					if(rset1.next())
					{
						cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
					}else{
						queryString ="select TRADER_NAME from FMS7_TRADER_MST where trader_abbr='"+cust_abbr+"'";
						rset1=stmt1.executeQuery(queryString);
						if(rset1.next())
						{
							cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
						}
					}
					/*HARSH20210128 if(cont_ty.equals("A")){
						deal_no="All";
					}*/
					
					if(!sec_ty.equals(old_sec_ty))
					{
						VNew_Changes.add(sec_ty);
						VOld_Changes.add(old_sec_ty);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Security Type");
						VRef_NO.add(sec_ref_no);
					}
					if(!due_dt.equals(old_due_dt))
					{
						VNew_Changes.add(due_dt);
						VOld_Changes.add(old_due_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						if(InOut.equals("R")){
							VField_Name.add("Expected Receipt(Due) Date");
						}else{
							VField_Name.add("Expected Issuance Date");
						}
						VRef_NO.add(sec_ref_no);
					}
					if(!currency.equals(old_currency))
					{
						VNew_Changes.add(currency);
						VOld_Changes.add(old_currency);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Currency");
						VRef_NO.add(sec_ref_no);
					}
					if(!amt.equals(old_amt))
					{
						VNew_Changes.add(amt);
						VOld_Changes.add(old_amt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Amount");
						VRef_NO.add(sec_ref_no);
					}
					if(!rmk.equals(old_rmk))
					{
						VNew_Changes.add(rmk);
						VOld_Changes.add(old_rmk);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Remarks");
						VRef_NO.add(sec_ref_no);
					}
				}//End if new_value
			}
			////Post Deal Capturing
			queryString="select new_value,old_value,log_time,to_char(log_dt,'dd/mm/yyyy'),log_uid from SEC_LOG_DETAILS where FORM_NAME='Collateral Management' AND LOG_DT = to_date('"+to_date+"','dd/mm/yyyy') order by LOG_TIME DESC";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				String new_values = rset.getString(1)==null?"":rset.getString(1);
				String old_values = rset.getString(2)==null?"":rset.getString(2);
				String time = rset.getString(3)==null?"":rset.getString(3);
				String update_dt=rset.getString(4)==null?"":rset.getString(4);
				String update_by=rset.getString(5)==null?"":rset.getString(5);
				
				if(!new_values.equals(""))
				{	String cust_nm="";
					String cust_cd="",cust_abbr="",sec_ref_no="",deal_no="",sec_ty="",due_dt="",currency="",amt="",rmk="",value_vari="",value_flcu="",iss_bk="",iss_bk_ref="",adv_bk="",adv_bk_ref="",conf_bk="",conf_bk_ref="",iss_dt="",exp_dt="",tenor="",review_dt="",in="",out="",renew_dt="",guran_cd="",status="",cancel_dt="";
					
					String old_cust_cd="",old_cust_abbr="",old_sec_ref_no="",old_deal_no="",old_sec_ty="",old_due_dt="",old_currency="",old_amt="",old_rmk="",old_value_vari="",old_value_flcu="",old_iss_bk="",old_iss_bk_ref="",old_adv_bk="",old_adv_bk_ref="",old_conf_bk="",old_conf_bk_ref="",old_iss_dt="",old_exp_dt="",old_tenor="",old_review_dt="",old_in="",old_out="",old_renew_dt="",old_guran_cd="",old_status="",old_cancel_dt="";
					
					String split_New_Value[] = new_values.split("#");
					//System.out.println("########NEW Value##############");
					for(int i=0; i<split_New_Value.length; i++)
					{
						if(split_New_Value[i].startsWith("CustCd=")){
							String temp[] = split_New_Value[i].split("CustCd=");
							if(temp.length>0){
								cust_cd=temp[1];
								//System.out.println(temp[1]);
							}
						}
						if(split_New_Value[i].startsWith("CustABBR=")){
							String temp[] = split_New_Value[i].split("CustABBR=");
							if(temp.length>0){
								cust_abbr=temp[1];
								//System.out.println(temp[1]);
							}
						}
						if(split_New_Value[i].startsWith("SecRefNo=")){
							String temp[] = split_New_Value[i].split("SecRefNo=");
							if(temp.length>0){
								sec_ref_no=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("DealNo=")){
							String temp[] = split_New_Value[i].split("DealNo=");
							if(temp.length>0){
								deal_no=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("SecTy=")){
							String temp[] = split_New_Value[i].split("SecTy=");
							if(temp.length>0){
								sec_ty=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("DueDt=")){
							String temp[] = split_New_Value[i].split("DueDt=");
							if(temp.length>0){
								due_dt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Currency=")){
							String temp[] = split_New_Value[i].split("Currency=");
							if(temp.length>0){
								currency=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Amt=")){
							String temp[] = split_New_Value[i].split("Amt=");
							if(temp.length>0){
								amt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Rmk=")){
							String temp[] = split_New_Value[i].split("Rmk=");
							if(temp.length>0){
								rmk=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("ValueVari=")){
							String temp[] = split_New_Value[i].split("ValueVari=");
							if(temp.length>0){
								value_vari=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("ValueFlcu=")){
							String temp[] = split_New_Value[i].split("ValueFlcu=");
							if(temp.length>0){
								value_flcu=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("IssBk=")){
							String temp[] = split_New_Value[i].split("IssBk=");
							if(temp.length>0){
								iss_bk=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("IssBkRef=")){
							String temp[] = split_New_Value[i].split("IssBkRef=");
							if(temp.length>0){
								iss_bk_ref=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("AdvBk=")){
							String temp[] = split_New_Value[i].split("AdvBk=");
							if(temp.length>0){
								adv_bk=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("AdvBkRef=")){
							String temp[] = split_New_Value[i].split("AdvBkRef=");
							if(temp.length>0){
								adv_bk_ref=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("ConfBk=")){
							String temp[] = split_New_Value[i].split("ConfBk=");
							if(temp.length>0){
								conf_bk=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("ConfBkRef=")){
							String temp[] = split_New_Value[i].split("ConfBkRef=");
							if(temp.length>0){
								conf_bk_ref=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("IssDt=")){
							String temp[] = split_New_Value[i].split("IssDt=");
							if(temp.length>0){
								iss_dt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("ExpDt=")){
							String temp[] = split_New_Value[i].split("ExpDt=");
							if(temp.length>0){
								exp_dt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Tenor=")){
							String temp[] = split_New_Value[i].split("Tenor=");
							if(temp.length>0){
								tenor=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("ReviewDt=")){
							String temp[] = split_New_Value[i].split("ReviewDt=");
							if(temp.length>0){
								review_dt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("In=")){
							String temp[] = split_New_Value[i].split("In=");
							if(temp.length>0){
								in=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Out=")){
							String temp[] = split_New_Value[i].split("Out=");
							if(temp.length>0){
								out=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("RenewDt=")){
							String temp[] = split_New_Value[i].split("RenewDt=");
							if(temp.length>0){
								renew_dt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("GuarantorAbbr=")){
							String temp[] = split_New_Value[i].split("GuarantorAbbr=");
							if(temp.length>0){
								guran_cd=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Status=")){
							String temp[] = split_New_Value[i].split("Status=");
							if(temp.length>0){
								status=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("CancelDt=")){
							String temp[] = split_New_Value[i].split("CancelDt=");
							if(temp.length>0){
								cancel_dt=temp[1];
							}
						}
					}//End for i
					
					if(!old_values.equals(""))
					{
						String split_Old_Value[] = old_values.split("#");
						for(int j=0; j<split_Old_Value.length; j++)
						{
							if(split_Old_Value[j].startsWith("SecTy=")){
								String temp[] = split_Old_Value[j].split("SecTy=");
								if(temp.length>0){
									old_sec_ty=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("DueDt=")){
								String temp[] = split_Old_Value[j].split("DueDt=");
								if(temp.length>0){
									old_due_dt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Currency=")){
								String temp[] = split_Old_Value[j].split("Currency=");
								if(temp.length>0){
									old_currency=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Amt=")){
								String temp[] = split_Old_Value[j].split("Amt=");
								if(temp.length>0){
									old_amt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Rmk=")){
								String temp[] = split_Old_Value[j].split("Rmk=");
								if(temp.length>0){
									old_rmk=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("ValueVari=")){
								String temp[] = split_Old_Value[j].split("ValueVari=");
								if(temp.length>0){
									old_value_vari=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("ValueFlcu=")){
								String temp[] = split_Old_Value[j].split("ValueFlcu=");
								if(temp.length>0){
									old_value_flcu=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("IssBk=")){
								String temp[] = split_Old_Value[j].split("IssBk=");
								if(temp.length>0){
									old_iss_bk=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("IssBkRef=")){
								String temp[] = split_Old_Value[j].split("IssBkRef=");
								if(temp.length>0){
									old_iss_bk_ref=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("AdvBk=")){
								String temp[] = split_Old_Value[j].split("AdvBk=");
								if(temp.length>0){
									old_adv_bk=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("AdvBkRef=")){
								String temp[] = split_Old_Value[j].split("AdvBkRef=");
								if(temp.length>0){
									old_adv_bk_ref=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("ConfBk=")){
								String temp[] = split_Old_Value[j].split("ConfBk=");
								if(temp.length>0){
									old_conf_bk=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("ConfBkRef=")){
								String temp[] = split_Old_Value[j].split("ConfBkRef=");
								if(temp.length>0){
									old_conf_bk_ref=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("IssDt=")){
								String temp[] = split_Old_Value[j].split("IssDt=");
								if(temp.length>0){
									old_iss_dt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("ExpDt=")){
								String temp[] = split_Old_Value[j].split("ExpDt=");
								if(temp.length>0){
									old_exp_dt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Tenor=")){
								String temp[] = split_Old_Value[j].split("Tenor=");
								if(temp.length>0){
									old_tenor=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("ReviewDt=")){
								String temp[] = split_Old_Value[j].split("ReviewDt=");
								if(temp.length>0){
									old_review_dt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("In=")){
								String temp[] = split_Old_Value[j].split("In=");
								if(temp.length>0){
									old_in=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Out=")){
								String temp[] = split_Old_Value[j].split("Out=");
								if(temp.length>0){
									old_out=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("RenewDt=")){
								String temp[] = split_Old_Value[j].split("RenewDt=");
								if(temp.length>0){
									old_renew_dt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("GuarantorAbbr=")){
								String temp[] = split_Old_Value[j].split("GuarantorAbbr=");
								if(temp.length>0){
									old_guran_cd=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Status=")){
								String temp[] = split_Old_Value[j].split("Status=");
								if(temp.length>0){
									old_status=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("CancelDt=")){
								String temp[] = split_Old_Value[j].split("CancelDt=");
								if(temp.length>0){
									old_cancel_dt=temp[1];
								}
							}
						}//end for j
					}else{
						old_cust_cd="";old_cust_abbr="";old_sec_ref_no="";old_deal_no="";old_sec_ty="";old_due_dt="";old_currency="";old_amt="";old_rmk="";
						old_value_vari="";old_value_flcu="";old_iss_bk=""; old_iss_bk="";old_adv_bk="";old_adv_bk_ref="";old_conf_bk=""; old_conf_bk_ref="";
						old_iss_dt="";old_exp_dt="";old_tenor="";old_review_dt="";old_in="";old_out="";old_renew_dt="";old_guran_cd="";old_status="";old_cancel_dt="";
					}//End else old_value
					
					/*String cont_ty = deal_no.substring(0,1);
					if(cont_ty.equals("B")){
						queryString ="select TRADER_NAME from FMS7_TRADER_MST where trader_cd='"+cust_cd+"'";
					}else{
						queryString="select customer_name from fms7_customer_mst where customer_cd='"+cust_cd+"'";
					}
					rset1=stmt1.executeQuery(queryString);
					if(rset1.next())
					{
						cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
					}*/
					/*HARSH20210130 if(cont_ty.equals("A")){
						deal_no="All";
					}*/
					
					deal_no = getDisplayDealId(deal_no);//HARSH20220228
					
					queryString="select customer_name from fms7_customer_mst where customer_abbr='"+cust_abbr+"'";
					rset1=stmt1.executeQuery(queryString);
					if(rset1.next())
					{
						cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
					}else{
						queryString ="select TRADER_NAME from FMS7_TRADER_MST where trader_abbr='"+cust_abbr+"'";
						rset1=stmt1.executeQuery(queryString);
						if(rset1.next())
						{
							cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
						}
					}
					
					
					if(!sec_ty.equals(old_sec_ty))
					{
						VNew_Changes.add(sec_ty);
						VOld_Changes.add(old_sec_ty);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Security Type");
						VRef_NO.add(sec_ref_no);
					}
					if(!due_dt.equals(old_due_dt))
					{
						VNew_Changes.add(due_dt);
						VOld_Changes.add(old_due_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Received/Authenticated Date");
						VRef_NO.add(sec_ref_no);
					}
					if(!currency.equals(old_currency))
					{
						VNew_Changes.add(currency);
						VOld_Changes.add(old_currency);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Currency");
						VRef_NO.add(sec_ref_no);
					}
					if(!amt.equals(old_amt))
					{
						VNew_Changes.add(amt);
						VOld_Changes.add(old_amt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Amount");
						VRef_NO.add(sec_ref_no);
					}
					if(!rmk.equals(old_rmk))
					{
						VNew_Changes.add(rmk);
						VOld_Changes.add(old_rmk);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Remarks");
						VRef_NO.add(sec_ref_no);
					}
					if(!value_vari.equals(old_value_vari))
					{
						VNew_Changes.add(value_vari);
						VOld_Changes.add(old_value_vari);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Value Variartion");
						VRef_NO.add(sec_ref_no);
					}
					if(!value_flcu.equals(old_value_flcu))
					{
						VNew_Changes.add(value_flcu);
						VOld_Changes.add(old_value_flcu);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Value Fluctuation(%)");
						VRef_NO.add(sec_ref_no);
					}
					if(!iss_bk.equals(old_iss_bk))
					{
						String issbknm=BankName(iss_bk);
						VNew_Changes.add(issbknm);
						String oldissbknm=BankName(old_iss_bk);
						VOld_Changes.add(oldissbknm);
						
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Issuing Bank Name");
						VRef_NO.add(sec_ref_no);
					}
					if(!iss_bk_ref.equals(old_iss_bk_ref))
					{
						VNew_Changes.add(iss_bk_ref);
						VOld_Changes.add(old_iss_bk_ref);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Issuing Bank Reference");
						VRef_NO.add(sec_ref_no);
					}
					if(!adv_bk.equals(old_adv_bk))
					{
						String advbknm=BankName(adv_bk);
						VNew_Changes.add(advbknm);
						String oldadvbknm = BankName(old_adv_bk);
						VOld_Changes.add(oldadvbknm);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Advising Bank Name");
						VRef_NO.add(sec_ref_no);
					}
					if(!adv_bk_ref.equals(old_adv_bk_ref))
					{
						VNew_Changes.add(adv_bk_ref);
						VOld_Changes.add(old_adv_bk_ref);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Advising Bank Reference");
						VRef_NO.add(sec_ref_no);
					}
					if(!conf_bk.equals(old_conf_bk))
					{
						String confbknm= BankName(conf_bk);
						VNew_Changes.add(confbknm);
						String oldconfbknm = BankName(old_conf_bk);
						VOld_Changes.add(oldconfbknm);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Confirming Bank Name");
						VRef_NO.add(sec_ref_no);
					}
					if(!conf_bk_ref.equals(old_conf_bk_ref))
					{
						VNew_Changes.add(conf_bk_ref);
						VOld_Changes.add(old_conf_bk_ref);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Confirming Bank Reference");
						VRef_NO.add(sec_ref_no);
					}
					if(!iss_dt.equals(old_iss_dt))
					{
						VNew_Changes.add(iss_dt);
						VOld_Changes.add(old_iss_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Issuance Date");
						VRef_NO.add(sec_ref_no);
					}
					if(!exp_dt.equals(old_exp_dt))
					{
						VNew_Changes.add(exp_dt);
						VOld_Changes.add(old_exp_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Expire Date");
						VRef_NO.add(sec_ref_no);
					}
					if(!tenor.equals(old_tenor))
					{
						VNew_Changes.add(tenor);
						VOld_Changes.add(old_tenor);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Tenor");
						VRef_NO.add(sec_ref_no);
					}
					if(!review_dt.equals(old_review_dt))
					{
						VNew_Changes.add(review_dt);
						VOld_Changes.add(old_review_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Review Date");
						VRef_NO.add(sec_ref_no);
					}
					/*if(!in.equals(old_in))
					{
						String r = "",old_r;
						if(in.equals("R")){r="Outgoing";}else{r="Incoming";}
						if(old_in.equals("R")){old_r="Outgoing";}else{old_r="Incoming";}
						VNew_Changes.add(r);
						VOld_Changes.add(old_r);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Incoming/Outgoing");
						VRef_NO.add(sec_ref_no);
					}
					if(!out.equals(old_out))
					{
						String r = "",old_r;
						if(in.equals("R")){r="Outgoing";}else{r="Incoming";}
						if(old_in.equals("R")){old_r="Outgoing";}else{old_r="Incoming";}
						VNew_Changes.add(r);
						VOld_Changes.add(old_r);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Incoming/Outgoing");
						VRef_NO.add(sec_ref_no);
					}*/
					if(!renew_dt.equals(old_renew_dt))
					{
						VNew_Changes.add(renew_dt);
						VOld_Changes.add(old_renew_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Renew Date");
						VRef_NO.add(sec_ref_no);
					}
					if(!status.equals(old_status))
					{
						VNew_Changes.add(status);
						VOld_Changes.add(old_status);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Status");
						VRef_NO.add(sec_ref_no);
					}
					if(!cancel_dt.equals(old_cancel_dt))
					{
						VNew_Changes.add(cancel_dt);
						VOld_Changes.add(old_cancel_dt);
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Cancel Date");
						VRef_NO.add(sec_ref_no);
					}
					if(!guran_cd.equals(old_guran_cd))
					{
						queryString2="select customer_name from fms7_customer_mst where customer_abbr='"+guran_cd+"'";
						rset2=stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							VNew_Changes.add(rset2.getString(1)==null?"":rset2.getString(1));
						}else{
							queryString2="select trader_name from fms7_trader_mst where trader_abbr='"+guran_cd+"'";
							rset2=stmt2.executeQuery(queryString2);
							if(rset2.next())
							{
								VNew_Changes.add(rset2.getString(1)==null?"":rset2.getString(1));
							}else{
								VNew_Changes.add("");
							}
						}
						queryString2="select customer_name from fms7_customer_mst where customer_abbr='"+old_guran_cd+"'";
						rset2=stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							VOld_Changes.add(rset2.getString(1)==null?"":rset2.getString(1));
						}else{
							queryString2="select trader_name from fms7_trader_mst where trader_abbr='"+old_guran_cd+"'";
							rset2=stmt2.executeQuery(queryString2);
							if(rset2.next())
							{
								VOld_Changes.add(rset2.getString(1)==null?"":rset2.getString(1));
							}else{
								VOld_Changes.add("");
							}
						}
						VDeal_NO.add(deal_no);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Guarantor Name");
						VRef_NO.add(sec_ref_no);
					}
				}//End if new_value
			}
			fetchLimitAuditReport();//HARSH20201223
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	public void fetchLimitAuditReport()
	{
		try
		{
			/*if(Buyer_cd.equals(""))
			{
				queryString="select cust_cd,limit_id from fms9_limit_mst order by cust_cd ASC,limit_id DESC";
			}
			else
			{
				queryString="select cust_cd,limit_id from fms9_limit_mst where cust_cd='"+Buyer_cd+"' order by cust_cd ASC,limit_id DESC";
			}*/
			queryString="select new_value,old_value,log_time,to_char(log_dt,'dd/mm/yyyy'),log_uid from SEC_LOG_DETAILS where FORM_NAME='Credit Limit Management / Credit Rating' AND LOG_DT = to_date('"+to_date+"','dd/mm/yyyy') order by LOG_TIME DESC";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				String new_values = rset.getString(1)==null?"":rset.getString(1);
				String old_values = rset.getString(2)==null?"":rset.getString(2);
				String time = rset.getString(3)==null?"":rset.getString(3);
				String update_dt=rset.getString(4)==null?"":rset.getString(4);
				String update_by=rset.getString(5)==null?"":rset.getString(5);
				//System.out.println(rset.getString(3));
				
				if(!new_values.equals(""))
				{
					String cust_nm="",cust_abbr="",bank_cd="";
					String creditRat = "",parentAbbr="",percentOwn="",parentEntDt="",parentExitDt="";
					String limitTy = "",limitAct="",userTy="",effDt="",expDt="",reviewDt="",status="",rmk="",ref_no="",inact_dt="";
					double amt=0; String st_amt="", old_st_amt="";
					double old_amt=0;
					
					String old_creditRat = "",old_parentAbbr="",old_percentOwn="",old_parentEntDt="",old_parentExitDt="";
					String old_limitTy = "",old_limitAct="",old_userTy="",old_effDt="",old_expDt="",old_reviewDt="",old_status="",old_rmk="",old_ref_no="",old_inact_dt="";
					
					String split_New_Value[] = new_values.split("#");
					//System.out.println("########NEW Value##############");
					for(int i=0; i<split_New_Value.length; i++)
					{
						if(split_New_Value[i].startsWith("Cust_abbr=")){
							String temp[] = split_New_Value[i].split("Cust_abbr=");
							if(temp.length>0){
								cust_abbr=temp[1];
								//System.out.println(temp[1]);
							}
						}
						if(split_New_Value[i].startsWith("Bank_cd=")){
							String temp[] = split_New_Value[i].split("Bank_cd=");
							if(temp.length>0){
								bank_cd=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Status=")){
							String temp[] = split_New_Value[i].split("Status=");
							if(temp.length>0){
								status=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("LimitType=")){
							String temp[] = split_New_Value[i].split("LimitType=");
							if(temp.length>0){
								limitTy=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("LimitAction=")){
							String temp[] = split_New_Value[i].split("LimitAction=");
							if(temp.length>0){
								limitAct=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("UserType=")){
							String temp[] = split_New_Value[i].split("UserType=");
							if(temp.length>0){
								userTy=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Amount=")){
							String temp[] = split_New_Value[i].split("Amount=");
							if(temp.length>0){
								amt=Double.parseDouble(temp[1]);
								st_amt=nf.format(amt);
							}
						}
						if(split_New_Value[i].startsWith("Eff_DT=")){
							String temp[] = split_New_Value[i].split("Eff_DT=");
							if(temp.length>0){
								effDt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Exp_DT=")){
							String temp[] = split_New_Value[i].split("Exp_DT=");
							if(temp.length>0){
								expDt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Review_DT=")){
							String temp[] = split_New_Value[i].split("Review_DT=");
							if(temp.length>0){
								reviewDt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Remarks=")){
							String temp[] = split_New_Value[i].split("Remarks=");
							if(temp.length>0){
								rmk=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Credit_rating=")){
							String temp[] = split_New_Value[i].split("Credit_rating=");
							if(temp.length>0){
								creditRat=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Parent_Legal_Entity=")){
							String temp[] = split_New_Value[i].split("Parent_Legal_Entity=");
							if(temp.length>0){
								parentAbbr= temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Percentage_Own=")){
							String temp[] = split_New_Value[i].split("Percentage_Own=");
							if(temp.length>0){
								percentOwn=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Parent_Entry_Dt=")){
							String temp[] = split_New_Value[i].split("Parent_Entry_Dt=");
							if(temp.length>0){
								parentEntDt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Parent_Exit_Dt=")){
							String temp[] = split_New_Value[i].split("Parent_Exit_Dt=");
							if(temp.length>0){
								parentExitDt=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("Ref_no=")){
							String temp[] = split_New_Value[i].split("Ref_no=");
							if(temp.length>0){
								ref_no=temp[1];
							}
						}
						if(split_New_Value[i].startsWith("InactDt=")){
							String temp[] = split_New_Value[i].split("InactDt=");
							if(temp.length>0){
								inact_dt=temp[1];
							}
						}
					}
					//System.out.println("########OLD Value##############");
					if(!old_values.equals(""))
					{
						String split_Old_Value[] = old_values.split("#");
						for(int j=0; j<split_Old_Value.length; j++)
						{
							if(split_Old_Value[j].startsWith("Status=")){
								String temp[] = split_Old_Value[j].split("Status=");
								if(temp.length>0){
									old_status=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("LimitType=")){
								String temp[] = split_Old_Value[j].split("LimitType=");
								if(temp.length>0){
									old_limitTy=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("LimitAction=")){
								String temp[] = split_Old_Value[j].split("LimitAction=");
								if(temp.length>0){
									old_limitAct=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("UserType=")){
								String temp[] = split_Old_Value[j].split("UserType=");
								if(temp.length>0){
									old_userTy=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Amount=")){
								String temp[] = split_Old_Value[j].split("Amount=");
								if(temp.length>0){
									old_amt=Double.parseDouble(temp[1]);
									old_st_amt=nf.format(old_amt);
								}
							}
							if(split_Old_Value[j].startsWith("Eff_DT=")){
								String temp[] = split_Old_Value[j].split("Eff_DT=");
								if(temp.length>0){
									old_effDt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Exp_DT=")){
								String temp[] = split_Old_Value[j].split("Exp_DT=");
								if(temp.length>0){
									old_expDt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Review_DT=")){
								String temp[] = split_Old_Value[j].split("Review_DT=");
								if(temp.length>0){
									old_reviewDt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Remarks=")){
								String temp[] = split_Old_Value[j].split("Remarks=");
								if(temp.length>0){
									old_rmk=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Credit_rating=")){
								String temp[] = split_Old_Value[j].split("Credit_rating=");
								if(temp.length>0){
									old_creditRat=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Parent_Legal_Entity=")){
								String temp[] = split_Old_Value[j].split("Parent_Legal_Entity=");
								if(temp.length>0){
									old_parentAbbr= temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Percentage_Own=")){
								String temp[] = split_Old_Value[j].split("Percentage_Own=");
								if(temp.length>0){
									old_percentOwn=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Parent_Entry_Dt=")){
								String temp[] = split_Old_Value[j].split("Parent_Entry_Dt=");
								if(temp.length>0){
									old_parentEntDt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("Parent_Exit_Dt=")){
								String temp[] = split_Old_Value[j].split("Parent_Exit_Dt=");
								if(temp.length>0){
									old_parentExitDt=temp[1];
								}
							}
							if(split_Old_Value[j].startsWith("InactDt=")){
								String temp[] = split_Old_Value[j].split("InactDt=");
								if(temp.length>0){
									old_inact_dt=temp[1];
								}
							}
						}
					}else{
						old_creditRat = "";old_parentAbbr="";old_percentOwn="";old_parentEntDt="";old_parentExitDt="";
						old_limitTy = "";old_limitAct="";old_userTy="";old_effDt="";old_expDt="";old_reviewDt="";old_status="";old_rmk="";
						old_amt=0;old_st_amt="";old_ref_no="";old_inact_dt="";
					}
					if(!cust_abbr.equals("BANK"))
					{
						queryString1="select customer_name,customer_abbr from FMS7_CUSTOMER_MST where customer_abbr='"+cust_abbr+"'";
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next()){
							cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
						}else{
							queryString1="select trader_name,trader_abbr from FMS7_TRADER_MST where trader_abbr='"+cust_abbr+"'";
							rset1=stmt1.executeQuery(queryString1);
							if(rset1.next()){
								cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
							}else{
								cust_nm="";
							}
						}
					}else if(!bank_cd.equals("0"))
					{
						queryString1="select bank_name from fms7_bank_mst where bank_cd='"+bank_cd+"'";
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next()){
							cust_nm=rset1.getString(1)==null?"":rset1.getString(1);
						}else{
							cust_nm="";
						}
						if(!old_parentAbbr.equals("")) //HARSH20210302
						{
							queryString1 = "select bank_abbr from fms7_bank_mst where bank_cd = '"+old_parentAbbr+"'";
							rset1=stmt1.executeQuery(queryString1);
							if(rset1.next()){
								old_parentAbbr = rset1.getString(1)==null?"":rset1.getString(1);
							}else{
								old_parentAbbr = "";
							}
						}
					}
					
					if(!status.equals(old_status))
					{
						if(status.equals("Y")){
							VNew_Changes.add("Active");
						}else if(status.equals("N")){
							VNew_Changes.add("InActive");
						}else{
							VNew_Changes.add(status);
						}
						
						if(old_status.equals("Y")){
							VOld_Changes.add("Active");
						}else if(old_status.equals("N")){
							VOld_Changes.add("InActive");
						}else{
							VOld_Changes.add(old_status);
						}
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Status");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!limitTy.equals(old_limitTy))
					{
						VNew_Changes.add(limitTy);
						VOld_Changes.add(old_limitTy);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Limit Type");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!limitAct.equals(old_limitAct))
					{
						VNew_Changes.add(limitAct);
						VOld_Changes.add(old_limitAct);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Limit Action");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!userTy.equals(old_userTy))
					{
						VNew_Changes.add(userTy);
						VOld_Changes.add(old_userTy);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("User Type");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					//System.out.println(st_amt+"|||"+old_st_amt);
					if(!st_amt.equals(old_st_amt))
					{
						VNew_Changes.add(st_amt);
						VOld_Changes.add(old_st_amt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Amount");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!effDt.equals(old_effDt))
					{
						VNew_Changes.add(effDt);
						VOld_Changes.add(old_effDt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Effective Date");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!expDt.equals(old_expDt))
					{
						VNew_Changes.add(expDt);
						VOld_Changes.add(old_expDt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Expiration Date");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!reviewDt.equals(old_reviewDt))
					{
						VNew_Changes.add(reviewDt);
						VOld_Changes.add(old_reviewDt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Review Date");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!rmk.equals(old_rmk))
					{
						VNew_Changes.add(rmk);
						VOld_Changes.add(old_rmk);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Remarks");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!creditRat.equals(old_creditRat))
					{
						VNew_Changes.add(creditRat);
						VOld_Changes.add(old_creditRat);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Credit Rating");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!parentAbbr.equals(old_parentAbbr))
					{
						VNew_Changes.add(parentAbbr);
						VOld_Changes.add(old_parentAbbr);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Parent Legal Entity");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!percentOwn.equals(old_percentOwn))
					{
						VNew_Changes.add(percentOwn);
						VOld_Changes.add(old_percentOwn);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Percentage Ownship");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!parentEntDt.equals(old_parentEntDt))
					{
						VNew_Changes.add(parentEntDt);
						VOld_Changes.add(old_parentEntDt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Parent Entry Date");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!parentExitDt.equals(old_parentExitDt))
					{
						VNew_Changes.add(parentExitDt);
						VOld_Changes.add(old_parentExitDt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Parent Exit Date");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
					if(!inact_dt.equals(old_inact_dt))
					{
						VNew_Changes.add(inact_dt);
						VOld_Changes.add(old_inact_dt);
						VUpdate_Dt.add(update_dt+" "+time);
						VUpdate_By.add(update_by);
						CUST_NM.add(cust_nm);
						VField_Name.add("Inactivation Date");
						VRef_NO.add(ref_no);
						VDeal_NO.add("");
					}
				}
			}
			///System.out.println(VRef_NO.size());
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	String TempCustName = new String();
	public String getTempCustName(){return TempCustName;}
	String sec_ref_no = "";
	public void setsec_ref_no(String sec_ref_no) {this.sec_ref_no = sec_ref_no;}
	String DetailFlag = "";
	public void setDetailFlag(String DetailFlag) {this.DetailFlag = DetailFlag;}
	
	Vector VColor = new Vector();//HARSH20201222
	public Vector getVColor() {return VColor;}//HARSH20201222
	Vector VNew_Changes = new Vector();//HARSH20201223
	public Vector getVNew_Changes() {return VNew_Changes;}//HARSH20201223
	Vector VOld_Changes = new Vector();//HARSH20201223
	public Vector getVOld_Changes() {return VOld_Changes;}//HARSH20201223
	Vector VField_Name = new Vector();//HARSH20201223
	public Vector getVField_Name() {return VField_Name;}//HARSH20201223
	Vector VLimit_New_Changes = new Vector();//HARSH20201223
	public Vector getVLimit_New_Changes() {return VLimit_New_Changes;}//HARSH20201223
	Vector VLimit_Old_Changes = new Vector();//HARSH20201223
	public Vector getVLimit_Old_Changes() {return VLimit_Old_Changes;}//HARSH20201223
	Vector VLimit_Field_Name = new Vector();//HARSH20201223
	public Vector getVLimit_Field_Name() {return VLimit_Field_Name;}//HARSH20201223
	
	Vector VIndex = new Vector();
	public Vector getVIndex() {return VIndex;}
	Vector VOld_Customer_Nm = new Vector();
	public Vector getVOld_Customer_Nm() {return VOld_Customer_Nm;}
	
	Vector VSec_Type = new Vector();
	public Vector getVSec_Type() {return VSec_Type;}
	Vector VOld_Sec_Type = new Vector();
	public Vector getVOld_Sec_Type() {return VOld_Sec_Type;}
	Vector VDeal_Type = new Vector();
	public Vector getVDeal_Type() {return VDeal_Type;}
	Vector VNew_Guaran_nm = new Vector();
	public Vector getVNew_Guaran_nm() {return VNew_Guaran_nm;}
	Vector VOld_Guaran_nm = new Vector();
	public Vector getVOld_Guaran_nm() {return VOld_Guaran_nm;}
	
	Vector VNew_Currency = new Vector();
	public Vector getVNew_Currency() {return VNew_Currency;}
	Vector VOld_Currency = new Vector();
	public Vector getVOld_Currency() {return VOld_Currency;}
	
	Vector VNew_Value_Vari = new Vector();
	public Vector getVNew_Value_Vari() {return VNew_Value_Vari;}
	Vector VOld_Value_Vari = new Vector();
	public Vector getVOld_Value_Vari() {return VOld_Value_Vari;}
	
	Vector VNew_Value = new Vector();
	public Vector getVNew_Value() {return VNew_Value;}
	Vector VOld_Value = new Vector();
	public Vector getVOld_Value() {return VOld_Value;}
	
	Vector VNew_Value_Fluc = new Vector();
	public Vector getVNew_Value_Fluc() {return VNew_Value_Fluc;}
	Vector VOld_Value_Fluc = new Vector();
	public Vector getVOld_Value_Fluc() {return VOld_Value_Fluc;}
	
	Vector VNew_Issu_Bank_nm = new Vector();
	public Vector getVNew_Issu_Bank_nm() {return VNew_Issu_Bank_nm;}
	Vector VOld_Issu_Bank_nm = new Vector();
	public Vector getVOld_Issu_Bank_nm() {return VOld_Issu_Bank_nm;}
	Vector VNew_Issu_Bank_Ref = new Vector();
	public Vector getVNew_Issu_Bank_Ref() {return VNew_Issu_Bank_Ref;}
	Vector VOld_Issu_Bank_Ref = new Vector();
	public Vector getVOld_Issu_Bank_Ref() {return VOld_Issu_Bank_Ref;}
	
	Vector VNew_Adv_Bank_nm = new Vector();
	public Vector getVNew_Adv_Bank_nm() {return VNew_Adv_Bank_nm;}
	Vector VOld_Adv_Bank_nm = new Vector();
	public Vector getVOld_Adv_Bank_nm() {return VOld_Adv_Bank_nm;}
	Vector VNew_Adv_Bank_Ref = new Vector();
	public Vector getVNew_Adv_Bank_Ref() {return VNew_Adv_Bank_Ref;}
	Vector VOld_Adv_Bank_Ref = new Vector();
	public Vector getVOld_Adv_Bank_Ref() {return VOld_Adv_Bank_Ref;}
	
	Vector VNew_Conf_Bank_nm = new Vector();
	public Vector getVNew_Conf_Bank_nm() {return VNew_Conf_Bank_nm;}
	Vector VOld_Conf_Bank_nm = new Vector();
	public Vector getVOld_Conf_Bank_nm() {return VOld_Conf_Bank_nm;}
	Vector VNew_Conf_Bank_Ref = new Vector();
	public Vector getVNew_Conf_Bank_Ref() {return VNew_Conf_Bank_Ref;}
	Vector VOld_Conf_Bank_Ref = new Vector();
	public Vector getVOld_Conf_Bank_Ref() {return VOld_Conf_Bank_Ref;}
	
	Vector VNew_Rec_Dt = new Vector();
	public Vector getVNew_Rec_Dt() {return VNew_Rec_Dt;}
	Vector VOld_Rec_Dt = new Vector();
	public Vector getVOld_Rec_Dt() {return VOld_Rec_Dt;}
	Vector VNew_Issu_Dt = new Vector();
	public Vector getVNew_Issu_Dt() {return VNew_Issu_Dt;}
	Vector VOld_Issu_Dt = new Vector();
	public Vector getVOld_Issu_Dt() {return VOld_Issu_Dt;}
	Vector VNew_Exp_Dt = new Vector();
	public Vector getVNew_Exp_Dt() {return VNew_Exp_Dt;}
	Vector VOld_Exp_Dt = new Vector();
	public Vector getVOld_Exp_Dt() {return VOld_Exp_Dt;}
	Vector VNew_Renew_Dt = new Vector();
	public Vector getVNew_Renew_Dt() {return VNew_Renew_Dt;}
	Vector VOld_Renew_Dt = new Vector();
	public Vector getVOld_Renew_Dt() {return VOld_Renew_Dt;}
	Vector VNew_Tenor = new Vector();
	public Vector getVNew_Tenor() {return VNew_Tenor;}
	Vector VOld_Tenor = new Vector();
	public Vector getVOld_Tenor() {return VOld_Tenor;}
	
	Vector VNew_Status = new Vector();
	public Vector getVNew_Status() {return VNew_Status;}
	Vector VOld_Status = new Vector();
	public Vector getVOld_Status() {return VOld_Status;}
	
	Vector VNew_Remark = new Vector();
	public Vector getVNew_Remark() {return VNew_Remark;}
	Vector VOld_Remark = new Vector();
	public Vector getVOld_Remark() {return VOld_Remark;}
	
	Vector VDeal_NO = new Vector();
	public Vector getVDeal_NO() {return VDeal_NO;}
	Vector VOld_Deal_NO = new Vector();
	public Vector getVOld_Deal_NO() {return VOld_Deal_NO;}
	Vector VInOut = new Vector();
	public Vector getVInOut() {return VInOut;}
	Vector VOld_InOut = new Vector();
	public Vector getVOld_InOut() {return VOld_InOut;}
	Vector VNew_Review_Dt = new Vector();
	public Vector getVNew_Review_Dt() {return VNew_Review_Dt;}
	Vector VOld_Review_Dt = new Vector();
	public Vector getVOld_Review_Dt() {return VOld_Review_Dt;}
	Vector VRef_NO = new Vector();
	public Vector getVRef_NO() {return VRef_NO;}
	Vector VOld_Ref_NO = new Vector();
	public Vector getVOld_Ref_NO() {return VOld_Ref_NO;}
	
	Vector VFindRef_NO = new Vector();
	public Vector getVFindRef_NO() {return VFindRef_NO;}
	
	Vector VUpdate_Dt = new Vector();
	public Vector getVUpdate_Dt() {return VUpdate_Dt;}
	Vector VUpdate_By = new Vector();
	public Vector getVUpdate_By() {return VUpdate_By;}
	Vector VLimit_Update_Dt = new Vector();
	public Vector getVLimit_Update_Dt() {return VLimit_Update_Dt;}
	Vector VLimit_Update_By = new Vector();
	public Vector getVLimit_Update_By() {return VLimit_Update_By;}
	
	Vector VOld_Update_Dt = new Vector();
	public Vector getVOld_Update_Dt() {return VOld_Update_Dt;}
	Vector VOld_Update_By = new Vector();
	public Vector getVOld_Update_By() {return VOld_Update_By;}
//////////////////////////////////////////////////////////////////////////
	
///////////////////////HARSH20201120///////////////For Credit Limit List///////////////
	public void fetch_CreditLimit_list() 
	{
		try
		{
			queryString1 = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+Buyer_cd+"'";
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				CustName = rset1.getString(1)==null?"":rset1.getString(1);
			}
			
			double limitValue = 0;
			double TotallimitValue = 0;
			queryString="SELECT LIMIT_TYPE,ACTION_TYPE,AMT,TO_CHAR(EFF_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),FLAG "
					+ "FROM FMS9_LIMIT_DTL WHERE CUST_CD = '"+Buyer_cd+"' AND EFF_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL AND FLAG='Y'  order by eff_dt";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				Vlimitty.add(rset.getString(1)==null?"":rset.getString(1));
				Vaction_type.add(rset.getString(2)==null?"":rset.getString(2));
				Vamt.add(rset.getString(3)==null?"0":rset.getString(3));
				Veff_dt.add(rset.getString(4)==null?"":rset.getString(4));
				Vexp_dt.add(rset.getString(5)==null?"":rset.getString(5));
				String flag = rset.getString(6)==null?"":rset.getString(6);
				if(flag.equals("Y"))
				{
					Vlimit_status.add("Active");
				}
				else
				{
					Vlimit_status.add("");
				}
				
				limitValue += rset.getDouble(3);
			}
			/*double CpercentageOwnship = 0;
			String CperOwnship = "";
			double childtotalLimit = 0;
			queryString="SELECT PARENT_OWNSHIP,PARENT_OWNSHIP_CD,CUST_CD FROM FMS9_LIMIT_MST"
					+ " WHERE CUST_CD=(SELECT CUST_CD FROM FMS9_LIMIT_MST WHERE PARENT_OWNSHIP_CD='"+Buyer_cd+"')";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				CpercentageOwnship=rset.getDouble(1);
				CperOwnship = rset.getString(1)==null?"0":rset.getString(1);
				childtotalLimit = limitValue * CpercentageOwnship / 100; 
				String cust_cd = rset.getString(3)==null?"":rset.getString(3);
				queryString="SELECT LIMIT_TYPE,ACTION_TYPE,AMT,TO_CHAR(EFF_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),FLAG "
						+ "FROM FMS9_LIMIT_DTL WHERE CUST_CD = '"+cust_cd+"' AND EFF_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND APRV_BY IS NOT NULL AND FLAG='Y'  order by eff_dt";
				rset=stmt.executeQuery(queryString);
				while(rset.next())
				{
					Vc_limitty.add(rset.getString(1)==null?"":rset.getString(1));
					Vc_action_type.add(rset.getString(2)==null?"":rset.getString(2));
					Vc_amt.add(rset.getString(3)==null?"0":rset.getString(3));
					Vc_eff_dt.add(rset.getString(4)==null?"":rset.getString(4));
					Vc_exp_dt.add(rset.getString(5)==null?"":rset.getString(5));
					String flag = rset.getString(6)==null?"":rset.getString(6);
					if(flag.equals("Y"))
					{
						Vc_limit_status.add("Active");
					}
					else
					{
						Vc_limit_status.add("");
					}
					
					//limitValue += rset.getDouble(3);
				}
			}*/
			//System.out.println("Child ----"+childtotalLimit);
			double percentageOwnship = 0;
			String perOwnship = "";
			String parentOwnshipCd = "";
			double parentlimitValue=0; 
			double parentPercentagelimitValue=0; 
			queryString="SELECT PARENT_OWNSHIP,PARENT_OWNSHIP_CD FROM FMS9_LIMIT_MST"
					+ " WHERE CUST_CD="+Buyer_cd+"";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				percentageOwnship=rset.getDouble(1);
				perOwnship = rset.getString(1)==null?"0":rset.getString(1);
				parentOwnshipCd = rset.getString(2)==null?"":rset.getString(2);
				if(!parentOwnshipCd.equals(""))
				{
					queryString1 = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+parentOwnshipCd+"'";
					rset1=stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						ParentName = rset1.getString(1)==null?"":rset1.getString(1);
					}
				}
			}
			
			queryString ="SELECT LIMIT_TYPE,ACTION_TYPE,AMT,TO_CHAR(EFF_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),FLAG from FMS9_LIMIT_DTL "+
					" WHERE CUST_CD=(SELECT PARENT_OWNSHIP_CD FROM FMS9_LIMIT_MST WHERE CUST_CD="+Buyer_cd+") "
					+ "AND EFF_DT<=to_date('"+to_date+"','dd/mm/yyyy') AND EXP_DT>=to_date('"+to_date+"','dd/mm/yyyy') AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL AND FLAG='Y' order by eff_dt";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				Vp_limitty.add(rset.getString(1)==null?"":rset.getString(1));
				Vp_action_type.add(rset.getString(2)==null?"":rset.getString(2));
				Vp_amt.add(rset.getString(3)==null?"0":rset.getString(3));
				Vp_eff_dt.add(rset.getString(4)==null?"":rset.getString(4));
				Vp_exp_dt.add(rset.getString(5)==null?"":rset.getString(5));
				String flag = rset.getString(6)==null?"":rset.getString(6);
				if(flag.equals("Y"))
				{
					Vp_limit_status.add("Active");
				}
				else
				{
					Vp_limit_status.add("");
				}
				
				parentlimitValue += rset.getDouble(3);
			}
			//parentPercentagelimitValue = parentlimitValue * percentageOwnship / 100;
			//TotallimitValue = limitValue + parentPercentagelimitValue - childtotalLimit;
			TotallimitValue = limitValue + parentlimitValue;
			//System.out.println("TotallimitValue----"+nf.format(TotallimitValue));
			LimitValue = nf.format(limitValue);
			ParentLimitValue = nf.format(parentlimitValue);
			//ChildLimitValue = nf.format(childtotalLimit);
			//ParcentageOwnship = perOwnship;
			//ChildParcentageOwnship = CperOwnship;
			ParcentageLimitOwnship = nf.format(parentPercentagelimitValue);
			TotalLimitValue = nf.format(TotallimitValue);
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
	}
	Vector Vp_limitty = new Vector();
	public Vector getVp_limitty() {return Vp_limitty;}
	Vector Vp_action_type = new Vector();
	public Vector getVp_action_type() {return Vp_action_type;}
	Vector Vp_amt = new Vector();
	public Vector getVp_amt() {return Vp_amt;}
	Vector Vp_eff_dt = new Vector();
	public Vector getVp_eff_dt() {return Vp_eff_dt;}
	Vector Vp_exp_dt = new Vector();
	public Vector getVp_exp_dt() {return Vp_exp_dt;}
	Vector Vp_limit_status = new Vector();
	public Vector getVp_limit_status() {return Vp_limit_status;}
	
	Vector Vc_limitty = new Vector();
	public Vector getVc_limitty() {return Vc_limitty;}
	Vector Vc_action_type = new Vector();
	public Vector getVc_action_type() {return Vc_action_type;}
	Vector Vc_amt = new Vector();
	public Vector getVc_amt() {return Vc_amt;}
	Vector Vc_eff_dt = new Vector();
	public Vector getVc_eff_dt() {return Vc_eff_dt;}
	Vector Vc_exp_dt = new Vector();
	public Vector getVc_exp_dt() {return Vc_exp_dt;}
	Vector Vc_limit_status = new Vector();
	public Vector getVc_limit_status() {return Vc_limit_status;}
	
	String LimitValue = new String();
	public String getLimitValue(){return LimitValue;}
	String ParentLimitValue = new String();
	public String getParentLimitValue(){return ParentLimitValue;}
	String ChildLimitValue = new String();
	public String getChildLimitValue(){return ChildLimitValue;}
	String ChildParcentageOwnship = new String();
	public String getChildParcentageOwnship(){return ChildParcentageOwnship;}
	String ParcentageOwnship = new String();
	public String getParcentageOwnship(){return ParcentageOwnship;}
	String ParcentageLimitOwnship = new String();
	public String getParcentageLimitOwnship(){return ParcentageLimitOwnship;}
	String TotalLimitValue = new String();
	public String getTotalLimitValue(){return TotalLimitValue;}
	
	String ParentName = new String();
	public String getParentName(){return ParentName;}
	String CustName = new String();
	public String getCustName(){return CustName;}
			
//////////////HARSH20201212//////////////////FOR PRE DEAL CREDIT CHECK REQ LIST////////////////////////////
	public void fetchPreDealCreditCheckRequest()
	{
		try
		{
			/*HARSH20201231 if(sell_buy.equals("Buy"))
			{
				queryString ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST order by trader_name";
			}
			else
			{
				queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST ORDER BY CUSTOMER_NAME";
			}
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				CUSTOMER_CD.add(rset.getString(3)==null?"":rset.getString(3));
				CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
			}*/
			
			////HARSH20201231 /////AFTER REMOVING SELL/BUY SELECTION MERGE BOTH CUSTOMER MST AND TREDER MST//////////////////
			/*HARSH20210112 queryString ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST ORDER BY CUSTOMER_NAME";
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				CUSTOMER_CD.add(rset.getString(3)==null?"":rset.getString(3)+"-S");//customer cd like "1-S" HARSH20201231
				CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
				VSell_Buy_Indicator.add("S"); //HARSH20201231
			}
			queryString ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST order by trader_name";
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				CUSTOMER_CD.add(rset.getString(3)==null?"":rset.getString(3)+"-B");//customer cd like "1-B" HARSH20201231
				CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
				VSell_Buy_Indicator.add("B"); //HARSH20201231
			}*/
			////////////////////////////////////////////////////////////////////////
			/////HARSH20210112/////NOW WE USE CUSTOMER ABBR INSTEAD OF CUSTOMER CD/////////////
			queryString="select distinct(a.CUSTOMER_CD),a.customer_name,a.customer_abbr from FMS7_CUSTOMER_MST a "
					+ "where a.eff_dt = (select max(b.Eff_dt) from FMS7_CUSTOMER_MST b where a.customer_cd=b.customer_cd) " 
					+ " order by a.customer_name";
			//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				CUSTOMER_CD.add(rset.getString(1)==null?"":rset.getString(1));
				CUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
				CUSTOMER_ABBR.add(rset.getString(3)==null?"":rset.getString(3));//HARSH20210106
				VSell_Buy_Indicator.add("S");//HARSH20201229
				VTemp_CustAbbr.add(rset.getString(3)==null?"":rset.getString(3));
			}
			queryString = "select distinct(a.TRADER_CD),a.TRADER_NAME,a.trader_abbr from FMS7_TRADER_MST a "
					+ "where a.eff_dt = (select max(b.eff_Dt) from FMS7_TRADER_MST b where a.TRADER_CD=b.TRADER_CD) order by a.TRADER_NAME";
			//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
			rset1 = stmt1.executeQuery(queryString);
			while(rset1.next())
			{
				String abbr = rset1.getString(3)==null?"":rset1.getString(3);
				int j =0;
				for(int i=0; i<VTemp_CustAbbr.size(); i++)
				{
					if(VTemp_CustAbbr.elementAt(i).equals(abbr))
					{
						j=j+1;
					}
				}
				if(j==0)
				{
					CUSTOMER_CD.add(rset1.getString(1)==null?"":rset1.getString(1));
					CUSTOMER_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
					CUSTOMER_ABBR.add(rset1.getString(3)==null?"":rset1.getString(3));//HARSH20210106
					VSell_Buy_Indicator.add("B");//HARSH20201229
				}
			}
			///////////////////////////////////////////////////////////////////////////////////
//HARSH20210112			queryString = "SELECT CUSTOMER_CD,SEQ_NO,VALUE,CURRENCY,TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),BUY_SELL,DLV_TERMS,SPOT_TERMS,PAYMENT_TERMS,REQUEST_ID,REQUEST_BY,"
//HARSH20210112					+ "TO_CHAR(REQUEST_DT,'DD/MM/YYYY HH12:MI:SS AM'),REQUEST_MSG,STATUS,TO_CHAR(APRV_DT,'DD/MM/YYYY HH12:MI:SS AM'),APRV_BY,APRV_MSG,FLAG,TO_CHAR(ENT_DT,'DD/MM/YYYY'),ENT_BY,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,SHELL_CONT "
//HARSH20210112					+ "FROM FMS9_DEAL_REQUEST_DTL order by REQUEST_ID DESC"; //WHERE BUY_SELL='"+sell_buy+"' remove checking sell/buy HARSH20201231
			
			queryString = "SELECT CUSTOMER_ABBR,SEQ_NO,VALUE,CURRENCY,TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),BUY_SELL,DLV_TERMS,SPOT_TERMS,PAYMENT_TERMS,REQUEST_ID,REQUEST_BY,"
					+ "TO_CHAR(REQUEST_DT,'DD/MM/YYYY HH12:MI:SS AM'),REQUEST_MSG,STATUS,TO_CHAR(APRV_DT,'DD/MM/YYYY HH12:MI:SS AM'),APRV_BY,APRV_MSG,FLAG,TO_CHAR(ENT_DT,'DD/MM/YYYY'),ENT_BY,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,SHELL_CONT "
					+ "FROM FMS9_DEAL_REQUEST_DTL order by REQUEST_ID DESC"; //Now We use customer_abbr instead of customer_cd HARSH20210112
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				VSeqNo.add(rset.getString(2)==null?"":rset.getString(2));
				VRequest_ID.add(rset.getString(11)==null?"":rset.getString(11));
				//HARSH20210112 String cust_cd = rset.getString(1)==null?"":rset.getString(1);
				String cust_abbr = rset.getString(1)==null?"":rset.getString(1);//HARSH20210112
				String sellbuy = rset.getString(7)==null?"":rset.getString(7);
				////////////HARSH20210112///////////////////////
				queryString1 ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_ABBR='"+cust_abbr+"'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					//CUST_CD.add(cust_cd);
					CUST_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
					VCUST_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));
					
				}else{
					queryString1 ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST where TRADER_ABBR='"+cust_abbr+"'";
					rset1=stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						//CUST_CD.add(cust_cd);
						CUST_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
						VCUST_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));
					}else{
						//CUST_CD.add("");
						CUST_NM.add("");
						VCUST_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));
					}
				}
				////////////////////////////////////////
				VBuySell.add(sellbuy);
				VDealValue.add(rset.getString(3)==null?"":rset.getString(3));
				VDealCurrency.add(rset.getString(4)==null?"":rset.getString(4));
				VDlv_Start_Dt.add(rset.getString(5)==null?"":rset.getString(5));
				VDlv_End_Dt.add(rset.getString(6)==null?"":rset.getString(6));
				VDlv_Terms.add(rset.getString(8)==null?"":rset.getString(8));
				VSpot_Terms.add(rset.getString(9)==null?"":rset.getString(9));
				VPayment_Terms.add(rset.getString(10)==null?"":rset.getString(10));
				//VRequest_ID.add(rset.getString(11)==null?"":rset.getString(11));
				String request_by = rset.getString(12)==null?"":rset.getString(12);
				queryString2="select emp_nm from HR_EMP_MST where emp_cd = '"+request_by+"'";
				rset2=stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					VRequest_By.add(rset2.getString(1)==null?"":rset2.getString(1));
				}else{
					VRequest_By.add("");//HARSH20201224
				}
				VRequest_Dt.add(rset.getString(13)==null?"":rset.getString(13));
				VRequest_Msg.add(rset.getString(14)==null?"":rset.getString(14));
				VReqStatus.add(rset.getString(15)==null?"":rset.getString(15));
				VApproval_Dt.add(rset.getString(16)==null?"":rset.getString(16));
				//VApproval_By.add(rset.getString(17)==null?"":rset.getString(17)); //HARSH20201224
				String approval_by = rset.getString(17)==null?"":rset.getString(17); //HARSH20201224
				queryString2="select emp_nm from HR_EMP_MST where emp_cd = '"+approval_by+"'";//HARSH20201224
				rset2=stmt2.executeQuery(queryString2);
				if(rset2.next())//HARSH20201224
				{
					VApproval_By.add(rset2.getString(1)==null?"":rset2.getString(1));//HARSH20201224
				}else{
					VApproval_By.add("");//HARSH20201224
				}
				VApproval_Msg.add(rset.getString(18)==null?"":rset.getString(18));
				VShell_Cont.add(rset.getString(24)==null?"":rset.getString(24));
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
//////////////HARSH20201215//////////////////FOR PRE DEAL CREDIT APPROVAL LIST////////////////////////////
	public void fetchPreDealCreditApproval()
	{
		try
		{
			if(!f_sts.equals("All"))//Implimented By Jayesh05012021 for filter pre deal-creatdit approval report 
			{
//HARSH20210112				queryString = "SELECT CUSTOMER_CD,SEQ_NO,VALUE,CURRENCY,TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),BUY_SELL,DLV_TERMS,SPOT_TERMS,PAYMENT_TERMS,REQUEST_ID,REQUEST_BY,"
//HARSH20210112						+ "TO_CHAR(REQUEST_DT,'DD/MM/YYYY HH12:MI:SS AM'),REQUEST_MSG,STATUS,TO_CHAR(APRV_DT,'DD/MM/YYYY HH12:MI:SS AM'),APRV_BY,APRV_MSG,FLAG,TO_CHAR(ENT_DT,'DD/MM/YYYY'),ENT_BY,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,SHELL_CONT "
//HARSH20210112						+ "FROM FMS9_DEAL_REQUEST_DTL where STATUS ='"+f_sts+"'";
				//System.out.println("My Varaible2 is................."+ f_sts);
				
				queryString = "SELECT CUSTOMER_ABBR,SEQ_NO,VALUE,CURRENCY,TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),BUY_SELL,DLV_TERMS,SPOT_TERMS,PAYMENT_TERMS,REQUEST_ID,REQUEST_BY,"
						+ "TO_CHAR(REQUEST_DT,'DD/MM/YYYY HH12:MI:SS AM'),REQUEST_MSG,STATUS,TO_CHAR(APRV_DT,'DD/MM/YYYY HH12:MI:SS AM'),APRV_BY,APRV_MSG,FLAG,TO_CHAR(ENT_DT,'DD/MM/YYYY'),ENT_BY,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,SHELL_CONT "
						+ "FROM FMS9_DEAL_REQUEST_DTL where STATUS ='"+f_sts+"'"; //Now We use customer_abbr instead of customer_cd HARSH20210112
			}
			else
			{
//HARSH20210112				queryString = "SELECT CUSTOMER_CD,SEQ_NO,VALUE,CURRENCY,TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),BUY_SELL,DLV_TERMS,SPOT_TERMS,PAYMENT_TERMS,REQUEST_ID,REQUEST_BY,"
//HARSH20210112						+ "TO_CHAR(REQUEST_DT,'DD/MM/YYYY HH12:MI:SS AM'),REQUEST_MSG,STATUS,TO_CHAR(APRV_DT,'DD/MM/YYYY HH12:MI:SS AM'),APRV_BY,APRV_MSG,FLAG,TO_CHAR(ENT_DT,'DD/MM/YYYY'),ENT_BY,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,SHELL_CONT "
//HARSH20210112						+ "FROM FMS9_DEAL_REQUEST_DTL order by REQUEST_ID DESC";
				
				queryString = "SELECT CUSTOMER_ABBR,SEQ_NO,VALUE,CURRENCY,TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'),BUY_SELL,DLV_TERMS,SPOT_TERMS,PAYMENT_TERMS,REQUEST_ID,REQUEST_BY,"
						+ "TO_CHAR(REQUEST_DT,'DD/MM/YYYY HH12:MI:SS AM'),REQUEST_MSG,STATUS,TO_CHAR(APRV_DT,'DD/MM/YYYY HH12:MI:SS AM'),APRV_BY,APRV_MSG,FLAG,TO_CHAR(ENT_DT,'DD/MM/YYYY'),ENT_BY,TO_CHAR(MODIFY_DT,'DD/MM/YYYY'),MODIFY_BY,SHELL_CONT "
						+ "FROM FMS9_DEAL_REQUEST_DTL order by REQUEST_ID DESC"; //Now We use customer_abbr instead of customer_cd HARSH20210112
			}
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				VSeqNo.add(rset.getString(2)==null?"":rset.getString(2));
				VRequest_ID.add(rset.getString(11)==null?"":rset.getString(11));
				String cust_abbr = rset.getString(1)==null?"":rset.getString(1);
				String sellbuy = rset.getString(7)==null?"":rset.getString(7);
				////////////HARSH20210112///////////////////////
				queryString1 ="select CUSTOMER_ABBR,CUSTOMER_NAME,CUSTOMER_CD from FMS7_CUSTOMER_MST where CUSTOMER_ABBR='"+cust_abbr+"'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					//CUST_CD.add(cust_cd);
					CUST_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
					VCUST_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));
					
				}else{
					queryString1 ="select TRADER_ABBR,TRADER_NAME,TRADER_CD from FMS7_TRADER_MST where TRADER_ABBR='"+cust_abbr+"'";
					rset1=stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						//CUST_CD.add(cust_cd);
						CUST_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
						VCUST_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));
					}else{
						//CUST_CD.add("");
						CUST_NM.add("");
						VCUST_ABBR.add(rset1.getString(1)==null?"":rset1.getString(1));
					}
				}
				////////////////////////////////////////
				VBuySell.add(sellbuy);
				VDealValue.add(rset.getString(3)==null?"":rset.getString(3));
				VDealCurrency.add(rset.getString(4)==null?"":rset.getString(4));
				VDlv_Start_Dt.add(rset.getString(5)==null?"":rset.getString(5));
				VDlv_End_Dt.add(rset.getString(6)==null?"":rset.getString(6));
				VDlv_Terms.add(rset.getString(8)==null?"":rset.getString(8));
				VSpot_Terms.add(rset.getString(9)==null?"":rset.getString(9));
				VPayment_Terms.add(rset.getString(10)==null?"":rset.getString(10));
				//VRequest_ID.add(rset.getString(11)==null?"":rset.getString(11));
				String request_by = rset.getString(12)==null?"":rset.getString(12);
				queryString2="select emp_nm from HR_EMP_MST where emp_cd = '"+request_by+"'";
				rset2=stmt2.executeQuery(queryString2);
				if(rset2.next())
				{
					VRequest_By.add(rset2.getString(1)==null?"":rset2.getString(1));
				}else{
					VRequest_By.add("");//HARSH20201224
				}
				VRequest_Dt.add(rset.getString(13)==null?"":rset.getString(13));
				VRequest_Msg.add(rset.getString(14)==null?"":rset.getString(14));
				VReqStatus.add(rset.getString(15)==null?"":rset.getString(15));
				VApproval_Dt.add(rset.getString(16)==null?"":rset.getString(16));
				//VApproval_By.add(rset.getString(17)==null?"":rset.getString(17)); //HARSH20201224
				String approval_by = rset.getString(17)==null?"":rset.getString(17); //HARSH20201224
				queryString2="select emp_nm from HR_EMP_MST where emp_cd = '"+approval_by+"'";//HARSH20201224
				rset2=stmt2.executeQuery(queryString2);
				if(rset2.next())//HARSH20201224
				{
					VApproval_By.add(rset2.getString(1)==null?"":rset2.getString(1));//HARSH20201224
				}else{
					VApproval_By.add("");//HARSH20201224
				}
				VApproval_Msg.add(rset.getString(18)==null?"":rset.getString(18));
				VShell_Cont.add(rset.getString(24)==null?"":rset.getString(24));
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	Vector VSeqNo = new Vector();
	public Vector getVSeqNo() {return VSeqNo;}
	Vector VRequest_ID = new Vector();
	public Vector getVRequest_ID() {return VRequest_ID;}
	Vector VDealValue = new Vector();
	public Vector getVDealValue() {return VDealValue;}
	Vector VDealCurrency = new Vector();
	public Vector getVDealCurrency() {return VDealCurrency;}
	Vector VRequest_By = new Vector();
	public Vector getVRequest_By() {return VRequest_By;}
	Vector VRequest_Dt = new Vector();
	public Vector getVRequest_Dt() {return VRequest_Dt;}
	Vector VRequest_Status = new Vector();
	public Vector getVRequest_Status() {return VRequest_Status;}
	Vector VRequest_Msg = new Vector();
	public Vector getVRequest_Msg() {return VRequest_Msg;}
	Vector VApproval_By = new Vector();
	public Vector getVApproval_By() {return VApproval_By;}
	Vector VApproval_Dt = new Vector();
	public Vector getVApproval_Dt() {return VApproval_Dt;}
	Vector VApproval_Msg = new Vector();
	public Vector getVApproval_Msg() {return VApproval_Msg;}
	Vector VDlv_Start_Dt = new Vector();
	public Vector getVDlv_Start_Dt() {return VDlv_Start_Dt;}
	Vector VDlv_End_Dt = new Vector();
	public Vector getVDlv_End_Dt() {return VDlv_End_Dt;}
	Vector VPayment_Terms = new Vector();
	public Vector getVPayment_Terms() {return VPayment_Terms;}
	Vector VDlv_Terms = new Vector();
	public Vector getVDlv_Terms() {return VDlv_Terms;}
	Vector VSpot_Terms = new Vector();
	public Vector getVSpot_Terms() {return VSpot_Terms;}
	Vector VShell_Cont = new Vector();
	public Vector getVShell_Cont() {return VShell_Cont;}
	Vector VReqStatus = new Vector();
	public Vector getVReqStatus() {return VReqStatus;}
	
	Vector VCUST_ABBR = new Vector(); //HARSH20210112
	public Vector getVCUST_ABBR() {return VCUST_ABBR;} //HARSH20210112
	
	Vector VPARENT_ABBR = new Vector(); //HARSH20210225
	public Vector getVPARENT_ABBR() {return VPARENT_ABBR;} //HARSH20210225
	
	Vector VPARENT_NM = new Vector(); //HARSH20210225
	public Vector getVPARENT_NM() {return VPARENT_NM;} //HARSH20210225
	Vector VPARENT_LIMIT = new Vector(); //HARSH20210225
	public Vector getVPARENT_LIMIT() {return VPARENT_LIMIT;} //HARSH20210225
	Vector VInfo = new Vector(); //HARSH20210225
	public Vector getVInfo() {return VInfo;} //HARSH20210225
	
	Vector VCOLOR = new Vector(); //HARSH20210220
	public Vector getVCOLOR() {return VCOLOR;} //HARSH20210220
	String Customer_ABBR = "";
	public void setCustomer_ABBR(String Customer_ABBR) {this.Customer_ABBR = Customer_ABBR;}//HARSH20210112
	
	String f_sts = "";
	public void setf_sts(String f_sts) {this.f_sts = f_sts;}//Jayesh 05012020
	String Days = "";//HARSH20210225
	public void setDays(String Days) {this.Days = Days;}//HARSH20210225
	
	///HARSH20201228///////Onscreen walk forward exposure/limit Monitoring/////
	public void fetchOnscreenWalkForwardExposure_LimitMonitoring()
	{
		try
		{
			String start_dt = "", end_dt="", viewStartDt="",FirstDt ="",sysdate_2 = "";
			String dt = "";
			queryString = "select to_char(sysdate-1,'DD/MM/YYYY') from dual";
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				dt = rset.getString(1);
			}
			
			fetchCapacityDealForWalkfwd(dt);
			fetchSecuredUnsecuredDealId_SN_LOA(dt); //HARSH20210721
			System.out.println(VWlakFwdCapacityDealId);
			System.out.println(VWlakFwdCapacityDealDCQ);
			
			if(!Days.equals("")){
				int d = Integer.parseInt(Days) - 1;
				queryString = "select to_char(sysdate-1,'DD/MM/YYYY'),"
									+ "to_char(sysdate+"+d+",'DD/MM/YYYY'),"
									+ "to_char(sysdate-1,'dd/mm/yyyy'),"
									+ "TO_CHAR(trunc(to_date('"+dt+"','DD/MM/YYYY')) - (to_number(to_char(to_date('"+dt+"','DD/MM/YYYY'),'DD')) - 1),'DD/MM/YYYY'),"
									+ "to_char(sysdate-2,'dd/mm/yyyy') "
									+ "from dual";
			}else{
				queryString = "select to_char(sysdate-1,'DD/MM/YYYY'),"
									+ "to_char(add_months(sysdate-1,6),'DD/MM/YYYY'),"
									+ "to_char(sysdate-1,'dd/mm/yyyy'),"
									+ "TO_CHAR(trunc(to_date('"+dt+"','DD/MM/YYYY')) - (to_number(to_char(to_date('"+dt+"','DD/MM/YYYY'),'DD')) - 1),'DD/MM/YYYY'),"
									+ "to_char(sysdate-2,'dd/mm/yyyy') "
									+ "from dual";
			}
			rset1=stmt1.executeQuery(queryString);
			if(rset1.next())
			{
				//System.out.println("Start Dt "+rset1.getString(1));
				//System.out.println("End Dt "+rset1.getString(2));
				start_dt=rset1.getString(1);
				end_dt = rset1.getString(2);
				viewStartDt = rset1.getString(3);
				FirstDt = rset1.getString(4);
				sysdate_2 = rset1.getString(5); //HARSH20210305
				
				int days = 0;
				///Now we count no of days between two days
				queryString="select to_date('"+start_dt+"','DD/MM/YYYY') - to_date('"+end_dt+"','DD/MM/YYYY')-1 from dual";
				rset2=stmt2.executeQuery(queryString);
				if(rset2.next())
				{
					//System.out.println("Days "+(-1)*rset2.getInt(1)/7);
					days = (-1)*rset2.getInt(1)/7;
				}//System.out.println("Days::::"+days);
				VExposure_dt.add(viewStartDt);
				//7 day ratio between two days
				for(int i=0; i<days; i++)
				{
					queryString="select to_char(to_date('"+start_dt+"','dd/mm/yyyy')+7,'dd/mm/yyyy'),to_char(to_date('"+start_dt+"','dd/mm/yyyy')+7,'dd/mm') from dual where to_date('"+start_dt+"','dd/mm/yyyy') <= to_date('"+end_dt+"','dd/mm/yyyy')";
					rset2=stmt2.executeQuery(queryString);
					if(rset2.next())
					{
						//System.out.println(i+"-"+rset2.getString(2));
						start_dt=rset2.getString(1);
						VExposure_dt.add(start_dt);
					}
				}
			}
			String S_B = "";
			/*HARSH20210112 if(sell_buy.equals("Buy")){
				S_B="B";
			}else{
				S_B="S";
			}*/
			
			//IF EXPOSURE EOD PORCESS NOT TRIGGER THEN WE FETCH REPORT DT IS SYSDATE-2 HARSH20210305
			queryString = "SELECT COUNT(*) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT = TO_DATE('"+viewStartDt+"','DD/MM/YYYY')";
			rset=stmt.executeQuery(queryString);
			if(rset.next())
			{
				if(rset.getInt(1) > 0)
				{
				}
				else{
					viewStartDt = sysdate_2;
				}
			}
			double monthTotal = 0;
			for(int j =0; j< VExposure_dt.size(); j++)
			{
				////////////Limit Calculation////////////////////
				double limit = 0; double parentLimit = 0;
				queryString ="SELECT SUM(AMT) from FMS9_LIMIT_DTL WHERE CUST_ABBR='"+Customer_ABBR+"' AND EFF_DT<= to_date('"+VExposure_dt.elementAt(j)+"','dd/mm/yyyy') AND ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') and inactivation_dt is null) or (exp_dt >= to_date('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') or exp_dt is null) and (inactivation_dt-1 >= to_date('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY'))) AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL"; // AND BUY_SELL='"+S_B+"'
				rset=stmt.executeQuery(queryString);
				if(rset.next())
				{
					limit = rset.getDouble(1); //HARSH20210225 :: AS PER FEEDBACK ON 24/02/2021
					if(limit < 0)//HARSH20210225 :: AS PER FEEDBACK ON 24/02/2021 NO NEED TO REFLECT NEGETIVE VALUES.
					{
						limit = 0;
					}
					//VLimitCalculation.add(nf.format(limit));
					
					VOpenExposure.add("0.00");
					//VAvailableCredit.add("0.00");
				}
					//HARSH20210225 AS PER FEEDBACK ON 24/02/2021
				queryString = "SELECT DISTINCT PARENT_OWNSHIP_ABBR,PARENT_OWNSHIP FROM FMS9_LIMIT_MST " 
						+ "WHERE CUST_ABBR='"+Customer_ABBR+"' AND PARENT_ENT_DT <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') AND (PARENT_EXIT_DT >= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') OR PARENT_EXIT_DT IS NULL)";
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					String parent_abbr = rset.getString(1)==null?"":rset.getString(1);
					queryString1 ="SELECT SUM(AMT) from FMS9_LIMIT_DTL WHERE CUST_ABBR='"+parent_abbr+"' AND EFF_DT<= to_date('"+VExposure_dt.elementAt(j)+"','dd/mm/yyyy') AND ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') and inactivation_dt is null) or (exp_dt >= to_date('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') or exp_dt is null) and (inactivation_dt-1 >= to_date('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY'))) AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL";
					rset1=stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						parentLimit = rset1.getDouble(1);
						if(parentLimit < 0 )
						{
							parentLimit = 0;
						}
						if(VPARENT_ABBR.size() == 0)
						{
							VPARENT_ABBR.add(parent_abbr);
						}else{
							for(int k=0; k<VPARENT_ABBR.size(); k++)
							{
								if(!VPARENT_ABBR.elementAt(k).equals(parent_abbr))
								{
									VPARENT_ABBR.add(parent_abbr);
								}
							}
						}
					}
				}
				double total_limit = limit + parentLimit;
				VLimitCalculation.add(nf.format(total_limit));
				
				///////////////////////////////////////////////////////////////////////
				/////////////////////Settlement sell open credit///////////////////////
				
				double countSettlementExpo = 0;
				int countExpo=0;
				
				int check = 0;
				int month_total_flag = 0; //HARSH20210515
				VCOLOR.add("");
				
				for(int a=0; a < VSN_LOA_UNSECURED_DEAL.size(); a++)//HARSH20210721
				{
					if(j==0)
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST M WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST N WHERE N.CUSTOMER_ABBR='"+Customer_ABBR+"' AND M.CUSTOMER_ABBR=N.CUSTOMER_ABBR)) "
								+ "AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DEAL_ID='"+VSN_LOA_UNSECURED_DEAL.elementAt(a)+"' "//DEAL ID ADDED HARSH20210721
								+ "AND DELV_DT >= TO_DATE('"+FirstDt+"','DD/MM/YYYY') AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					else
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST M WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST N WHERE N.CUSTOMER_ABBR='"+Customer_ABBR+"' AND M.CUSTOMER_ABBR=N.CUSTOMER_ABBR)) "
								+ "AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DEAL_ID='"+VSN_LOA_UNSECURED_DEAL.elementAt(a)+"' "//DEAL ID ADDED HARSH20210721"
								+ "AND DELV_DT >= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY')-6 AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					//System.out.println(queryString);
					rset=stmt.executeQuery(queryString);
					while(rset.next())
					{
						check = 1;
						//countSettlementExpo += rset.getDouble(1);
						String deal_id = rset.getString(2)==null?"":rset.getString(2);//System.out.println(i+" "+deal_id);
					//	String cust_nm = rset.getString(3)==null?"":rset.getString(3);
						String cust_cd = rset.getString(3)==null?"":rset.getString(3);
						String price_type = rset.getString(4)==null?"":rset.getString(4);
						
						double cont_price = rset.getDouble(5); 
						double fwd_price_fin = rset.getDouble(6);
						double eff_deal_price = rset.getDouble(7);
						String dlvdt = rset.getString(8)==null?"":rset.getString(8); //HARSH20210303
						double total = 0;
						if(price_type.equals("Fixed"))
						{
							total = rset.getDouble(1) * cont_price;
						}else{
							if(fwd_price_fin != 0)
							{
								total = rset.getDouble(1) * fwd_price_fin;
							}
							else
							{
								total = rset.getDouble(1) * eff_deal_price;
							}
						}
						total = Double.parseDouble(nf.format(total));
						
						String dealNosplit[] = deal_id.split("-");
						String contType = dealNosplit[0].substring(0,1);
						String fgsano = dealNosplit[1];
						String snno = dealNosplit[3];
						String fgsaRev = dealNosplit[2]; //HARSH20210520
						String snRev = dealNosplit[4]; //HARSH20210520
						//HARSH20210520
						double TranValue=0;
						if(contType.equals("S"))
						{
							queryString1 = "SELECT TRANSPORTATION_CHARGE FROM FMS7_SN_MST WHERE CUSTOMER_CD = '"+cust_cd+"' AND FGSA_NO='"+fgsano+"' AND FGSA_REV_NO = '"+fgsaRev+"' AND SN_NO = '"+snno+"' AND SN_REV_NO = '"+snRev+"'";
						}
						else
						{
							queryString1 = "SELECT TRANSPORTATION_CHARGE FROM FMS7_LOA_MST WHERE CUSTOMER_CD = '"+cust_cd+"' AND TENDER_NO='"+fgsano+"' AND LOA_NO = '"+snno+"' AND LOA_REV_NO = '"+snRev+"'";
						}
						//System.out.println(queryString1);
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next())
						{
							TranValue = rset1.getDouble(1);
						}//System.out.println("TranValue :: "+TranValue);
						///////////
						
						//System.out.println("Cont Type@@"+contType);
						String ExchRateCd="";
						queryString1 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS7_SN_BILLING_DTL WHERE cont_type='"+contType+"' AND customer_cd="+cust_cd+" AND FGSA_NO="+fgsano+" AND sn_no="+snno+" ";
						//System.out.println(queryString1);
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next()){
							ExchRateCd=rset1.getString(1)==null?"":rset1.getString(1);
						}
						double AvailableExchgRate=0;
						queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+VExposure_dt.elementAt(j)+"','dd/mm/yyyy')) AND FLAG='Y' ";
						//System.out.println(queryString2);
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							AvailableExchgRate =rset2.getDouble(1);	
						}
						//System.out.println("AvailableExchgRate###"+AvailableExchgRate);
						
						double AvgTaxInInv = 0;
						queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
								" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD="+cust_cd+" AND APP_DATE <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') "
								+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
								+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY'))";
								//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							AvgTaxInInv=rset2.getDouble(1);
						}
						//System.out.println("AvgTaxInInv###"+AvgTaxInInv);	
						double USDtoINR = total * AvailableExchgRate; //System.out.println("USDtoINR@@"+USDtoINR);
						USDtoINR = Double.parseDouble(nf.format(USDtoINR));
						double ApplyTax = USDtoINR * (AvgTaxInInv/100); //System.out.println("ApplyTax@@"+ApplyTax);
						ApplyTax = Double.parseDouble(nf.format(ApplyTax));
						
						double AddTransCharge = 0;
						if(TranValue > 0) //HARSH20210520 INCLUDED TRANSPORTATION CHARGE
						{
							AddTransCharge = rset.getDouble(1) * TranValue;
						}
						AddTransCharge = Double.parseDouble(nf.format(AddTransCharge));
						
						countSettlementExpo += USDtoINR + ApplyTax + AddTransCharge;
						
						if(dlvdt.substring(0,2).equals("01"))
						{
							month_total_flag = 1; //HARSH20210515
							monthTotal = 0;
							monthTotal += countSettlementExpo;//USDtoINR + ApplyTax;
						}
						else
						{
							monthTotal += USDtoINR + ApplyTax + AddTransCharge;
						}
						//System.out.println(dlvdt+"#####"+nf.format(countSettlementExpo)+"############"+nf.format(monthTotal));
						int count=0;
						if(VDealID.size()==0)
						{
							VDealID.add(deal_id);
							CUSTOMER_CD.add(cust_cd);
							VExchgRate.add(AvailableExchgRate);
							VTaxRate.add(AvgTaxInInv);
							VBuySell.add("Sell");
							VTransValue.add(nf.format(TranValue));
						} //HARSH20210301
						for(int i=0; i < VDealID.size(); i++)
						{
							if(VDealID.elementAt(i).equals(deal_id))
							{//System.out.println(j);
								count=count+1;
							}
						}
						if(count==0)
						{
							VDealID.add(deal_id);
							CUSTOMER_CD.add(cust_cd);
							VExchgRate.add(AvailableExchgRate);
							VTaxRate.add(AvgTaxInInv);
							VBuySell.add("Sell");
							VTransValue.add(nf.format(TranValue));
						} //HARSH20210301
							
					}
				}
				
				//HARSH20210515 ADDING CAPACITY DEAL AS PER SHI-TING MAIL ON 05/05/2021
				if(VWlakFwdCapacityDealId.size() > 0)
				{
					int CAP_DAY =0;
					if(j == 0)
					{
						queryString = "SELECT TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY')-TO_DATE('"+FirstDt+"','DD/MM/YYYY')+1 FROM DUAL";
						rset=stmt.executeQuery(queryString);
						if(rset.next())
						{
							CAP_DAY = rset.getInt(1);
						}
					}
					else
					{
						CAP_DAY = 7;
					}
					for(int k=0; k < CAP_DAY; k++)
					{
						if(j == 0)
						{
							queryString="SELECT TO_CHAR(TO_DATE('"+FirstDt+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL";
						}
						else
						{
							int temp_c = k-(CAP_DAY-1);
							queryString="SELECT TO_CHAR(TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY')+"+temp_c+",'DD/MM/YYYY') FROM DUAL";
						}
						rset=stmt.executeQuery(queryString);
						if(rset.next())
						{
							String cap_dt = rset.getString(1)==null?"":rset.getString(1);
							for(int m=0; m < VWlakFwdCapacityDealId.size(); m++)
							{
								queryString1 = "SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+cap_dt+"','DD/MM/YYYY') <= TO_DATE('"+VWlakFwdCapacityDealEndDt.elementAt(m)+"','DD/MM/YYYY')";
								rset1=stmt1.executeQuery(queryString1);
								if(rset1.next())
								{
									if(rset1.getInt(1)>0)
									{
										check=1;
										String deal_id = VWlakFwdCapacityDealId.elementAt(m).toString();
										String map_id = deal_id.substring(1,deal_id.length());
										String ExchRateCd="";
										queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS8_LNG_REGAS_BILLING_DTL WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
										rset2=stmt2.executeQuery(queryString2);
										if(rset2.next()){
											ExchRateCd=rset2.getString(1)==null?"":rset2.getString(1);
										}
										double AvailableExchgRate=0;
										queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+VExposure_dt.elementAt(j)+"','dd/mm/yyyy')) AND FLAG='Y' ";
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvailableExchgRate =rset2.getDouble(1);	
										}
										double AvgTaxInInv = 0;
										/*HARSH20210524 queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
												" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"') "
												+ "AND APP_DATE <= TO_DATE('"+cap_dt+"','DD/MM/YYYY') "
												+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
												+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+cap_dt+"','DD/MM/YYYY'))";
												//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvgTaxInInv=rset2.getDouble(1);
										}*/
										
										AvgTaxInInv = 18; //AS PER ROHITBHAI MAIL ON 24/05/2021
										
										double total = 0;
										double DCQ = Double.parseDouble(""+VWlakFwdCapacityDealDCQ.elementAt(m));
										double cont_price = Double.parseDouble(""+VWlakFwdCapacityDealRate.elementAt(m));
										
										String currencyFlag = VWlakFwdCapacityCurrFlag.elementAt(m).toString();
										total = DCQ * cont_price;
										total = Double.parseDouble(nf.format(total));
										
										double USDtoINR =0;
										if(currencyFlag.equals("2"))
										{
											USDtoINR = total * AvailableExchgRate; //USD To INR
										}
										else
										{
											USDtoINR = total; //INR
										}  
										
										USDtoINR = Double.parseDouble(nf.format(USDtoINR));
										double ApplyTax = USDtoINR * (AvgTaxInInv/100);
										ApplyTax = Double.parseDouble(nf.format(ApplyTax));
										countSettlementExpo += USDtoINR + ApplyTax;
										
										if(cap_dt.substring(0,2).equals("01"))
										{
											if(month_total_flag == 1)
											{
												monthTotal += USDtoINR + ApplyTax;
											}
											else
											{
												monthTotal = 0;
												monthTotal += countSettlementExpo;
											}
										}
										else
										{
											monthTotal += USDtoINR + ApplyTax;
										}
									}
								}	
							}
						}
					}
				}
				/////////////////////////////////////////////////////
				if(check == 0)
				{
					monthTotal=0;
				}
				//}
				if(countSettlementExpo >= 0)
				{
					//HARSH20210304 VSettlementSellCredit.add(nf.format(countSettlementExpo));
					Vtotal.add(nf.format(countSettlementExpo));
				}
				else
				{
					countSettlementExpo = (-1)*(countSettlementExpo);
					Vtotal.add(nf.format(countSettlementExpo));
					//HARSH20210304 VSettlementSellCredit.add(nf.format(countSettlementExpo));
				}
				//HARSH20210303
				double availableCredit = 0;
				if(monthTotal >= 0)
				{
					VCumulativeExposure.add(nf.format(monthTotal));
					VSettlementSellCredit.add(nf.format(monthTotal));
					availableCredit = total_limit - monthTotal;
				}else{
					double t = (-1) * monthTotal;
					VSettlementSellCredit.add(nf.format(t));
					VCumulativeExposure.add(nf.format(t));
					availableCredit = total_limit - t;
				}
				////////////////////////////////////////////////////////////////////////
				
				///////////////Available Credit HARSH20210225/////////////////////////
				//double availableCredit = total_limit - countSettlementExpo;
				
				 
				if(availableCredit < 0)
				{
					//availableCredit = 0;
				}
				VAvailableCredit.add(nf.format(availableCredit));
			}
			
			///only show deal & date wise data///////////////////////////////
			for(int j=0; j<VDealID.size();j++)
			{
				queryString = "select customer_name from fms7_customer_mst where customer_cd='"+CUSTOMER_CD.elementAt(j)+"'";
				rset=stmt.executeQuery(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(1)==null?"":rset.getString(1));
				}
				
				double cumulativeTotal = 0;
				
				for(int i =0; i< VExposure_dt.size(); i++)
				{
					String information = "";
					double sum_grandTotal = 0;
					int countExpo=0;
					
					int check = 0;//HARSH20210309
					if(i == 0)
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD='"+CUSTOMER_CD.elementAt(j)+"' AND DEAL_ID = '"+VDealID.elementAt(j)+"' AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DELV_DT >= TO_DATE('"+FirstDt+"','DD/MM/YYYY') AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					else
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD='"+CUSTOMER_CD.elementAt(j)+"' AND DEAL_ID = '"+VDealID.elementAt(j)+"' AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DELV_DT >= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY')-6 AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					rset=stmt.executeQuery(queryString);
					while(rset.next())
					{
						check = 1;//HARSH20210309
						String price_type = rset.getString(4)==null?"":rset.getString(4);
						String  delv_dt = rset.getString(8)==null?"":rset.getString(8); //HARSH20210225
						
						double cont_price = rset.getDouble(5);
						double fwd_price_fin = rset.getDouble(6);
						double eff_deal_price = rset.getDouble(7);
						
						double total = 0;
						information += "Date "+delv_dt+"~Price_Type = "+price_type+"~DCQ = "+rset.getDouble(1)+"~";
						if(price_type.equals("Fixed"))
						{
							information+="Cont_Price = "+cont_price+"";
							total = rset.getDouble(1) * cont_price;
						}else{
							if(fwd_price_fin != 0)
							{
								information+="Fwd_Price_Fin_Leg = "+fwd_price_fin+"";
								total = rset.getDouble(1) * fwd_price_fin;
							}
							else
							{
								information+="Eff_Deal_Price = "+eff_deal_price+"";
								total = rset.getDouble(1) * eff_deal_price;
							}
						}
						total = Double.parseDouble(nf.format(total));
						//information += total+"~ExchgRate = ("+total+") * ("+(double)VExchgRate.elementAt(j)+") = ";
						information += "~Total = "+total+"~ExchgRate = "+(double)VExchgRate.elementAt(j)+"";
						//System.out.println("Total###"+total);
						double USDtoINR = total * (double)VExchgRate.elementAt(j); //System.out.println("USDtoINR@@"+USDtoINR);
						//information += nf.format(USDtoINR)+"~ApplyTax = ("+nf.format(USDtoINR)+") * ("+(double)VTaxRate.elementAt(j)+") / 100 = ";
						USDtoINR = Double.parseDouble(nf.format(USDtoINR));
						information += "~ApplyTax = "+(double)VTaxRate.elementAt(j)+"";
						double ApplyTax = USDtoINR * ((double)VTaxRate.elementAt(j)/100); //System.out.println("ApplyTax@@"+ApplyTax);
						ApplyTax = Double.parseDouble(nf.format(ApplyTax));
						//information +=  nf.format(ApplyTax)+"~Grand_Total = ("+nf.format(USDtoINR)+") + ("+nf.format(ApplyTax)+") = ";
						
						//HARSH20210520
						double TranValue = Double.parseDouble(""+VTransValue.elementAt(j));
						double AddTransCharge = 0;
						if(TranValue > 0)
						{
							AddTransCharge = rset.getDouble(1) * TranValue;
							information += "~TransValue = "+nf.format(TranValue)+"";
						}
						AddTransCharge = Double.parseDouble(nf.format(AddTransCharge));
						double grandTotal = USDtoINR + ApplyTax + AddTransCharge; //System.out.println("grandTotal@@"+grandTotal+"\n");
						information += "~Grand_Total = "+nf.format(grandTotal)+" ";
						
						sum_grandTotal += grandTotal;
						
						if(delv_dt.substring(0,2).equals("01"))//HARSH20210309
						{
							cumulativeTotal = 0;
							cumulativeTotal += sum_grandTotal;//USDtoINR + ApplyTax;
						}
						else
						{
							cumulativeTotal += USDtoINR + ApplyTax + AddTransCharge;
						}
						
					}
					//}
					//System.out.println("sum_grandTotal@@"+sum_grandTotal);
					if(sum_grandTotal >= 0){
						//HARSH20210309 VCustWiseSettlementSellCredit.add(nf.format(sum_grandTotal));
					}else{
						//HARSH20210309 VCustWiseSettlementSellCredit.add(nf.format((-1)*sum_grandTotal));
					}
					
					if(check == 0) //HARSH20210309
					{
						cumulativeTotal=0;
					}
					if(cumulativeTotal >= 0){ //HARSH20210309
						VCustWiseSettlementSellCredit.add(nf.format(cumulativeTotal));
					}else{
						VCustWiseSettlementSellCredit.add(nf.format((-1)*cumulativeTotal));
					}
					
					VInfo.add(information);
				}
			}
			//SHOWING DETAIL CUSTOMER WISE FOR CAPACITY DEAL HARSH20210515
			if(VWlakFwdCapacityDealId.size()>0)
			{
				for(int j=0; j<VWlakFwdCapacityDealId.size(); j++)
				{
					String customer_nm = getCustomerNm(Customer_ABBR);
					CUSTOMER_NM.add(customer_nm);
					
					VDealID.add(VWlakFwdCapacityDealId.elementAt(j).toString());
					VBuySell.add("Sell");
					
					double cumulativeTotal = 0;
					for(int i =0; i< VExposure_dt.size(); i++)
					{
						String information = "";
						double sum_grandTotal = 0;
						int countExpo=0;
						
						int check = 0;
						
						int CAP_DAY =0;
						if(i == 0)
						{
							queryString = "SELECT TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+FirstDt+"','DD/MM/YYYY')+1 FROM DUAL";
							rset=stmt.executeQuery(queryString);
							if(rset.next())
							{
								CAP_DAY = rset.getInt(1);
							}
						}
						else
						{
							CAP_DAY = 7;
						}
						for(int k=0; k < CAP_DAY; k++)
						{
							if(i == 0)
							{
								queryString="SELECT TO_CHAR(TO_DATE('"+FirstDt+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL";
							}
							else
							{
								int temp_c = k-(CAP_DAY-1);
								queryString="SELECT TO_CHAR(TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY')+"+temp_c+",'DD/MM/YYYY') FROM DUAL";
							}
							rset=stmt.executeQuery(queryString);
							if(rset.next())
							{
								String cap_dt = rset.getString(1)==null?"":rset.getString(1);
								queryString1 = "SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+cap_dt+"','DD/MM/YYYY') <= TO_DATE('"+VWlakFwdCapacityDealEndDt.elementAt(j)+"','DD/MM/YYYY')";
								rset1=stmt1.executeQuery(queryString1);
								if(rset1.next())
								{
									if(rset1.getInt(1)>0)
									{
										check=1;
										String deal_id = VWlakFwdCapacityDealId.elementAt(j).toString();
										String map_id = deal_id.substring(1,deal_id.length());
										String ExchRateCd="";
										queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS8_LNG_REGAS_BILLING_DTL WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
										rset2=stmt2.executeQuery(queryString2);
										if(rset2.next()){
											ExchRateCd=rset2.getString(1)==null?"":rset2.getString(1);
										}
										double AvailableExchgRate=0;
										queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+VExposure_dt.elementAt(i)+"','dd/mm/yyyy')) AND FLAG='Y' ";
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvailableExchgRate =rset2.getDouble(1);	
										}
										double AvgTaxInInv = 0;
										/*HARSH20210524 queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
												" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"') "
												+ "AND APP_DATE <= TO_DATE('"+cap_dt+"','DD/MM/YYYY') "
												+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
												+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+cap_dt+"','DD/MM/YYYY'))";
												//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvgTaxInInv=rset2.getDouble(1);
										}*/
										
										AvgTaxInInv = 18; //AS PER ROHITBHAI MAIL ON 24/05/2021
										
										double total = 0;
										double DCQ = Double.parseDouble(""+VWlakFwdCapacityDealDCQ.elementAt(j));
										double cont_price = Double.parseDouble(""+VWlakFwdCapacityDealRate.elementAt(j));
										//System.out.println("DCQ :: "+DCQ);
										//System.out.println("cont_price :: "+cont_price);
										//System.out.println("AvailableExchgRate :: "+AvailableExchgRate);
										//System.out.println("AvgTaxInInv :: "+AvgTaxInInv);
										//DCQ = 33333.00;
										//cont_price = 0.78;
										
										information += "Date "+cap_dt+"~Price_Type = Fixed~DCQ = "+DCQ+"~";
										information+="Cont_Price = "+cont_price+"";
										
										
										total = DCQ * cont_price;
										total = Double.parseDouble(nf.format(total));
										//System.out.println("Total :: "+nf.format(total));
										String currencyFlag = VWlakFwdCapacityCurrFlag.elementAt(j).toString();
										double USDtoINR = 0;
										//AvailableExchgRate=73.47;
										
										if(currencyFlag.equals("2"))
										{
											information += "~Total = "+total+"~ExchgRate = "+AvailableExchgRate+"";
											USDtoINR = total * AvailableExchgRate;
											
										}
										else
										{
											information += "~Total = "+total+"";
											USDtoINR = total;
										}
										//AvgTaxInInv=12.50;
										
										USDtoINR = Double.parseDouble(nf.format(USDtoINR));
										
										information += "~ApplyTax = "+AvgTaxInInv+"";
										double ApplyTax = USDtoINR * (AvgTaxInInv/100); 
										ApplyTax = Double.parseDouble(nf.format(ApplyTax));
										double grandTotal = USDtoINR + ApplyTax; 
										information += "~Grand_Total = "+nf.format(grandTotal)+"";
										//System.out.println(nf.format(grandTotal));
										
										sum_grandTotal += grandTotal;
										
										if(cap_dt.substring(0,2).equals("01"))
										{
											cumulativeTotal = 0;
											cumulativeTotal += sum_grandTotal;
										}
										else
										{
											cumulativeTotal += USDtoINR + ApplyTax;
										}
									}
								}
							}
						}
						if(check == 0) 
						{
							cumulativeTotal=0;
						}
						if(cumulativeTotal >= 0){ 
							VCustWiseSettlementSellCredit.add(nf.format(cumulativeTotal));
						}else{
							VCustWiseSettlementSellCredit.add(nf.format((-1)*cumulativeTotal));
						}
						
						VInfo.add(information);
					}
				}
			}
			////////////////////////////////////////////////////////////////////////////////
			/////ONLY FOR SHOW PARENT LIMIT DATE WISE HARSH20210225///////////////////////
			for(int j=0; j<VPARENT_ABBR.size();j++)
			{
				queryString = "select customer_name from fms7_customer_mst where customer_abbr='"+VPARENT_ABBR.elementAt(j)+"'";
				rset=stmt.executeQuery(queryString);
				if(rset.next())
				{
					VPARENT_NM.add(rset.getString(1)==null?"":rset.getString(1));
				}else{
					queryString = "select trader_name from fms7_trader_mst where trader_abbr='"+VPARENT_ABBR.elementAt(j)+"'";
					rset=stmt.executeQuery(queryString);
					if(rset.next())
					{
						VPARENT_NM.add(rset.getString(1)==null?"":rset.getString(1));
					}else{
						VPARENT_NM.add("");
					}
				}
				for(int i =0; i< VExposure_dt.size(); i++)
				{
					double parentLimit =0;
					queryString = "SELECT DISTINCT PARENT_OWNSHIP_ABBR,PARENT_OWNSHIP FROM FMS9_LIMIT_MST " 
							+ "WHERE CUST_ABBR='"+Customer_ABBR+"' AND PARENT_ENT_DT <= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') AND (PARENT_EXIT_DT >= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') OR PARENT_EXIT_DT IS NULL)";
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						String parent_abbr = rset.getString(1)==null?"":rset.getString(1);
						queryString1 ="SELECT SUM(AMT) from FMS9_LIMIT_DTL WHERE CUST_ABBR='"+parent_abbr+"' AND EFF_DT<= to_date('"+VExposure_dt.elementAt(i)+"','dd/mm/yyyy') AND ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') and inactivation_dt is null) or (exp_dt >= to_date('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') or exp_dt is null) and (inactivation_dt-1 >= to_date('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY'))) AND ((ACTION_TYPE='Adjust Limit') OR (ACTION_TYPE='Adjust Usage' AND LIMIT_TYPE != 'Unsecured')) AND APRV_BY IS NOT NULL";
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next())
						{
							parentLimit = rset1.getDouble(1);
							if(parentLimit < 0 )
							{
								parentLimit = 0;
							}
						}
					}
					VPARENT_LIMIT.add(parentLimit);
				}
			}
			///////////////////////////////////////////////////////////////////////////////
			System.out.println(VExposure_dt+"\n"+VSettlementSellCredit+"\n"+VDealID.size()+"\n"+CUSTOMER_NM.size()+"\n"+VCustWiseSettlementSellCredit.size());
		
			countSecuredDealSettlmentSellExposure(viewStartDt,FirstDt); //HARSH20210722
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	//HARSH20210721 NEW FUNCATION FOR SECURED DEAL FOR SETTLMENT SELL EXPOSURES
	public void countSecuredDealSettlmentSellExposure(String viewStartDt,String FirstDt)
	{
		try
		{
			double monthTotal = 0;
			for(int j =0; j< VExposure_dt.size(); j++)
			{
				/////////////////////Settlement sell Exposure///////////////////////
				double countSettlementExpo = 0;
				int countExpo=0;
				
				int check = 0;
				int month_total_flag = 0; //HARSH20210515
				VCOLOR.add("");
				
				for(int a=0; a < VSN_LOA_SECURED_DEAL.size(); a++)//HARSH20210721
				{
					if(j==0)
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST M WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST N WHERE N.CUSTOMER_ABBR='"+Customer_ABBR+"' AND M.CUSTOMER_ABBR=N.CUSTOMER_ABBR)) "
								+ "AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DEAL_ID='"+VSN_LOA_SECURED_DEAL.elementAt(a)+"' "//DEAL ID ADDED HARSH20210721
								+ "AND DELV_DT >= TO_DATE('"+FirstDt+"','DD/MM/YYYY') AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					else
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST M WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST N WHERE N.CUSTOMER_ABBR='"+Customer_ABBR+"' AND M.CUSTOMER_ABBR=N.CUSTOMER_ABBR)) "
								+ "AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DEAL_ID='"+VSN_LOA_SECURED_DEAL.elementAt(a)+"' "//DEAL ID ADDED HARSH20210721"
								+ "AND DELV_DT >= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY')-6 AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					//System.out.println(queryString);
					rset=stmt.executeQuery(queryString);
					while(rset.next())
					{
						check = 1;
						//countSettlementExpo += rset.getDouble(1);
						String deal_id = rset.getString(2)==null?"":rset.getString(2);//System.out.println(i+" "+deal_id);
					//	String cust_nm = rset.getString(3)==null?"":rset.getString(3);
						String cust_cd = rset.getString(3)==null?"":rset.getString(3);
						String price_type = rset.getString(4)==null?"":rset.getString(4);
						
						double cont_price = rset.getDouble(5); 
						double fwd_price_fin = rset.getDouble(6);
						double eff_deal_price = rset.getDouble(7);
						String dlvdt = rset.getString(8)==null?"":rset.getString(8); //HARSH20210303
						double total = 0;
						if(price_type.equals("Fixed"))
						{
							total = rset.getDouble(1) * cont_price;
						}else{
							if(fwd_price_fin != 0)
							{
								total = rset.getDouble(1) * fwd_price_fin;
							}
							else
							{
								total = rset.getDouble(1) * eff_deal_price;
							}
						}
						total = Double.parseDouble(nf.format(total));
						
						String dealNosplit[] = deal_id.split("-");
						String contType = dealNosplit[0].substring(0,1);
						String fgsano = dealNosplit[1];
						String snno = dealNosplit[3];
						String fgsaRev = dealNosplit[2]; //HARSH20210520
						String snRev = dealNosplit[4]; //HARSH20210520
						//HARSH20210520
						double TranValue=0;
						if(contType.equals("S"))
						{
							queryString1 = "SELECT TRANSPORTATION_CHARGE FROM FMS7_SN_MST WHERE CUSTOMER_CD = '"+cust_cd+"' AND FGSA_NO='"+fgsano+"' AND FGSA_REV_NO = '"+fgsaRev+"' AND SN_NO = '"+snno+"' AND SN_REV_NO = '"+snRev+"'";
						}
						else
						{
							queryString1 = "SELECT TRANSPORTATION_CHARGE FROM FMS7_LOA_MST WHERE CUSTOMER_CD = '"+cust_cd+"' AND TENDER_NO='"+fgsano+"' AND LOA_NO = '"+snno+"' AND LOA_REV_NO = '"+snRev+"'";
						}
						//System.out.println(queryString1);
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next())
						{
							TranValue = rset1.getDouble(1);
						}//System.out.println("TranValue :: "+TranValue);
						///////////
						
						//System.out.println("Cont Type@@"+contType);
						String ExchRateCd="";
						queryString1 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS7_SN_BILLING_DTL WHERE cont_type='"+contType+"' AND customer_cd="+cust_cd+" AND FGSA_NO="+fgsano+" AND sn_no="+snno+" ";
						//System.out.println(queryString1);
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next()){
							ExchRateCd=rset1.getString(1)==null?"":rset1.getString(1);
						}
						double AvailableExchgRate=0;
						queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+VExposure_dt.elementAt(j)+"','dd/mm/yyyy')) AND FLAG='Y' ";
						//System.out.println(queryString2);
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							AvailableExchgRate =rset2.getDouble(1);	
						}
						//System.out.println("AvailableExchgRate###"+AvailableExchgRate);
						
						double AvgTaxInInv = 0;
						queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
								" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD="+cust_cd+" AND APP_DATE <= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY') "
								+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
								+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY'))";
								//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							AvgTaxInInv=rset2.getDouble(1);
						}
						//System.out.println("AvgTaxInInv###"+AvgTaxInInv);	
						double USDtoINR = total * AvailableExchgRate; //System.out.println("USDtoINR@@"+USDtoINR);
						USDtoINR = Double.parseDouble(nf.format(USDtoINR));
						double ApplyTax = USDtoINR * (AvgTaxInInv/100); //System.out.println("ApplyTax@@"+ApplyTax);
						ApplyTax = Double.parseDouble(nf.format(ApplyTax));
						
						double AddTransCharge = 0;
						if(TranValue > 0) //HARSH20210520 INCLUDED TRANSPORTATION CHARGE
						{
							AddTransCharge = rset.getDouble(1) * TranValue;
						}
						AddTransCharge = Double.parseDouble(nf.format(AddTransCharge));
						
						countSettlementExpo += USDtoINR + ApplyTax + AddTransCharge;
						
						if(dlvdt.substring(0,2).equals("01"))
						{
							month_total_flag = 1; //HARSH20210515
							monthTotal = 0;
							monthTotal += countSettlementExpo;//USDtoINR + ApplyTax;
						}
						else
						{
							monthTotal += USDtoINR + ApplyTax + AddTransCharge;
						}
						//System.out.println(dlvdt+"#####"+nf.format(countSettlementExpo)+"############"+nf.format(monthTotal));
						int count=0;
						if(VSEC_DealID.size()==0)
						{
							VSEC_DealID.add(deal_id);
							VSEC_CUSTOMER_CD.add(cust_cd);
							VSEC_ExchgRate.add(AvailableExchgRate);
							VSEC_TaxRate.add(AvgTaxInInv);
							VSEC_BuySell.add("Sell");
							VSEC_TransValue.add(nf.format(TranValue));
						} //HARSH20210301
						for(int i=0; i < VSEC_DealID.size(); i++)
						{
							if(VSEC_DealID.elementAt(i).equals(deal_id))
							{//System.out.println(j);
								count=count+1;
							}
						}
						if(count==0)
						{
							VSEC_DealID.add(deal_id);
							VSEC_CUSTOMER_CD.add(cust_cd);
							VSEC_ExchgRate.add(AvailableExchgRate);
							VSEC_TaxRate.add(AvgTaxInInv);
							VSEC_BuySell.add("Sell");
							VSEC_TransValue.add(nf.format(TranValue));
						} //HARSH20210301
							
					}
				}
				
				//HARSH20210515 ADDING CAPACITY DEAL AS PER SHI-TING MAIL ON 05/05/2021
				if(VWlakFwdSecCapaDealId.size() > 0)
				{
					int CAP_DAY =0;
					if(j == 0)
					{
						queryString = "SELECT TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY')-TO_DATE('"+FirstDt+"','DD/MM/YYYY')+1 FROM DUAL";
						rset=stmt.executeQuery(queryString);
						if(rset.next())
						{
							CAP_DAY = rset.getInt(1);
						}
					}
					else
					{
						CAP_DAY = 7;
					}
					for(int k=0; k < CAP_DAY; k++)
					{
						if(j == 0)
						{
							queryString="SELECT TO_CHAR(TO_DATE('"+FirstDt+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL";
						}
						else
						{
							int temp_c = k-(CAP_DAY-1);
							queryString="SELECT TO_CHAR(TO_DATE('"+VExposure_dt.elementAt(j)+"','DD/MM/YYYY')+"+temp_c+",'DD/MM/YYYY') FROM DUAL";
						}
						rset=stmt.executeQuery(queryString);
						if(rset.next())
						{
							String cap_dt = rset.getString(1)==null?"":rset.getString(1);
							for(int m=0; m < VWlakFwdSecCapaDealId.size(); m++)
							{
								queryString1 = "SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+cap_dt+"','DD/MM/YYYY') <= TO_DATE('"+VWlakFwdSecCapaDealEndDt.elementAt(m)+"','DD/MM/YYYY')";
								rset1=stmt1.executeQuery(queryString1);
								if(rset1.next())
								{
									if(rset1.getInt(1)>0)
									{
										check=1;
										String deal_id = VWlakFwdSecCapaDealId.elementAt(m).toString();
										String map_id = deal_id.substring(1,deal_id.length());
										String ExchRateCd="";
										queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS8_LNG_REGAS_BILLING_DTL WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
										rset2=stmt2.executeQuery(queryString2);
										if(rset2.next()){
											ExchRateCd=rset2.getString(1)==null?"":rset2.getString(1);
										}
										double AvailableExchgRate=0;
										queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+VExposure_dt.elementAt(j)+"','dd/mm/yyyy')) AND FLAG='Y' ";
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvailableExchgRate =rset2.getDouble(1);	
										}
										double AvgTaxInInv = 0;
										/*HARSH20210524 queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
												" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"') "
												+ "AND APP_DATE <= TO_DATE('"+cap_dt+"','DD/MM/YYYY') "
												+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
												+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+cap_dt+"','DD/MM/YYYY'))";
												//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvgTaxInInv=rset2.getDouble(1);
										}*/
										
										AvgTaxInInv = 18; //AS PER ROHITBHAI MAIL ON 24/05/2021
										
										double total = 0;
										double DCQ = Double.parseDouble(""+VWlakFwdSecCapaDealDCQ.elementAt(m));
										double cont_price = Double.parseDouble(""+VWlakFwdSecCapaDealRate.elementAt(m));
										
										String currencyFlag = VWlakFwdSecCapaCurrFlag.elementAt(m).toString();
										total = DCQ * cont_price;
										total = Double.parseDouble(nf.format(total));
										
										double USDtoINR =0;
										if(currencyFlag.equals("2"))
										{
											USDtoINR = total * AvailableExchgRate; //USD To INR
										}
										else
										{
											USDtoINR = total; //INR
										}  
										
										USDtoINR = Double.parseDouble(nf.format(USDtoINR));
										double ApplyTax = USDtoINR * (AvgTaxInInv/100);
										ApplyTax = Double.parseDouble(nf.format(ApplyTax));
										countSettlementExpo += USDtoINR + ApplyTax;
										
										if(cap_dt.substring(0,2).equals("01"))
										{
											if(month_total_flag == 1)
											{
												monthTotal += USDtoINR + ApplyTax;
											}
											else
											{
												monthTotal = 0;
												monthTotal += countSettlementExpo;
											}
										}
										else
										{
											monthTotal += USDtoINR + ApplyTax;
										}
									}
								}	
							}
						}
					}
				}
				/////////////////////////////////////////////////////
				if(check == 0)
				{
					monthTotal=0;
				}
				//}
				if(countSettlementExpo >= 0)
				{
					Vtotal.add(nf.format(countSettlementExpo));
				}
				else
				{
					countSettlementExpo = (-1)*(countSettlementExpo);
					Vtotal.add(nf.format(countSettlementExpo));
				}
				//HARSH20210303
				double availableCredit = 0;
				if(monthTotal >= 0)
				{
					//VCumulativeExposure.add(nf.format(monthTotal));
					VSettlementSellExposure.add(nf.format(monthTotal));
					//availableCredit = total_limit - monthTotal;
				}else{
					double t = (-1) * monthTotal;
					VSettlementSellExposure.add(nf.format(t));
					//VCumulativeExposure.add(nf.format(t));
					//availableCredit = total_limit - t;
				}
				////////////////////////////////////////////////////////////////////////
				
				///////////////Available Credit HARSH20210225/////////////////////////
				//double availableCredit = total_limit - countSettlementExpo;
				
				 
				/*if(availableCredit < 0)
				{
					//availableCredit = 0;
				}
				VAvailableCredit.add(nf.format(availableCredit));*/
			}
			
			///only show deal & date wise data///////////////////////////////
			for(int j=0; j<VSEC_DealID.size();j++)
			{
				queryString = "select customer_name from fms7_customer_mst where customer_cd='"+VSEC_CUSTOMER_CD.elementAt(j)+"'";
				rset=stmt.executeQuery(queryString);
				if(rset.next())
				{
					VSEC_CUSTOMER_NM.add(rset.getString(1)==null?"":rset.getString(1));
				}
				
				double cumulativeTotal = 0;
				
				for(int i =0; i< VExposure_dt.size(); i++)
				{
					String information = "";
					double sum_grandTotal = 0;
					int countExpo=0;
					
					int check = 0;//HARSH20210309
					if(i == 0)
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD='"+VSEC_CUSTOMER_CD.elementAt(j)+"' AND DEAL_ID = '"+VSEC_DealID.elementAt(j)+"' AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DELV_DT >= TO_DATE('"+FirstDt+"','DD/MM/YYYY') AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					else
					{
						queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
								+ "WHERE CUSTOMER_CD='"+VSEC_CUSTOMER_CD.elementAt(j)+"' AND DEAL_ID = '"+VSEC_DealID.elementAt(j)+"' AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+viewStartDt+"','DD/MM/YYYY')) "
								+ "AND DELV_DT >= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY')-6 AND DELV_DT <= TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
					}
					rset=stmt.executeQuery(queryString);
					while(rset.next())
					{
						check = 1;//HARSH20210309
						String price_type = rset.getString(4)==null?"":rset.getString(4);
						String  delv_dt = rset.getString(8)==null?"":rset.getString(8); //HARSH20210225
						
						double cont_price = rset.getDouble(5);
						double fwd_price_fin = rset.getDouble(6);
						double eff_deal_price = rset.getDouble(7);
						
						double total = 0;
						information += "Date "+delv_dt+"~Price_Type = "+price_type+"~DCQ = "+rset.getDouble(1)+"~";
						if(price_type.equals("Fixed"))
						{
							information+="Cont_Price = "+cont_price+"";
							total = rset.getDouble(1) * cont_price;
						}else{
							if(fwd_price_fin != 0)
							{
								information+="Fwd_Price_Fin_Leg = "+fwd_price_fin+"";
								total = rset.getDouble(1) * fwd_price_fin;
							}
							else
							{
								information+="Eff_Deal_Price = "+eff_deal_price+"";
								total = rset.getDouble(1) * eff_deal_price;
							}
						}
						total = Double.parseDouble(nf.format(total));
						//information += total+"~ExchgRate = ("+total+") * ("+(double)VExchgRate.elementAt(j)+") = ";
						information += "~Total = "+total+"~ExchgRate = "+(double)VSEC_ExchgRate.elementAt(j)+"";
						//System.out.println("Total###"+total);
						double USDtoINR = total * (double)VSEC_ExchgRate.elementAt(j); //System.out.println("USDtoINR@@"+USDtoINR);
						//information += nf.format(USDtoINR)+"~ApplyTax = ("+nf.format(USDtoINR)+") * ("+(double)VTaxRate.elementAt(j)+") / 100 = ";
						USDtoINR = Double.parseDouble(nf.format(USDtoINR));
						information += "~ApplyTax = "+(double)VSEC_TaxRate.elementAt(j)+"";
						double ApplyTax = USDtoINR * ((double)VSEC_TaxRate.elementAt(j)/100); //System.out.println("ApplyTax@@"+ApplyTax);
						ApplyTax = Double.parseDouble(nf.format(ApplyTax));
						//information +=  nf.format(ApplyTax)+"~Grand_Total = ("+nf.format(USDtoINR)+") + ("+nf.format(ApplyTax)+") = ";
						
						//HARSH20210520
						double TranValue = Double.parseDouble(""+VSEC_TransValue.elementAt(j));
						double AddTransCharge = 0;
						if(TranValue > 0)
						{
							AddTransCharge = rset.getDouble(1) * TranValue;
							information += "~TransValue = "+nf.format(TranValue)+"";
						}
						AddTransCharge = Double.parseDouble(nf.format(AddTransCharge));
						double grandTotal = USDtoINR + ApplyTax + AddTransCharge; //System.out.println("grandTotal@@"+grandTotal+"\n");
						information += "~Grand_Total = "+nf.format(grandTotal)+" ";
						
						sum_grandTotal += grandTotal;
						
						if(delv_dt.substring(0,2).equals("01"))//HARSH20210309
						{
							cumulativeTotal = 0;
							cumulativeTotal += sum_grandTotal;//USDtoINR + ApplyTax;
						}
						else
						{
							cumulativeTotal += USDtoINR + ApplyTax + AddTransCharge;
						}
						
					}
					//}
					//System.out.println("sum_grandTotal@@"+sum_grandTotal);
					if(sum_grandTotal >= 0){
						//HARSH20210309 VCustWiseSettlementSellCredit.add(nf.format(sum_grandTotal));
					}else{
						//HARSH20210309 VCustWiseSettlementSellCredit.add(nf.format((-1)*sum_grandTotal));
					}
					
					if(check == 0) //HARSH20210309
					{
						cumulativeTotal=0;
					}
					if(cumulativeTotal >= 0){ //HARSH20210309
						VCustWiseSettlementSellExposure.add(nf.format(cumulativeTotal));
					}else{
						VCustWiseSettlementSellExposure.add(nf.format((-1)*cumulativeTotal));
					}
					
					VInfo1.add(information);
				}
			}
			
			//SHOWING DETAIL CUSTOMER WISE FOR CAPACITY DEAL HARSH20210515
			if(VWlakFwdSecCapaDealId.size()>0)
			{
				for(int j=0; j<VWlakFwdSecCapaDealId.size(); j++)
				{
					String customer_nm = getCustomerNm(Customer_ABBR);
					VSEC_CUSTOMER_NM.add(customer_nm);
					
					VSEC_DealID.add(VWlakFwdSecCapaDealId.elementAt(j).toString());
					VSEC_BuySell.add("Sell");
					
					double cumulativeTotal = 0;
					for(int i =0; i< VExposure_dt.size(); i++)
					{
						String information = "";
						double sum_grandTotal = 0;
						int countExpo=0;
						
						int check = 0;
						
						int CAP_DAY =0;
						if(i == 0)
						{
							queryString = "SELECT TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY')-TO_DATE('"+FirstDt+"','DD/MM/YYYY')+1 FROM DUAL";
							rset=stmt.executeQuery(queryString);
							if(rset.next())
							{
								CAP_DAY = rset.getInt(1);
							}
						}
						else
						{
							CAP_DAY = 7;
						}
						for(int k=0; k < CAP_DAY; k++)
						{
							if(i == 0)
							{
								queryString="SELECT TO_CHAR(TO_DATE('"+FirstDt+"','DD/MM/YYYY')+"+k+",'DD/MM/YYYY') FROM DUAL";
							}
							else
							{
								int temp_c = k-(CAP_DAY-1);
								queryString="SELECT TO_CHAR(TO_DATE('"+VExposure_dt.elementAt(i)+"','DD/MM/YYYY')+"+temp_c+",'DD/MM/YYYY') FROM DUAL";
							}
							rset=stmt.executeQuery(queryString);
							if(rset.next())
							{
								String cap_dt = rset.getString(1)==null?"":rset.getString(1);
								queryString1 = "SELECT COUNT(*) FROM DUAL WHERE TO_DATE('"+cap_dt+"','DD/MM/YYYY') <= TO_DATE('"+VWlakFwdSecCapaDealEndDt.elementAt(j)+"','DD/MM/YYYY')";
								rset1=stmt1.executeQuery(queryString1);
								if(rset1.next())
								{
									if(rset1.getInt(1)>0)
									{
										check=1;
										String deal_id = VWlakFwdSecCapaDealId.elementAt(j).toString();
										String map_id = deal_id.substring(1,deal_id.length());
										String ExchRateCd="";
										queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS8_LNG_REGAS_BILLING_DTL WHERE LTCORA_CN_FLAG='C' AND MAPPING_ID='"+map_id+"' ";
										rset2=stmt2.executeQuery(queryString2);
										if(rset2.next()){
											ExchRateCd=rset2.getString(1)==null?"":rset2.getString(1);
										}
										double AvailableExchgRate=0;
										queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+VExposure_dt.elementAt(i)+"','dd/mm/yyyy')) AND FLAG='Y' ";
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvailableExchgRate =rset2.getDouble(1);	
										}
										double AvgTaxInInv = 0;
										/*HARSH20210524 queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
												" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Customer_ABBR+"') "
												+ "AND APP_DATE <= TO_DATE('"+cap_dt+"','DD/MM/YYYY') "
												+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
												+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+cap_dt+"','DD/MM/YYYY'))";
												//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
										rset2 = stmt2.executeQuery(queryString2);
										if(rset2.next())
										{
											AvgTaxInInv=rset2.getDouble(1);
										}*/
										
										AvgTaxInInv = 18; //AS PER ROHITBHAI MAIL ON 24/05/2021
										
										double total = 0;
										double DCQ = Double.parseDouble(""+VWlakFwdSecCapaDealDCQ.elementAt(j));
										double cont_price = Double.parseDouble(""+VWlakFwdSecCapaDealRate.elementAt(j));
										//System.out.println("DCQ :: "+DCQ);
										//System.out.println("cont_price :: "+cont_price);
										//System.out.println("AvailableExchgRate :: "+AvailableExchgRate);
										//System.out.println("AvgTaxInInv :: "+AvgTaxInInv);
										//DCQ = 33333.00;
										//cont_price = 0.78;
										
										information += "Date "+cap_dt+"~Price_Type = Fixed~DCQ = "+DCQ+"~";
										information+="Cont_Price = "+cont_price+"";
										
										
										total = DCQ * cont_price;
										total = Double.parseDouble(nf.format(total));
										//System.out.println("Total :: "+nf.format(total));
										String currencyFlag = VWlakFwdSecCapaCurrFlag.elementAt(j).toString();
										double USDtoINR = 0;
										//AvailableExchgRate=73.47;
										
										if(currencyFlag.equals("2"))
										{
											information += "~Total = "+total+"~ExchgRate = "+AvailableExchgRate+"";
											USDtoINR = total * AvailableExchgRate;
											
										}
										else
										{
											information += "~Total = "+total+"";
											USDtoINR = total;
										}
										//AvgTaxInInv=12.50;
										
										USDtoINR = Double.parseDouble(nf.format(USDtoINR));
										
										information += "~ApplyTax = "+AvgTaxInInv+"";
										double ApplyTax = USDtoINR * (AvgTaxInInv/100); 
										ApplyTax = Double.parseDouble(nf.format(ApplyTax));
										double grandTotal = USDtoINR + ApplyTax; 
										information += "~Grand_Total = "+nf.format(grandTotal)+"";
										//System.out.println(nf.format(grandTotal));
										
										sum_grandTotal += grandTotal;
										
										if(cap_dt.substring(0,2).equals("01"))
										{
											cumulativeTotal = 0;
											cumulativeTotal += sum_grandTotal;
										}
										else
										{
											cumulativeTotal += USDtoINR + ApplyTax;
										}
									}
								}
							}
						}
						if(check == 0) 
						{
							cumulativeTotal=0;
						}
						if(cumulativeTotal >= 0){ 
							VCustWiseSettlementSellExposure.add(nf.format(cumulativeTotal));
						}else{
							VCustWiseSettlementSellExposure.add(nf.format((-1)*cumulativeTotal));
						}
						
						VInfo1.add(information);
					}
				}
			}
			////////////////////////////////////////////////////////////////////////////////
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	//NEW FUNCATION FOR WALK FWD CAPACITY DEAL
	public void fetchCapacityDealForWalkfwd(String date)
	{
		try
		{
			String queryString3 = "select TO_CHAR(A.CONTRACT_START_DT,'DD/MM/YYYY'),TO_CHAR(A.CONTRACT_END_DT,'DD/MM/YYYY'), " +
					"A.mapping_id,DCQ_QTY,A.REGAS_TARIF,A.TARIFF_CUR_FLAG from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
				    "A.CONTRACT_START_DT <= to_date('"+date+"','dd/mm/yyyy') AND " +
					"A.CONTRACT_END_DT >= to_date('"+date+"','dd/mm/yyyy') AND "
					+ "C.CUSTOMER_CD = (SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST M WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST N WHERE N.CUSTOMER_ABBR='"+Customer_ABBR+"' AND M.CUSTOMER_ABBR=N.CUSTOMER_ABBR)) AND C.MAPPING_ID = A.MAPPING_ID";
			//System.out.println(queryString3);
			rset2 = stmt2.executeQuery(queryString3);
			while(rset2.next())
			{
				String map_id=rset2.getString(3)==null?"":rset2.getString(3);
				
				//HARSH20210721 AS PER SHI TING MAIL ON 21/07/2021 IF SECURITY AS OA THEN CONSIDER UNSECURED DEAL, IF SECURITY AS LC OR BG THEN CONSIDER SECURED DEAL  
				int LCBGcount=0,OAcount=0;
				queryString1="SELECT COUNT(*) FROM FMS9_SECURITY_POST_MST A,LOG_FMS9_SECURITY_POST_MST B "
						+ "WHERE A.CUSTOMER_ABBR='"+Customer_ABBR+"' AND A.LINK='C"+map_id+"' AND A.SEC_TYPE IN ('LC','BG') "
						+ "AND A.CUSTOMER_ABBR=B.CUSTOMER_ABBR AND A.LINK=B.LINK AND A.SEQ_NO=B.SEQ_NO "
						+ "AND B.DTL_SEQ_NO='1' AND B.STATUS='Pending' AND A.RECEIVED='R' AND A.ISSUED IS NULL  ";
						//+ "A.RECEIVED=B.RECEIVED AND A.ISSUED=B.ISSUED";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					LCBGcount=rset1.getInt(1);
				}
				//HARSH20210726 AS PER SHI TING MAIL ON 26/07/2021 ALSO INCLUDE SECURITY AS PCG
				queryString1="SELECT COUNT(*) FROM FMS9_SECURITY_POST_MST A,LOG_FMS9_SECURITY_POST_MST B "
						+ "WHERE A.CUSTOMER_ABBR='"+Customer_ABBR+"' AND A.LINK='C"+map_id+"' AND A.SEC_TYPE IN ('OA','PCG') "
						+ "AND A.CUSTOMER_ABBR=B.CUSTOMER_ABBR AND A.LINK=B.LINK AND A.SEQ_NO=B.SEQ_NO "
						+ "AND B.DTL_SEQ_NO='1' AND B.STATUS='Pending' AND A.RECEIVED='R' AND A.ISSUED IS NULL  ";
				
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					OAcount=rset1.getInt(1);
				}
				if(OAcount > 0 && LCBGcount==0)//HARSH20210721
				{
					VWlakFwdCapacityDealId.add("C"+map_id);
					VWlakFwdCapacityDealDCQ.add(rset2.getDouble(4));
					VWlakFwdCapacityDealStDt.add(rset2.getString(1)==null?"":rset2.getString(1));
					VWlakFwdCapacityDealEndDt.add(rset2.getString(2)==null?"":rset2.getString(2));
					VWlakFwdCapacityDealRate.add(rset2.getDouble(5));
					VWlakFwdCapacityCurrFlag.add(rset2.getString(6)==null?"2":rset2.getString(6));
				}
				else if(LCBGcount > 0)//HARSH20210721
				{
					VWlakFwdSecCapaDealId.add("C"+map_id); //HARSH20210721
					VWlakFwdSecCapaDealDCQ.add(rset2.getDouble(4)); //HARSH20210721
					VWlakFwdSecCapaDealStDt.add(rset2.getString(1)==null?"":rset2.getString(1)); //HARSH20210721
					VWlakFwdSecCapaDealEndDt.add(rset2.getString(2)==null?"":rset2.getString(2)); //HARSH20210721
					VWlakFwdSecCapaDealRate.add(rset2.getDouble(5)); //HARSH20210721
					VWlakFwdSecCapaCurrFlag.add(rset2.getString(6)==null?"2":rset2.getString(6)); //HARSH20210721
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	//HARSH20210721 NEW FUNCTION
	public void fetchSecuredUnsecuredDealId_SN_LOA(String date)
	{
		//HARSH20210721 AS PER SHI TING MAIL ON 21/07/2021 IF SECURITY AS OA THEN CONSIDER UNSECURED DEAL, IF SECURITY AS LC OR BG THEN CONSIDER SECURED DEAL
		try
		{
			queryString = "SELECT DEAL_ID FROM FMS9_EOD_EXPOSURE_MST "
					+ "WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST M WHERE CUSTOMER_ABBR='"+Customer_ABBR+"' AND EFF_DT=(SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST N WHERE N.CUSTOMER_ABBR='"+Customer_ABBR+"' AND M.CUSTOMER_ABBR=N.CUSTOMER_ABBR)) "
					+ "AND REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+date+"','DD/MM/YYYY')) "
					+ "AND DEAL_ID NOT LIKE 'B%'";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				String map_id=rset.getString(1)==null?"":rset.getString(1);
				String split[] = map_id.split("-");
				String deal_id = split[0].substring(0,1)+split[1]+"-%-"+split[3]+"-%";
				//System.out.println(deal_id);
				//HARSH20210721 AS PER SHI TING MAIL ON 21/07/2021 IF SECURITY AS OA THEN CONSIDER UNSECURED DEAL, IF SECURITY AS LC OR BG THEN CONSIDER SECURED DEAL  
				int LCBGcount=0,OAcount=0;
				queryString1="SELECT COUNT(*) FROM FMS9_SECURITY_POST_MST A,LOG_FMS9_SECURITY_POST_MST B "
						+ "WHERE A.CUSTOMER_ABBR='"+Customer_ABBR+"' AND A.LINK LIKE '"+deal_id+"' AND A.SEC_TYPE IN ('LC','BG') "
						+ "AND A.CUSTOMER_ABBR=B.CUSTOMER_ABBR AND A.SEQ_NO=B.SEQ_NO "
						+ "AND B.DTL_SEQ_NO='1' AND B.STATUS='Pending' AND A.RECEIVED='R' AND A.ISSUED IS NULL "; 
						//+ "A.RECEIVED=B.RECEIVED AND A.ISSUED=B.ISSUED";
				//System.out.println(queryString1);
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					LCBGcount=rset1.getInt(1);
				}
				//HARSH20210726 AS PER SHI TING MAIL ON 26/07/2021 ALSO INCLUDE SECURITY AS PCG
				queryString1="SELECT COUNT(*) FROM FMS9_SECURITY_POST_MST A,LOG_FMS9_SECURITY_POST_MST B "
						+ "WHERE A.CUSTOMER_ABBR='"+Customer_ABBR+"' AND A.LINK LIKE '"+deal_id+"' AND A.SEC_TYPE IN ('OA','PCG') "
						+ "AND A.CUSTOMER_ABBR=B.CUSTOMER_ABBR AND A.SEQ_NO=B.SEQ_NO "
						+ "AND B.DTL_SEQ_NO='1' AND B.STATUS='Pending' AND A.RECEIVED='R' AND A.ISSUED IS NULL ";
				//System.out.println(queryString1);
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					OAcount=rset1.getInt(1);
				}
				
				if(OAcount > 0 && LCBGcount==0)//HARSH20210721
				{
					VSN_LOA_UNSECURED_DEAL.add(map_id);	
				}
				else if(LCBGcount > 0)//HARSH20210721
				{
					VSN_LOA_SECURED_DEAL.add(map_id);
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	Vector VSEC_DealID= new Vector(); //HARSH20210721
	public Vector getVSEC_DealID() {return VSEC_DealID;} //HARSH20210721
	Vector VSEC_CUSTOMER_CD= new Vector(); //HARSH20210721
	public Vector getVSEC_CUSTOMER_CD() {return VSEC_CUSTOMER_CD;} //HARSH20210721
	Vector VSEC_ExchgRate= new Vector(); //HARSH20210721
	public Vector getVSEC_ExchgRate() {return VSEC_ExchgRate;} //HARSH20210721
	Vector VSEC_TaxRate= new Vector(); //HARSH20210721
	public Vector getVSEC_TaxRate() {return VSEC_TaxRate;} //HARSH20210721
	Vector VSEC_BuySell= new Vector(); //HARSH20210721
	public Vector getVSEC_BuySell() {return VSEC_BuySell;} //HARSH20210721
	Vector VSEC_TransValue= new Vector(); //HARSH20210721
	public Vector getVSEC_TransValue() {return VSEC_TransValue;} //HARSH20210721
	Vector VSEC_CUSTOMER_NM = new Vector(); //HARSH20210721
	public Vector getVSEC_CUSTOMER_NM() {return VSEC_CUSTOMER_NM;} //HARSH20210721
	
	Vector VSettlementSellExposure = new Vector();//HARSH20210721
	public Vector getVSettlementSellExposure() {return VSettlementSellExposure;} //HARSH20210721
	
	Vector VCustWiseSettlementSellExposure = new Vector(); //HARSH20210721
	public Vector getVCustWiseSettlementSellExposure() {return VCustWiseSettlementSellExposure;}//HARSH20210721
	
	Vector VInfo1=new Vector(); //HARSH20210721
	public Vector getVInfo1() {return VInfo1;} //HARSH20210721
	
	Vector VSN_LOA_SECURED_DEAL = new Vector(); //HARSH20210721
	public Vector getVSN_LOA_SECURED_DEAL() {return VSN_LOA_SECURED_DEAL;} //HARSH20210721
	Vector VSN_LOA_UNSECURED_DEAL = new Vector(); //HARSH20210721
	public Vector getVSN_LOA_UNSECURED_DEAL() {return VSN_LOA_UNSECURED_DEAL;} //HARSH20210721
	
	Vector VWlakFwdCapacityDealId = new Vector(); //HARSH20210515
	public Vector getVWlakFwdCapacityDealId() {return VWlakFwdCapacityDealId;} //HARSH20210515
	Vector VWlakFwdCapacityDealDCQ = new Vector(); //HARSH20210515
	public Vector getVWlakFwdCapacityDealDCQ() {return VWlakFwdCapacityDealDCQ;} //HARSH20210515
	Vector VWlakFwdCapacityDealStDt = new Vector(); //HARSH20210515
	public Vector getVWlakFwdCapacityDealStDt() {return VWlakFwdCapacityDealStDt;} //HARSH20210515
	Vector VWlakFwdCapacityDealEndDt = new Vector(); //HARSH20210515
	public Vector getVWlakFwdCapacityDealEndDt() {return VWlakFwdCapacityDealEndDt;} //HARSH20210515
	Vector VWlakFwdCapacityDealRate = new Vector(); //HARSH20210515
	public Vector getVWlakFwdCapacityDealRate() {return VWlakFwdCapacityDealRate;} //HARSH20210515
	Vector VWlakFwdCapacityCurrFlag = new Vector(); //HARSH20210521
	public Vector getVWlakFwdCapacityCurrFlag() {return VWlakFwdCapacityCurrFlag;} //HARSH20210521
	
	Vector VWlakFwdSecCapaDealId = new Vector(); //HARSH20210721
	public Vector getVWlakFwdSecCapaDealId() {return VWlakFwdSecCapaDealId;} //HARSH20210721
	Vector VWlakFwdSecCapaDealDCQ = new Vector(); //HARSH20210721
	public Vector getVWlakFwdSecCapaDealDCQ() {return VWlakFwdSecCapaDealDCQ;} //HARSH20210721
	Vector VWlakFwdSecCapaDealStDt = new Vector(); //HARSH20210721
	public Vector getVWlakFwdSecCapaDealStDt() {return VWlakFwdSecCapaDealStDt;} //HARSH20210721
	Vector VWlakFwdSecCapaDealEndDt = new Vector(); //HARSH20210721
	public Vector getVWlakFwdSecCapaDealEndDt() {return VWlakFwdSecCapaDealEndDt;} //HARSH20210721
	Vector VWlakFwdSecCapaDealRate = new Vector(); //HARSH20210721
	public Vector getVWlakFwdSecCapaDealRate() {return VWlakFwdSecCapaDealRate;} //HARSH20210721
	Vector VWlakFwdSecCapaCurrFlag = new Vector(); //HARSH20210721
	public Vector getVWlakFwdSecCapaCurrFlag() {return VWlakFwdSecCapaCurrFlag;} //HARSH20210721
	
	
	String Cust_ABBR = new String();
	public String getCust_ABBR(){return Cust_ABBR;}
	
	Vector VCumulativeExposure = new Vector(); //HARSH20210303
	public Vector getVCumulativeExposure() {return VCumulativeExposure;} //HARSH20210303
	Vector Vtotal = new Vector(); //HARSH20210304
	public Vector getVtotal() {return Vtotal;} //HARSH20210304
	
	Vector VExposure_dt = new Vector();
	public Vector getVExposure_dt() {return VExposure_dt;}
	Vector VLimitCalculation = new Vector();
	public Vector getVLimitCalculation() {return VLimitCalculation;}
	Vector VSettlementSellCredit = new Vector();
	public Vector getVSettlementSellCredit() {return VSettlementSellCredit;}
	
	Vector VCustWiseSettlementSellCredit = new Vector(); //HARSH20210209
	public Vector getVCustWiseSettlementSellCredit() {return VCustWiseSettlementSellCredit;}//HARSH20210209
	
	Vector VOpenExposure = new Vector();
	public Vector getVOpenExposure() {return VOpenExposure;}
	Vector VAvailableCredit = new Vector();
	public Vector getVAvailableCredit() {return VAvailableCredit;}
	Vector VDealID = new Vector();//HARSH20210209
	public Vector getVDealID() {return VDealID;}//HARSH20210209
	Vector VTaxRate = new Vector();//HARSH20210210
	public Vector getVTaxRate() {return VTaxRate;}//HARSH20210210
	
	/////////////////////////////////HARSH20210107///////////////////////////////////////////
	Vector VTemp_CustAbbr = new Vector();
	Vector VCustCdLimitMST = new Vector();
	Vector VLimitIdMST = new Vector();
	Vector VParentCd = new Vector();
	Vector VCustCdLimitDTL = new Vector();
	Vector VLimitIdDTL = new Vector();
	Vector VLimitIdDTLDTL = new Vector();
	Vector VMSTCustAbbr = new Vector();
	Vector VDTLCustAbbr = new Vector();
	Vector VSeq = new Vector();
	public void createCustomerMst()
	{
		try
		{
			queryString="select distinct(a.CUSTOMER_CD),a.customer_name,a.customer_abbr from FMS7_CUSTOMER_MST a "
					+ "where a.eff_dt = (select max(b.Eff_dt) from FMS7_CUSTOMER_MST b where a.customer_cd=b.customer_cd) " 
					+ " order by a.customer_name";
			//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				VParent_cd.add(rset.getString(1)==null?"":rset.getString(1));
				VParent_nm.add(rset.getString(2)==null?"":rset.getString(2));
				VParent_abbr.add(rset.getString(3)==null?"":rset.getString(3));//HARSH20210106
				VSell_Buy_Indicator.add("S");//HARSH20201229
				VTemp_CustAbbr.add(rset.getString(3)==null?"":rset.getString(3));
			}
			queryString = "select distinct(a.TRADER_CD),a.TRADER_NAME,a.trader_abbr from FMS7_TRADER_MST a "
					+ "where a.eff_dt = (select max(b.eff_Dt) from FMS7_TRADER_MST b where a.TRADER_CD=b.TRADER_CD) order by a.TRADER_NAME";
			//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
			rset1 = stmt1.executeQuery(queryString);
			while(rset1.next())
			{
				String abbr = rset1.getString(3)==null?"":rset1.getString(3);
				int j =0;
				for(int i=0; i<VTemp_CustAbbr.size(); i++)
				{
					if(VTemp_CustAbbr.elementAt(i).equals(abbr))
					{
						j=j+1;
					}
				}
				if(j==0)
				{
					VParent_cd.add(rset1.getString(1)==null?"":rset1.getString(1));
					VParent_nm.add(rset1.getString(2)==null?"":rset1.getString(2));
					VParent_abbr.add(rset1.getString(3)==null?"":rset1.getString(3));//HARSH20210106
					VSell_Buy_Indicator.add("B");//HARSH20201229
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
	}
	//HARSH20210130////////
	public void replaceData()
	{
		try
		{
			int count1=0;
			String s1="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' AND UPPER(COLUMN_NAME) LIKE 'CUSTOMER_ABBR'";
			rset=stmt.executeQuery(s1);
			if(rset.next()){
				count1=rset.getInt(1);
			}
			if(count1==1)
			{
				queryString="SELECT CUSTOMER_CD,SEQ_NO,LINK,REF_NO FROM FMS9_SECURITY_POST_MST WHERE LINK IS NOT NULL AND CUSTOMER_ABBR IS NULL";
				rset=stmt.executeQuery(queryString);
				while(rset.next())
				{
					String cd = rset.getString(1)==null?"":rset.getString(1);
					String seqno = rset.getString(2)==null?"":rset.getString(2);
					String link = rset.getString(3)==null?"":rset.getString(3);
					String ref_no = rset.getString(4)==null?"":rset.getString(4);
					link=link.substring(0,1);
					if(!link.equals("A"))
					{
						if(link.equals("B"))
						{
							queryString1="SELECT TRADER_ABBR FROM FMS7_TRADER_MST WHERE TRADER_CD='"+cd+"'";
						}else{
							queryString1="SELECT CUSTOMER_ABBR FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+cd+"'";
						}
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next()){
							String custabbr=rset1.getString(1)==null?"":rset1.getString(1);
							String u = "UPDATE FMS9_SECURITY_POST_MST SET CUSTOMER_ABBR='"+custabbr+"' WHERE CUSTOMER_CD='"+cd+"' AND SEQ_NO='"+seqno+"'";
							stmt2.executeUpdate(u);
							conn.commit();
						}
					}else{
						if(!ref_no.equals("") || !ref_no.equals(null) || ref_no != "")
						{
							String split_refno[] = ref_no.split("-");
							//System.out.println(ref_no+"---"+split_refno[0]);
							String u = "UPDATE FMS9_SECURITY_POST_MST SET CUSTOMER_ABBR='"+split_refno[0]+"' WHERE CUSTOMER_CD='"+cd+"' AND SEQ_NO='"+seqno+"'";
							stmt2.executeUpdate(u);
							conn.commit();
						}
					}
				}
			}
			
			int count2=0;
			String s2="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' AND UPPER(COLUMN_NAME) LIKE 'GUARANTOR_ABBR'";
			rset=stmt.executeQuery(s2);
			if(rset.next()){
				count2=rset.getInt(1);
			}
			if(count2 == 1)
			{
				queryString="SELECT CUSTOMER_CD,SEQ_NO,GUARANTOR_NM FROM FMS9_SECURITY_POST_MST WHERE GUARANTOR_NM IS NOT NULL AND GUARANTOR_ABBR IS NULL";
				rset=stmt.executeQuery(queryString);
				while(rset.next())
				{
					String cd = rset.getString(1)==null?"":rset.getString(1);
					String seqno = rset.getString(2)==null?"":rset.getString(2);
					String guran_cd = rset.getString(3)==null?"":rset.getString(3);
					if(!guran_cd.equals("")){
						queryString1="SELECT CUSTOMER_ABBR FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD='"+guran_cd+"'";
						rset1=stmt1.executeQuery(queryString1);
						if(rset1.next()){
							String custabbr=rset1.getString(1)==null?"":rset1.getString(1);
							String u = "UPDATE FMS9_SECURITY_POST_MST SET GUARANTOR_ABBR='"+custabbr+"' WHERE CUSTOMER_CD='"+cd+"' AND SEQ_NO='"+seqno+"'";
							stmt2.executeUpdate(u);
							conn.commit();
						}
					}
					
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	///////////////////////
	//HARSH20210109 ONLY RETURN ONE BANK NAME
	public String BankName(String bank_cd)
	{
		String bank_nm="";
		try
		{
			queryString2="select bank_name from fms7_bank_mst where bank_cd='"+bank_cd+"'";
			Statement s = conn.createStatement();
			ResultSet r = s.executeQuery(queryString2);
			if(r.next())
			{
				bank_nm=r.getString(1)==null?"":r.getString(1);
			}
			r.close();
			s.close();
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		return bank_nm;
	}
	/////////
	//////HARSH20210206//////
	public void credit_rating_detail()
	{
		try
		{
			String rating_dtl = "select credit_rating,to_char(rating_eff_date,'dd/mm/yyyy'),parent_ownship_abbr,parent_ownship,remarks,status,limit_id,bank_cd,cust_abbr,to_char(parent_ent_dt,'dd/mm/yyyy'),to_char(parent_exit_dt,'dd/mm/yyyy'),to_char(ent_dt,'dd/mm/yyyy'),ref_no from fms9_limit_mst where (cust_abbr='"+Lcust_cd+"' or bank_cd='"+Lbank_cd+"') order by limit_id desc"; //and buy_sell='"+sell_buy+"' 
			//System.out.println(rating_dtl);
			rset = stmt.executeQuery(rating_dtl);
			while(rset.next())
			{	
				Vcredit_rating.add(rset.getString(1)==null?"":rset.getString(1));
				Vrating_eff_dt.add(rset.getString(2)==null?"":rset.getString(2));
				String par_cd = rset.getString(3)==null?"0":rset.getString(3);
				String par_cust_nm = "select customer_name,customer_abbr from FMS7_CUSTOMER_MST where customer_abbr='"+par_cd+"'";
				rset1 = stmt1.executeQuery(par_cust_nm);
				if(rset1.next())
				{
					Vparent_ownship_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
					Vparent_ownship_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
				}
				else
				{
					par_cust_nm = "select trader_name,trader_abbr from FMS7_TRADER_MST where trader_abbr='"+par_cd+"'";
					rset1 = stmt1.executeQuery(par_cust_nm);
					if(rset1.next())
					{
						Vparent_ownship_nm.add(rset1.getString(1)==null?"":rset1.getString(1));
						Vparent_ownship_cd.add(rset1.getString(2)==null?"":rset1.getString(2));
					}else{
					Vparent_ownship_cd.add("");
					Vparent_ownship_nm.add("");
					}
				}
				//Vparent_ownship_nm.add();
				Vparent_ownship_per.add(rset.getString(4)==null?"":rset.getString(4));
				Vremarks.add(rset.getString(5)==null?"":rset.getString(5));
				Vstatus.add(rset.getString(6)==null?"":rset.getString(6));
				Vlimit_id_mst.add(rset.getString(7)==null?"":rset.getString(7));
				Vparent_ent_dt.add(rset.getString(10)==null?"":rset.getString(10));
				Vparent_exit_dt.add(rset.getString(11)==null?"":rset.getString(11));
				Vent_dt.add(rset.getString(12)==null?"":rset.getString(12));
				Vrating_ref_no.add(rset.getString(13)==null?"":rset.getString(13));//HARSH20210127
			}
			////////////////////////
			String q_cust_nm ="";
			q_cust_nm = "select customer_name,customer_cd,customer_abbr from FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+Lcust_cd+"'";
			rset1 = stmt1.executeQuery(q_cust_nm);
			if(rset1.next())
			{
				CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
				CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
				CUSTOMER_ABBR.add(rset1.getString(3)==null?"":rset1.getString(3));  //HARSH20210122
			}else{
				q_cust_nm = "select TRADER_NAME,TRADER_CD,TRADER_ABBR from FMS7_TRADER_MST where TRADER_ABBR = '"+Lcust_cd+"'";
				rset1 = stmt1.executeQuery(q_cust_nm);
				if(rset1.next())
				{
					CUSTOMER_CD.add(rset1.getString(2)==null?"":rset1.getString(2));
					CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
					CUSTOMER_ABBR.add(rset1.getString(3)==null?"":rset1.getString(3));  //HARSH20210122
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	////HARSH20210220
	Vector VCUSTOMER_CD = new Vector();
	public Vector getVCUSTOMER_CD() {return VCUSTOMER_CD;}
	Vector VCUSTOMER_NM = new Vector();
	public Vector getVCUSTOMER_NM() {return VCUSTOMER_NM;}
	Vector VCUSTOMER_ABBR = new Vector();
	public Vector getVCUSTOMER_ABBR() {return VCUSTOMER_ABBR;}
	
	public void CustomerMaster()
	{
		try
		{
			queryString="select distinct(a.CUSTOMER_CD),a.customer_name,a.customer_abbr from FMS7_CUSTOMER_MST a "
					+ "where a.eff_dt = (select max(b.Eff_dt) from FMS7_CUSTOMER_MST b where a.customer_cd=b.customer_cd) " 
					+ " order by a.customer_name";
			//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				VCUSTOMER_CD.add(rset.getString(1)==null?"":rset.getString(1));
				VCUSTOMER_NM.add(rset.getString(2)==null?"":rset.getString(2));
				VCUSTOMER_ABBR.add(rset.getString(3)==null?"":rset.getString(3));
				VTemp_CustAbbr.add(rset.getString(3)==null?"":rset.getString(3));
			}
			queryString = "select distinct(a.TRADER_CD),a.TRADER_NAME,a.trader_abbr from FMS7_TRADER_MST a "
					+ "where a.eff_dt = (select max(b.eff_Dt) from FMS7_TRADER_MST b where a.TRADER_CD=b.TRADER_CD) order by a.TRADER_NAME";
			//HARSH20210519 DUBLICATE CUSTOMER APPEAR IN DROP DOWN
			rset1 = stmt1.executeQuery(queryString);
			while(rset1.next())
			{
				String abbr = rset1.getString(3)==null?"":rset1.getString(3);
				int j =0;
				for(int i=0; i<VTemp_CustAbbr.size(); i++)
				{
					if(VTemp_CustAbbr.elementAt(i).equals(abbr))
					{
						j=j+1;
					}
				}
				if(j==0)
				{
					VCUSTOMER_CD.add(rset1.getString(1)==null?"":rset1.getString(1));
					VCUSTOMER_NM.add(rset1.getString(2)==null?"":rset1.getString(2));
					VCUSTOMER_ABBR.add(rset1.getString(3)==null?"":rset1.getString(3));
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	Vector VTEMP_CUSTOMER_CD = new Vector();
	public Vector getVTEMP_CUSTOMER_CD() {return VTEMP_CUSTOMER_CD;}
	public void walkforwardExpoCustomerList()
	{
		try
		{
			queryString = "SELECT TO_CHAR(SYSDATE-1,'DD/MM/YYYY') FROM DUAL";
			rset = stmt.executeQuery(queryString);
			if(rset.next())
			{
				to_date = rset.getString(1)==null?"":rset.getString(1);
				//to_date = "01/12/2020";
			}
			queryString ="select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.SN_NO,A.SN_REV_NO,A.CUSTOMER_CD,A.FGSA_NO,A.FGSA_REV_NO,A.TCQ, " +
			 		"A.SN_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE from FMS7_SN_MST A where "+ 
			 		"(START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND "+ //SB20200916
			 		"A.SN_REV_NO=(SELECT MAX(B.SN_REV_NO) FROM FMS7_SN_MST B where A.SN_NO=B.SN_NO AND A.FGSA_NO=B.FGSA_NO AND " +
			 		"A.CUSTOMER_CD=B.CUSTOMER_CD AND A.FGSA_REV_NO=B.FGSA_REV_NO) order by A.CUSTOMER_CD, A.START_DT";
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				VTEMP_CUSTOMER_CD.add(rset.getString(5)==null?"":rset.getString(5));
			}
			
			queryString =   "select TO_CHAR(A.START_DT,'DD/MM/YYYY'),TO_CHAR(A.END_DT,'DD/MM/YYYY'),A.LOA_NO,A.LOA_REV_NO,A.CUSTOMER_CD,A.TENDER_NO,A.TCQ, " +
					"A.LOA_REF_NO,to_char(A.SIGNING_DT,'dd/mm/yyyy'),A.RATE,FCC_BY,TO_CHAR(FCC_DATE,'DD/mm/yyyy'),EMP_CD,TO_CHAR(ENT_DT,'dd/mm/yyyy'), DCQ, ADV_AMT, TRANSPORTATION_CHARGE  from FMS7_LOA_MST A where "+ 
					"(A.START_DT <= to_date('"+to_date+"','dd/mm/yyyy')"+"AND A.END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND " + //SB20201013
					"A.LOA_REV_NO=(SELECT MAX(B.LOA_REV_NO) FROM FMS7_LOA_MST B where A.LOA_NO=B.LOA_NO AND A.TENDER_NO=B.TENDER_NO AND " +
					"A.CUSTOMER_CD=B.CUSTOMER_CD) order by A.START_DT";
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				VTEMP_CUSTOMER_CD.add(rset.getString(5)==null?"":rset.getString(5));
			}
			
			queryString="select TO_CHAR(START_DT,'DD/MM/YYYY'),TO_CHAR(END_DT,'DD/MM/YYYY'), " +
					"A.mapping_id,A.mapping_id,A.CARGO_REF_NO,A.CARGO_SEQ_NO,A.QTY_TO_BE_SUPPLY,A.REGAS_TARIF, " +
					"C.REV_NO,C.PRE_APPROVAL_BY,TO_CHAR(C.PRE_APPROVAL_DaTE,'DD/MM/YYYY'),C.ENT_BY,TO_CHAR(C.ENT_DT,'DD/MM/YYYY'), DCQ_QTY, A.TARIFF_CUR_FLAG, NO_OF_CARGO from FMS8_LNG_REGAS_CARGO_DTL A, FMS8_LNG_REGAS_MST C where " +
					"(A.CONTRACT_START_DT <= to_date('"+to_date+"','dd/mm/yyyy') AND " +
					"A.CONTRACT_END_DT >= to_date('"+to_date+"','dd/mm/yyyy')) AND A.MAPPING_ID=C.MAPPING_ID " +
					"AND C.CN_NO!='0' AND CN_NO >'9999' AND C.CN_REV_NO=(SELECT MAX(B.CN_REV_NO) FROM FMS8_LNG_REGAS_MST B " +
					"where C.agreement_no=B.agreement_no AND C.customer_cd=B.customer_cd AND B.CN_NO!=0 AND CN_NO >'9999' AND " +
					"B.CN_NO=C.CN_NO AND c.rev_no=B.rev_no AND B.REV_NO=(SELECT MAX(D.REV_NO) FROM FMS8_LNG_REGAS_MST D WHERE " +
					"D.agreement_no=B.agreement_no AND B.customer_cd=D.customer_cd AND D.CN_NO=0 " +
					"AND D.agreement_no=C.agreement_no AND D.customer_cd=C.customer_cd and B.rev_no=D.rev_no and D.rev_no=C.rev_no )) " +  
					"order by A.CONTRACT_START_DT";
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				String map_id=rset.getString(3)==null?"":rset.getString(3);
				String tempmap_id[]=map_id.split("-");
				
				String temp_regas_no=tempmap_id[3];
				String temp_regas_rev_no=tempmap_id[4];
				String temp_cust_cd=tempmap_id[0];
				
				VTEMP_CUSTOMER_CD.add(temp_cust_cd);
			}
			String prv_cust_cd = "";
			
			for(int i=0; i<VTEMP_CUSTOMER_CD.size(); i++)
			{
				if(!prv_cust_cd.equals(VTEMP_CUSTOMER_CD.elementAt(i)))
				{
					queryString = "SELECT CUSTOMER_NAME,CUSTOMER_CD,CUSTOMER_ABBR FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_CD = '"+VTEMP_CUSTOMER_CD.elementAt(i)+"'";
					rset=stmt.executeQuery(queryString);
					if(rset.next())
					{
						VCUSTOMER_CD.add(rset.getString(2)==null?"":rset.getString(2));
						VCUSTOMER_NM.add(rset.getString(1)==null?"":rset.getString(1));
						VCUSTOMER_ABBR.add(rset.getString(3)==null?"":rset.getString(3));
					}
				}
				prv_cust_cd = (String)VTEMP_CUSTOMER_CD.elementAt(i);
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	//New Function HARSH20210303
	public double limit_usage_calculation(String cust_abbr)
	{
		double countSettlementExpo=0;
		try
		{
			String information = "";
			String sysdate="",nextSevenDayDt="",yesdt="",FirstDtOfMonth = "",sysdate_2="";
			queryString = "SELECT TO_CHAR(SYSDATE,'DD/MM/YYYY'),TO_CHAR(SYSDATE+6,'DD/MM/YYYY'),TO_CHAR(SYSDATE-1,'DD/MM/YYYY'),TO_CHAR(SYSDATE-2,'DD/MM/YYYY') FROM DUAL";
			rset3=stmt3.executeQuery(queryString);
			if(rset3.next())
			{
				sysdate = rset3.getString(1)==null?"":rset3.getString(1);
				nextSevenDayDt = rset3.getString(2)==null?"":rset3.getString(2);
				yesdt = rset3.getString(3)==null?"":rset3.getString(3);
				sysdate_2 = rset3.getString(4)==null?"":rset3.getString(4);
			}
			queryString = "SELECT TO_CHAR(trunc(to_date('"+sysdate+"','DD/MM/YYYY')) - (to_number(to_char(to_date('"+sysdate+"','DD/MM/YYYY'),'DD')) - 1),'DD/MM/YYYY') FROM DUAL";
			rset3 = stmt3.executeQuery(queryString);
			if(rset3.next())
			{
				FirstDtOfMonth = rset3.getString(1)==null?"":rset3.getString(1); 
			}
			//IF EXPOSURE EOD PORCESS NOT TRIGGER THEN WE FETCH REPORT DT IS SYSDATE-2 HARSH20210305
			queryString = "SELECT COUNT(*) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT = TO_DATE('"+yesdt+"','DD/MM/YYYY')";
			rset3=stmt3.executeQuery(queryString);
			if(rset3.next())
			{
				if(rset3.getInt(1) > 0)
				{
				}
				else{
					yesdt = sysdate_2;
				}
			}
			queryString = "SELECT DCQ,DEAL_ID,CUSTOMER_CD,PRICE_TYPE,CONT_PRICE,FWD_PRICE_FIN,EFF_DEAL_PRICE,TO_CHAR(DELV_DT,'DD/MM/YYYY') FROM FMS9_EOD_EXPOSURE_DTL "
					+ "WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"' AND EFF_DT=(SELECT MAX(A.EFF_DT) FROM FMS7_CUSTOMER_MST A WHERE A.CUSTOMER_ABBR='"+cust_abbr+"')) AND " //AS PER MAIL ON 27/01/2022 @MAHESH SIR
					+ "REPORT_DT = (SELECT MAX(REPORT_DT) FROM FMS9_EOD_EXPOSURE_DTL WHERE REPORT_DT <= TO_DATE('"+yesdt+"','DD/MM/YYYY')) AND DELV_DT >= TO_DATE('"+FirstDtOfMonth+"','DD/MM/YYYY') AND DELV_DT <= TO_DATE('"+sysdate+"','DD/MM/YYYY') AND DEAL_ID NOT LIKE 'B%'";
			//System.out.println(queryString);
			rset3=stmt3.executeQuery(queryString);
			while(rset3.next())
			{
				String deal_id = rset3.getString(2)==null?"":rset3.getString(2);
				
				String dealNosplit[] = deal_id.split("-");
				String contType = dealNosplit[0].substring(0,1);
				String fgsano = dealNosplit[1];
				String snno = dealNosplit[3];
				
				String OriginalDealId = "";
				if(!contType.equals("C"))
				{
					OriginalDealId = dealNosplit[0].charAt(0)+dealNosplit[1]+"-"+dealNosplit[2]+"-"+dealNosplit[3]+"-"+dealNosplit[4];
				}
				else
				{
					OriginalDealId = deal_id;
				}
				String cust_cd = rset3.getString(3)==null?"":rset3.getString(3);
				String price_type = rset3.getString(4)==null?"":rset3.getString(4);
				
				double cont_price = rset3.getDouble(5); 
				double fwd_price_fin = rset3.getDouble(6);
				double eff_deal_price = rset3.getDouble(7);
				
				String delv_dt = rset3.getString(8)==null?"":rset3.getString(8);
				
				information += "DealId "+OriginalDealId+"~"+delv_dt+"~Price_Type = "+price_type+"~DCQ = "+rset3.getDouble(1)+"~";
				double total = 0;
				if(price_type.equals("Fixed"))
				{
					information+="Cont_Price = "+cont_price+"";
					total = rset3.getDouble(1) * cont_price;
				}else{
					if(fwd_price_fin != 0)
					{
						information+="Fwd_Price_Fin_Leg = "+fwd_price_fin+"";
						total = rset3.getDouble(1) * fwd_price_fin;
					}
					else
					{
						information+="Eff_Deal_Price = "+eff_deal_price+"";
						total = rset3.getDouble(1) * eff_deal_price;
					}
				}
				
				String ExchRateCd="";
				queryString1 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS7_SN_BILLING_DTL WHERE cont_type='"+contType+"' AND customer_cd="+cust_cd+" AND FGSA_NO="+fgsano+" AND sn_no="+snno+" ";
				
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next()){
					ExchRateCd=rset1.getString(1)==null?"":rset1.getString(1);
				}
				double AvailableExchgRate=0;
				queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+sysdate+"','dd/mm/yyyy')) AND FLAG='Y' ";
				
				rset1 = stmt1.executeQuery(queryString2);
				if(rset1.next())
				{
					AvailableExchgRate =rset1.getDouble(1);	
				}
				//System.out.println("AvailableExchgRate###"+AvailableExchgRate);
				
				double AvgTaxInInv = 0;
				queryString2 = "select MAX(FACTOR) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL A, FMS7_TAX_STRUCTURE_DTL B "+
						" WHERE A.TAX_STRUCT_CD=B.TAX_STR_CD AND CUSTOMER_CD="+cust_cd+" AND APP_DATE <= TO_DATE('"+sysdate+"','DD/MM/YYYY') "
						+ "AND A.tax_struct_dt=(SELECT MAX(B.tax_struct_dt) FROM FMS7_CUSTOMER_TAX_STRUCT_DTL B WHERE A.customer_cd=B.customer_cd AND "
						+ "A.plant_seq_no=B.plant_seq_no AND B.tax_struct_dt<= TO_DATE('"+sysdate+"','DD/MM/YYYY'))";
						//System.out.println("STEP-4: FMS7_DAILY_ALLOCATION_DTL: "+queryString);
				rset1 = stmt1.executeQuery(queryString2);
				if(rset1.next())
				{
					AvgTaxInInv=rset1.getDouble(1);
				}
				//System.out.println("AvgTaxInInv###"+AvgTaxInInv);
				information += "~Total = "+total+"~ExchgRate = "+nf.format(AvailableExchgRate)+"";
				double USDtoINR = total * AvailableExchgRate; //System.out.println("USDtoINR@@"+USDtoINR);
				information += "~ApplyTax = "+nf.format(AvgTaxInInv)+"";
				double ApplyTax = USDtoINR * (AvgTaxInInv/100); //System.out.println("ApplyTax@@"+ApplyTax);
				countSettlementExpo += USDtoINR + ApplyTax;	
				
				double tt = USDtoINR + ApplyTax; //only for show 
				information += "~Grand_Total = "+nf.format(tt)+" ";
			}
			
			if(countSettlementExpo >= 0)
			{
			}
			else
			{
				countSettlementExpo = (-1)*(countSettlementExpo);
			}
			VInfo.add(information);
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		return countSettlementExpo;
	}
	///HARSH20210305////
	public void fetch_kpi_report()
	{
		try
		{
			int count7=0;
			String s7="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'FMS9_SECURITY_POST_MST' "+
			" AND UPPER(COLUMN_NAME) LIKE 'INORDER_HIST'";
			rset=stmt.executeQuery(s7);
			if(rset.next()){
				count7=rset.getInt(1);
			}
			if(count7==0){
				s7="ALTER TABLE FMS9_SECURITY_POST_MST ADD INORDER_HIST CHAR(1)";
				stmt.executeUpdate(s7);
				conn.commit();
			}
			int count8=0;
			String s8="SELECT COUNT(COLUMN_NAME) FROM COLS WHERE UPPER(TABLE_NAME) LIKE 'LOG_FMS9_SECURITY_POST_MST' "+
			" AND UPPER(COLUMN_NAME) LIKE 'INORDER_HIST'";
			rset=stmt.executeQuery(s8);
			if(rset.next()){
				count8=rset.getInt(1);
			}
			if(count8==0){
				s8="ALTER TABLE LOG_FMS9_SECURITY_POST_MST ADD INORDER_HIST CHAR(1)";
				stmt.executeUpdate(s8);
				conn.commit();
			}
			
			double InLCAmtConfUSD = 0; double InLCAmtConf = 0; int InLCCountConf = 0; double InLCAmtCancUSD = 0; double InLCAmtCanc = 0; int InLCCountCanc = 0; double InLCAmtAdvisUSD = 0; double InLCAmtAdvis = 0; int InLCCountAdvis = 0;
			double InBGAmtConfUSD = 0; double InBGAmtConf = 0; int InBGCountConf = 0; double InBGAmtCancUSD = 0; double InBGAmtCanc = 0; int InBGCountCanc = 0; double InBGAmtAdvisUSD = 0; double InBGAmtAdvis = 0; int InBGCountAdvis = 0;
			double InPCGAmtConfUSD = 0; double InPCGAmtConf = 0; int InPCGCountConf = 0; double InPCGAmtCancUSD = 0; double InPCGAmtCanc = 0; int InPCGCountCanc = 0; double InPCGAmtAdvisUSD = 0; double InPCGAmtAdvis = 0; int InPCGCountAdvis = 0;
			
			double OutLCAmtConfUSD = 0; double OutLCAmtConf = 0; int OutLCCountConf = 0; double OutLCAmtCancUSD = 0; double OutLCAmtCanc = 0; int OutLCCountCanc = 0; double OutLCAmtAdvisUSD = 0; double OutLCAmtAdvis = 0; int OutLCCountAdvis = 0;
			double OutBGAmtConfUSD = 0; double OutBGAmtConf = 0; int OutBGCountConf = 0; double OutBGAmtCancUSD = 0; double OutBGAmtCanc = 0; int OutBGCountCanc = 0; double OutBGAmtAdvisUSD = 0; double OutBGAmtAdvis = 0; int OutBGCountAdvis = 0;
			double OutPCGAmtConfUSD = 0; double OutPCGAmtConf = 0; int OutPCGCountConf = 0; double OutPCGAmtCancUSD = 0; double OutPCGAmtCanc = 0; int OutPCGCountCanc = 0; double OutPCGAmtAdvisUSD = 0; double OutPCGAmtAdvis = 0; int OutPCGCountAdvis = 0;
			
			/*HARSH20210330 queryString="SELECT SEC_TYPE,ISSUED_RECEIVED,CUSTOMER_ABBR,LINK,REF_NO,STATUS,CURRENCY,VALUE,"
					+ "Issued_date,Received_date,Security_expiry_date,"
					+ "iss_bank_ref,iss_bank_cd,confirm_bank_cd,remarks,confirm_bank_ref,adv_bank_cd,adv_bank_ref,SEQ_NO FROM REPORT_COLLATERAL_KPI "
					+ "where to_date(Received_date,'dd/mm/yyyy') >= to_date('"+from_date+"','dd/mm/yyyy') and to_date(Received_date,'dd/mm/yyyy') <= to_date('"+to_date+"','dd/mm/yyyy') order by to_date(Received_date,'dd/mm/yyyy')";
			System.out.println(queryString);
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				///IF EXCH_RATE IS 0(ZERO) THEN WE USE "SBI TT SELL BUY" EXCG RATE HARSH20210311
				double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
				queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI TT BUY SELL'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
					exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
				}
				queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
						+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchgRate = rset1.getDouble(1);
				}
				/////////////////////////////////////////////////////////////////
				String seq_no = rset.getString(19)==null?"":rset.getString(19); //HARSH20210316
				String cust_abbr = rset.getString(3)==null?"":rset.getString(3);
				
				queryString1 = "SELECT COUNT(*) FROM LOG_FMS9_SECURITY_POST_MST WHERE CUSTOMER_ABBR = '"+cust_abbr+"' AND SEQ_NO = '"+seq_no+"'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					if(rset1.getInt(1) > 0)
					{
						queryString2 = "SELECT SEC_TYPE,ISSUED,RECEIVED,CUSTOMER_ABBR,LINK,REF_NO,STATUS,CURRENCY,VALUE,"
								+ "TO_CHAR(ISSU_DT,'DD/MM/YYYY'),TO_CHAR(REC_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),"
								+ "ISS_BANK_CD,ISS_BANK_REF,ADV_BANK_CD,ADV_BANK_REF,CONFIRM_BANK_CD,CONFIRM_BANK_REF,REMARKS FROM LOG_FMS9_SECURITY_POST_MST "
								+ "WHERE SEC_TYPE IN ('LC','BG','PCG') AND STATUS != 'Pending' AND LINK != '0' AND LINK IS NOT NULL "
								+ "AND CUSTOMER_ABBR = '"+cust_abbr+"' AND SEQ_NO = '"+seq_no+"' AND REC_DT >= to_date('"+from_date+"','dd/mm/yyyy') AND REC_DT <= to_date('"+to_date+"','dd/mm/yyyy') ORDER BY DTL_SEQ_NO DESC";
						rset2=stmt2.executeQuery(queryString2);
						while(rset2.next())
						{
							VSec_Type.add(rset2.getString(1)==null?"":rset2.getString(1));
							if(rset2.getString(2)==null && rset2.getString(3)!= null){
								VInOut.add("Incoming");
							}else if(rset2.getString(2)!= null && rset2.getString(3)== null){
								VInOut.add("Outgoing");
							}else{
								VInOut.add("");
							}
							
							String custabbr = rset2.getString(4)==null?"":rset2.getString(4);
							String cust_nm = getCustomerNm(custabbr);
							CUSTOMER_NM.add(cust_nm);
							
							VDealID.add(rset2.getString(5)==null?"":rset2.getString(5));
							VSecRefNo.add(rset2.getString(6)==null?"":rset2.getString(6));
							VStatus.add(rset2.getString(7)==null?"":rset2.getString(7));
							VIssuance_dt.add(rset2.getString(10)==null?"":rset2.getString(10));
							VReceived_dt.add(rset2.getString(11)==null?"":rset2.getString(11));
							Vexp_dt.add(rset2.getString(12)==null?"":rset2.getString(12));
							String issbankcd = rset2.getString(13)==null?"":rset2.getString(13);
							String issbanknm = BankName(issbankcd);
							VIss_bank_nm.add(issbanknm);
							Viss_bank_ref.add(rset2.getString(14)==null?"":rset2.getString(14));
							
							String advbankcd = rset2.getString(15)==null?"":rset2.getString(15);
							String advbanknm = BankName(advbankcd);
							VAdv_bank_nm.add(advbanknm);
							
							VAdv_bank_ref.add(rset2.getString(16)==null?"":rset2.getString(16));
							
							String conbankcd = rset2.getString(17)==null?"":rset2.getString(17);
							String conbanknm = BankName(conbankcd);
							VConfi_bank_nm.add(conbanknm);
							VConfi_bank_ref.add(rset2.getString(18)==null?"":rset2.getString(18));
							VRemarks.add(rset2.getString(19)==null?"":rset2.getString(19));
							
							///INR to USD & USD to IN
							String deal_id = rset2.getString(5)==null?"":rset2.getString(5);
							String currency = rset2.getString(8)==null?"":rset2.getString(8);
							VCurrency.add(currency);
							double value = rset2.getDouble(9);
							double INRtoUSD = 0;double USDtoINR = 0;
							double INR_Value = 0;double USD_Value = 0;
							
							double AvailableExchgRate = fetchExchgRate(deal_id,custabbr);
							if(!deal_id.substring(0, 1).equals("B"))
							{
								if(currency.equalsIgnoreCase("USD"))
								{
									USDtoINR = value * AvailableExchgRate;
									Vamt.add(nf.format(USDtoINR));
									VAmt_USD.add(nf.format(value));
									INR_Value = USDtoINR;
									USD_Value = value;
									VExchgRate.add(nf.format(AvailableExchgRate));
								}
								else
								{
									if(AvailableExchgRate > 0)
									{
										INRtoUSD = value / AvailableExchgRate;
										VExchgRate.add(nf.format(AvailableExchgRate));
									}
									else
									{
										if(exchgRate > 0)
										{
											INRtoUSD = value / exchgRate;
											VExchgRate.add(nf.format(exchgRate));
										}else
										{
											INRtoUSD = value;
											VExchgRate.add("0.00");
										}
									}
									Vamt.add(nf.format(value));
									VAmt_USD.add(nf.format(INRtoUSD));
									INR_Value = value;
									USD_Value = INRtoUSD;
								}
							}
							else
							{
								if(currency.equalsIgnoreCase("USD"))
								{
									USDtoINR = value * exchgRate;
									Vamt.add(nf.format(USDtoINR));
									VAmt_USD.add(nf.format(value));
									INR_Value = USDtoINR;
									USD_Value = value;
								}
								else
								{
									if(exchgRate > 0)
									{
										INRtoUSD = value / exchgRate;
									}
									else
									{
										INRtoUSD = value;
									}
									Vamt.add(nf.format(value));
									VAmt_USD.add(nf.format(INRtoUSD));
									INR_Value = value;
									USD_Value = INRtoUSD;
									VExchgRate.add(nf.format(exchgRate));
								}
							}
						}		
					}
					else
					{
						VSec_Type.add(rset.getString(1)==null?"":rset.getString(1));
						String InOut = rset.getString(2)==null?"":rset.getString(2);
						if(InOut.equalsIgnoreCase("R"))
						{
							VInOut.add("Incoming");
						}else if(InOut.equalsIgnoreCase("I"))
						{
							VInOut.add("Outgoing");
						}else{
							VInOut.add("");
						}
						
						String cust_nm = getCustomerNm(cust_abbr);
						CUSTOMER_NM.add(cust_nm);
						VDealID.add(rset.getString(4)==null?"":rset.getString(4));
						VSecRefNo.add(rset.getString(5)==null?"":rset.getString(5));
						VStatus.add(rset.getString(6)==null?"":rset.getString(6));
						VIssuance_dt.add(rset.getString(9)==null?"":rset.getString(9));
						VReceived_dt.add(rset.getString(10)==null?"":rset.getString(10));
						Vexp_dt.add(rset.getString(11)==null?"":rset.getString(11));
						Viss_bank_ref.add(rset.getString(12)==null?"":rset.getString(12));
						String issbankcd = rset.getString(13)==null?"":rset.getString(13);
						String issbanknm = BankName(issbankcd);
						VIss_bank_nm.add(issbanknm);
						
						String conbankcd = rset.getString(14)==null?"":rset.getString(14);
						String conbanknm = BankName(conbankcd);
						VConfi_bank_nm.add(conbanknm);
						
						VRemarks.add(rset.getString(15)==null?"":rset.getString(15));
						VConfi_bank_ref.add(rset.getString(16)==null?"":rset.getString(16));
						
						String advbankcd = rset.getString(17)==null?"":rset.getString(17);
						String advbanknm = BankName(advbankcd);
						VAdv_bank_nm.add(advbanknm);
						
						VAdv_bank_ref.add(rset.getString(18)==null?"":rset.getString(18));
						
						///INR to USD & USD to IN
						String deal_id = rset.getString(4)==null?"":rset.getString(4);
						String currency = rset.getString(7)==null?"":rset.getString(7);
						VCurrency.add(currency);
						double value = rset.getDouble(8);
						double INRtoUSD = 0;double USDtoINR = 0;
						double INR_Value = 0;double USD_Value = 0;
						
						double AvailableExchgRate = fetchExchgRate(deal_id,cust_abbr);
						if(!deal_id.substring(0, 1).equals("B"))
						{
							if(currency.equalsIgnoreCase("USD"))
							{
								USDtoINR = value * AvailableExchgRate;
								Vamt.add(nf.format(USDtoINR));
								VAmt_USD.add(nf.format(value));
								INR_Value = USDtoINR;
								USD_Value = value;
								VExchgRate.add(nf.format(AvailableExchgRate));
							}
							else
							{
								if(AvailableExchgRate > 0)
								{
									INRtoUSD = value / AvailableExchgRate;
									VExchgRate.add(nf.format(AvailableExchgRate));
								}
								else
								{
									if(exchgRate > 0)
									{
										INRtoUSD = value / exchgRate;
										VExchgRate.add(nf.format(exchgRate));
									}else
									{
										INRtoUSD = value;
										VExchgRate.add("0.00");
									}
								}
								Vamt.add(nf.format(value));
								VAmt_USD.add(nf.format(INRtoUSD));
								INR_Value = value;
								USD_Value = INRtoUSD;
							}
						}
						else
						{
							if(currency.equalsIgnoreCase("USD"))
							{
								USDtoINR = value * exchgRate;
								Vamt.add(nf.format(USDtoINR));
								VAmt_USD.add(nf.format(value));
								INR_Value = USDtoINR;
								USD_Value = value;
							}
							else
							{
								if(exchgRate > 0)
								{
									INRtoUSD = value / exchgRate;
								}
								else
								{
									INRtoUSD = value;
								}
								Vamt.add(nf.format(value));
								VAmt_USD.add(nf.format(INRtoUSD));
								INR_Value = value;
								USD_Value = INRtoUSD;
								VExchgRate.add(nf.format(exchgRate));
							}
						}
					}
				}
				
				//String SecurityTy = rset.getString(1)==null?"":rset.getString(1);
				//String status = rset.getString(6)==null?"":rset.getString(6);	
			}*/
			
			///IF EXCH_RATE IS 0(ZERO) THEN WE USE "SBI FIRST RATE TT BUY SELL" EXCG RATE HARSH20210311
			double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
			queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI FIRST RATE TT BUY SELL'"; //AS PER FEEDBACK ON 06/04/2021
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
				exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
			}
			queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
					+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				exchgRate = rset1.getDouble(1);
			}
			/////////////////////////////////////////////////////////////////
			queryString2 = "SELECT SEC_TYPE,ISSUED,RECEIVED,CUSTOMER_ABBR,LINK,REF_NO,STATUS,CURRENCY,VALUE,"
					+ "TO_CHAR(ISSU_DT,'DD/MM/YYYY'),TO_CHAR(REC_DT,'DD/MM/YYYY'),TO_CHAR(EXP_DT,'DD/MM/YYYY'),"
					+ "ISS_BANK_CD,ISS_BANK_REF,ADV_BANK_CD,ADV_BANK_REF,CONFIRM_BANK_CD,CONFIRM_BANK_REF,REMARKS,SEQ_NO,DTL_SEQ_NO,TO_CHAR(CANCEL_DT,'DD/MM/YYYY') " //HARSH20210330 SEQ_NO,DTL_SEQ_NO
					+ "FROM LOG_FMS9_SECURITY_POST_MST A "
					+ "WHERE SEC_TYPE IN ('LC','BG','PCG') AND STATUS IN ('In order','Cancelled') "//AND LINK != '0' AND LINK IS NOT NULL "
					+ "AND ((STATUS='Cancelled' AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')>= TO_DATE('"+from_date+"','dd/mm/yyyy') AND TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')<= TO_DATE('"+to_date+"','dd/mm/yyyy'))) "
					+ "OR (STATUS='In order' AND REC_DT >= to_date('"+from_date+"','dd/mm/yyyy') AND REC_DT <= to_date('"+to_date+"','dd/mm/yyyy'))) "
					+ "AND INORDER_HIST='Y' AND MAPPING_ID IS NULL "
					+ "AND DTL_SEQ_NO=(SELECT MAX(DTL_SEQ_NO) FROM LOG_FMS9_SECURITY_POST_MST WHERE CUSTOMER_ABBR=A.CUSTOMER_ABBR AND SEQ_NO=A.SEQ_NO AND STATUS = A.STATUS) "
					+ "ORDER BY CUSTOMER_ABBR ASC,SEQ_NO ASC,DTL_SEQ_NO DESC";
			//HARSH20210610 REMOVE DUPLICATION AS REQUESTED BY JENNINE ON 10/06/2021.
			//HARSH20210525 AS PER JENNIE REQUESTED W/O DEAL WILL APPEAR IN KPI REPORT 24/05/2021
			//AS PER JENNIE MAIL REMOVE LINKED SECURITY ON 07/05/2021 HARSH20210508
			//System.out.println("KPI -- "+queryString2);
			rset2=stmt2.executeQuery(queryString2);
			while(rset2.next())
			{
				String custabbr = rset2.getString(4)==null?"":rset2.getString(4);
				VSec_Type.add(rset2.getString(1)==null?"":rset2.getString(1));
				if(rset2.getString(2)==null && rset2.getString(3)!= null){
					VInOut.add("Incoming");
				}else if(rset2.getString(2)!= null && rset2.getString(3)== null){
					VInOut.add("Outgoing");
				}else{
					VInOut.add("");
				}
				
				String cust_nm = getCustomerNm(custabbr);
				CUSTOMER_NM.add(cust_nm);
				
				String deal_id = rset2.getString(5)==null?"0":rset2.getString(5); //HARSH20210525
				String contType = "";//HARSH20210525
				VDealID.add(""+getDisplayDealId(deal_id)); //HARSH20220228
				VDealId_Display.add(""+getDisplayDealId(deal_id)); //HARSH20220228
				
				VSecRefNo.add(rset2.getString(6)==null?"":rset2.getString(6));
				VStatus.add(rset2.getString(7)==null?"":rset2.getString(7));
				VIssuance_dt.add(rset2.getString(10)==null?"":rset2.getString(10));
				VReceived_dt.add(rset2.getString(11)==null?"":rset2.getString(11));
				Vexp_dt.add(rset2.getString(12)==null?"":rset2.getString(12));
				String issbankcd = rset2.getString(13)==null?"":rset2.getString(13);
				String issbanknm = BankName(issbankcd);
				VIss_bank_nm.add(issbanknm);
				Viss_bank_ref.add(rset2.getString(14)==null?"":rset2.getString(14));
				
				String advbankcd = rset2.getString(15)==null?"":rset2.getString(15);
				String advbanknm = BankName(advbankcd);
				VAdv_bank_nm.add(advbanknm);
				
				VAdv_bank_ref.add(rset2.getString(16)==null?"":rset2.getString(16));
				
				String conbankcd = rset2.getString(17)==null?"":rset2.getString(17);
				String conbanknm = BankName(conbankcd);
				VConfi_bank_nm.add(conbanknm);
				VConfi_bank_ref.add(rset2.getString(18)==null?"":rset2.getString(18));
				VRemarks.add(rset2.getString(19)==null?"":rset2.getString(19));
				VCancelled_DT.add(rset2.getString(22)==null?"":rset2.getString(22)); //HARSH20210412
				
				///INR to USD & USD to IN
				
				String currency = rset2.getString(8)==null?"":rset2.getString(8);
				VCurrency.add(currency);
				double value = rset2.getDouble(9);
				double INRtoUSD = 0;double USDtoINR = 0;
				double INR_Value = 0;double USD_Value = 0;
				
				double AvailableExchgRate = fetchExchgRate(deal_id,custabbr);
				if(!contType.equals("B"))
				{
					if(currency.equalsIgnoreCase("USD"))
					{
						USDtoINR = value * AvailableExchgRate;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(value));
						INR_Value = USDtoINR;
						USD_Value = value;
						VExchgRate.add(nf.format(AvailableExchgRate));
						VCOLOR.add("");//HARSH20210406
					}
					else
					{
						if(AvailableExchgRate > 0)
						{
							INRtoUSD = value / AvailableExchgRate;
							VExchgRate.add(nf.format(AvailableExchgRate));
							VCOLOR.add("");//HARSH20210406
						}
						else
						{
							if(exchgRate > 0)
							{
								INRtoUSD = value / exchgRate;
								VExchgRate.add(nf.format(exchgRate));
								VCOLOR.add("");//HARSH20210406
							}else
							{
								//INRtoUSD = value; AS PER FEEDBACK ON 06/04/2021
								VExchgRate.add("0.00");
								VCOLOR.add("RED");//HARSH20210406
							}
						}
						Vamt.add(nf.format(value));
						VAmt_USD.add(nf2.format(INRtoUSD));
						INR_Value = value;
						USD_Value = INRtoUSD;
					}
				}
				else
				{
					if(currency.equalsIgnoreCase("USD"))
					{
						USDtoINR = value * exchgRate;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(value));
						INR_Value = USDtoINR;
						USD_Value = value;
						VCOLOR.add("");//HARSH20210406
					}
					else
					{
						if(exchgRate > 0)
						{
							INRtoUSD = value / exchgRate;
							VCOLOR.add("");//HARSH20210406
						}
						else
						{
							//INRtoUSD = value; AS PER FEEDBACK ON 06/04/2021
							VCOLOR.add("RED");//HARSH20210406
						}
						Vamt.add(nf.format(value));
						VAmt_USD.add(nf2.format(INRtoUSD));
						INR_Value = value;
						USD_Value = INRtoUSD;
						VExchgRate.add(nf.format(exchgRate));
					}
				}
			}
			//calculate summary
			for(int i=0; i < CUSTOMER_NM.size(); i++)
			{
				String InOut = ""+VInOut.elementAt(i);
				String status = ""+VStatus.elementAt(i);
				String SecurityTy = ""+VSec_Type.elementAt(i);
				String conbankcd = ""+VConfi_bank_nm.elementAt(i);
				double INR_Value = Double.parseDouble(""+Vamt.elementAt(i));
				double USD_Value = Double.parseDouble(""+VAmt_USD.elementAt(i));
				
				if(InOut.equalsIgnoreCase("Incoming"))
				{
					if(status.equalsIgnoreCase("In order") && !conbankcd.equalsIgnoreCase("")) //AS PER FEEDBACK ON 10/03/2021
					{
						if(SecurityTy.equalsIgnoreCase("LC"))
						{
							
							InLCCountConf += 1;
							InLCAmtConf += INR_Value;
							InLCAmtConfUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("BG"))
						{
							InBGCountConf += 1;
							InBGAmtConf += INR_Value;
							InBGAmtConfUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("PCG"))
						{
							InPCGCountConf += 1;
							InPCGAmtConf += INR_Value;
							InPCGAmtConfUSD += USD_Value;
						}
						
					}
					if(status.equalsIgnoreCase("Cancelled"))
					{
						if(SecurityTy.equalsIgnoreCase("LC"))
						{
							InLCCountCanc += 1;
							InLCAmtCanc += INR_Value;
							InLCAmtCancUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("BG"))
						{
							InBGCountCanc += 1;
							InBGAmtCanc += INR_Value;
							InBGAmtCancUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("PCG"))
						{
							InPCGCountCanc += 1;
							InPCGAmtCanc += INR_Value;
							InPCGAmtCancUSD += USD_Value;
						}
					}
					//HARSH20210311 else if(status.equalsIgnoreCase("Pending") || status.equalsIgnoreCase("Pending for amendment") || status.equalsIgnoreCase("Reinstated"))
					if(status.equalsIgnoreCase("In order")) //AS PER FEEDBACK ON 10/03/2021
					{
						if(SecurityTy.equalsIgnoreCase("LC"))
						{
							InLCCountAdvis += 1;
							InLCAmtAdvis += INR_Value;
							InLCAmtAdvisUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("BG"))
						{
							InBGCountAdvis += 1;
							InBGAmtAdvis += INR_Value;
							InBGAmtAdvisUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("PCG"))
						{
							InPCGCountAdvis += 1;
							InPCGAmtAdvis += INR_Value;
							InPCGAmtAdvisUSD += USD_Value;
						}
					}
				}
				else if(InOut.equalsIgnoreCase("Outgoing"))
				{
					if(status.equalsIgnoreCase("In order") && !conbankcd.equalsIgnoreCase("")) //AS PER FEEDBACK ON 10/03/2021
					{
						if(SecurityTy.equalsIgnoreCase("LC"))
						{
							OutLCCountConf += 1;
							OutLCAmtConf += INR_Value;
							OutLCAmtConfUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("BG"))
						{
							OutBGCountConf += 1;
							OutBGAmtConf += INR_Value;
							OutBGAmtConfUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("PCG"))
						{
							OutPCGCountConf += 1;
							OutPCGAmtConf += INR_Value;
							OutPCGAmtConfUSD += USD_Value;
						}
					}
					if(status.equalsIgnoreCase("Cancelled"))
					{
						if(SecurityTy.equalsIgnoreCase("LC"))
						{
							OutLCCountCanc +=1;
							OutLCAmtCanc += INR_Value;
							OutLCAmtCancUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("BG"))
						{
							OutBGCountCanc +=1;
							OutBGAmtCanc += INR_Value;
							OutBGAmtCancUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("PCG"))
						{
							OutPCGCountCanc +=1;
							OutPCGAmtCanc += INR_Value;
							OutPCGAmtCancUSD += USD_Value;
						}
					}
					//HARSH20210011 else if(status.equalsIgnoreCase("Pending") || status.equalsIgnoreCase("Pending for amendment") || status.equalsIgnoreCase("Reinstated"))
					if(status.equalsIgnoreCase("In order")) //AS PER FEEDBACK ON 10/03/2021
					{
						if(SecurityTy.equalsIgnoreCase("LC"))
						{
							OutLCCountAdvis +=1;
							OutLCAmtAdvis += INR_Value;
							OutLCAmtAdvisUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("BG"))
						{
							OutBGCountAdvis +=1;
							OutBGAmtAdvis += INR_Value;
							OutBGAmtAdvisUSD += USD_Value;
						}
						else if(SecurityTy.equalsIgnoreCase("PCG"))
						{
							OutPCGCountAdvis +=1;
							OutPCGAmtAdvis += INR_Value;
							OutPCGAmtAdvisUSD += USD_Value;
						}
					}
				}
			}
			Count_LC_In_Conf = String.valueOf(InLCCountConf);
			Amt_LC_In_Conf = nf.format(InLCAmtConf);
			Amt_LC_In_Conf_USD = nf2.format(InLCAmtConfUSD);
			
			Count_LC_In_Canc = String.valueOf(InLCCountCanc);
			Amt_LC_In_Canc = nf.format(InLCAmtCanc);
			Amt_LC_In_Canc_USD = nf2.format(InLCAmtCancUSD);
			
			Count_LC_In_Advis = String.valueOf(InLCCountAdvis);
			Amt_LC_In_Advis = nf.format(InLCAmtAdvis);
			Amt_LC_In_Advis_USD = nf2.format(InLCAmtAdvisUSD);
			///////////////////////////////////////////////
			Count_BG_In_Conf = String.valueOf(InBGCountConf);
			Amt_BG_In_Conf = nf.format(InBGAmtConf);
			Amt_BG_In_Conf_USD = nf2.format(InBGAmtConfUSD);
			
			Count_BG_In_Canc = String.valueOf(InBGCountCanc);
			Amt_BG_In_Canc = nf.format(InBGAmtCanc);
			Amt_BG_In_Canc_USD = nf2.format(InBGAmtCancUSD);
			
			Count_BG_In_Advis = String.valueOf(InBGCountAdvis);
			Amt_BG_In_Advis= nf.format(InBGAmtAdvis);
			Amt_BG_In_Advis_USD= nf2.format(InBGAmtAdvisUSD);
			///////////////////////////////////////////////////
			Count_PCG_In_Conf = String.valueOf(InPCGCountConf);
			Amt_PCG_In_Conf = nf.format(InPCGAmtConf);
			Amt_PCG_In_Conf_USD = nf2.format(InPCGAmtConfUSD);
			
			Count_PCG_In_Canc = String.valueOf(InPCGCountCanc);
			Amt_PCG_In_Canc = nf.format(InPCGAmtCanc);
			Amt_PCG_In_Canc_USD = nf2.format(InPCGAmtCancUSD);
			
			Count_PCG_In_Advis = String.valueOf(InPCGCountAdvis);
			Amt_PCG_In_Advis= nf.format(InPCGAmtAdvis);
			Amt_PCG_In_Advis_USD= nf2.format(InPCGAmtAdvisUSD);
			///////////////////////////////////////////////////
			Count_LC_Out_Conf = String.valueOf(OutLCCountConf);
			Amt_LC_Out_Conf = nf.format(OutLCAmtConf);
			Amt_LC_Out_Conf_USD = nf2.format(OutLCAmtConfUSD);
			
			Count_LC_Out_Canc = String.valueOf(OutLCCountCanc);
			Amt_LC_Out_Canc = nf.format(OutLCAmtCanc);
			Amt_LC_Out_Canc_USD = nf2.format(OutLCAmtCancUSD);
			
			Count_LC_Out_Advis = String.valueOf(OutLCCountAdvis);
			Amt_LC_Out_Advis = nf.format(OutLCAmtAdvis);
			Amt_LC_Out_Advis_USD = nf2.format(OutLCAmtAdvisUSD);
			/////////////////////////////////////////////////////
			Count_BG_Out_Conf = String.valueOf(OutBGCountConf);
			Amt_BG_Out_Conf = nf.format(OutBGAmtConf);
			Amt_BG_Out_Conf_USD = nf2.format(OutBGAmtConfUSD);
			
			Count_BG_Out_Canc = String.valueOf(OutBGCountCanc);
			Amt_BG_Out_Canc = nf.format(OutBGAmtCanc);
			Amt_BG_Out_Canc_USD = nf2.format(OutBGAmtCancUSD);
			
			Count_BG_Out_Advis = String.valueOf(OutBGCountAdvis);
			Amt_BG_Out_Advis = nf.format(OutBGAmtAdvis);
			Amt_BG_Out_Advis_USD = nf2.format(OutBGAmtAdvisUSD);
			/////////////////////////////////////////////////////
			Count_PCG_Out_Conf = String.valueOf(OutPCGCountConf);
			Amt_PCG_Out_Conf = nf.format(OutPCGAmtConf);
			Amt_PCG_Out_Conf_USD = nf2.format(OutPCGAmtConfUSD);
			
			Count_PCG_Out_Canc = String.valueOf(OutPCGCountCanc);
			Amt_PCG_Out_Canc = nf.format(OutPCGAmtCanc);
			Amt_PCG_Out_Canc_USD = nf2.format(OutPCGAmtCancUSD);
			
			Count_PCG_Out_Advis = String.valueOf(OutPCGCountAdvis);
			Amt_PCG_Out_Advis = nf.format(OutPCGAmtAdvis);
			Amt_PCG_Out_Advis_USD = nf2.format(OutPCGAmtAdvisUSD);			
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	Vector VAmt_USD = new Vector();
	public Vector getVAmt_USD() {return VAmt_USD;}
	
	String Count_LC_In_Conf = new String();
	public String getCount_LC_In_Conf(){return Count_LC_In_Conf;}
	String Amt_LC_In_Conf = new String();
	public String getAmt_LC_In_Conf(){return Amt_LC_In_Conf;}
	String Amt_LC_In_Conf_USD = new String();
	public String getAmt_LC_In_Conf_USD(){return Amt_LC_In_Conf_USD;}
	
	String Count_LC_In_Canc = new String();
	public String getCount_LC_In_Canc(){return Count_LC_In_Canc;}
	String Amt_LC_In_Canc = new String();
	public String getAmt_LC_In_Canc(){return Amt_LC_In_Canc;}
	String Amt_LC_In_Canc_USD = new String();
	public String getAmt_LC_In_Canc_USD(){return Amt_LC_In_Canc_USD;}
	
	String Count_LC_In_Advis = new String();
	public String getCount_LC_In_Advis(){return Count_LC_In_Advis;}
	String Amt_LC_In_Advis = new String();
	public String getAmt_LC_In_Advis(){return Amt_LC_In_Advis;}
	String Amt_LC_In_Advis_USD = new String();
	public String getAmt_LC_In_Advis_USD(){return Amt_LC_In_Advis_USD;}
	
	String Count_BG_In_Conf = new String();
	public String getCount_BG_In_Conf(){return Count_BG_In_Conf;}
	String Amt_BG_In_Conf = new String();
	public String getAmt_BG_In_Conf(){return Amt_BG_In_Conf;}
	String Amt_BG_In_Conf_USD = new String();
	public String getAmt_BG_In_Conf_USD(){return Amt_BG_In_Conf_USD;}
	
	String Count_BG_In_Canc = new String();
	public String getCount_BG_In_Canc(){return Count_BG_In_Canc;}
	String Amt_BG_In_Canc = new String();
	public String getAmt_BG_In_Canc(){return Amt_BG_In_Canc;}
	String Amt_BG_In_Canc_USD = new String();
	public String getAmt_BG_In_Canc_USD(){return Amt_BG_In_Canc_USD;}
	
	String Count_BG_In_Advis = new String();
	public String getCount_BG_In_Advis(){return Count_BG_In_Advis;}
	String Amt_BG_In_Advis = new String();
	public String getAmt_BG_In_Advis(){return Amt_BG_In_Advis;}
	String Amt_BG_In_Advis_USD = new String();
	public String getAmt_BG_In_Advis_USD(){return Amt_BG_In_Advis_USD;}
	
	String Count_PCG_In_Conf = new String();
	public String getCount_PCG_In_Conf(){return Count_PCG_In_Conf;}
	String Amt_PCG_In_Conf = new String();
	public String getAmt_PCG_In_Conf(){return Amt_PCG_In_Conf;}
	String Amt_PCG_In_Conf_USD = new String();
	public String getAmt_PCG_In_Conf_USD(){return Amt_PCG_In_Conf_USD;}
	
	String Count_PCG_In_Canc = new String();
	public String getCount_PCG_In_Canc(){return Count_PCG_In_Canc;}
	String Amt_PCG_In_Canc = new String();
	public String getAmt_PCG_In_Canc(){return Amt_PCG_In_Canc;}
	String Amt_PCG_In_Canc_USD = new String();
	public String getAmt_PCG_In_Canc_USD(){return Amt_PCG_In_Canc_USD;}
	
	String Count_PCG_In_Advis = new String();
	public String getCount_PCG_In_Advis(){return Count_PCG_In_Advis;}
	String Amt_PCG_In_Advis = new String();
	public String getAmt_PCG_In_Advis(){return Amt_PCG_In_Advis;}
	String Amt_PCG_In_Advis_USD = new String();
	public String getAmt_PCG_In_Advis_USD(){return Amt_PCG_In_Advis_USD;}
	
	String Count_LC_Out_Conf = new String();
	public String getCount_LC_Out_Conf(){return Count_LC_Out_Conf;}
	String Amt_LC_Out_Conf = new String();
	public String getAmt_LC_Out_Conf(){return Amt_LC_Out_Conf;}
	String Amt_LC_Out_Conf_USD = new String();
	public String getAmt_LC_Out_Conf_USD(){return Amt_LC_Out_Conf_USD;}
	
	String Count_LC_Out_Canc = new String();
	public String getCount_LC_Out_Canc(){return Count_LC_Out_Canc;}
	String Amt_LC_Out_Canc = new String();
	public String getAmt_LC_Out_Canc(){return Amt_LC_Out_Canc;}
	String Amt_LC_Out_Canc_USD = new String();
	public String getAmt_LC_Out_Canc_USD(){return Amt_LC_Out_Canc_USD;}
	
	String Count_LC_Out_Advis = new String();
	public String getCount_LC_Out_Advis(){return Count_LC_Out_Advis;}
	String Amt_LC_Out_Advis = new String();
	public String getAmt_LC_Out_Advis(){return Amt_LC_Out_Advis;}
	String Amt_LC_Out_Advis_USD = new String();
	public String getAmt_LC_Out_Advis_USD(){return Amt_LC_Out_Advis_USD;}
	
	String Count_BG_Out_Conf = new String();
	public String getCount_BG_Out_Conf(){return Count_BG_Out_Conf;}
	String Amt_BG_Out_Conf = new String();
	public String getAmt_BG_Out_Conf(){return Amt_BG_Out_Conf;}
	String Amt_BG_Out_Conf_USD = new String();
	public String getAmt_BG_Out_Conf_USD(){return Amt_BG_Out_Conf_USD;}
	
	String Count_BG_Out_Canc = new String();
	public String getCount_BG_Out_Canc(){return Count_BG_Out_Canc;}
	String Amt_BG_Out_Canc = new String();
	public String getAmt_BG_Out_Canc(){return Amt_BG_Out_Canc;}
	String Amt_BG_Out_Canc_USD = new String();
	public String getAmt_BG_Out_Canc_USD(){return Amt_BG_Out_Canc_USD;}
	
	String Count_BG_Out_Advis = new String();
	public String getCount_BG_Out_Advis(){return Count_BG_Out_Advis;}
	String Amt_BG_Out_Advis = new String();
	public String getAmt_BG_Out_Advis(){return Amt_BG_Out_Advis;}
	String Amt_BG_Out_Advis_USD = new String();
	public String getAmt_BG_Out_Advis_USD(){return Amt_BG_Out_Advis_USD;}
	
	String Count_PCG_Out_Conf = new String();
	public String getCount_PCG_Out_Conf(){return Count_PCG_Out_Conf;}
	String Amt_PCG_Out_Conf = new String();
	public String getAmt_PCG_Out_Conf(){return Amt_PCG_Out_Conf;}
	String Amt_PCG_Out_Conf_USD = new String();
	public String getAmt_PCG_Out_Conf_USD(){return Amt_PCG_Out_Conf_USD;}
	
	String Count_PCG_Out_Canc = new String();
	public String getCount_PCG_Out_Canc(){return Count_PCG_Out_Canc;}
	String Amt_PCG_Out_Canc = new String();
	public String getAmt_PCG_Out_Canc(){return Amt_PCG_Out_Canc;}
	String Amt_PCG_Out_Canc_USD = new String();
	public String getAmt_PCG_Out_Canc_USD(){return Amt_PCG_Out_Canc_USD;}
	
	String Count_PCG_Out_Advis = new String();
	public String getCount_PCG_Out_Advis(){return Count_PCG_Out_Advis;}
	String Amt_PCG_Out_Advis = new String();
	public String getAmt_PCG_Out_Advis(){return Amt_PCG_Out_Advis;}
	String Amt_PCG_Out_Advis_USD = new String();
	public String getAmt_PCG_Out_Advis_USD(){return Amt_PCG_Out_Advis_USD;}
	
	///NEW FUNCTION HARSH20210309 
	public void fetch_security_status_report()
	{
		try
		{
			queryString = "SELECT CUSTOMER_ABBR,Issueing_Bank_Ref,Deal_Reference,Security_Type,CURRENCY,VALUE,"
					+ "Security_Expiry_Date,Security_Issuing_Date,"
					+ "Security_Status,Remark,FORM_C,SECURITY_REF_NO,CANCEL_DT,ISSUED_RECEIVED "
					+ "FROM REPORT_SECURITY_STATUS "
					+ "WHERE to_date(Security_Issuing_Date,'dd/mm/yyyy') <= to_date('"+to_date+"','dd/mm/yyyy') AND (to_date(Security_Expiry_Date,'dd/mm/yyyy') >= to_date('"+to_date+"','dd/mm/yyyy') AND (to_date(CANCEL_DT,'dd/mm/yyyy') >= to_date('"+to_date+"','dd/mm/yyyy') OR CANCEL_DT IS NULL)) "
					+ " AND Security_Status in('In order','Dummy','Pending for amendment') AND ISSUED_RECEIVED = 'R' order by to_date(Security_Expiry_Date,'dd/mm/yyyy')"; //to_date(Security_Issuing_Date,'dd/mm/yyyy') <= to_date('"+to_date+"','dd/mm/yyyy') and 
			System.out.println(queryString);
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				VInOut.add(rset.getString(14)==null?"R":rset.getString(14)); //HARSH20210716
				
				String cust_abbr = rset.getString(1)==null?"":rset.getString(1);
				queryString1 = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"'";
				rset1 = stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
				}
				else
				{
					queryString1 = "SELECT TRADER_NAME FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+cust_abbr+"'";
					rset1 = stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
					}
					else
					{
						CUSTOMER_NM.add(cust_abbr);
					}
				}
				
				Viss_bank_ref.add(rset.getString(2)==null?"":rset.getString(2));
				String deal = rset.getString(3)==null?"":rset.getString(3);
				VDealID.add(""+getDisplayDealId(deal)); //HARSH20220228
				VDealId_Display.add(""+getDisplayDealId(deal)); //HARSH20220228
				
				VSec_Type.add(rset.getString(4)==null?"":rset.getString(4));
				String currency = rset.getString(5)==null?"":rset.getString(5);
				VCurrency.add(currency);
				//Vamt.add(rset.getString(6)==null?"":rset.getString(6));
				Vexp_dt.add(rset.getString(7)==null?"":rset.getString(7));
				//8
				VStatus.add(rset.getString(9)==null?"":rset.getString(9));
				VRemarks.add(rset.getString(10)==null?"":rset.getString(10));
				VFORM_C.add(rset.getString(11)==null?"":rset.getString(11));
				VRef_no.add(rset.getString(12)==null?"":rset.getString(12));
				VCancelled_DT.add(rset.getString(13)==null?"":rset.getString(13));
				
				//count days before expiry date
				String exp_dt = rset.getString(7)==null?"":rset.getString(7);
				String cancel_dt = rset.getString(13)==null?"":rset.getString(13);
				
				String temp_dt = "";
				if(cancel_dt.equals(""))
				{
					temp_dt = exp_dt;
				}
				else
				{
					temp_dt = cancel_dt;
				}
				//System.out.println(exp_dt);
				queryString1 = "SELECT TO_DATE('"+temp_dt+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL";
				//System.out.println(queryString1);
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					if(rset1.getInt(1) < 46) //AS PER FEEDBACK ON 15/03/2021
					{
						VColor.add("RED");
					}
					else
					{
						VColor.add("");
					}
					VDayBeforeExpiry.add(rset1.getInt(1));
				}
				else
				{
					VColor.add("");
					VDayBeforeExpiry.add("");
				}
				
				///IF EXCH_RATE IS 0(ZERO) THEN WE USE "SBI FIRST RATE TT BUY SELL" EXCG RATE HARSH20210311
				double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
				queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI FIRST RATE TT BUY SELL'"; //AS PER FEEDBACK ON 06/04/2021
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
					exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
				}
				queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
						+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchgRate = rset1.getDouble(1);
				}
				/////////////////////////////////////////////////////////////////
				
				
				//INR to USD & USD to INR
				String deal_id = rset.getString(3)==null?"":rset.getString(3);
				double value = rset.getDouble(6);
				double INRtoUSD = 0;
				double USDtoINR = 0;
				
				String dealNosplit[] = {};
				if(deal_id.contains("-"))
				{
					dealNosplit = deal_id.split("-");
				}
			
				String contType ="";//= dealNosplit[0].substring(0,1);
				if(dealNosplit.length > 0)
				{
					contType = dealNosplit[0].substring(0,1);
				}
				String ExchRateCd="";
				double AvailableExchgRate=0;
				if(!contType.equalsIgnoreCase("B"))
				{
					String fgsano = "0";String snno = "0";
					if(dealNosplit.length > 0)
					{
						fgsano = dealNosplit[0].substring(1,dealNosplit[0].length());
						snno = dealNosplit[2]; 
					}
					
					if(contType.equalsIgnoreCase("C"))
					{
						String map_id = "";
						if(dealNosplit.length > 0) 
						{
							map_id = deal_id.substring(1,deal_id.length());
						}
						
						queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
								" FROM FMS8_LNG_REGAS_BILLING_DTL " +
								"WHERE LTCORA_CN_FLAG='"+contType+"' AND MAPPING_ID='"+map_id+"' ";
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							ExchRateCd=rset2.getString(3)==null?"1":rset2.getString(3);
						}
					}
					else
					{
						queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS7_SN_BILLING_DTL WHERE cont_type='"+contType+"' AND customer_cd=(select customer_cd from fms7_customer_mst where customer_abbr='"+cust_abbr+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"')) AND FGSA_NO="+fgsano+" AND sn_no="+snno+"";
						rset2=stmt2.executeQuery(queryString2);
						if(rset2.next()){
							ExchRateCd=rset2.getString(1)==null?"":rset2.getString(1);
						}	
					}
					queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y' ";
					rset2 = stmt2.executeQuery(queryString2);
					if(rset2.next())
					{
						AvailableExchgRate =rset2.getDouble(1);	
					}
					
					if(currency.equalsIgnoreCase("USD"))
					{
						USDtoINR = value * AvailableExchgRate;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(value));
						VExchgRate.add(nf.format(AvailableExchgRate));
					}
					else
					{
						if(AvailableExchgRate > 0)
						{
							INRtoUSD = value / AvailableExchgRate;
							VExchgRate.add(nf.format(AvailableExchgRate));
						}
						else
						{
							if(exchgRate > 0)
							{
								INRtoUSD = value / exchgRate;
								VExchgRate.add(nf.format(exchgRate));
							}
							else
							{
								INRtoUSD = value;
								VExchgRate.add("0.00");
							}
						}
						Vamt.add(nf.format(value));
						VAmt_USD.add(nf2.format(INRtoUSD));
					}
				}
				else
				{
					if(currency.equalsIgnoreCase("USD"))
					{
						USDtoINR = value * AvailableExchgRate;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(value));
						VExchgRate.add(nf.format(AvailableExchgRate));
					}
					else
					{
						if(AvailableExchgRate > 0)
						{
							INRtoUSD = value / AvailableExchgRate;
							VExchgRate.add(nf.format(AvailableExchgRate));
						}
						else
						{
							if(exchgRate > 0)
							{
								INRtoUSD = value / exchgRate;
								VExchgRate.add(nf.format(exchgRate));
							}
							else
							{
								INRtoUSD = value;
								VExchgRate.add("0.00");
							}
						}
						Vamt.add(nf.format(value));
						VAmt_USD.add(nf2.format(INRtoUSD));
					}
					/*Vamt.add(nf.format(value));
					VAmt_USD.add(nf.format(value));*/
				}
				//VExchgRate.add(nf.format(AvailableExchgRate));
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	Vector VFORM_C = new Vector();
	public Vector getVFORM_C() {return VFORM_C;}
	Vector VDayBeforeExpiry = new Vector();
	public Vector getVDayBeforeExpiry() {return VDayBeforeExpiry;}
	
	//NEW FUNCATION HARSH20210310
	public void fetch_BANK_LIMIT_EXPOSURE()
	{
		try
		{
			queryString = "select DISTINCT cust_abbr,bank_cd from fms9_limit_mst where cust_abbr = 'BANK' and bank_cd != '0'";
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				String cust_abbr = rset.getString(1)==null?"":rset.getString(1);
				String bank_cd = rset.getString(2)==null?"":rset.getString(2);
				String bank_nm = BankName(bank_cd);
				VBank_Name.add(bank_nm);
				VBank_CD.add(bank_cd);
				
				double available = 0;
				double total_limit = 0;
				double unsecured = 0;
				double temporary =0;
				double adjust_usage = 0;
				double net_usage = 0;
				double usage = 0;
				double used = 0;
				
				String limitSummray = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,a.cust_abbr,a.bank_cd,b.remarks from fms9_limit_mst a,fms9_limit_dtl b "
						+ "where (a.cust_abbr='"+cust_abbr+"' and a.bank_cd='"+bank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id and eff_dt <= to_date('"+to_date+"','dd/mm/yyyy') and ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') and inactivation_dt is null) or ((exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') or exp_dt is null) and inactivation_dt-1 >= to_date('"+to_date+"','DD/MM/YYYY')))";    
				rset2 = stmt2.executeQuery(limitSummray);
				while(rset2.next())
				{
					String action_ty = rset2.getString(8)==null?"":rset2.getString(8);
					String limit_ty = rset2.getString(6)==null?"":rset2.getString(6);
					double amt = Double.parseDouble(rset2.getString(1)==null?"0":rset2.getString(1));
								
					if(!limit_ty.equals("Unsecured") && action_ty.equals("Adjust Usage"))
					{
						adjust_usage = adjust_usage + amt;
					}
					if(limit_ty.equals("Unsecured") && action_ty.equals("Adjust Limit"))
					{
						unsecured = unsecured + amt;
					}
					if(limit_ty.equals("Temporary") && action_ty.equals("Adjust Limit"))
					{
						temporary = temporary + amt;
					}	
					if(action_ty.equals("Adjust Limit"))
					{
						total_limit = total_limit + amt;
					}
				}
				available = total_limit + adjust_usage - usage;
				VBank_Limit.add(nf.format(available));
				
				double Limit_USD = 0;
				double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
				queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI FIRST RATE TT BUY SELL'"; //AS PER FEEDBACK ON 06/04/2021
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
					exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
				}
				queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
						+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchgRate = rset1.getDouble(1);
				}
				//System.out.println(exchg_rate_nm);
				if(exchgRate > 0)
				{
					Limit_USD = available / exchgRate;
				}else{
					//Limit_USD = available; AS PER FEEDBACK ON 06/04/2021
				}
				VBank_Limit_USD.add(nf2.format(Limit_USD));
				VExcRate.add(nf.format(exchgRate));
				VExcRateNm.add(exchg_rate_nm);
				
				double value_1 = 0; double value_1_usd = 0; double temp_available = available; double available_usd = 0;
				queryString1 = "SELECT CUSTOMER_ABBR,VALUE,TO_CHAR(ISSU_DT,'DD/MM/YYYY'),REF_NO,CURRENCY,LINK FROM FMS9_SECURITY_POST_MST "
						+ "WHERE ((ISS_BANK_CD IS NOT NULL AND CONFIRM_BANK_CD IS NOT NULL AND CONFIRM_BANK_CD = '"+bank_cd+"') OR (ISS_BANK_CD IS NOT NULL AND CONFIRM_BANK_CD IS NULL AND ISS_BANK_CD = '"+bank_cd+"')) "
						+ "AND SEC_TYPE IN ('LC','BG') AND RECEIVED = 'R' AND ISSUED IS NULL AND ISSU_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND (EXP_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND MAPPING_ID IS NULL "
						+ "AND ((STATUS = 'Dummy' AND APRV_DT IS NULL) OR (FLAG IN ('Y','N','X') AND APRV_DT IS NOT NULL)) ORDER BY ISSU_DT";
				//HARSH20210419 AND (LINK != '0' AND LINK IS NOT NULL) 
				System.out.println(queryString1);
				rset1 = stmt1.executeQuery(queryString1);
				while(rset1.next())
				{
					String custAbbr = rset1.getString(1)==null?"":rset1.getString(1);
					String value = rset1.getString(2)==null?"":rset1.getString(2);
					String issuing_dt = rset1.getString(3)==null?"":rset1.getString(3);
					String deal_no = rset1.getString(6)==null?"0":rset1.getString(6);
					double AvailableExchgRate = fetchExchgRate(deal_no,custAbbr);
					
					String currency = rset1.getString(5)==null?"":rset1.getString(5);
					double amt = rset1.getDouble(2);
					
					double USDtoINR = 0; double INRtoUSD = 0;
					String contType="";
					if(!deal_no.equals(""))
					{
						contType = deal_no.substring(0, 1);
					}
					if(!contType.equals("B"))
					{
						if(currency.equals("USD"))
						{
							USDtoINR = amt * AvailableExchgRate;
							value_1 += USDtoINR;
							value_1_usd += amt;
							//Availability USD calculation
							temp_available = temp_available - USDtoINR;
						}else{
							value_1 += rset1.getDouble(2);
							//Availability USD calculation
							temp_available = temp_available - amt;
							if(AvailableExchgRate > 0)
							{
								value_1_usd += amt / AvailableExchgRate;
							}
							else
							{
								if(exchgRate > 0)
								{
									value_1_usd += amt / exchgRate;
								}
								else
								{
									//value_1_usd +=amt; //AS PER FEEDBACK ON 06/04/2021
								}
								
							}
						}
					}
					else
					{
						if(currency.equals("USD"))
						{
							USDtoINR = amt * exchgRate;
							value_1 += USDtoINR;
							value_1_usd += amt;
							//Availability USD calculation
							temp_available = temp_available - USDtoINR;
						}else{
							value_1 += rset1.getDouble(2);
							//Availability USD calculation
							temp_available = temp_available - amt;
							if(exchgRate > 0)
							{
								value_1_usd += amt / exchgRate;
							}
							else
							{
								//value_1_usd +=amt;//AS PER FEEDBACK 06/04/2021
							}
						}
					}
					
					
					if(AvailableExchgRate > 0)
					{//System.out.println(temp_available );
						available_usd = temp_available / AvailableExchgRate;
					}
					else
					{
						if(exchgRate > 0)
						{
							available_usd = temp_available / exchgRate;
						}
						else
						{
							//available_usd = temp_available; //AS PER FEEDBACK ON 06/04/2021
						}
						
					}
				}
				double availability = available - value_1;
				VExposure_INR.add(nf.format(value_1));
				VExposure_USD.add(nf2.format(value_1_usd));
				VAvailability_INR.add(nf.format(availability));
				VAvailability_USD.add(nf2.format(available_usd));
				
				if(available == 0 && value_1 == 0)
				{
					VColor.add("");
				}
				else
				{
					if(available > value_1) //AS REQUESTED BY JENNINE values to be in red if EXPOSURE (INR & USD) is more than values of BANK LIMIT (INR & USD) 31/05/2021
					{
						VColor.add("");
					}
					else
					{
						VColor.add("RED");
					}
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	public void fetch_BANK_EXPOSURE_DTL()
	{
		try
		{
			double available = 0;
			double total_limit = 0;
			double unsecured = 0;
			double temporary =0;
			double adjust_usage = 0;
			double net_usage = 0;
			double usage = 0;
			double used = 0;
			
			String limitSummray = "select  b.amt,b.amt_unit,b.amt_adj,b.usage_amt,b.limit_id,b.limit_type,b.seq_no,b.action_type,to_char(b.eff_dt,'dd/mm/yyyy'),to_char(b.exp_dt,'dd/mm/yyyy'),to_char(b.review_dt,'dd/mm/yyyy'),b.cat_user_type,a.cust_abbr,a.bank_cd,b.remarks from fms9_limit_mst a,fms9_limit_dtl b "
					+ "where (a.cust_abbr='BANK' and a.bank_cd='"+Bank_cd+"') and a.cust_abbr = b.cust_abbr and a.limit_id = b.limit_id and eff_dt <= to_date('"+to_date+"','dd/mm/yyyy') and ((exp_dt is null and inactivation_dt is null) or (exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') and inactivation_dt is null) or ((exp_dt >= to_date('"+to_date+"','DD/MM/YYYY') or exp_dt is null) and inactivation_dt-1 >= to_date('"+to_date+"','DD/MM/YYYY')))";    
			System.out.println("LimitSum---"+limitSummray);
			rset2 = stmt2.executeQuery(limitSummray);
			while(rset2.next())
			{
				String action_ty = rset2.getString(8)==null?"":rset2.getString(8);
				String limit_ty = rset2.getString(6)==null?"":rset2.getString(6);
				double amt = Double.parseDouble(rset2.getString(1)==null?"0":rset2.getString(1));
							
				if(!limit_ty.equals("Unsecured") && action_ty.equals("Adjust Usage"))
				{
					adjust_usage = adjust_usage + amt;
				}
				if(limit_ty.equals("Unsecured") && action_ty.equals("Adjust Limit"))
				{
					unsecured = unsecured + amt;
				}
				if(limit_ty.equals("Temporary") && action_ty.equals("Adjust Limit"))
				{
					temporary = temporary + amt;
				}	
				if(action_ty.equals("Adjust Limit"))
				{
					total_limit = total_limit + amt;
				}
			}
			available = total_limit + adjust_usage - usage;
			
			bank_nm = BankName(Bank_cd); 
			System.out.println(bank_nm);
			bank_limit = nf.format(available);
			
			double Limit_USD = 0;
			double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
			queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI FIRST RATE TT BUY SELL'"; //AS PER FEEDBACK ON 06/04/2021
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
				exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
			}
			queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
					+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
			rset1=stmt1.executeQuery(queryString1);
			if(rset1.next())
			{
				exchgRate = rset1.getDouble(1);
			}
			//System.out.println(exchg_rate_nm);
			if(exchgRate > 0)
			{
				Limit_USD = available / exchgRate;
			}else{
				//Limit_USD = available; AS PER FEEDBACK ON 06/04/2021
			}
			bank_limit_USD = nf2.format(Limit_USD);
			
			double value_1 = 0; double value_1_usd = 0; double temp_available = available; double available_usd = 0; double available_1 = available;
			queryString1 = "SELECT CUSTOMER_ABBR,VALUE,TO_CHAR(ISSU_DT,'DD/MM/YYYY'),REF_NO,CURRENCY,LINK,CONFIRM_BANK_CD,ISS_BANK_CD,TO_CHAR(EXP_DT,'DD/MM/YYYY'),STATUS,TO_CHAR(CANCEL_DT,'DD/MM/YYYY') FROM FMS9_SECURITY_POST_MST "
					+ "WHERE ((ISS_BANK_CD IS NOT NULL AND CONFIRM_BANK_CD IS NOT NULL AND CONFIRM_BANK_CD = '"+Bank_cd+"') OR (ISS_BANK_CD IS NOT NULL AND CONFIRM_BANK_CD IS NULL AND ISS_BANK_CD = '"+Bank_cd+"')) "
					+ "AND SEC_TYPE IN ('LC','BG') AND RECEIVED = 'R' AND ISSUED IS NULL AND ISSU_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND (EXP_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') AND (TO_DATE(TO_CHAR(CANCEL_DT,'DD/MM/YYYY'),'DD/MM/YYYY')-1 >= TO_DATE('"+to_date+"','DD/MM/YYYY') OR CANCEL_DT IS NULL)) AND MAPPING_ID IS NULL "
					+ "AND ((STATUS = 'Dummy' AND APRV_DT IS NULL) OR (FLAG IN ('Y','N','X') AND APRV_DT IS NOT NULL)) ORDER BY ISSU_DT";
			//HARSH20210419 AND (LINK != '0' AND LINK IS NOT NULL) 
			System.out.println(queryString1);
			rset1 = stmt1.executeQuery(queryString1);
			while(rset1.next())
			{
				String custAbbr = rset1.getString(1)==null?"":rset1.getString(1);
				queryString = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+custAbbr+"'";
				rset = stmt.executeQuery(queryString);
				if(rset.next())
				{
					CUSTOMER_NM.add(rset.getString(1)==null?"":rset.getString(1));
				}
				else
				{
					queryString = "SELECT TRADER_NAME FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+custAbbr+"'";
					rset = stmt.executeQuery(queryString);
					if(rset.next())
					{
						CUSTOMER_NM.add(rset.getString(1)==null?"":rset.getString(1));
					}
					else
					{
						CUSTOMER_NM.add("");
					}
				}
				String value = rset1.getString(2)==null?"":rset1.getString(2);
				String issuing_dt = rset1.getString(3)==null?"":rset1.getString(3);
				String deal_no = rset1.getString(6)==null?"0":rset1.getString(6);
				
				String confbankcd = rset1.getString(7)==null?"":rset1.getString(7);
				String confbanknm = BankName(confbankcd);
				VConfi_bank_nm.add(confbanknm);
				
				String issbankcd = rset1.getString(8)==null?"":rset1.getString(8);
				String issbanknm = BankName(issbankcd);
				VIss_bank_nm.add(issbanknm);
				Vexp_dt.add(rset1.getString(9)==null?"":rset1.getString(9)); //HARSH20210315
				VStatus.add(rset1.getString(10)==null?"":rset1.getString(10)); //HARSH20210415
				VCancelled_DT.add(rset1.getString(11)==null?"":rset1.getString(11)); //HARSH20210415
				
				VDeal_NO.add(""+getDisplayDealId(deal_no)); //HARSH20220228
				VDealId_Display.add(""+getDisplayDealId(deal_no)); //HARSH20220228
			
				VRef_no.add(rset1.getString(4)==null?"":rset1.getString(4));
				VIssuance_dt.add(issuing_dt);
				
				double AvailableExchgRate = fetchExchgRate(deal_no,custAbbr);
				
				String currency = rset1.getString(5)==null?"":rset1.getString(5);
				double amt = rset1.getDouble(2);
				
				double USDtoINR = 0; double INRtoUSD = 0;
				
				String contType="";
				if(!deal_no.equals(""))
				{
					contType = deal_no.substring(0, 1);
				}
				if(!contType.equals("B"))
				{
					if(currency.equals("USD"))
					{
						USDtoINR = amt * AvailableExchgRate;
						available = available - USDtoINR;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(amt));
						
						value_1 += USDtoINR;
						value_1_usd += amt;
						//Availability USD calculation
						temp_available = temp_available - USDtoINR;
						
					}else{
						value_1 += rset1.getDouble(2);
						//Availability USD calculation
						temp_available = temp_available - amt;
						
						Vamt.add(nf.format(amt));
						available = available - amt;
						
						if(AvailableExchgRate > 0)
						{
							INRtoUSD = amt / AvailableExchgRate;
							
							value_1_usd += amt / AvailableExchgRate;
						}
						else
						{
							if(exchgRate > 0)
							{
								INRtoUSD = amt / exchgRate;
								
								value_1_usd += amt / exchgRate;
							}
							else
							{
								//INRtoUSD = amt; //AS PER FEEDBACK ON 06/04/2021
							}	
						}
						VAmt_USD.add(nf2.format(INRtoUSD));
					}
				}
				else
				{
					if(currency.equals("USD"))
					{
						USDtoINR = amt * exchgRate;
						available = available - USDtoINR;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(amt));
						
						value_1 += USDtoINR;
						value_1_usd += amt;
						//Availability USD calculation
						temp_available = temp_available - USDtoINR;
						
					}else{
						value_1 += rset1.getDouble(2);
						//Availability USD calculation
						temp_available = temp_available - amt;
						
						Vamt.add(nf.format(amt));
						available = available - amt;
						
						if(exchgRate > 0)
						{
							INRtoUSD = amt / exchgRate;
							
							value_1_usd += amt / exchgRate;
						}
						else
						{
							//INRtoUSD = amt; //AS PER FEEDBACK ON 06/04/2021
						}	
						VAmt_USD.add(nf2.format(INRtoUSD));
					}
				}
				
				if(AvailableExchgRate > 0)
				{
					VAvailability_DTL_USD.add(nf2.format(available / AvailableExchgRate));
					
					available_usd = temp_available / AvailableExchgRate;
				}
				else
				{
					if(exchgRate > 0)
					{
						VAvailability_DTL_USD.add(nf2.format(available / exchgRate));
						
						available_usd = temp_available / exchgRate;
					}
					else
					{
						//VAvailability_DTL_USD.add(nf.format(available)); //AS PER FEEDBACK ON 06/04/2021
						VAvailability_DTL_USD.add("0.0000");
					}
				}
				VAvailability_DTL_INR.add(nf.format(available));
				VExchgRate.add(nf.format(AvailableExchgRate));
				
				if(available < 0)
				{
					VCOLOR.add("RED");
				}
				else
				{
					VCOLOR.add("");
				}
			}
			double availability = available_1 - value_1;
			Exposure_INR=nf.format(value_1);
			Exposure_USD=nf2.format(value_1_usd);
			Availability_INR=nf.format(availability);
			Availability_USD=nf2.format(available_usd);
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	public double fetchExchgRate(String deal_id,String cust_abbr)
	{
		double AvailableExchgRate=0;
		try
		{
			String dealNosplit[] = {};
			if(deal_id.contains("-"))
			{
				dealNosplit = deal_id.split("-");
			}
		
			String contType ="";//= dealNosplit[0].substring(0,1);
			if(dealNosplit.length > 0)
			{
				contType = dealNosplit[0].substring(0,1);
			}
			String ExchRateCd="";
			
			if(!contType.equalsIgnoreCase("B"))
			{
				String fgsano = "0";String snno = "0";
				if(dealNosplit.length > 0)
				{
					fgsano = dealNosplit[0].substring(1,dealNosplit[0].length());
					snno = dealNosplit[2]; 
				}
				
				if(contType.equalsIgnoreCase("C"))
				{
					String map_id = "";
					if(dealNosplit.length > 0) 
					{
						map_id = deal_id.substring(1,deal_id.length());
					}
					
					queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
							" FROM FMS8_LNG_REGAS_BILLING_DTL " +
							"WHERE LTCORA_CN_FLAG='"+contType+"' AND MAPPING_ID='"+map_id+"' ";
					rset_tmpl = stmt_tmp1.executeQuery(queryString2);
					if(rset_tmpl.next())
					{
						ExchRateCd=rset_tmpl.getString(3)==null?"1":rset_tmpl.getString(3);
					}
				}
				else
				{
					queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS7_SN_BILLING_DTL WHERE cont_type='"+contType+"' AND customer_cd=(select customer_cd from fms7_customer_mst where customer_abbr='"+cust_abbr+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"')) AND FGSA_NO="+fgsano+" AND sn_no="+snno+"";
					rset_tmpl=stmt_tmp1.executeQuery(queryString2);
					if(rset_tmpl.next()){
						ExchRateCd=rset_tmpl.getString(1)==null?"":rset_tmpl.getString(1);
					}	
				}
				queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y' ";
				rset_tmpl = stmt_tmp1.executeQuery(queryString2);
				if(rset_tmpl.next())
				{
					AvailableExchgRate =rset_tmpl.getDouble(1);	
				}
			}
			else
			{
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		
		return AvailableExchgRate;
	}
	
	
	String Bank_cd = "";
	public void setBank_cd(String Bank_cd) {this.Bank_cd = Bank_cd;}
	
	String bank_nm = new String();
	public String getbank_nm(){return bank_nm;}
	String bank_limit = new String();
	public String getbank_lmit(){return bank_limit;}
	String bank_limit_USD = new String();
	public String getbank_limit_USD(){return bank_limit_USD;}
	String Exposure_INR = new String();
	public String getExposure_INR(){return Exposure_INR;}
	String Exposure_USD = new String(); //HARSH20210409
	public String getExposure_USD(){return Exposure_USD;} //HARSH20210409
	String Availability_INR = new String(); //HARSH20210409
	public String getAvailability_INR(){return Availability_INR;} //HARSH20210409
	String Availability_USD = new String(); //HARSH20210409
	public String getAvailability_USD(){return Availability_USD;} //HARSH20210409
	
	
	Vector VExcRateNm = new Vector();
	public Vector getVExcRateNm() {return VExcRateNm;}
	Vector VExcRate = new Vector();
	public Vector getVExcRate() {return VExcRate;}
	
	Vector VBank_Name = new Vector();
	public Vector getVBank_Name() {return VBank_Name;}
	Vector VBank_CD = new Vector();
	public Vector getVBank_CD() {return VBank_CD;}
	Vector VBank_Limit = new Vector();
	public Vector getVBank_Limit() {return VBank_Limit;}
	Vector VBank_Limit_USD = new Vector();
	public Vector getVBank_Limit_USD() {return VBank_Limit_USD;}
	Vector VExposure_INR = new Vector();
	public Vector getVExposure_INR() {return VExposure_INR;}
	Vector VExposure_USD = new Vector();
	public Vector getVExposure_USD() {return VExposure_USD;}
	Vector VAvailability_INR = new Vector();
	public Vector getVAvailability_INR() {return VAvailability_INR;}
	Vector VAvailability_USD = new Vector();
	public Vector getVAvailability_USD() {return VAvailability_USD;}
	
	Vector VAvailability_DTL_INR = new Vector();
	public Vector getVAvailability_DTL_INR() {return VAvailability_DTL_INR;}
	Vector VAvailability_DTL_USD = new Vector();
	public Vector getVAvailability_DTL_USD() {return VAvailability_DTL_USD;}
	
	//HARSH20210313 NEW FUNCTION
	public void payment_receipt_status_report()
	{
		try
		{
			queryString = "SELECT CUSTOMER_ABBR,SEC_TYPE,LINK,TO_CHAR(EXP_DT,'DD/MM/YYYY'),REF_NO,STATUS FROM FMS9_SECURITY_POST_MST "
					+ "WHERE SEC_TYPE IN ('LC','BG','PCG') AND RECEIVED = 'R' AND ISSUED IS NULL AND ISSU_DT <= TO_DATE('"+to_date+"','DD/MM/YYYY') "
					+ "AND EXP_DT >= TO_DATE('"+to_date+"','DD/MM/YYYY') AND STATUS IN ('In order','Dummy','Pending for amendment') AND INORDER_HIST='Y' "//((INORDER_HIST='Y') OR (MAPPING_ID IS NOT NULL AND INORDER_HIST IS NULL))  "
					+ "AND LINK NOT LIKE 'B%' AND LINK != '0' AND LINK IS NOT NULL ORDER BY EXP_DT"; //AS PER JENNIE REQUESTED W/O DEAL NOT REFLECTED IN PAYMENT STATUS REPORT HARSH20210505
			rset = stmt.executeQuery(queryString);
			while(rset.next())
			{
				/*String custAbbr = rset.getString(1)==null?"":rset.getString(1);
				queryString1 = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+custAbbr+"'";
				rset1 = stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
				}
				else
				{
					queryString1 = "SELECT TRADER_NAME FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+custAbbr+"'";
					rset1 = stmt.executeQuery(queryString1);
					if(rset1.next())
					{
						CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
					}
					else
					{
						CUSTOMER_NM.add("");
					}
				}
				
				VSec_Type.add(rset.getString(2)==null?"":rset.getString(2));
				VDeal_NO.add(rset.getString(3)==null?"":rset.getString(3));
				Vexp_dt.add(rset.getString(4)==null?"":rset.getString(4));*/
				
				String custAbbr = rset.getString(1)==null?"":rset.getString(1);
				String deal_no = rset.getString(3)==null?"":rset.getString(3);
				String cont_type = deal_no.substring(0,1);
				//System.out.println(cont_type);
				if(!cont_type.equals("0"))
				{
					///FOR UNPAID INVOICE
					/*HARSH20210422 if(cont_type.equals("C"))
					{
						String mapping_id = deal_no.substring(1,deal_no.length());
						queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
								+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,NEW_INV_SEQ_NO,APPROVED_FLAG,TO_CHAR(DUE_DT,'DD/MM/YYYY') "
								+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR = '"+custAbbr+"') AND MAPPING_ID = '"+mapping_id+"' AND CONTRACT_TYPE='"+cont_type+"' "
								+ "AND FLAG NOT IN  ('A','U') AND INVOICE_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
								+ "AND APPROVED_FLAG='Y' AND CHECKED_FLAG='Y' AND PAY_RECV_AMT IS NULL AND PAY_INSERT_BY IS NULL ORDER BY HLPL_INV_SEQ_NO ";
					}
					else 
					{System.out.println(deal_no);
						String split[] = deal_no.split("-");
						String sn_no = split[2];
						String fgsa_no = split[0].substring(1,split[0].length());
						queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
								+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,NEW_INV_SEQ_NO,APPROVED_FLAG,TO_CHAR(DUE_DT,'DD/MM/YYYY') "
								+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR = '"+custAbbr+"') AND FGSA_NO='"+fgsa_no+"' AND CONTRACT_TYPE='"+cont_type+"' AND "
								+ "SN_NO='"+sn_no+"' AND INVOICE_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
								+ "AND APPROVED_FLAG='Y' AND CHECKED_FLAG='Y' AND PAY_RECV_AMT IS NULL AND PAY_INSERT_BY IS NULL ORDER BY HLPL_INV_SEQ_NO ";
						
					}*/
					
					queryString1 = "SELECT INVOICE_NO,AMT_DC,NET_DUE_DT,DUE_AMT,PAY_RECV_DT "
							+ "FROM VIEW_RECEIVABLE_MST "
							+ "WHERE CUSTOMER_ABBR='"+custAbbr+"' AND DEAL_ASSIGNMENT='"+deal_no+"' AND TO_DATE(BL_DT,'DD/MM/YYYY')>= TO_DATE('01/04/2020','DD/MM/YYYY') "
							+ "AND ((DUE_AMT > 2 AND TO_DATE(NET_DUE_DT,'DD/MM/YYYY') <= TO_DATE('"+to_date+"','DD/MM/YYYY')) OR (DUE_AMT <= 2 AND TO_DATE(NET_DUE_DT,'DD/MM/YYYY') = TO_DATE('"+to_date+"','DD/MM/YYYY') AND TO_DATE(PAY_RECV_DT,'DD/MM/YYYY') <= TO_DATE('"+to_date+"','DD/MM/YYYY')) OR (DUE_AMT <= 2 AND TO_DATE(NET_DUE_DT,'DD/MM/YYYY') <= TO_DATE('"+to_date+"','DD/MM/YYYY') AND TO_DATE(PAY_RECV_DT,'DD/MM/YYYY') = TO_DATE('"+to_date+"','DD/MM/YYYY')))";
					//HARSH20210514 AS PER JENNIE MAIL INVOICE APPEARE ON DUE DATE IN PSR REPORT 14/05/2021
					//System.out.println(queryString1);
					rset1= stmt1.executeQuery(queryString1);
					while(rset1.next())
					{
						VInvoice_Amt.add(nf.format(rset1.getDouble(2))); //HARSH20210422
						
						double invoice_amt = rset1.getDouble(2);
						double invoice_due = rset1.getDouble(4);
						double pay_recv = invoice_amt-invoice_due;
						VInvoice_Rec_Amt.add(nf.format(pay_recv));
						/*String inv_no = rset1.getString(12)==null?"":rset1.getString(12);
						if(inv_no.equals(""))
						{*/
							//VInvoice_No.add(rset1.getString(9)==null?"":rset1.getString(9));
						VInvoice_No.add(rset1.getString(1)==null?"":rset1.getString(1)); //HARSH20210422
						/*}
						else
						{
							VInvoice_No.add(rset1.getString(12)==null?"":rset1.getString(12));
						}*/
						//VPAY_RECV_DT.add(rset1.getString(7)==null?"":rset1.getString(7));
						VPAY_RECV_DT.add(rset1.getString(5)==null?"":rset1.getString(5)); //HARSH20210422
						//VInvoice_Due_Dt.add(rset1.getString(14)==null?"":rset1.getString(14));
						VInvoice_Due_Dt.add(rset1.getString(3)==null?"":rset1.getString(3));
						
						if(invoice_due > 2)
						{
							VStatus.add("Not Received");
							VColor.add("Red");
						}
						else
						{
							VStatus.add("Received");
							VColor.add("");
						}
						
						
						
						String cust_nm = getCustomerNm(custAbbr);
						CUSTOMER_NM.add(cust_nm);
						
						VSec_Type.add(rset.getString(2)==null?"":rset.getString(2));
						String dealno = rset.getString(3)==null?"":rset.getString(3);
						
						VDeal_NO.add(""+getDisplayDealId(dealno));
						VDealId_Display.add(""+getDisplayDealId(dealno));
						
						Vexp_dt.add(rset.getString(4)==null?"":rset.getString(4));
						VRef_NO.add(rset.getString(5)==null?"":rset.getString(5));
						VSecStatus.add(rset.getString(6)==null?"":rset.getString(6));
						
					}
					
				}
				else
				{
					VInvoice_Amt.add("");//HARSH20210422	
					VInvoice_Rec_Amt.add("");
					VInvoice_No.add("");
					
					VPAY_RECV_DT.add("");
					VInvoice_Due_Dt.add("");
					VStatus.add("");
					VColor.add("");
					
					
					String cust_nm = getCustomerNm(custAbbr);
					CUSTOMER_NM.add(cust_nm);
					
					VSec_Type.add(rset.getString(2)==null?"":rset.getString(2));
					String dealno = rset.getString(3)==null?"":rset.getString(3);
					VDeal_NO.add(""+getDisplayDealId(dealno));
					VDealId_Display.add(""+getDisplayDealId(dealno));
					
					Vexp_dt.add(rset.getString(4)==null?"":rset.getString(4));
					VRef_NO.add(rset.getString(5)==null?"":rset.getString(5));
					VSecStatus.add(rset.getString(6)==null?"":rset.getString(6));
				}
				
				/*HARSH20210422 if(!cont_type.equals("0"))
				{
					///FOR PAID INVOICE ONLY ON REPORT DATE
					if(cont_type.equals("C"))
					{
						String mapping_id = deal_no.substring(1,deal_no.length());
						queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
								+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,NEW_INV_SEQ_NO,APPROVED_FLAG,TO_CHAR(DUE_DT,'DD/MM/YYYY') "
								+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR = '"+custAbbr+"') AND MAPPING_ID = '"+mapping_id+"' AND CONTRACT_TYPE='"+cont_type+"' "
								+ "AND FLAG NOT IN  ('A','U') AND INVOICE_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
								+ "AND APPROVED_FLAG='Y' AND CHECKED_FLAG='Y' AND PAY_RECV_AMT IS NOT NULL AND PAY_RECV_DT = TO_DATE('"+to_date+"','DD/MM/YYYY') ORDER BY HLPL_INV_SEQ_NO ";
					}
					else 
					{
						String split[] = deal_no.split("-");
						String sn_no = split[2];
						String fgsa_no = split[0].substring(1,split[0].length());
						queryString1="SELECT (GROSS_AMT_INR), (NET_AMT_INR), (EXCHG_RATE_VALUE),(TAX_AMT_INR),(GROSS_AMT_USD), (PAY_RECV_AMT), TO_CHAR(PAY_RECV_DT,'DD/MM/YYYY') "
								+ " ,(TOTAL_QTY), HLPL_INV_SEQ_NO, FINANCIAL_YEAR, TDS_PERCENT,NEW_INV_SEQ_NO,APPROVED_FLAG,TO_CHAR(DUE_DT,'DD/MM/YYYY') "
								+ " FROM FMS7_INVOICE_MST WHERE CUSTOMER_CD=(SELECT CUSTOMER_CD FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR = '"+custAbbr+"') AND FGSA_NO='"+fgsa_no+"' AND CONTRACT_TYPE='"+cont_type+"' AND "
								+ "SN_NO='"+sn_no+"' AND INVOICE_DT <= TO_DATE('"+to_date+"','dd/mm/yyyy') "
								+ "AND APPROVED_FLAG='Y' AND CHECKED_FLAG='Y' AND PAY_RECV_AMT IS NOT NULL AND PAY_RECV_DT = TO_DATE('"+to_date+"','DD/MM/YYYY') ORDER BY HLPL_INV_SEQ_NO ";
						
					}
					//System.out.println(queryString1);
					rset1= stmt1.executeQuery(queryString1);
					while(rset1.next())
					{
						System.out.println("######################"+deal_no+"####################");
						System.out.println("Amount : "+nf.format(rset1.getDouble(1)));
						System.out.println("Invoice No : "+rset1.getString(12));
						System.out.println("Invoice DUE DT : "+rset1.getString(14));
						System.out.println("Status : "+rset1.getString(13));
						System.out.println("#####################################################");
						
						VInvoice_Rec_Amt.add(nf.format(rset1.getDouble(6)));
						String inv_no = rset1.getString(12)==null?"":rset1.getString(12);
						if(inv_no.equals(""))
						{
							VInvoice_No.add(rset1.getString(9)==null?"":rset1.getString(9));
						}
						else
						{
							VInvoice_No.add(rset1.getString(12)==null?"":rset1.getString(12));
						}
						VPAY_RECV_DT.add(rset1.getString(7)==null?"":rset1.getString(7));
						VInvoice_Due_Dt.add(rset1.getString(14)==null?"":rset1.getString(14));
						VStatus.add("Received");
						VColor.add("");
						
						
						String cust_nm = getCustomerNm(custAbbr);
						CUSTOMER_NM.add(cust_nm);
						
						VSec_Type.add(rset.getString(2)==null?"":rset.getString(2));
						VDeal_NO.add(rset.getString(3)==null?"":rset.getString(3));
						Vexp_dt.add(rset.getString(4)==null?"":rset.getString(4));
						VRef_NO.add(rset.getString(5)==null?"":rset.getString(5));
						VSecStatus.add(rset.getString(6)==null?"":rset.getString(6));
					}
				}*/
				
			}
				/*else
				{
					VInvoice_Rec_Amt.add("");
					VInvoice_No.add("");
					VInvoice_Due_Dt.add("");
					VStatus.add("");
				}*/
			//}
			
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	Vector VInvoice_No = new Vector();
	public Vector getVInvoice_No() {return VInvoice_No;}
	Vector VInvoice_Due_Dt = new Vector();
	public Vector getVInvoice_Due_Dt() {return VInvoice_Due_Dt;}
	Vector VInvoice_Amt = new Vector();
	public Vector getVInvoice_Amt() {return VInvoice_Amt;}
	Vector VInvoice_Rec_Amt = new Vector();
	public Vector getVInvoice_Rec_Amt() {return VInvoice_Rec_Amt;}
	Vector VPAY_RECV_DT = new Vector();
	public Vector getVPAY_RECV_DT() {return VPAY_RECV_DT;}
	
	//FIND CUSTOMER NAME USING CUSTOMER ABBR HARSH20210318
	public String getCustomerNm(String cust_abbr)
	{
		String customer_nm="";
		String query="";
		try
		{
			query = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"'";
			rset_tmpl = stmt_tmp1.executeQuery(query);
			if(rset_tmpl.next())
			{
				customer_nm = rset_tmpl.getString(1)==null?"":rset_tmpl.getString(1);
			}
			else
			{
				query = "SELECT TRADER_NAME FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+cust_abbr+"'";
				rset_tmpl = stmt_tmp1.executeQuery(query);
				if(rset_tmpl.next())
				{
					customer_nm = rset_tmpl.getString(1)==null?"":rset_tmpl.getString(1);
				}
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
		return customer_nm;
	}
	
	//HARSH20210331 NEW FUNCTION AS PER FEEDBACK ON 30/03/2021
	//CHECK CREDIT LIMIT IF EXP_DT <= SYSDATE-1 THEN UPDATE STATUS ACTIVE TO INACTIVE 
	public void Check_Credit_Limit_Expired()
    {
    	try
    	{
    		queryString = "SELECT CUST_ABBR,LIMIT_ID,SEQ_NO FROM FMS9_LIMIT_DTL "
    				+ "WHERE EXP_DT <= TO_DATE(TO_CHAR(SYSDATE-1,'DD/MM/YYYY'),'DD/MM/YYYY') AND EXP_DT IS NOT NULL AND "
    				+ "FLAG = 'Y'";
    		rset=stmt.executeQuery(queryString);
    		while(rset.next())
    		{
    			String cust_abbr = rset.getString(1)==null?"":rset.getString(1);
    			String limit_id = rset.getString(2)==null?"":rset.getString(2);
    			String seq_no = rset.getString(3)==null?"":rset.getString(3);
    			queryString1 = "UPDATE FMS9_LIMIT_DTL SET FLAG='N' WHERE CUST_ABBR = '"+cust_abbr+"' AND LIMIT_ID = '"+limit_id+"' AND SEQ_NO = '"+seq_no+"'";
    			stmt1.executeUpdate(queryString1);
    		}
    		conn.commit();
    	}
    	catch(Exception e)
    	{
    		e.printStackTrace();
    	}
    }
	
	//NEW FUNCTION FOR BLE REPORT EXPORT TO XLS  HARSH20210408
	public void clear()
	{
		CUSTOMER_NM.clear();
		VConfi_bank_nm.clear();
		VIss_bank_nm.clear();
		VIssuance_dt.clear();
		Vexp_dt.clear();
		Vamt.clear();
		VAmt_USD.clear();
		VDeal_NO.clear();
		VRef_no.clear();
		VAvailability_DTL_INR.clear();
		VAvailability_DTL_USD.clear();
	}
	
	//HARSH20210716 AS PER INCIDENT ID#114 NEW REPORT FOR OUTGOING SECURITY STATUS REPORT
	public void fetch_outgoing_security_status_report()
	{
		try
		{
			queryString = "SELECT CUSTOMER_ABBR,Issueing_Bank_Ref,Deal_Reference,Security_Type,CURRENCY,VALUE,"
					+ "Security_Expiry_Date,Security_Issuing_Date,"
					+ "Security_Status,Remark,FORM_C,SECURITY_REF_NO,CANCEL_DT,ISSUED_RECEIVED "
					+ "FROM REPORT_SECURITY_STATUS "
					+ "WHERE to_date(Security_Issuing_Date,'dd/mm/yyyy') <= to_date('"+to_date+"','dd/mm/yyyy') AND (to_date(Security_Expiry_Date,'dd/mm/yyyy') >= to_date('"+to_date+"','dd/mm/yyyy') AND (to_date(CANCEL_DT,'dd/mm/yyyy') >= to_date('"+to_date+"','dd/mm/yyyy') OR CANCEL_DT IS NULL)) "
					+ " AND Security_Status in('In order','Dummy','Pending for amendment') AND ISSUED_RECEIVED = 'I' order by to_date(Security_Expiry_Date,'dd/mm/yyyy')"; //to_date(Security_Issuing_Date,'dd/mm/yyyy') <= to_date('"+to_date+"','dd/mm/yyyy') and 
			System.out.println(queryString);
			rset=stmt.executeQuery(queryString);
			while(rset.next())
			{
				VInOut.add(rset.getString(14)==null?"I":rset.getString(14)); //HARSH20210716
				
				String cust_abbr = rset.getString(1)==null?"":rset.getString(1);
				queryString1 = "SELECT CUSTOMER_NAME FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"'";
				rset1 = stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
				}
				else
				{
					queryString1 = "SELECT TRADER_NAME FROM FMS7_TRADER_MST WHERE TRADER_ABBR='"+cust_abbr+"'";
					rset1 = stmt1.executeQuery(queryString1);
					if(rset1.next())
					{
						CUSTOMER_NM.add(rset1.getString(1)==null?"":rset1.getString(1));
					}
					else
					{
						CUSTOMER_NM.add(cust_abbr);
					}
				}
				
				Viss_bank_ref.add(rset.getString(2)==null?"":rset.getString(2));
				String deal = rset.getString(3)==null?"":rset.getString(3);
				VDealID.add(""+getDisplayDealId(deal)); //HARSH20220228
				VDealId_Display.add(""+getDisplayDealId(deal)); //HARSH20220228
				
				VSec_Type.add(rset.getString(4)==null?"":rset.getString(4));
				String currency = rset.getString(5)==null?"":rset.getString(5);
				VCurrency.add(currency);
				//Vamt.add(rset.getString(6)==null?"":rset.getString(6));
				Vexp_dt.add(rset.getString(7)==null?"":rset.getString(7));
				//8
				VStatus.add(rset.getString(9)==null?"":rset.getString(9));
				VRemarks.add(rset.getString(10)==null?"":rset.getString(10));
				VFORM_C.add(rset.getString(11)==null?"":rset.getString(11));
				VRef_no.add(rset.getString(12)==null?"":rset.getString(12));
				VCancelled_DT.add(rset.getString(13)==null?"":rset.getString(13));
				
				//count days before expiry date
				String exp_dt = rset.getString(7)==null?"":rset.getString(7);
				String cancel_dt = rset.getString(13)==null?"":rset.getString(13);
				
				String temp_dt = "";
				if(cancel_dt.equals(""))
				{
					temp_dt = exp_dt;
				}
				else
				{
					temp_dt = cancel_dt;
				}
				//System.out.println(exp_dt);
				queryString1 = "SELECT TO_DATE('"+temp_dt+"','DD/MM/YYYY')-TO_DATE('"+to_date+"','DD/MM/YYYY') FROM DUAL";
				//System.out.println(queryString1);
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					if(rset1.getInt(1) < 46) //AS PER FEEDBACK ON 15/03/2021
					{
						VColor.add("RED");
					}
					else
					{
						VColor.add("");
					}
					VDayBeforeExpiry.add(rset1.getInt(1));
				}
				else
				{
					VColor.add("");
					VDayBeforeExpiry.add("");
				}
				
				///IF EXCH_RATE IS 0(ZERO) THEN WE USE "SBI FIRST RATE TT BUY SELL" EXCG RATE HARSH20210311
				double exchgRate = 0; String exchg_rate_cd = "",exchg_rate_nm = "";
				queryString1 = "SELECT EXC_RATE_NM,EXC_RATE_CD FROM FMS7_CONT_EXCHG_RATE_MST WHERE UPPER(EXC_RATE_NM) = 'SBI FIRST RATE TT BUY SELL'"; //AS PER FEEDBACK ON 06/04/2021
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchg_rate_nm = rset1.getString(1)==null?"N.A":rset1.getString(1);
					exchg_rate_cd = rset1.getString(2)==null?"":rset1.getString(2);
				}
				queryString1 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"' "
						+ "AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+exchg_rate_cd+"'  AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y'";
				rset1=stmt1.executeQuery(queryString1);
				if(rset1.next())
				{
					exchgRate = rset1.getDouble(1);
				}
				/////////////////////////////////////////////////////////////////
				
				
				//INR to USD & USD to INR
				String deal_id = rset.getString(3)==null?"":rset.getString(3);
				double value = rset.getDouble(6);
				double INRtoUSD = 0;
				double USDtoINR = 0;
				
				String dealNosplit[] = {};
				if(deal_id.contains("-"))
				{
					dealNosplit = deal_id.split("-");
				}
			
				String contType ="";//= dealNosplit[0].substring(0,1);
				if(dealNosplit.length > 0)
				{
					contType = dealNosplit[0].substring(0,1);
				}
				String ExchRateCd="";
				double AvailableExchgRate=0;
				if(!contType.equalsIgnoreCase("B"))
				{
					String fgsano = "0";String snno = "0";
					if(dealNosplit.length > 0)
					{
						fgsano = dealNosplit[0].substring(1,dealNosplit[0].length());
						snno = dealNosplit[2]; 
					}
					
					if(contType.equalsIgnoreCase("C"))
					{
						String map_id = "";
						if(dealNosplit.length > 0) 
						{
							map_id = deal_id.substring(1,deal_id.length());
						}
						
						queryString2 = "SELECT NVL(billing_freq,'F'),NVL(due_date,'0'),NVL(exchng_rate_cd,'0'),NVL(exchng_rate_cal,'D') " +
								" FROM FMS8_LNG_REGAS_BILLING_DTL " +
								"WHERE LTCORA_CN_FLAG='"+contType+"' AND MAPPING_ID='"+map_id+"' ";
						rset2 = stmt2.executeQuery(queryString2);
						if(rset2.next())
						{
							ExchRateCd=rset2.getString(3)==null?"1":rset2.getString(3);
						}
					}
					else
					{
						queryString2 = "SELECT NVL(exchng_rate_cd,'0') FROM FMS7_SN_BILLING_DTL WHERE cont_type='"+contType+"' AND customer_cd=(select customer_cd from fms7_customer_mst where customer_abbr='"+cust_abbr+"' AND EFF_DT = (SELECT MAX(EFF_DT) FROM FMS7_CUSTOMER_MST WHERE CUSTOMER_ABBR='"+cust_abbr+"')) AND FGSA_NO="+fgsano+" AND sn_no="+snno+"";
						rset2=stmt2.executeQuery(queryString2);
						if(rset2.next()){
							ExchRateCd=rset2.getString(1)==null?"":rset2.getString(1);
						}	
					}
					queryString2 = "SELECT EXCHG_VAL FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT =(SELECT MAX(EFF_DT) FROM FMS7_EXCHG_RATE_ENTRY WHERE EXCHG_RATE_CD='"+ExchRateCd+"' AND EFF_DT <= to_date('"+to_date+"','dd/mm/yyyy')) AND FLAG='Y' ";
					rset2 = stmt2.executeQuery(queryString2);
					if(rset2.next())
					{
						AvailableExchgRate =rset2.getDouble(1);	
					}
					
					if(currency.equalsIgnoreCase("USD"))
					{
						USDtoINR = value * AvailableExchgRate;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(value));
						VExchgRate.add(nf.format(AvailableExchgRate));
					}
					else
					{
						if(AvailableExchgRate > 0)
						{
							INRtoUSD = value / AvailableExchgRate;
							VExchgRate.add(nf.format(AvailableExchgRate));
						}
						else
						{
							if(exchgRate > 0)
							{
								INRtoUSD = value / exchgRate;
								VExchgRate.add(nf.format(exchgRate));
							}
							else
							{
								INRtoUSD = value;
								VExchgRate.add("0.00");
							}
						}
						Vamt.add(nf.format(value));
						VAmt_USD.add(nf2.format(INRtoUSD));
					}
				}
				else
				{
					if(currency.equalsIgnoreCase("USD"))
					{
						USDtoINR = value * AvailableExchgRate;
						Vamt.add(nf.format(USDtoINR));
						VAmt_USD.add(nf2.format(value));
						VExchgRate.add(nf.format(AvailableExchgRate));
					}
					else
					{
						if(AvailableExchgRate > 0)
						{
							INRtoUSD = value / AvailableExchgRate;
							VExchgRate.add(nf.format(AvailableExchgRate));
						}
						else
						{
							if(exchgRate > 0)
							{
								INRtoUSD = value / exchgRate;
								VExchgRate.add(nf.format(exchgRate));
							}
							else
							{
								INRtoUSD = value;
								VExchgRate.add("0.00");
							}
						}
						Vamt.add(nf.format(value));
						VAmt_USD.add(nf2.format(INRtoUSD));
					}
					/*Vamt.add(nf.format(value));
					VAmt_USD.add(nf.format(value));*/
				}
				//VExchgRate.add(nf.format(AvailableExchgRate));
			}
		}
		catch(Exception e)
		{
			e.printStackTrace();
		}
	}
	
	//HARSH20210727 GET CONFIGURED MAIL LIST ONLY FOR GEN_TYPE=On-Event
	public String RECIPIENT_LIST(String menu_nm, String module_nm, String rpt_freq, String gen_type)
    {
    	String recipient_list="";
    	try
    	{
    		String report_freq="";
    		String recipient_cd = ""; //HARSH20210528
    		// HARSH20210728 AFTER IMPLEMENTING SUPPORT TABLE
    		int support_flag = 0;
    		queryString="SELECT COUNT(*) FROM FMS9_REPORT_SUPPORT_MST WHERE UPPER(MODULE_NAME)='"+module_nm.toUpperCase()+"' AND "
    				+ "UPPER(MENU_NAME) LIKE '"+menu_nm.toUpperCase()+"' AND UPPER(REPORT_FREQ)='"+rpt_freq.toUpperCase()+"' AND "
    				+ "UPPER(GENERATION_TYPE)='"+gen_type.toUpperCase()+"' AND SUPPORT_FLAG='Y'";
    		System.out.println(queryString);
    		rset_tmpl=stmt_tmp1.executeQuery(queryString);
    		if(rset_tmpl.next())
    		{
    			support_flag=rset_tmpl.getInt(1);
    		}
    		
    		if(support_flag > 0)
    		{
    			
				queryString="SELECT REPORT_FREQ,RECIPIENTS_CD FROM FMS9_REPORT_RECIPIENT_MST WHERE UPPER(MENU_NAME) LIKE '"+menu_nm.toUpperCase()+"' AND "
						+ "UPPER(MODULE_NAME)='"+module_nm.toUpperCase()+"' AND UPPER(REPORT_FREQ)='"+rpt_freq.toUpperCase()+"' AND UPPER(GENERATION_TYPE)='"+gen_type.toUpperCase()+"'";
				System.out.println(queryString);
				rset_tmpl=stmt_tmp1.executeQuery(queryString);
				if(rset_tmpl.next())
				{
					report_freq = rset_tmpl.getString(1)==null?"":rset_tmpl.getString(1);
					recipient_cd = rset_tmpl.getString(2)==null?"0":rset_tmpl.getString(2);
				}
				int count=0;
				
				queryString="SELECT COUNT(*) FROM FMS9_REPORT_RECIPIENT_DTL "
	    				+ "WHERE RECIPIENTS_CD = (SELECT RECIPIENTS_CD FROM FMS9_REPORT_RECIPIENT_MST WHERE RECIPIENTS_CD='"+recipient_cd+"' AND STOP_FLAG='N') "
	    				+ "AND UPPER(ENABLE_DISABLE)='Y'";
				System.out.println(queryString);
				rset_tmpl=stmt_tmp1.executeQuery(queryString);
				if(rset_tmpl.next())
				{
					count = rset_tmpl.getInt(1);
				}
				if(count > 0)
				{
					int temp_count=0;
					queryString="SELECT EMAIL FROM FMS9_REPORT_RECIPIENT_DTL "
		    				+ "WHERE RECIPIENTS_CD = (SELECT RECIPIENTS_CD FROM FMS9_REPORT_RECIPIENT_MST WHERE RECIPIENTS_CD='"+recipient_cd+"' AND STOP_FLAG='N') "
		    				+ "AND UPPER(ENABLE_DISABLE)='Y'";
			    	System.out.println(queryString);
		    		rset_tmpl=stmt_tmp1.executeQuery(queryString);
		    		while(rset_tmpl.next())
		    		{
		    			temp_count=temp_count+1;
		    			if(temp_count == count)
		    			{
		    				recipient_list += rset_tmpl.getString(1)==null?"":rset_tmpl.getString(1);
		    			}
		    			else
		    			{
		    				recipient_list += rset_tmpl.getString(1)==null?"":rset_tmpl.getString(1)+",";
		    			}
		    		}
				}
    		}
    		else
    		{
    			System.out.println("Report Frequency Not Supported!!");
    		}
    		System.out.println("Report :: "+menu_nm);
    		System.out.println("Recipient :: "+recipient_list);
    	}
    	catch(Exception e)
    	{
    		e.printStackTrace();
    	}
    	return recipient_list;
    }
	
	String mail_list = "";//HARSH20210728
	public String getmail_list() {return mail_list;}//HARSH20210728
	Vector VDealId_Display = new Vector();//HARSH20210722
	public Vector getVDealId_Display() {return VDealId_Display;} //HARSH20210722
	
	public String getDisplayDealId(String deal_no) //HARSH20210525
	{
		String display_deal_id="";
		try
		{
			if(deal_no.equalsIgnoreCase("0") || deal_no.equalsIgnoreCase(""))
			{
				display_deal_id="NA";
			}
			else
			{
				String contType = deal_no.substring(0,1);
				if(contType.equals("C"))
				{
					String temp[] = deal_no.split("-");
					display_deal_id=contType+temp[1]+"-"+temp[3];				
				}
				else if(contType.equals("S") || contType.equals("L"))
				{
					String temp[] = deal_no.split("-");
					if(temp.length>4)
					{
						display_deal_id=temp[0]+"-"+temp[2]+"-"+temp[4];
					}
					else
					{
						display_deal_id=temp[0]+"-"+temp[2];
					}
				}
				else
				{
					display_deal_id=deal_no;
				}
			}
		}
		catch (Exception e) 
		{
			e.printStackTrace();
		}
		return display_deal_id;
	}
}//End Of Class DataBean_Cargo ...